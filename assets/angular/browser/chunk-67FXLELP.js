import{a as oe,b as it}from"./chunk-B3ZFSLO6.js";import{a as It}from"./chunk-DUXQYQIP.js";import{a as Te}from"./chunk-5EUTDLE7.js";import{a as yt}from"./chunk-BDYLTSXV.js";import{a as Ie}from"./chunk-X2UZLZXS.js";import{b as te}from"./chunk-A5M3HUGQ.js";import{b as At}from"./chunk-2XFHIHYO.js";import{b as ie}from"./chunk-OXONTOT5.js";import{a as Mt,b as wt}from"./chunk-X5D4Q5JT.js";import{k as ut}from"./chunk-2UZ5XJOB.js";import{b as ne}from"./chunk-5XGECW57.js";import{g as Ae}from"./chunk-3IGMLI3N.js";import{c as Se,e as k,f as Y,g as Ee,h as et,j as D,k as J,l as ye,m as tt,o as Et,p as Me,q as we,r as X,s as Z,t as ee}from"./chunk-F4JB6MJU.js";import{a as Ze}from"./chunk-5RMZ5E5A.js";import{Ab as me,Ac as q,Ba as Ce,Bb as pe,Ca as s,Cc as K,Dc as Q,Eb as Ke,Ec as ve,F as ce,Gb as Qe,Gc as he,Jb as d,Ka as A,Kb as C,Kc as be,Lb as w,Lc as St,Mb as ue,Nb as bt,Pa as W,Qa as Ue,Qb as I,Rb as T,Rc as Je,Sa as qe,Sb as O,Ua as g,Vc as Xe,Wb as Ye,Xb as pt,Yb as y,Z as ze,_ as He,_a as B,ac as P,ba as We,bc as R,dc as U,ec as $,ga as u,gb as l,ha as _,hb as o,ib as r,jb as x,k as se,nb as dt,ob as mt,q as le,qb as h,tb as f,vb as m,w as $e,za as j,zb as de}from"./chunk-4IB5NCLX.js";import{a as ae,b as Be,m as ct}from"./chunk-GG76335P.js";var kt=["modalgestioncarreras"],H=(a,t)=>({"bi-caret-up":a,"bi-caret-down":t}),Lt=(a,t)=>({top:a,left:t});function Gt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m(2);l("ngClass",y(1,H,e.getSortDircarreras("NombreInstitucion")==="asc",e.getSortDircarreras("NombreInstitucion")==="desc"))}}function jt(a,t){if(a&1){let e=h();o(0,"th",23),f("click",function(n){u(e);let c=m();return _(c.sortBycarreras("NombreInstitucion",n))}),d(1," Instituci\xF3n "),g(2,Gt,1,4,"i",24),r()}if(a&2){let e=m();s(2),l("ngIf",e.isSortedcarreras("NombreInstitucion"))}}function Bt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("NombreCarrera")==="asc",e.getSortDircarreras("NombreCarrera")==="desc"))}}function $t(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Area")==="asc",e.getSortDircarreras("Area")==="desc"))}}function zt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Mencion")==="asc",e.getSortDircarreras("Mencion")==="desc"))}}function Ht(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Resolucion")==="asc",e.getSortDircarreras("Resolucion")==="desc"))}}function Wt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Nivel")==="asc",e.getSortDircarreras("Nivel")==="desc"))}}function Ut(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("HorasTotales")==="asc",e.getSortDircarreras("HorasTotales")==="desc"))}}function qt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Visibilidad")==="asc",e.getSortDircarreras("Visibilidad")==="desc"))}}function Kt(a,t){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",y(1,H,e.getSortDircarreras("Estado")==="asc",e.getSortDircarreras("Estado")==="desc"))}}function Qt(a,t){if(a&1&&(o(0,"tr")(1,"td",21)(2,"div",33)(3,"span",34),d(4,"Cargando..."),r()()()()),a&2){let e=m();s(),B("colspan",e.esSuperAdmin?11:10)}}function Yt(a,t){if(a&1&&(o(0,"tr")(1,"td",21),d(2,"No hay datos disponibles"),r()()),a&2){let e=m();s(),B("colspan",e.esSuperAdmin?11:10)}}function Jt(a,t){if(a&1&&(o(0,"td"),d(1),r()),a&2){let e=m().$implicit;s(),C(e.NombreInstitucion)}}function Xt(a,t){if(a&1&&x(0,"img",41),a&2){let e=m(2);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function Zt(a,t){if(a&1&&x(0,"ng-lottie",42),a&2){let e=m(2);l("options",e._tools.optionsEditar)}}function ei(a,t){if(a&1&&x(0,"img",41),a&2){let e=m(2);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function ti(a,t){if(a&1&&x(0,"ng-lottie",42),a&2){let e=m(2);l("options",e._tools.optionsEliminar)}}function ii(a,t){if(a&1){let e=h();o(0,"tr",35),f("contextmenu",function(n){let c=u(e).$implicit,p=m();return _(p.abrirMenucarreras(n,c))}),o(1,"td",21),d(2),r(),g(3,Jt,2,1,"td",25),o(4,"td"),d(5),r(),o(6,"td"),d(7),r(),o(8,"td"),d(9),r(),o(10,"td"),d(11),r(),o(12,"td"),d(13),r(),o(14,"td"),d(15),r(),o(16,"td"),d(17),r(),o(18,"td"),d(19),r(),o(20,"td",36)(21,"button",37),f("click",function(){let n=u(e).$implicit,c=m();return _(c.Seleccionarcarreras(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m();return _(c._tools.hoverBotonMap["edicioncarreras-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m();return _(c._tools.hoverBotonMap["edicioncarreras-"+n.id]=!1)}),g(22,Xt,1,1,"img",38)(23,Zt,1,1,"ng-lottie",39),r(),o(24,"button",40),f("click",function(){let n=u(e).$implicit,c=m();return _(c.Eliminarcarreras(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m();return _(c._tools.hoverBotonMap["eliminacioncarreras-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m();return _(c._tools.hoverBotonMap["eliminacioncarreras-"+n.id]=!1)}),g(25,ei,1,1,"img",38)(26,ti,1,1,"ng-lottie",39),r()()()}if(a&2){let e=t.index,i=t.$implicit,n=m();s(2),C((n.paginacarreras-1)*n.pageSizecarreras+(e+1)),s(),l("ngIf",n.esSuperAdmin),s(2),C(i.NombreCarrera),s(2),C(i.Area),s(2),C(i.Mencion),s(2),C(i.Resolucion),s(2),C(i.Nivel),s(2),C(i.HorasTotales),s(2),C(i.Visibilidad),s(2),C(i.Estado),s(3),l("ngIf",!n._tools.hoverBotonMap["edicioncarreras-"+i.id]),s(),l("ngIf",n._tools.hoverBotonMap["edicioncarreras-"+i.id]),s(2),l("ngIf",!n._tools.hoverBotonMap["eliminacioncarreras-"+i.id]),s(),l("ngIf",n._tools.hoverBotonMap["eliminacioncarreras-"+i.id])}}function ni(a,t){if(a&1&&(o(0,"option",43),d(1),r()),a&2){let e=t.$implicit;l("value",e),s(),w("",e," por p\xE1gina")}}function oi(a,t){if(a&1&&(o(0,"option",43),d(1),r()),a&2){let e=t.$implicit;l("value",e.id),s(),C(e.Nombre)}}function ri(a,t){if(a&1&&(o(0,"div",84)(1,"select",85),g(2,oi,2,2,"option",30),r(),o(3,"label"),d(4,"Instituci\xF3n"),r(),o(5,"div",52),d(6,"Este campo es obligatorio*"),r()()),a&2){let e=m(2);s(),l("ngClass",e.ValidacioncarrerasxElemento("instituciones_id")),s(),l("ngForOf",e.instituciones)}}function ai(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function si(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function li(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function ci(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function di(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function mi(a,t){if(a&1&&(o(0,"option",86),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function pi(a,t){if(a&1){let e=h();o(0,"button",89),f("click",function(){u(e);let n=m(3);return _(n.AutoCompletarLastcarreras())}),o(1,"span",8),x(2,"ng-lottie",9),r(),o(3,"span"),d(4,"AUTO COMPLETAR "),r(),x(5,"span",10),r()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function ui(a,t){if(a&1&&(o(0,"div",87),g(1,pi,6,1,"button",88),r()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalcarreras)}}function _i(a,t){if(a&1){let e=h();o(0,"button",90),f("click",function(){u(e);let n=m().$implicit,c=m();return n.dismiss(),_(c.resetcarreras())}),o(1,"span",8),x(2,"ng-lottie",9),r(),o(3,"span"),d(4,"CANCELAR"),r(),x(5,"span",10),r()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function gi(a,t){if(a&1){let e=h();o(0,"button",91),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarcarreras())}),x(1,"span",92),r()}a&2&&l("disabled",!0)}function fi(a,t){if(a&1){let e=h();o(0,"button",93),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarcarreras())}),o(1,"span",8),x(2,"ng-lottie",9),r(),o(3,"span"),d(4),r(),x(5,"span",10),r()}if(a&2){let e,i,n=m(2);s(2),l("options",(e=n.newcarreras.get("id"))!=null&&e.value?n._tools.optionsEditar:n._tools.optionsAdicionar),s(2),C((i=n.newcarreras.get("id"))!=null&&i.value?"MODIFICAR":"REGISTRAR")}}function xi(a,t){if(a&1){let e=h();o(0,"div",44)(1,"h4",45),d(2),r(),o(3,"button",46),f("click",function(){let n=u(e).$implicit,c=m();return n.dismiss(),_(c.resetcarreras())}),r()(),o(4,"div",47)(5,"form",48),g(6,ri,7,2,"div",49),o(7,"div",2)(8,"div",50)(9,"input",51),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"Area"))}),r(),o(10,"label"),d(11,"Area"),r(),o(12,"div",52),d(13,"Este campo es obligatorio*"),r()(),o(14,"div",50)(15,"input",53),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"Mencion"))}),r(),o(16,"label"),d(17,"Mencion"),r(),o(18,"div",52),d(19,"Este campo es obligatorio*"),r()(),o(20,"div",50)(21,"input",54),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"Resolucion"))}),r(),o(22,"label"),d(23,"Resolucion"),r(),o(24,"div",52),d(25,"Este campo es obligatorio*"),r()(),o(26,"div",50)(27,"input",55),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"NombreCarrera"))}),r(),o(28,"label"),d(29,"Nombre de Carrera"),r(),o(30,"div",52),d(31,"Este campo es obligatorio*"),r()()(),o(32,"div",2)(33,"div",56)(34,"input",57),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"HorasTotales"))}),r(),o(35,"label"),d(36,"Horas Totales"),r(),o(37,"div",52),d(38,"Este campo es obligatorio*"),r()(),o(39,"div",56)(40,"select",58)(41,"option",59),d(42,"Seleccione una opci\xF3n"),r(),g(43,ai,2,3,"option",60),r(),o(44,"label"),d(45,"Nivel"),r(),o(46,"div",52),d(47,"Este campo es obligatorio*"),r()(),o(48,"div",56)(49,"select",61)(50,"option",59),d(51,"Seleccione una opci\xF3n"),r(),g(52,si,2,3,"option",60),r(),o(53,"label"),d(54,"Cantidad Evaluaciones"),r(),o(55,"div",52),d(56,"Este campo es obligatorio*"),r()()(),o(57,"div",2)(58,"div",50),x(59,"input",62),o(60,"label"),d(61,"Limite M\xE1ximo Te\xF3rico"),r(),o(62,"div",52),d(63,"Este campo es obligatorio*"),r()(),o(64,"div",50),x(65,"input",63),o(66,"label"),d(67,"Limite M\xE1ximo Pr\xE1ctico"),r(),o(68,"div",52),d(69,"Este campo es obligatorio*"),r()(),o(70,"div",50),x(71,"input",64),o(72,"label"),d(73,"Nota M\xEDnima Aprobaci\xF3n"),r(),o(74,"div",52),d(75,"Este campo es obligatorio*"),r()(),o(76,"div",50),x(77,"input",65),o(78,"label"),d(79,"Nota M\xEDnima 2da Instancia"),r(),o(80,"div",52),d(81,"Este campo es obligatorio*"),r()()(),o(82,"div",2)(83,"div",56)(84,"input",66),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"TituloOficial"))}),r(),o(85,"label"),d(86,"Titulo Oficial"),r(),o(87,"div",52),d(88,"Este campo es obligatorio*"),r()(),o(89,"div",56)(90,"select",67)(91,"option",59),d(92,"Seleccione una opci\xF3n"),r(),g(93,li,2,3,"option",60),r(),o(94,"label"),d(95,"Programa"),r(),o(96,"div",52),d(97,"Este campo es obligatorio*"),r()(),o(98,"div",56)(99,"input",68),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"Duracion"))}),r(),o(100,"label"),d(101,"Duracion"),r(),o(102,"div",52),d(103,"Este campo es obligatorio*"),r()()(),o(104,"div",2)(105,"div",69)(106,"input",70),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"Capacitacion"))}),r(),o(107,"label"),d(108,"Capacitaci\xF3n"),r(),o(109,"div",52),d(110,"Este campo es obligatorio*"),r()(),o(111,"div",69)(112,"input",71),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newcarreras,"CarreraProfesional"))}),r(),o(113,"label"),d(114,"Carrera Profesional"),r(),o(115,"div",52),d(116,"Este campo es obligatorio*"),r()()(),o(117,"div",2)(118,"div",56)(119,"select",72)(120,"option",59),d(121,"Seleccione una opci\xF3n"),r(),g(122,ci,2,3,"option",60),r(),o(123,"label"),d(124,"Modalidad"),r(),o(125,"div",52),d(126,"Este campo es obligatorio*"),r()(),o(127,"div",56)(128,"select",73)(129,"option",59),d(130,"Seleccione una opci\xF3n"),r(),g(131,di,2,3,"option",60),r(),o(132,"label"),d(133,"Visibilidad"),r(),o(134,"div",52),d(135,"Este campo es obligatorio*"),r()(),o(136,"div",56)(137,"select",74)(138,"option",59),d(139,"Seleccione una opci\xF3n"),r(),g(140,mi,2,3,"option",60),r(),o(141,"label"),d(142,"Estado"),r(),o(143,"div",52),d(144,"Este campo es obligatorio*"),r()(),o(145,"div",75)(146,"label"),d(147,"Descripci\xF3n"),r(),x(148,"quill-editor",76),o(149,"div",52),d(150,"Este campo es obligatorio*"),r()()()()(),o(151,"div",77),g(152,ui,2,1,"div",78),o(153,"div",79),g(154,_i,6,1,"button",80),r(),o(155,"div",81),g(156,gi,2,1,"button",82)(157,fi,6,2,"button",83),r()()}if(a&2){let e,i=m();s(2),w("",(e=i.newcarreras.get("id"))!=null&&e.value?"Modificar":"Registrar"," carreras"),s(3),l("formGroup",i.newcarreras),s(),l("ngIf",i.esSuperAdmin),s(3),l("ngClass",i.ValidacioncarrerasxElemento("Area")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Mencion")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Resolucion")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("NombreCarrera")),s(7),l("ngClass",i.ValidacioncarrerasxElemento("HorasTotales")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Nivel")),s(3),l("ngForOf",i.nivelcarreraOptions),s(6),l("ngClass",i.ValidacioncarrerasxElemento("CantidadEvaluaciones")),s(3),l("ngForOf",i.cantidadevaluacionesOptions),s(7),l("ngClass",i.ValidacioncarrerasxElemento("LimiteMaxTeorico")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("LimiteMaxPractico")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("NotaAprobacion")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("NotaMinRevalida")),s(7),l("ngClass",i.ValidacioncarrerasxElemento("TituloOficial")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Programa")),s(3),l("ngForOf",i.programaOptions),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Duracion")),s(7),l("ngClass",i.ValidacioncarrerasxElemento("Capacitacion")),s(6),l("ngClass",i.ValidacioncarrerasxElemento("CarreraProfesional")),s(7),l("ngClass",i.ValidacioncarrerasxElemento("Modalidad")),s(3),l("ngForOf",i.modalidadOptions),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Visibilidad")),s(3),l("ngForOf",i.visibilidadOptions),s(6),l("ngClass",i.ValidacioncarrerasxElemento("Estado")),s(3),l("ngForOf",i.estadoOptions),s(8),l("modules",i.modulesQuillEdicion)("ngClass",i.ValidacioncarrerasxElemento("Descripcion")),s(4),l("ngIf",!i.newcarreras.get("id").value),s(2),l("ngIf",!i.AnimacionCargabtnModalcarreras),s(2),l("ngIf",i.AnimacionCargabtnModalcarreras),s(),l("ngIf",!i.AnimacionCargabtnModalcarreras)}}function Ci(a,t){if(a&1){let e=h();o(0,"button",96),f("click",function(){let n=u(e).$implicit;return _(n.action())}),d(1),r()}if(a&2){let e=t.$implicit;s(),w(" ",e.label," ")}}function vi(a,t){if(a&1&&(o(0,"div",94),P(1,"async"),P(2,"async"),g(3,Ci,2,1,"button",95),P(4,"async"),r()),a&2){let e,i,n=m();l("ngStyle",y(8,Lt,((e=R(1,2,n.menuStatecarreras$))==null?null:e.y)+"px",((e=R(2,4,n.menuStatecarreras$))==null?null:e.x)+"px")),s(3),l("ngForOf",(i=R(4,6,n.menuStatecarreras$))==null?null:i.items)}}var Oe=class Oe{constructor(t,e,i,n,c){this._carr=t;this._tools=e;this._inst=i;this._controles=n;this._auth=c;this.modulesQuillEdicion={toolbar:[["bold","italic","underline","strike"],[{align:[]}],[{size:["small",!1,"large"]}],[{color:[]},{background:[]}],[{font:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","video"],["clean"]]};this.modulesQuillShow={toolbar:!1};this.esSuperAdmin=!1;this.estadoOptions=[];this.visibilidadOptions=[];this.programaOptions=[];this.modalidadOptions=[];this.nivelcarreraOptions=[];this.cantidadevaluacionesOptions=[];this.carreras=[];this.paginacarreras=1;this.isLoadingcarreras=!0;this.AnimacionCargabtnModalcarreras=!1;this.filtertxtcarreras="";this.collectionSizecarreras=0;this.pageSizecarreras=10;this.pageSizeOptionscarreras=[5,10,20,50];this.sortColumnscarreras=[];this.menuStatecarreras$=this._tools.state$;this.instituciones=[];this.newcarreras=this._carr.createFormGroupcarreras(),this.newcarrerasAnteriorAccion=this._carr.createFormGroupcarreras()}ngOnInit(){this.Cargarcarreras(),this.cargarInstituciones(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(t=>this.esSuperAdmin=t)}cargarOptionsDesdeControles(){let t=["ESTADO","VISIBILIDAD","PROGRAMA","MODALIDAD","NIVEL DE CARRERA","CANTIDAD DE EVALUACIONES"];this._controles.ObtenerOptionsSelectPorCategorias(t).subscribe({next:e=>{this.estadoOptions=e?.ESTADO||[],this.visibilidadOptions=e?.VISIBILIDAD||[],this.programaOptions=e?.PROGRAMA||[],this.modalidadOptions=e?.MODALIDAD||[],this.nivelcarreraOptions=e?.["NIVEL DE CARRERA"]||[],this.cantidadevaluacionesOptions=e?.["CANTIDAD DE EVALUACIONES"]||[]},error:()=>{this.estadoOptions=[],this.visibilidadOptions=[],this.programaOptions=[],this.modalidadOptions=[],this.nivelcarreraOptions=[],this.cantidadevaluacionesOptions=[]}})}abrirModalNuevoCarreras(){this.modalGestioncarrerasRef=this._tools.openModal(this.modalgestioncarreras,"xl")}Cargarcarreras(){this.isLoadingcarreras=!0,this._carr.Obtenercarreras().subscribe({next:t=>{console.log(t),this.carreras=t.data||[],this.collectionSizecarreras=this.carreras.length,this.isLoadingcarreras=!1},error:t=>{console.error("Error al cargar carreras",t),this.isLoadingcarreras=!1}})}AgregarModificarcarreras(){if(this.newcarreras.invalid){this.ValidacionTodoElementocarreras(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalcarreras=!1;return}else{this.AnimarCargaTablacarreras(),this.AnimacionCargabtnModalcarreras=!0,this._tools.MostrarMensajeLoading(),this.newcarrerasAnteriorAccion.setValue(this.newcarreras.value);let t=this.newcarreras.controls.id.value;console.log("INFO A PROCESAR",this.newcarreras.value),t?this._carr.Modificarcarreras(this.newcarreras.value,this.newcarreras.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE carreras",e.data),this.Cargarcarreras(),this.resetcarreras(),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR carreras",e),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeError()}):this._carr.Agregarcarreras(this.newcarreras.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE carreras",e.data),this.Cargarcarreras(),this.resetcarreras(),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR carreras",e),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeError()})}}Seleccionarcarreras(t){if(this._tools.MostrarMensajeLoading(),t){if(!this.carreras.find(i=>i.id===t))return;this._carr.Seleccionarcarreras(t).subscribe(i=>{Object.keys(this.newcarreras.controls).forEach(n=>{this.newcarreras.controls[n].setValue(i.data[n])}),console.log("SELECCION DE carreras EXITOSA",this.newcarreras.value),this.newcarrerasAnteriorAccion.setValue(this.newcarreras.value),this.modalGestioncarrerasRef=this._tools.openModal(this.modalgestioncarreras,"xl"),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL SELECCIONAR carreras",i),this._tools.MostrarMensajeError()})}}Eliminarcarreras(t){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._carr.Eliminarcarreras(t).subscribe(i=>{console.log(i.data),this.Cargarcarreras(),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL ELIMINAR carreras",i),this._tools.MostrarMensajeError()}))})}resetcarreras(){this.newcarreras=this._carr.createFormGroupcarreras(),this._tools.closeModal(this.modalGestioncarrerasRef)}AutoCompletarLastcarreras(){this.newcarreras.setValue(this.newcarrerasAnteriorAccion.value),this.newcarreras.patchValue({id:0}),console.log("listo",this.newcarreras.value)}AnimarCargaTablacarreras(){this.carreras=[],this.isLoadingcarreras=!0}ValidacioncarrerasxElemento(t){return this._tools.obtenerValidationClass(this.newcarreras,t)}ValidacionTodoElementocarreras(){Object.values(this.newcarreras.controls).forEach(t=>{t.markAsTouched(),t.markAsDirty()})}onPageSizeChangecarreras(){this.paginacarreras=1}sortBycarreras(t,e){this.sortColumnscarreras=this._tools.handleSort(t,e,this.sortColumnscarreras),this.carreras=this._tools.applyMultiSort(this.carreras,this.sortColumnscarreras)}isSortedcarreras(t){return this._tools.isSorted(this.sortColumnscarreras,t)}getSortDircarreras(t){return this._tools.getSortDirection(this.sortColumnscarreras,t)}closeMenu(){this._tools.close()}abrirMenucarreras(t,e){t.preventDefault(),t.stopPropagation(),console.log("aS",e);let i=[{label:"\u270F Editar",action:()=>this.Seleccionarcarreras(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarcarreras(e.id)}];this._tools.open(t.clientX,t.clientY,i)}cargarInstituciones(){this._inst.Obtenerinstituciones().subscribe({next:t=>{console.log(t),this.instituciones=t.data||[]},error:t=>{console.error("Error al cargar instituciones",t)}})}};Oe.\u0275fac=function(e){return new(e||Oe)(A(oe),A(ne),A(yt),A(Ie),A(te))},Oe.\u0275cmp=W({type:Oe,selectors:[["app-carreras"]],viewQuery:function(e,i){if(e&1&&de(kt,7),e&2){let n;me(n=pe())&&(i.modalgestioncarreras=n.first)}},hostBindings:function(e,i){e&1&&f("click",function(){return i.closeMenu()},Ce)},standalone:!1,decls:70,vars:31,consts:[["modalgestioncarreras",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"button","col-sm-3","d-flex","justify-content-start"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],["class","form-floating mb-3 col-sm-12",4,"ngIf"],[1,"form-floating","mb-3","col-sm-3"],["type","text","placeholder","","formControlName","Area",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"invalid-feedback"],["type","text","placeholder","","formControlName","Mencion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","Resolucion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","NombreCarrera",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"form-floating","mb-3","col-sm-4"],["type","text","placeholder","","formControlName","HorasTotales",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Nivel",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","CantidadEvaluaciones",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","LimiteMaxTeorico",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","LimiteMaxPractico",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","NotaAprobacion",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","NotaMinRevalida",1,"form-control",3,"ngClass"],["type","text","placeholder","","formControlName","TituloOficial",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Programa",1,"form-control",3,"ngClass"],["type","text","placeholder","","formControlName","Duracion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"form-floating","mb-3","col-sm-6"],["type","text","placeholder","","formControlName","Capacitacion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","CarreraProfesional",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Modalidad",1,"form-control",3,"ngClass"],["formControlName","Visibilidad",1,"form-control",3,"ngClass"],["formControlName","Estado",1,"form-control",3,"ngClass"],[1,"mb-3","col-sm-12"],["placeholder","","formControlName","Descripcion",1,"quill-container-wrapper",2,"text-transform","uppercase",3,"modules","ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[1,"form-floating","mb-3","col-sm-12"],["formControlName","instituciones_id",1,"form-control",3,"ngClass"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"]],template:function(e,i){if(e&1){let n=h();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),d(4,"Gesti\xF3n de carreras"),r(),o(5,"p",5),d(6,"Administra la informaci\xF3n de los carreras de manera sencilla y eficiente"),r()()()(),o(7,"div",2)(8,"div",6)(9,"button",7),f("click",function(){return u(n),_(i.abrirModalNuevoCarreras())}),o(10,"span",8),x(11,"ng-lottie",9),r(),o(12,"span"),d(13,"A\xF1adir carreras "),r(),x(14,"span",10),r()(),o(15,"div",11)(16,"div",12)(17,"span",13),x(18,"ng-lottie",14),r(),o(19,"div",15)(20,"input",16),f("input",function(){return u(n),_(i.paginacarreras=1)}),O("ngModelChange",function(p){return u(n),T(i.filtertxtcarreras,p)||(i.filtertxtcarreras=p),_(p)}),r(),o(21,"label"),d(22,"Buscar"),r()()()()(),o(23,"div",17)(24,"div",18)(25,"table",19)(26,"thead",20)(27,"tr")(28,"th",21),d(29,"#"),r(),g(30,jt,3,1,"th",22),o(31,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("NombreCarrera",p))}),d(32," NombreCarrera "),g(33,Bt,1,4,"i",24),r(),o(34,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Area",p))}),d(35," Area "),g(36,$t,1,4,"i",24),r(),o(37,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Mencion",p))}),d(38," Mencion "),g(39,zt,1,4,"i",24),r(),o(40,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Resolucion",p))}),d(41," Resolucion "),g(42,Ht,1,4,"i",24),r(),o(43,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Nivel",p))}),d(44," Nivel "),g(45,Wt,1,4,"i",24),r(),o(46,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("HorasTotales",p))}),d(47," HorasTotales "),g(48,Ut,1,4,"i",24),r(),o(49,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Visibilidad",p))}),d(50," Visibilidad "),g(51,qt,1,4,"i",24),r(),o(52,"th",23),f("click",function(p){return u(n),_(i.sortBycarreras("Estado",p))}),d(53," Estado "),g(54,Kt,1,4,"i",24),r(),o(55,"th",21),d(56,"ACCIONES"),r()()(),o(57,"tbody"),g(58,Qt,5,1,"tr",25)(59,Yt,3,1,"tr",25)(60,ii,27,14,"tr",26),P(61,"slice"),r()()(),o(62,"div",27)(63,"ngb-pagination",28),O("pageChange",function(p){return u(n),T(i.paginacarreras,p)||(i.paginacarreras=p),_(p)}),r(),o(64,"select",29),O("ngModelChange",function(p){return u(n),T(i.pageSizecarreras,p)||(i.pageSizecarreras=p),_(p)}),f("change",function(){return u(n),_(i.onPageSizeChangecarreras())}),g(65,ni,2,2,"option",30),r()()(),g(66,xi,158,34,"ng-template",null,0,$)(68,vi,5,11,"div",31),P(69,"async")}if(e&2){let n;s(11),l("options",i._tools.optionsAdicionar),s(7),l("options",i._tools.optionslupa),s(2),I("ngModel",i.filtertxtcarreras),s(10),l("ngIf",i.esSuperAdmin),s(3),l("ngIf",i.isSortedcarreras("NombreCarrera")),s(3),l("ngIf",i.isSortedcarreras("Area")),s(3),l("ngIf",i.isSortedcarreras("Mencion")),s(3),l("ngIf",i.isSortedcarreras("Resolucion")),s(3),l("ngIf",i.isSortedcarreras("Nivel")),s(3),l("ngIf",i.isSortedcarreras("HorasTotales")),s(3),l("ngIf",i.isSortedcarreras("Visibilidad")),s(3),l("ngIf",i.isSortedcarreras("Estado")),s(4),l("ngIf",i.isLoadingcarreras),s(),l("ngIf",!i.isLoadingcarreras&&(!i.carreras||i.carreras.length===0)),s(),l("ngForOf",U(61,25,i.carreras,(i.paginacarreras-1)*i.pageSizecarreras,i.paginacarreras*i.pageSizecarreras)),s(3),I("page",i.paginacarreras),l("collectionSize",i.collectionSizecarreras)("pageSize",i.pageSizecarreras)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),I("ngModel",i.pageSizecarreras),s(),l("ngForOf",i.pageSizeOptionscarreras),s(3),l("ngIf",(n=R(69,29,i.menuStatecarreras$))==null?null:n.visible)}},dependencies:[q,K,Q,ve,ye,Z,ee,Se,tt,X,Y,Ee,J,Me,we,Ae,ie,Mt,he,be],encapsulation:2});var Ve=Oe;var _e=class _e{constructor(t){this.http=t;this.ruta=Ze.ruta}Obtenerplandeestudios(t){let e=new Je,i=t||{};return i?.anio_id&&(e=e.set("anio_id",String(i.anio_id))),i?.resolucion&&(e=e.set("resolucion",String(i.resolucion))),i?.nivel&&(e=e.set("nivel",String(i.nivel))),i?.instituciones_id&&(e=e.set("instituciones_id",String(i.instituciones_id))),this.http.get(this.ruta+"api/plandeestudios/",{params:e})}Agregarplandeestudios(t){return this.http.post(this.ruta+"api/plandeestudios/",t)}Modificarplandeestudios(t,e){return this.http.put(this.ruta+"api/plandeestudios/"+e,t)}Seleccionarplandeestudios(t){return this.http.get(this.ruta+"api/plandeestudios/"+t)}Eliminarplandeestudios(t){return this.http.delete(this.ruta+"api/plandeestudios/"+t)}createFormGroupplandeestudios(){return new et({id:new D(0),carreras_id:new D("",[k.required]),Rango:new D("",[k.required]),RangoLvlCurso:new D("",[k.required]),LvlCurso:new D("",[k.required]),Horas:new D("",[k.required]),anio_id:new D("",[k.required]),ModoMateria:new D("1 DOCENTE x MATERIA",[k.required]),NombreMateria:new D("",[k.required]),SiglaMateria:new D("",[k.required]),Prerrequisitos:new D(""),SiglasPrerrequisitos:new D(""),TipoMateria:new D("TE\xD3RICO",[k.required]),RelacionDocenteCursoAEstudiante:new D("NINGUNA",[k.required])})}};_e.\u0275fac=function(e){return new(e||_e)(We(Xe))},_e.\u0275prov=ze({token:_e,factory:_e.\u0275fac,providedIn:"root"});var Ne=_e;var De=class De{transform(t,e,i,n=!0,c=4){if(!t||!Array.isArray(t)||t.length===0)return[];let p=(e??"").toString().trim();if(!p)return t;let v=p.split(/\s+/g).map(b=>this.normalizarTexto(b).toLowerCase()).filter(Boolean);if(v.length===0)return t;let S=this.normalizarTexto(p).toLowerCase(),E=t.map((b,M)=>{let V=this.buildHaystack(b,i,c);if(!(n?v.every(N=>this.tokenMatches(V,N)):v.some(N=>this.tokenMatches(V,N))))return{item:b,idx:M,score:-1};let F=this.computeScore(V,S,v);return{item:b,idx:M,score:F}}).filter(b=>b.score>=0);return E.sort((b,M)=>M.score-b.score||b.idx-M.idx),E.map(b=>b.item)}buildHaystack(t,e,i=4){let n=[];if(Array.isArray(e)&&e.length>0){for(let v of e){let S=this.getByPath(t,v),E=this.normalizarTexto(S).toLowerCase();E&&n.push(E)}return n.join(" ")}let c=new Set,p=(v,S)=>{if(v==null||S<0)return;let E=typeof v;if(E==="string"||E==="number"||E==="boolean"||v instanceof Date){let b=this.normalizarTexto(v).toLowerCase();b&&n.push(b);return}if(Array.isArray(v)){for(let b of v)p(b,S-1);return}if(E==="object"){if(c.has(v))return;c.add(v);for(let b of Object.keys(v))p(v[b],S-1)}};return p(t,i),n.join(" ")}tokenMatches(t,e){return e?e.length<=1?new RegExp(`\\b${this.escapeRegExp(e)}\\b`,"i").test(t):new RegExp(`\\b${this.escapeRegExp(e)}\\b`,"i").test(t)||t.includes(e):!0}computeScore(t,e,i){let n=0;if(e&&t.includes(e)){n+=120;let p=t.indexOf(e);n+=Math.max(0,40-Math.min(p,40))}let c=[];for(let p of i){if(!p)continue;let v=new RegExp(`\\b${this.escapeRegExp(p)}\\b`,"i").test(t);n+=v?30:10;let S=t.indexOf(p);S>=0&&c.push(S)}if(c.length>=2){let p=Math.min(...c),S=Math.max(...c)-p;n+=Math.max(0,40-S/5)}return n}escapeRegExp(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}getByPath(t,e){return!t||!e?"":e.includes(".")?e.split(".").reduce((i,n)=>i?.[n],t):t?.[e]}normalizarTexto(t){if(t==null)return"";let e="";try{e=typeof t=="string"?t:String(t)}catch{e=""}return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}};De.\u0275fac=function(e){return new(e||De)},De.\u0275pipe=qe({name:"filterByText",type:De,pure:!0,standalone:!1});var nt=De;var yi=["modalAccionesMaterias"],Mi=["modalgestionmaterias"],wi=()=>["LvlCurso","Nivel","Paralelo","Turno","NombreMateria","SiglaMateria","ModoAsistencia","EstadoHabilitacion","EstadoEnvio","Anio","Resolucion"],Fe=(a,t)=>({"bi-caret-up":a,"bi-caret-down":t}),Ai=(a,t)=>({top:a,left:t});function Ii(a,t){if(a&1&&(o(0,"option",15),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.id),s(),C(e.Anio)}}function Ti(a,t){if(a&1&&(o(0,"option",15),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.key),s(),C(e.label)}}function Oi(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("LvlCurso")==="asc",e.getSortDirmaterias("LvlCurso")==="desc"))}}function Vi(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("Paralelo")==="asc",e.getSortDirmaterias("Paralelo")==="desc"))}}function Ni(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("Turno")==="asc",e.getSortDirmaterias("Turno")==="desc"))}}function Di(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("NombreMateria")==="asc",e.getSortDirmaterias("NombreMateria")==="desc"))}}function Pi(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("ModoAsistencia")==="asc",e.getSortDirmaterias("ModoAsistencia")==="desc"))}}function Ri(a,t){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",y(1,Fe,e.getSortDirmaterias("EstadoHabilitacion")==="asc",e.getSortDirmaterias("EstadoHabilitacion")==="desc"))}}function Fi(a,t){a&1&&(o(0,"tr")(1,"td",31)(2,"div",41)(3,"span",42),d(4,"Cargando..."),r()()()()),a&2&&(s(),B("colspan",9))}function ki(a,t){a&1&&(o(0,"tr")(1,"td",31),d(2,"No hay datos disponibles"),r()()),a&2&&(s(),B("colspan",9))}function Li(a,t){if(a&1&&x(0,"img",50),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function Gi(a,t){if(a&1&&x(0,"ng-lottie",51),a&2){let e=m(3);l("options",e._tools.optionsEditar)}}function ji(a,t){if(a&1&&x(0,"img",50),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function Bi(a,t){if(a&1&&x(0,"ng-lottie",51),a&2){let e=m(3);l("options",e._tools.optionsEliminar)}}function $i(a,t){if(a&1){let e=h();o(0,"tr",43),f("contextmenu",function(n){let c=u(e).$implicit,p=m(2);return _(p.abrirMenumaterias(n,c))}),o(1,"td",31),d(2),r(),o(3,"td"),d(4),o(5,"div",44),d(6),r()(),o(7,"td"),d(8),r(),o(9,"td"),d(10),r(),o(11,"td"),d(12),o(13,"div",44),d(14),r()(),o(15,"td"),d(16),r(),o(17,"td"),d(18),r(),o(19,"td",45)(20,"button",46),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.Seleccionarmaterias(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["edicionmaterias-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["edicionmaterias-"+n.id]=!1)}),g(21,Li,1,1,"img",47)(22,Gi,1,1,"ng-lottie",48),r(),o(23,"button",49),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.Eliminarmaterias(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["eliminacionmaterias-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["eliminacionmaterias-"+n.id]=!1)}),g(24,ji,1,1,"img",47)(25,Bi,1,1,"ng-lottie",48),r()()()}if(a&2){let e=t.$implicit,i=t.index,n=m(2);s(2),C((n.paginamaterias-1)*n.pageSizematerias+(i+1)),s(2),w(" ",e.LvlCurso," "),s(2),C(e.Nivel),s(2),C(e.Paralelo),s(2),C(e.Turno),s(2),w("",e.NombreMateria," "),s(2),ue("A\xF1o: ",e.Anio," \xB7 Res: ",e.Resolucion),s(2),C(e.ModoAsistencia),s(2),C(e.EstadoHabilitacion),s(3),l("ngIf",!n._tools.hoverBotonMap["edicionmaterias-"+e.id]),s(),l("ngIf",n._tools.hoverBotonMap["edicionmaterias-"+e.id]),s(2),l("ngIf",!n._tools.hoverBotonMap["eliminacionmaterias-"+e.id]),s(),l("ngIf",n._tools.hoverBotonMap["eliminacionmaterias-"+e.id])}}function zi(a,t){if(a&1&&(o(0,"option",52),d(1),r()),a&2){let e=t.$implicit;l("value",e),s(),w("",e," por p\xE1gina")}}function Hi(a,t){if(a&1){let e=h();o(0,"div",27)(1,"div",28)(2,"table",29)(3,"thead",30)(4,"tr")(5,"th",31),d(6,"#"),r(),o(7,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("LvlCurso",n))}),d(8," LvlCurso "),g(9,Oi,1,4,"i",33),r(),o(10,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("Paralelo",n))}),d(11," Paralelo "),g(12,Vi,1,4,"i",33),r(),o(13,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("Turno",n))}),d(14," Turno "),g(15,Ni,1,4,"i",33),r(),o(16,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("NombreMateria",n))}),d(17," NombreMateria "),g(18,Di,1,4,"i",33),r(),o(19,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("ModoAsistencia",n))}),d(20," ModoAsistencia "),g(21,Pi,1,4,"i",33),r(),o(22,"th",32),f("click",function(n){u(e);let c=m();return _(c.sortBymaterias("EstadoHabilitacion",n))}),d(23," EstadoHabilitacion "),g(24,Ri,1,4,"i",33),r(),o(25,"th",31),d(26,"ACCIONES"),r()()(),o(27,"tbody"),g(28,Fi,5,1,"tr",34)(29,ki,3,1,"tr",34)(30,$i,26,14,"tr",35),P(31,"slice"),r()()(),o(32,"div",36)(33,"ngb-pagination",37),O("pageChange",function(n){u(e);let c=m();return T(c.paginamaterias,n)||(c.paginamaterias=n),_(n)}),r(),o(34,"select",38),O("ngModelChange",function(n){u(e);let c=m();return T(c.pageSizematerias,n)||(c.pageSizematerias=n),_(n)}),f("change",function(){u(e);let n=m();return _(n.onPageSizeChangematerias())}),g(35,zi,2,2,"option",39),r()()()}if(a&2){let e=t.ngIf,i=m();s(9),l("ngIf",i.isSortedmaterias("LvlCurso")),s(3),l("ngIf",i.isSortedmaterias("Paralelo")),s(3),l("ngIf",i.isSortedmaterias("Turno")),s(3),l("ngIf",i.isSortedmaterias("NombreMateria")),s(3),l("ngIf",i.isSortedmaterias("ModoAsistencia")),s(3),l("ngIf",i.isSortedmaterias("EstadoHabilitacion")),s(4),l("ngIf",i.isLoadingmaterias),s(),l("ngIf",!i.isLoadingmaterias&&e.length===0),s(),l("ngForOf",U(31,18,e,(i.paginamaterias-1)*i.pageSizematerias,i.paginamaterias*i.pageSizematerias)),s(3),I("page",i.paginamaterias),l("collectionSize",e.length)("pageSize",i.pageSizematerias)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),I("ngModel",i.pageSizematerias),s(),l("ngForOf",i.pageSizeOptionsmaterias)}}function Wi(a,t){if(a&1){let e=h();o(0,"div",80),f("click",function(){let n=u(e).$implicit,c=m(3);return _(c.seleccionarPlan(n))}),o(1,"div",81)(2,"h6",82),d(3),r(),o(4,"small"),d(5),r()(),o(6,"p",82),d(7),r()()}if(a&2){let e=t.$implicit;s(3),bt(" ",e.RangoLvlCurso," | ",e.NombreMateria," (",e.SiglaMateria,") "),s(2),C(e.Anio),s(2),w(" Resoluci\xF3n: ",e.Resolucion," ")}}function Ui(a,t){if(a&1&&(o(0,"div",78),g(1,Wi,8,5,"div",79),r()),a&2){let e=m(2);s(),l("ngForOf",e.planesFiltrados)}}function qi(a,t){a&1&&(o(0,"div",83),d(1," Este campo es obligatorio* "),r())}function Ki(a,t){if(a&1&&(o(0,"option",84),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Qi(a,t){if(a&1&&(o(0,"option",84),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Yi(a,t){if(a&1&&(o(0,"option",84),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Ji(a,t){if(a&1&&(o(0,"option",84),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Xi(a,t){if(a&1){let e=h();o(0,"button",87),f("click",function(){u(e);let n=m(3);return _(n.AutoCompletarLastmaterias())}),o(1,"span",9),x(2,"ng-lottie",10),r(),o(3,"span"),d(4,"AUTO COMPLETAR "),r(),x(5,"span",11),r()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function Zi(a,t){if(a&1&&(o(0,"div",85),g(1,Xi,6,1,"button",86),r()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalmaterias)}}function en(a,t){if(a&1){let e=h();o(0,"button",88),f("click",function(){u(e);let n=m().$implicit,c=m();return n.dismiss(),_(c.resetmaterias())}),o(1,"span",9),x(2,"ng-lottie",10),r(),o(3,"span"),d(4,"CANCELAR"),r(),x(5,"span",11),r()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function tn(a,t){if(a&1){let e=h();o(0,"button",89),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarmaterias())}),x(1,"span",90),r()}a&2&&l("disabled",!0)}function nn(a,t){if(a&1){let e=h();o(0,"button",91),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarmaterias())}),o(1,"span",9),x(2,"ng-lottie",10),r(),o(3,"span"),d(4),r(),x(5,"span",11),r()}if(a&2){let e,i,n=m(2);s(2),l("options",(e=n.newmaterias.get("id"))!=null&&e.value?n._tools.optionsEditar:n._tools.optionsAdicionar),s(2),C((i=n.newmaterias.get("id"))!=null&&i.value?"MODIFICAR":"REGISTRAR")}}function on(a,t){if(a&1){let e=h();o(0,"div",53)(1,"h4",54),d(2),r(),o(3,"button",55),f("click",function(){let n=u(e).$implicit,c=m();return n.dismiss(),_(c.resetmaterias())}),r()(),o(4,"div",56)(5,"form",57)(6,"div",58)(7,"input",59),f("focus",function(){u(e);let n=m();return _(n.mostrarLista=!0)}),r(),g(8,Ui,2,1,"div",60)(9,qi,2,0,"div",61),r(),o(10,"div",62)(11,"input",63),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newmaterias,"Paralelo"))}),r(),o(12,"label"),d(13,"Paralelo"),r(),o(14,"div",64),d(15,"Este campo es obligatorio*"),r()(),o(16,"div",62)(17,"select",65)(18,"option",66),d(19,"Seleccione una opci\xF3n"),r(),g(20,Ki,2,3,"option",67),r(),o(21,"label"),d(22,"Turno"),r(),o(23,"div",64),d(24,"Este campo es obligatorio*"),r()(),o(25,"div",62)(26,"select",68)(27,"option",66),d(28,"Seleccione una opci\xF3n"),r(),g(29,Qi,2,3,"option",67),r(),o(30,"label"),d(31,"ModoAsistencia"),r(),o(32,"div",64),d(33,"Este campo es obligatorio*"),r()(),o(34,"div",62)(35,"select",69)(36,"option",66),d(37,"Seleccione una opci\xF3n"),r(),g(38,Yi,2,3,"option",67),r(),o(39,"label"),d(40,"EstadoHabilitacion"),r(),o(41,"div",64),d(42,"Este campo es obligatorio*"),r()(),o(43,"div",62)(44,"select",70)(45,"option",66),d(46,"Seleccione una opci\xF3n"),r(),g(47,Ji,2,3,"option",67),r(),o(48,"label"),d(49,"EstadoEnvio"),r(),o(50,"div",64),d(51,"Este campo es obligatorio*"),r()()()(),o(52,"div",71),g(53,Zi,2,1,"div",72),o(54,"div",73),g(55,en,6,1,"button",74),r(),o(56,"div",75),g(57,tn,2,1,"button",76)(58,nn,6,2,"button",77),r()()}if(a&2){let e,i,n=m();s(2),w("",(e=n.newmaterias.get("id"))!=null&&e.value?"Modificar":"Registrar"," materias"),s(3),l("formGroup",n.newmaterias),s(2),l("formControl",n.planInput),s(),l("ngIf",n.mostrarLista&&n.planInput.value),s(),l("ngIf",(i=n.newmaterias.get("plandeestudios_id"))==null?null:i.invalid),s(2),l("ngClass",n.ValidacionmateriasxElemento("Paralelo")),s(6),l("ngClass",n.ValidacionmateriasxElemento("Turno")),s(3),l("ngForOf",n.turnoOptions),s(6),l("ngClass",n.ValidacionmateriasxElemento("ModoAsistencia")),s(3),l("ngForOf",n.modoAsistenciaOptions),s(6),l("ngClass",n.ValidacionmateriasxElemento("EstadoHabilitacion")),s(3),l("ngForOf",n.estadoHabilitacionOptions),s(6),l("ngClass",n.ValidacionmateriasxElemento("EstadoEnvio")),s(3),l("ngForOf",n.estadoEnvioOptions),s(6),l("ngIf",!n.newmaterias.get("id").value),s(2),l("ngIf",!n.AnimacionCargabtnModalmaterias),s(2),l("ngIf",n.AnimacionCargabtnModalmaterias),s(),l("ngIf",!n.AnimacionCargabtnModalmaterias)}}function rn(a,t){if(a&1){let e=h();o(0,"button",94),f("click",function(){let n=u(e).$implicit;return _(n.action())}),d(1),r()}if(a&2){let e=t.$implicit;s(),w(" ",e.label," ")}}function an(a,t){if(a&1&&(o(0,"div",92),P(1,"async"),P(2,"async"),g(3,rn,2,1,"button",93),P(4,"async"),r()),a&2){let e,i,n=m();l("ngStyle",y(8,Ai,((e=R(1,2,n.menuStatematerias$))==null?null:e.y)+"px",((e=R(2,4,n.menuStatematerias$))==null?null:e.x)+"px")),s(3),l("ngForOf",(i=R(4,6,n.menuStatematerias$))==null?null:i.items)}}function sn(a,t){if(a&1&&(o(0,"option",15),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e),s(),C(e)}}function ln(a,t){if(a&1&&(o(0,"option",15),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e),s(),C(e)}}function cn(a,t){if(a&1){let e=h();o(0,"div",97)(1,"div",23)(2,"select",104),O("ngModelChange",function(n){u(e);let c=m(2);return T(c.paraleloActualGrupal,n)||(c.paraleloActualGrupal=n),_(n)}),o(3,"option",15),d(4,"Seleccione una opci\xF3n"),r(),g(5,ln,2,2,"option",16),r(),o(6,"label"),d(7,"Paralelo actual"),r()()()}if(a&2){let e=m(2);s(2),I("ngModel",e.paraleloActualGrupal),s(),l("ngValue",""),s(2),l("ngForOf",e.paralelosGrupalOptions)}}function dn(a,t){if(a&1){let e=h();o(0,"div",97)(1,"div",23)(2,"input",105),O("ngModelChange",function(n){u(e);let c=m(2);return T(c.paraleloNuevoGrupal,n)||(c.paraleloNuevoGrupal=n),_(n)}),r(),o(3,"label"),d(4,"Nuevo paralelo"),r()(),o(5,"div",106),d(6,"Se valida que no exista en el mismo A\xF1o + Resoluci\xF3n."),r()()}if(a&2){let e=m(2);s(2),I("ngModel",e.paraleloNuevoGrupal)}}function mn(a,t){if(a&1&&(o(0,"option",109),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),C(e.label)}}function pn(a,t){if(a&1){let e=h();o(0,"div",97)(1,"div",23)(2,"select",107),O("ngModelChange",function(n){u(e);let c=m(2);return T(c.turnoGrupal,n)||(c.turnoGrupal=n),_(n)}),o(3,"option",15),d(4,"(No cambiar realizar cambios)"),r(),g(5,mn,2,3,"option",108),r(),o(6,"label"),d(7,"Turno"),r()()()}if(a&2){let e=m(2);s(2),I("ngModel",e.turnoGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.turnoOptions)}}function un(a,t){if(a&1&&(o(0,"option",109),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),C(e.label)}}function _n(a,t){if(a&1){let e=h();o(0,"div",97)(1,"div",23)(2,"select",110),O("ngModelChange",function(n){u(e);let c=m(2);return T(c.modoAsistenciaGrupal,n)||(c.modoAsistenciaGrupal=n),_(n)}),o(3,"option",15),d(4,"(No cambiar realizar cambios)"),r(),g(5,un,2,3,"option",108),r(),o(6,"label"),d(7,"ModoAsistencia"),r()()()}if(a&2){let e=m(2);s(2),I("ngModel",e.modoAsistenciaGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.modoAsistenciaOptions)}}function gn(a,t){if(a&1&&(o(0,"option",109),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),C(e.label)}}function fn(a,t){if(a&1){let e=h();o(0,"div",97)(1,"div",23)(2,"select",111),O("ngModelChange",function(n){u(e);let c=m(2);return T(c.estadoHabilitacionGrupal,n)||(c.estadoHabilitacionGrupal=n),_(n)}),o(3,"option",15),d(4,"(No cambiar realizar cambios)"),r(),g(5,gn,2,3,"option",108),r(),o(6,"label"),d(7,"EstadoHabilitacion"),r()()()}if(a&2){let e=m(2);s(2),I("ngModel",e.estadoHabilitacionGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.estadoHabilitacionOptions)}}function xn(a,t){a&1&&(o(0,"button",112),x(1,"span",90),r()),a&2&&l("disabled",!0)}function Cn(a,t){if(a&1){let e=h();o(0,"button",113),f("click",function(){u(e);let n=m(2);return _(n.ejecutarAccionGrupal())}),o(1,"span",9),x(2,"ng-lottie",10),r(),o(3,"span"),d(4,"EJECUTAR"),r(),x(5,"span",11),r()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionstrengranaje)}}function vn(a,t){if(a&1){let e=h();o(0,"div",53)(1,"h5",54),d(2,"Acciones grupales de materias"),r(),o(3,"button",95),f("click",function(){let n=u(e).$implicit;return _(n.dismiss())}),r()(),o(4,"div",56)(5,"div",96),d(6,"Se aplicar\xE1 sobre el filtro actual (A\xF1o + Resoluci\xF3n)."),r(),o(7,"div",3)(8,"div",97)(9,"div",23)(10,"select",98),O("ngModelChange",function(n){u(e);let c=m();return T(c.accionGrupal,n)||(c.accionGrupal=n),_(n)}),o(11,"option",15),d(12,"A\xF1adir todas las materias del curso"),r(),o(13,"option",15),d(14,"Modificar paralelo del curso"),r(),o(15,"option",15),d(16,"Eliminar materias del curso (por paralelo)"),r()(),o(17,"label"),d(18,"Acci\xF3n"),r()()(),o(19,"div",97)(20,"div",23)(21,"select",99),O("ngModelChange",function(n){u(e);let c=m();return T(c.cursoGrupal,n)||(c.cursoGrupal=n),_(n)}),f("ngModelChange",function(){u(e);let n=m();return _(n.onCursoGrupalChange())}),o(22,"option",15),d(23,"Seleccione una opci\xF3n"),r(),g(24,sn,2,2,"option",16),r(),o(25,"label"),d(26,"Curso (LvlCurso)"),r()()(),g(27,cn,8,3,"div",100)(28,dn,7,1,"div",100)(29,pn,8,3,"div",100)(30,_n,8,3,"div",100)(31,fn,8,3,"div",100),r()(),o(32,"div",71)(33,"div",73)(34,"button",101),f("click",function(){let n=u(e).$implicit;return _(n.dismiss())}),o(35,"span",9),x(36,"ng-lottie",10),r(),o(37,"span"),d(38,"CANCELAR"),r(),x(39,"span",11),r()(),o(40,"div",75),g(41,xn,2,1,"button",102)(42,Cn,6,1,"button",103),r()()}if(a&2){let e=m();s(10),I("ngModel",e.accionGrupal),s(),l("ngValue","agregar"),s(2),l("ngValue","modificar"),s(2),l("ngValue","eliminar"),s(6),I("ngModel",e.cursoGrupal),s(),l("ngValue",""),s(2),l("ngForOf",e.cursosGrupalOptions),s(3),l("ngIf",e.accionGrupal!=="agregar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(3),l("disabled",e.isProcesandoAccionGrupal),s(2),l("options",e._tools.optionscancelar),s(5),l("ngIf",e.isProcesandoAccionGrupal),s(),l("ngIf",!e.isProcesandoAccionGrupal)}}var Pe=class Pe{constructor(t,e,i,n,c,p,v){this._mat=t;this._tools=e;this._planest=i;this._controles=n;this._carr=c;this._anios=p;this._auth=v;this.esSuperAdmin=!1;this.estadoHabilitacionOptions=[];this.estadoEnvioOptions=[];this.modoAsistenciaOptions=[];this.turnoOptions=[];this.accionGrupal="agregar";this.cursoGrupal="";this.paraleloActualGrupal="";this.paraleloNuevoGrupal="";this.turnoGrupal=null;this.modoAsistenciaGrupal=null;this.estadoHabilitacionGrupal=null;this.estadoEnvioGrupal=null;this.cursosGrupalOptions=[];this.paralelosGrupalOptions=[];this.planesFiltroActual=[];this.isProcesandoAccionGrupal=!1;this.materias=[];this.paginamaterias=1;this.isLoadingmaterias=!1;this.AnimacionCargabtnModalmaterias=!1;this.filtertxtmaterias="";this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.collectionSizematerias=0;this.pageSizematerias=10;this.pageSizeOptionsmaterias=[5,10,20,50];this.sortColumnsmaterias=[];this.menuStatematerias$=this._tools.state$;this.carreras=[];this.anios=[];this.plandeestudios=[];this.planInput=new D("");this.planesFiltrados=[];this.mostrarLista=!1;this.newmaterias=this._mat.createFormGroupmaterias(),this.newmateriasAnteriorAccion=this._mat.createFormGroupmaterias()}ngOnInit(){this.cargarCarreras(),this.cargarAnios(),this.cargarplandeestudios(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(t=>{this.esSuperAdmin=t,this.rebuildResolucionOptions(),this.onFiltroChange()}),this.planesFiltrados=[],this.planInput.valueChanges.subscribe(t=>{let e=t?.toLowerCase()||"";if(!e){this.planesFiltrados=[];return}this.planesFiltrados=this.plandeestudios.filter(i=>`${i.RangoLvlCurso} ${i.NombreMateria} ${i.SiglaMateria} ${i.Anio} ${i.Resolucion}`.toLowerCase().includes(e))})}cargarOptionsDesdeControles(){let t=["ESTADO DE HABILITACI\xD3N","ESTADO DE ENVIO","MODO DE ASISTENCIA","TURNO"];this._controles.ObtenerOptionsSelectPorCategorias(t).subscribe({next:e=>{this.estadoHabilitacionOptions=e?.["ESTADO DE HABILITACI\xD3N"]||[],this.estadoEnvioOptions=e?.["ESTADO DE ENVIO"]||[],this.modoAsistenciaOptions=e?.["MODO DE ASISTENCIA"]||[],this.turnoOptions=e?.TURNO||[]},error:()=>{this.estadoHabilitacionOptions=[],this.estadoEnvioOptions=[],this.modoAsistenciaOptions=[],this.turnoOptions=[]}})}abrirModalNuevoMaterias(){this.modalGestionmateriasRef=this._tools.openModal(this.modalgestionmaterias,"xl")}abrirModalAccionesMaterias(){let t=this.getFiltroParams();if(!t){this._tools.MostrarMensaje("warning","Seleccione A\xF1o y Resoluci\xF3n para continuar");return}this.isProcesandoAccionGrupal=!0,this._tools.MostrarMensajeLoading(),$e({materias:this._mat.Obtenermaterias(t).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error cargando materias (modal grupal)",e),se([])))),planes:this._planest.Obtenerplandeestudios(t).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error cargando planes (modal grupal)",e),se([]))))}).subscribe({next:({materias:e,planes:i})=>{this.materias=e||[],this.collectionSizematerias=this.materias.length,this.planesFiltroActual=i||[];let n=new Set;for(let c of this.planesFiltroActual){let p=(c?.LvlCurso??"").toString().trim();p&&n.add(p)}this.cursosGrupalOptions=Array.from(n.values()).sort((c,p)=>c.localeCompare(p)),this.accionGrupal="agregar",this.cursoGrupal="",this.paraleloActualGrupal="",this.paraleloNuevoGrupal="",this.paralelosGrupalOptions=[],this.turnoGrupal=null,this.modoAsistenciaGrupal=null,this.estadoHabilitacionGrupal=null,this.estadoEnvioGrupal=null,this.modalAccionesMateriasRef=this._tools.openModal(this.modalAccionesMaterias,"xl")},error:e=>{console.error(e),this._tools.MostrarMensajeError()},complete:()=>{this.isProcesandoAccionGrupal=!1}})}onCursoGrupalChange(){let t=this.upper(this.cursoGrupal),e=new Set;for(let i of this.materias||[]){let n=this.upper(i?.LvlCurso),c=this.upper(i?.Paralelo);t&&n===t&&c&&e.add(c)}this.paralelosGrupalOptions=Array.from(e.values()).sort((i,n)=>i.localeCompare(n)),this.paraleloActualGrupal=""}ejecutarAccionGrupal(){let t=this.getFiltroParams();if(!t){this._tools.MostrarMensaje("warning","Seleccione A\xF1o y Resoluci\xF3n (incluye Nivel) para continuar");return}let e=this.upper(this.cursoGrupal),i=this.upper(this.paraleloNuevoGrupal),n=this.upper(this.paraleloActualGrupal),c=(this.turnoGrupal??"").toString().trim(),p=(this.modoAsistenciaGrupal??"").toString().trim(),v=(this.estadoHabilitacionGrupal??"").toString().trim(),S=(this.estadoEnvioGrupal??"").toString().trim(),E={};if(t.nivel&&(E.nivel=t.nivel),c&&(E.Turno=c),p&&(E.ModoAsistencia=p),v&&(E.EstadoHabilitacion=v),S&&(E.EstadoEnvio=S),!e){this._tools.MostrarMensaje("warning","Seleccione un curso (LvlCurso)");return}if(this.accionGrupal!=="eliminar"&&!i){this._tools.MostrarMensaje("warning","Ingrese el nuevo paralelo");return}if(this.accionGrupal!=="agregar"&&!n){this._tools.MostrarMensaje("warning","Seleccione el paralelo actual");return}this.isProcesandoAccionGrupal=!0,this._tools.MostrarMensajeLoading(),this._mat.Obtenermaterias(t).pipe(le(b=>b?.data||[]),ce(b=>(console.error("Error refrescando materias (acci\xF3n grupal)",b),se([])))).subscribe({next:b=>{let M=(F,N,re=[])=>{let Rt=new Set(re.map(je=>Number(je)));return(b||[]).some(je=>{let Ft=Number(je?.id);return Rt.has(Ft)?!1:this.upper(je?.LvlCurso)===N&&this.upper(je?.Paralelo)===F})},V=F=>(b||[]).filter(N=>this.upper(N?.LvlCurso)===e&&this.upper(N?.Paralelo)===F);if(this.accionGrupal==="agregar"){if(M(i,e)){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","Ese paralelo ya existe para el mismo A\xF1o y Resoluci\xF3n");return}this._mat.AgregarMateriasGrupal(ae({anio_id:t.anio_id,resolucion:t.resolucion,nivel:t.nivel,instituciones_id:t.instituciones_id,lvlcurso:e,paralelo_nuevo:i},E)).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:F=>{console.error("Error en alta grupal de materias (bulk)",F);let N=F?.error?.message;N?this._tools.MostrarMensaje("warning",N):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}});return}let L=V(n);if(!L.length){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","No hay materias para ese curso y paralelo");return}if(this.accionGrupal==="modificar"){let F=L.map(N=>Number(N?.id)).filter(N=>Number.isFinite(N));if(M(i,e,F)){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","Ese paralelo ya existe para el mismo A\xF1o y Resoluci\xF3n");return}this._mat.ActualizarParaleloGrupal(ae({anio_id:t.anio_id,resolucion:t.resolucion,nivel:t.nivel,instituciones_id:t.instituciones_id,lvlcurso:e,paralelo_actual:n,paralelo_nuevo:i},E)).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:N=>{console.error("Error en modificaci\xF3n grupal de paralelo (bulk)",N);let re=N?.error?.message;re?this._tools.MostrarMensaje("warning",re):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}});return}this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","Se eliminar\xE1n todas las materias del curso/paralelo seleccionado","warning","SI, ESTOY SEGURO","NO").then(F=>{if(!F){this.isProcesandoAccionGrupal=!1;return}this._mat.EliminarMateriasGrupal({anio_id:t.anio_id,resolucion:t.resolucion,nivel:t.nivel,instituciones_id:t.instituciones_id,lvlcurso:e,paralelo_actual:n}).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:N=>{console.error("Error en eliminaci\xF3n grupal de materias (bulk)",N);let re=N?.error?.message;re?this._tools.MostrarMensaje("warning",re):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}})})},error:()=>{this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensajeError()}})}upper(t){return(t??"").toString().trim().toUpperCase()}getFiltroParams(){let t=this.filtroAnioId,e=!!(this.filtroResolucionKey&&this.filtroResolucionKey.toString().trim());return!t||!e||(this.parseResolucionKey(),!this.filtroResolucion||!this.filtroNivelCarrera)?null:{anio_id:t,resolucion:this.filtroResolucion,nivel:this.filtroNivelCarrera,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0}}rebuildResolucionOptions(){let t=new Map;for(let e of this.carreras){let i=(e?.Resolucion??"").toString().trim();if(!i)continue;let n=(e?.Nivel??"").toString().trim(),c=(e?.Area??"").toString().trim(),p=e?.instituciones_id,v=p!=null&&p!==""?Number(p):null,S=(e?.NombreInstitucion??"").toString().trim(),E=n||"SIN NIVEL",b=`${i}|${E}`,M=this.esSuperAdmin&&v?`${v}|${b}`:b,V=`${c?c+" \xB7 ":""}${i} (${E})`,L=this.esSuperAdmin&&v?`${V}${S?" \xB7 "+S:""}`:V;t.has(M)||t.set(M,{key:M,label:L,resolucion:i,nivel:E,instituciones_id:v})}this.resolucionOptions=Array.from(t.values()).sort((e,i)=>e.label.localeCompare(i.label))}onFiltroChange(){if(this.paginamaterias=1,!!!this.filtroAnioId){this.materias=[],this.collectionSizematerias=0;return}this.parseResolucionKey(),this.Cargarmaterias()}parseResolucionKey(){let t=(this.filtroResolucionKey??"").toString();if(!t){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=t.split("|");if(e.length>=3){let i=Number(e[0]),n=(e[1]??"").toString(),c=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(i)?i:null,this.filtroResolucion=n||null,this.filtroNivelCarrera=c||null;return}if(e.length===2){let i=(e[0]??"").toString(),n=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=i||null,this.filtroNivelCarrera=n||null;return}this.filtroInstitucionId=null,this.filtroResolucion=t,this.filtroNivelCarrera=null}Cargarmaterias(){let t=this.filtroAnioId;if(!t){this.materias=[],this.collectionSizematerias=0;return}this.isLoadingmaterias=!0;let e={anio_id:t,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0};this.filtroResolucion&&(e.resolucion=this.filtroResolucion),this.filtroNivelCarrera&&(e.nivel=this.filtroNivelCarrera),this._mat.Obtenermaterias(e).subscribe({next:i=>{console.log(i),this.materias=i.data||[],this.collectionSizematerias=this.materias.length,this.isLoadingmaterias=!1},error:i=>{console.error("Error al cargar materias",i),this.isLoadingmaterias=!1}})}AgregarModificarmaterias(){if(this.newmaterias.invalid){this.ValidacionTodoElementomaterias(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalmaterias=!1;return}else{this.AnimarCargaTablamaterias(),this.AnimacionCargabtnModalmaterias=!0,this._tools.MostrarMensajeLoading(),this.newmateriasAnteriorAccion.setValue(this.newmaterias.value);let t=this.newmaterias.controls.id.value;console.log("INFO A PROCESAR",this.newmaterias.value),t?this._mat.Modificarmaterias(this.newmaterias.value,this.newmaterias.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE materias",e.data),this.Cargarmaterias(),this.resetmaterias(),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR materias",e),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeError()}):this._mat.Agregarmaterias(this.newmaterias.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE materias",e.data),this.Cargarmaterias(),this.resetmaterias(),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR materias",e),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeError()})}}Seleccionarmaterias(t){if(this._tools.MostrarMensajeLoading(),t){if(!this.materias.find(i=>i.id===t))return;this._mat.Seleccionarmaterias(t).subscribe(i=>{Object.keys(this.newmaterias.controls).forEach(n=>{this.newmaterias.controls[n].setValue(i.data[n])}),console.log("SELECCION DE materias EXITOSA",this.newmaterias.value),this.newmateriasAnteriorAccion.setValue(this.newmaterias.value),this.modalGestionmateriasRef=this._tools.openModal(this.modalgestionmaterias,"xl"),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL SELECCIONAR materias",i),this._tools.MostrarMensajeError()})}}Eliminarmaterias(t){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._mat.Eliminarmaterias(t).subscribe(i=>{console.log(i.data),this.Cargarmaterias(),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL ELIMINAR materias",i),this._tools.MostrarMensajeError()}))})}resetmaterias(){this.newmaterias=this._mat.createFormGroupmaterias(),this._tools.closeModal(this.modalGestionmateriasRef)}AutoCompletarLastmaterias(){this.newmaterias.setValue(this.newmateriasAnteriorAccion.value),this.newmaterias.patchValue({id:0}),console.log("listo",this.newmaterias.value)}AnimarCargaTablamaterias(){this.materias=[],this.isLoadingmaterias=!0}ValidacionmateriasxElemento(t){return this._tools.obtenerValidationClass(this.newmaterias,t)}ValidacionTodoElementomaterias(){Object.values(this.newmaterias.controls).forEach(t=>{t.markAsTouched(),t.markAsDirty()})}onPageSizeChangematerias(){this.paginamaterias=1}sortBymaterias(t,e){this.sortColumnsmaterias=this._tools.handleSort(t,e,this.sortColumnsmaterias),this.materias=this._tools.applyMultiSort(this.materias,this.sortColumnsmaterias)}isSortedmaterias(t){return this._tools.isSorted(this.sortColumnsmaterias,t)}getSortDirmaterias(t){return this._tools.getSortDirection(this.sortColumnsmaterias,t)}closeMenu(){this._tools.close()}abrirMenumaterias(t,e){t.preventDefault(),t.stopPropagation(),console.log("aS",e);let i=[{label:"\u270F Editar",action:()=>this.Seleccionarmaterias(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarmaterias(e.id)}];this._tools.open(t.clientX,t.clientY,i)}cargarCarreras(){this._carr.Obtenercarreras().subscribe({next:t=>{this.carreras=t.data||[],this.rebuildResolucionOptions()},error:t=>{console.error("Error al cargar carreras",t)}})}cargarAnios(){this._anios.ObtenerAniosConPredeterminado().subscribe({next:t=>{if(this.anios=t?.anios||[],this.filtroAnioId===null||this.filtroAnioId===void 0){let e=t?.predeterminado;e?.id?this.filtroAnioId=Number(e.id):this.anios?.length&&(this.filtroAnioId=Number(this.anios[0]?.id))}this.onFiltroChange()},error:t=>{console.error("Error al cargar anios",t)}})}cargarplandeestudios(){this._planest.Obtenerplandeestudios().subscribe({next:t=>{console.log(t.data),this.plandeestudios=t.data||[]},error:t=>{console.error("Error al cargar plandeestudios",t)}})}seleccionarPlan(t){this.planInput.setValue(`${t.NombreMateria} (${t.SiglaMateria})`,{emitEvent:!1}),this.newmaterias.get("plandeestudios_id")?.setValue(t.id),this.mostrarLista=!1}};Pe.\u0275fac=function(e){return new(e||Pe)(A(it),A(ne),A(Ne),A(Ie),A(oe),A(Te),A(te))},Pe.\u0275cmp=W({type:Pe,selectors:[["app-materias"]],viewQuery:function(e,i){if(e&1&&(de(yi,7),de(Mi,7)),e&2){let n;me(n=pe())&&(i.modalAccionesMaterias=n.first),me(n=pe())&&(i.modalgestionmaterias=n.first)}},hostBindings:function(e,i){e&1&&f("click",function(){return i.closeMenu()},Ce)},standalone:!1,decls:46,vars:18,consts:[["modalgestionmaterias",""],["modalAccionesMaterias",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"col-sm-6","d-flex","justify-content-start","button",2,"gap","10px"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","d-flex","justify-content-end",2,"gap","10px"],[1,"form-floating",2,"min-width","140px"],["title","Filtrar por A\xF1o",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-floating",2,"min-width","180px"],["title","Filtrar por Resoluci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],["class","mt-4",4,"ngIf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"small","text-muted"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"col-sm-12","mb-3","position-relative"],["type","text","placeholder","Buscar plan de estudios","autocomplete","off",1,"form-control",3,"focus","formControl"],["class","list-group position-absolute w-100","style","z-index: 1000;",4,"ngIf"],["class","invalid-feedback d-block",4,"ngIf"],[1,"form-floating","mb-3","col-sm-12"],["type","text","placeholder","","formControlName","Paralelo",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"invalid-feedback"],["formControlName","Turno",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","ModoAsistencia",1,"form-control",3,"ngClass"],["formControlName","EstadoHabilitacion",1,"form-control",3,"ngClass"],["formControlName","EstadoEnvio",1,"form-control",3,"ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[1,"list-group","position-absolute","w-100",2,"z-index","1000"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"click"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"invalid-feedback","d-block"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"text-muted","mb-3"],[1,"col-sm-6","mb-3"],["title","Acci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],["title","Curso",1,"form-control",3,"ngModelChange","ngModel"],["class","col-sm-6 mb-3",4,"ngIf"],["title","Cancelar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click","disabled"],["class","btn mouse-dir success","title","Procesando",3,"disabled",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style","gap: 8px;","title","Ejecutar",3,"click",4,"ngIf"],["title","Paralelo actual",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","",1,"form-control",2,"text-transform","uppercase",3,"ngModelChange","ngModel"],[1,"form-text"],["title","Turno",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],[3,"ngValue","disabled"],["title","Modo de asistencia",1,"form-control",3,"ngModelChange","ngModel"],["title","Estado de habilitaci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],["title","Procesando",1,"btn","mouse-dir","success",3,"disabled"],["title","Ejecutar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"]],template:function(e,i){if(e&1){let n=h();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1",5),d(4,"Gesti\xF3n de materias"),r(),o(5,"p",6),d(6,"Administra la informaci\xF3n de los materias de manera sencilla y eficiente"),r()()()(),o(7,"div",3)(8,"div",7)(9,"button",8),f("click",function(){return u(n),_(i.abrirModalAccionesMaterias())}),o(10,"span",9),x(11,"ng-lottie",10),r(),o(12,"span"),d(13,"Acciones Grupales"),r(),x(14,"span",11),r()(),o(15,"div",12)(16,"div",13)(17,"select",14),O("ngModelChange",function(p){return u(n),T(i.filtroAnioId,p)||(i.filtroAnioId=p),_(p)}),f("ngModelChange",function(){return u(n),i.paginamaterias=1,_(i.onFiltroChange())}),o(18,"option",15),d(19,"Seleccione una opci\xF3n"),r(),g(20,Ii,2,2,"option",16),r(),o(21,"label"),d(22,"A\xF1o"),r()(),o(23,"div",17)(24,"select",18),O("ngModelChange",function(p){return u(n),T(i.filtroResolucionKey,p)||(i.filtroResolucionKey=p),_(p)}),f("ngModelChange",function(){return u(n),i.paginamaterias=1,_(i.onFiltroChange())}),o(25,"option",15),d(26,"Seleccione una opci\xF3n"),r(),g(27,Ti,2,2,"option",16),r(),o(28,"label"),d(29,"Resoluci\xF3n"),r()()(),o(30,"div",19)(31,"div",20)(32,"span",21),x(33,"ng-lottie",22),r(),o(34,"div",23)(35,"input",24),f("input",function(){return u(n),_(i.paginamaterias=1)}),O("ngModelChange",function(p){return u(n),T(i.filtertxtmaterias,p)||(i.filtertxtmaterias=p),_(p)}),r(),o(36,"label"),d(37,"Buscar"),r()()()()(),g(38,Hi,36,22,"div",25),P(39,"filterByText"),g(40,on,59,18,"ng-template",null,0,$)(42,an,5,11,"div",26),P(43,"async"),g(44,vn,43,16,"ng-template",null,1,$)}if(e&2){let n;s(11),l("options",i._tools.optionssubgestion),s(6),I("ngModel",i.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",i.anios),s(4),I("ngModel",i.filtroResolucionKey),s(),l("ngValue",null),s(2),l("ngForOf",i.resolucionOptions),s(6),l("options",i._tools.optionslupa),s(2),I("ngModel",i.filtertxtmaterias),s(3),l("ngIf",U(39,11,i.materias,i.filtertxtmaterias,Ye(17,wi))),s(4),l("ngIf",(n=R(43,15,i.menuStatematerias$))==null?null:n.visible)}},dependencies:[q,K,Q,ve,ye,Z,ee,Se,X,Y,Ee,J,Et,Me,we,Ae,ie,he,be,nt],styles:[".dropdown-list[_ngcontent-%COMP%]{position:absolute;width:100%;max-height:280px;overflow-y:auto;background:#fff;border:1px solid #ced4da;z-index:1000}.dropdown-item[_ngcontent-%COMP%]{padding:8px 12px;cursor:pointer}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.row-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 80px 140px;gap:12px;align-items:center}.center[_ngcontent-%COMP%]{text-align:center;font-weight:500}.right[_ngcontent-%COMP%]{text-align:right;white-space:nowrap}"]});var Re=Pe;var ke=class ke{transform(t,e,i=[],n=!0){if(!t||!Array.isArray(t)||t.length===0)return[];let c=(e??"").toString().trim();if(!c)return t;let p=c.split(/\s+/g).map(S=>this.normalizarTexto(S).toLowerCase()).filter(Boolean);if(p.length===0)return t;let v=i?.length?i:Object.keys(t[0]);return t.filter(S=>{let E=v.map(M=>{let V=typeof M=="function"?M(S):this.getByPath(S,M);return this.normalizarTexto(V).toLowerCase()}).filter(Boolean),b=M=>E.some(V=>V.includes(M));return n?p.every(b):p.some(b)})}getByPath(t,e){return!t||!e?"":e.includes(".")?e.split(".").reduce((i,n)=>i?.[n],t):t?.[e]}normalizarTexto(t){return t==null?"":String(t).normalize("NFD").replace(/[\u0300-\u036f]/g,"")}};ke.\u0275fac=function(e){return new(e||ke)},ke.\u0275pipe=qe({name:"filterByFields",type:ke,pure:!0,standalone:!1});var ot=ke;var Sn=["modalgestionplandeestudios"],En=()=>["RangoLvlCurso","Rango","LvlCurso","NombreMateria","SiglaMateria","SiglasPrerrequisitos","TipoMateria","ModoMateria","Horas","Anio","Resolucion","Nivel","NombreCarrera","NombreInstitucion"],G=(a,t)=>({"bi-caret-up":a,"bi-caret-down":t}),yn=(a,t)=>({top:a,left:t});function Mn(a,t){if(a&1&&(o(0,"option",16),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.id),s(),C(e.Anio)}}function wn(a,t){if(a&1&&(o(0,"option",16),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.key),s(),C(e.label)}}function An(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(3);l("ngClass",y(1,G,e.getSortDirplandeestudios("NombreInstitucion")==="asc",e.getSortDirplandeestudios("NombreInstitucion")==="desc"))}}function In(a,t){if(a&1){let e=h();o(0,"th",34),f("click",function(n){u(e);let c=m(2);return _(c.sortByplandeestudios("NombreInstitucion",n))}),d(1," Nombre Institucion "),g(2,An,1,4,"i",35),r()}if(a&2){let e=m(2);s(2),l("ngIf",e.isSortedplandeestudios("NombreInstitucion"))}}function Tn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("RangoLvlCurso")==="asc",e.getSortDirplandeestudios("RangoLvlCurso")==="desc"))}}function On(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("Rango")==="asc",e.getSortDirplandeestudios("Rango")==="desc"))}}function Vn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("LvlCurso")==="asc",e.getSortDirplandeestudios("LvlCurso")==="desc"))}}function Nn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("NombreMateria")==="asc",e.getSortDirplandeestudios("NombreMateria")==="desc"))}}function Dn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("Horas")==="asc",e.getSortDirplandeestudios("Horas")==="desc"))}}function Pn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("SiglaMateria")==="asc",e.getSortDirplandeestudios("SiglaMateria")==="desc"))}}function Rn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("SiglasPrerrequisitos")==="asc",e.getSortDirplandeestudios("SiglasPrerrequisitos")==="desc"))}}function Fn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("TipoMateria")==="asc",e.getSortDirplandeestudios("TipoMateria")==="desc"))}}function kn(a,t){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",y(1,G,e.getSortDirplandeestudios("ModoMateria")==="asc",e.getSortDirplandeestudios("ModoMateria")==="desc"))}}function Ln(a,t){if(a&1&&(o(0,"tr")(1,"td",32)(2,"div",44)(3,"span",45),d(4,"Cargando..."),r()()()()),a&2){let e=m(2);s(),B("colspan",e.esSuperAdmin?14:13)}}function Gn(a,t){if(a&1&&(o(0,"tr")(1,"td",32),d(2,"No hay datos disponibles"),r()()),a&2){let e=m(2);s(),B("colspan",e.esSuperAdmin?14:13)}}function jn(a,t){if(a&1&&(o(0,"td"),d(1),r()),a&2){let e=m().$implicit;s(),C(e.NombreInstitucion)}}function Bn(a,t){if(a&1&&x(0,"img",53),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function $n(a,t){if(a&1&&x(0,"ng-lottie",54),a&2){let e=m(3);l("options",e._tools.optionsEditar)}}function zn(a,t){if(a&1&&x(0,"img",53),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function Hn(a,t){if(a&1&&x(0,"ng-lottie",54),a&2){let e=m(3);l("options",e._tools.optionsEliminar)}}function Wn(a,t){if(a&1){let e=h();o(0,"tr",46),f("contextmenu",function(n){let c=u(e).$implicit,p=m(2);return _(p.abrirMenuplandeestudios(n,c))}),o(1,"td",32),d(2),r(),g(3,jn,2,1,"td",37),o(4,"td",32),d(5),r(),o(6,"td",32),d(7),r(),o(8,"td"),d(9),o(10,"div",47),d(11),r()(),o(12,"td"),d(13),o(14,"div",47),d(15),r()(),o(16,"td",32),d(17),r(),o(18,"td"),d(19),r(),o(20,"td"),d(21),r(),o(22,"td"),d(23),r(),o(24,"td"),d(25),r(),o(26,"td",48)(27,"button",49),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.Seleccionarplandeestudios(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["edicionplandeestudios-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["edicionplandeestudios-"+n.id]=!1)}),g(28,Bn,1,1,"img",50)(29,$n,1,1,"ng-lottie",51),r(),o(30,"button",52),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.Eliminarplandeestudios(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["eliminacionplandeestudios-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return _(c._tools.hoverBotonMap["eliminacionplandeestudios-"+n.id]=!1)}),g(31,zn,1,1,"img",50)(32,Hn,1,1,"ng-lottie",51),r()()()}if(a&2){let e=t.$implicit,i=t.index,n=m(2);s(2),C((n.paginaplandeestudios-1)*n.pageSizeplandeestudios+(i+1)),s(),l("ngIf",n.esSuperAdmin),s(2),w(" ",e.RangoLvlCurso," "),s(2),C(e.Rango),s(2),w("",e.LvlCurso," "),s(2),w(" ",e.Nivel),s(2),w("",e.NombreMateria," "),s(2),ue("A\xF1o: ",e.Anio," \xB7 Res: ",e.Resolucion),s(2),C(e.Horas),s(2),C(e.SiglaMateria),s(2),C(e.SiglasPrerrequisitos),s(2),C(e.TipoMateria),s(2),C(e.ModoMateria),s(3),l("ngIf",!n._tools.hoverBotonMap["edicionplandeestudios-"+e.id]),s(),l("ngIf",n._tools.hoverBotonMap["edicionplandeestudios-"+e.id]),s(2),l("ngIf",!n._tools.hoverBotonMap["eliminacionplandeestudios-"+e.id]),s(),l("ngIf",n._tools.hoverBotonMap["eliminacionplandeestudios-"+e.id])}}function Un(a,t){if(a&1&&(o(0,"option",55),d(1),r()),a&2){let e=t.$implicit;l("value",e),s(),w("",e," por p\xE1gina")}}function qn(a,t){if(a&1){let e=h();o(0,"div",28)(1,"div",29)(2,"table",30)(3,"thead",31)(4,"tr")(5,"th",32),d(6,"#"),r(),g(7,In,3,1,"th",33),o(8,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("RangoLvlCurso",n))}),d(9," Nivel "),g(10,Tn,1,4,"i",35),r(),o(11,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("Rango",n))}),d(12," Rango "),g(13,On,1,4,"i",35),r(),o(14,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("LvlCurso",n))}),d(15," Nivel Curso "),g(16,Vn,1,4,"i",35),r(),o(17,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("NombreMateria",n))}),d(18," NombreMateria "),g(19,Nn,1,4,"i",35),r(),o(20,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("Horas",n))}),d(21," Horas "),g(22,Dn,1,4,"i",35),r(),o(23,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("SiglaMateria",n))}),d(24," Sigla "),g(25,Pn,1,4,"i",35),r(),o(26,"th",36),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("SiglasPrerrequisitos",n))}),d(27," Sigla Pre. "),g(28,Rn,1,4,"i",35),r(),o(29,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("TipoMateria",n))}),d(30," TipoMateria "),g(31,Fn,1,4,"i",35),r(),o(32,"th",34),f("click",function(n){u(e);let c=m();return _(c.sortByplandeestudios("ModoMateria",n))}),d(33," Modo Materia "),g(34,kn,1,4,"i",35),r(),o(35,"th",32),d(36,"ACCIONES"),r()()(),o(37,"tbody"),g(38,Ln,5,1,"tr",37)(39,Gn,3,1,"tr",37)(40,Wn,33,18,"tr",38),P(41,"slice"),r()()(),o(42,"div",39)(43,"ngb-pagination",40),O("pageChange",function(n){u(e);let c=m();return T(c.paginaplandeestudios,n)||(c.paginaplandeestudios=n),_(n)}),r(),o(44,"select",41),O("ngModelChange",function(n){u(e);let c=m();return T(c.pageSizeplandeestudios,n)||(c.pageSizeplandeestudios=n),_(n)}),f("change",function(){u(e);let n=m();return _(n.onPageSizeChangeplandeestudios())}),g(45,Un,2,2,"option",42),r()()()}if(a&2){let e=t.ngIf,i=m();s(7),l("ngIf",i.esSuperAdmin),s(3),l("ngIf",i.isSortedplandeestudios("RangoLvlCurso")),s(3),l("ngIf",i.isSortedplandeestudios("Rango")),s(3),l("ngIf",i.isSortedplandeestudios("LvlCurso")),s(3),l("ngIf",i.isSortedplandeestudios("NombreMateria")),s(3),l("ngIf",i.isSortedplandeestudios("Horas")),s(3),l("ngIf",i.isSortedplandeestudios("SiglaMateria")),s(3),l("ngIf",i.isSortedplandeestudios("SiglasPrerrequisitos")),s(3),l("ngIf",i.isSortedplandeestudios("TipoMateria")),s(3),l("ngIf",i.isSortedplandeestudios("ModoMateria")),s(4),l("ngIf",i.isLoadingplandeestudios),s(),l("ngIf",!i.isLoadingplandeestudios&&e.length===0),s(),l("ngForOf",U(41,22,e,(i.paginaplandeestudios-1)*i.pageSizeplandeestudios,i.paginaplandeestudios*i.pageSizeplandeestudios)),s(3),I("page",i.paginaplandeestudios),l("collectionSize",e.length)("pageSize",i.pageSizeplandeestudios)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),I("ngModel",i.pageSizeplandeestudios),s(),l("ngForOf",i.pageSizeOptionsplandeestudios)}}function Kn(a,t){if(a&1&&(o(0,"option",55),d(1),r()),a&2){let e=t.$implicit;l("value",e.id),s(),C(e.Anio)}}function Qn(a,t){if(a&1&&(o(0,"option",55),d(1),r()),a&2){let e=t.$implicit,i=m(2);l("value",e.id),s(),w(" ",i.esSuperAdmin?e.NombreCarrera+" ("+e.NombreInstitucion+" | "+e.Resolucion+(e.Nivel?" ("+e.Nivel+")":"")+")":e.NombreCarrera+" ("+e.Resolucion+(e.Nivel?" ("+e.Nivel+")":"")+")"," ")}}function Yn(a,t){if(a&1&&(o(0,"option",89),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Jn(a,t){if(a&1&&(o(0,"option",89),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Xn(a,t){if(a&1&&(o(0,"option",89),d(1),r()),a&2){let e=t.$implicit;l("value",e.value)("disabled",e.disabled),s(),C(e.label)}}function Zn(a,t){if(a&1){let e=h();o(0,"button",92),f("click",function(){u(e);let n=m(3);return _(n.AutoCompletarLastplandeestudios())}),o(1,"span",10),x(2,"ng-lottie",11),r(),o(3,"span"),d(4,"AUTO COMPLETAR "),r(),x(5,"span",12),r()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function eo(a,t){if(a&1&&(o(0,"div",90),g(1,Zn,6,1,"button",91),r()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalplandeestudios)}}function to(a,t){if(a&1){let e=h();o(0,"button",93),f("click",function(){u(e);let n=m().$implicit,c=m();return n.dismiss(),_(c.resetplandeestudios())}),o(1,"span",10),x(2,"ng-lottie",11),r(),o(3,"span"),d(4,"CANCELAR"),r(),x(5,"span",12),r()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function io(a,t){if(a&1){let e=h();o(0,"button",94),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarplandeestudios())}),x(1,"span",95),r()}a&2&&l("disabled",!0)}function no(a,t){if(a&1){let e=h();o(0,"button",96),f("click",function(){u(e);let n=m(2);return _(n.AgregarModificarplandeestudios())}),o(1,"span",10),x(2,"ng-lottie",11),r(),o(3,"span"),d(4),r(),x(5,"span",12),r()}if(a&2){let e,i,n=m(2);s(2),l("options",(e=n.newplandeestudios.get("id"))!=null&&e.value?n._tools.optionsEditar:n._tools.optionsAdicionar),s(2),C((i=n.newplandeestudios.get("id"))!=null&&i.value?"MODIFICAR":"REGISTRAR")}}function oo(a,t){if(a&1){let e=h();o(0,"div",56)(1,"h4",57),d(2),r(),o(3,"button",58),f("click",function(){let n=u(e).$implicit,c=m();return n.dismiss(),_(c.resetplandeestudios())}),r()(),o(4,"div",59)(5,"form",60)(6,"div",4)(7,"div",61)(8,"select",62)(9,"option",63),d(10,"Seleccione una opci\xF3n"),r(),g(11,Kn,2,2,"option",42),r(),o(12,"label"),d(13,"A\xF1o"),r(),o(14,"div",64),d(15,"Este campo es obligatorio*"),r()(),o(16,"div",61)(17,"select",65)(18,"option",63),d(19,"Seleccione una opci\xF3n"),r(),g(20,Qn,2,2,"option",42),r(),o(21,"label"),d(22,"Carrera"),r(),o(23,"div",64),d(24,"Este campo es obligatorio*"),r()()(),o(25,"div",4)(26,"div",66),x(27,"input",67),o(28,"label"),d(29,"Nivel"),r(),o(30,"div",64),d(31,"Este campo es obligatorio*"),r()(),o(32,"div",66),x(33,"input",68),o(34,"label"),d(35,"Rango"),r(),o(36,"div",64),d(37,"Este campo es obligatorio*"),r()(),o(38,"div",69),x(39,"input",70),o(40,"label"),d(41,"Horas"),r(),o(42,"div",64),d(43,"Este campo es obligatorio*"),r()(),o(44,"div",71)(45,"select",72)(46,"option",73),d(47,"Seleccione una opci\xF3n"),r(),g(48,Yn,2,3,"option",74),r(),o(49,"label"),d(50,"Nivel del Curso"),r(),o(51,"div",64),d(52,"Este campo es obligatorio*"),r()()(),o(53,"div",4)(54,"div",61)(55,"input",75),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newplandeestudios,"NombreMateria"))}),r(),o(56,"label"),d(57,"Nombre Materia"),r(),o(58,"div",64),d(59,"Este campo es obligatorio*"),r()(),o(60,"div",61)(61,"input",76),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newplandeestudios,"SiglaMateria"))}),r(),o(62,"label"),d(63,"Sigla Materia"),r(),o(64,"div",64),d(65,"Este campo es obligatorio*"),r()()(),o(66,"div",4)(67,"div",61)(68,"input",77),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newplandeestudios,"Prerrequisitos"))}),r(),o(69,"label"),d(70,"Prerrequisitos"),r(),o(71,"div",64),d(72,"Este campo es obligatorio*"),r()(),o(73,"div",61)(74,"input",78),f("change",function(n){u(e);let c=m();return _(c._tools.EscribirEnMayuscula(n,c.newplandeestudios,"SiglasPrerrequisitos"))}),r(),o(75,"label"),d(76,"Siglas Prerrequisitos"),r(),o(77,"div",64),d(78,"Este campo es obligatorio*"),r()()(),o(79,"div",4)(80,"div",66)(81,"select",79)(82,"option",73),d(83,"Seleccione una opci\xF3n"),r(),g(84,Jn,2,3,"option",74),r(),o(85,"label"),d(86,"Tipo de Materia"),r(),o(87,"div",64),d(88,"Este campo es obligatorio*"),r()(),o(89,"div",80)(90,"select",81)(91,"option",73),d(92,"Seleccione una opci\xF3n"),r(),g(93,Xn,2,3,"option",74),r(),o(94,"label"),d(95,"Modo de Materia"),r(),o(96,"div",64),d(97,"Este campo es obligatorio*"),r()()()()(),o(98,"div",82),g(99,eo,2,1,"div",83),o(100,"div",84),g(101,to,6,1,"button",85),r(),o(102,"div",86),g(103,io,2,1,"button",87)(104,no,6,2,"button",88),r()()}if(a&2){let e,i=m();s(2),w("",(e=i.newplandeestudios.get("id"))!=null&&e.value?"Modificar":"Registrar"," plandeestudios"),s(3),l("formGroup",i.newplandeestudios),s(3),l("ngClass",i.ValidacionplandeestudiosxElemento("anio_id")),s(3),l("ngForOf",i.anios),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("carreras_id")),s(3),l("ngForOf",i.carreras),s(7),l("ngClass",i.ValidacionplandeestudiosxElemento("RangoLvlCurso")),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("Rango")),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("Horas")),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("LvlCurso")),s(3),l("ngForOf",i.LvlCursoOptions),s(7),l("ngClass",i.ValidacionplandeestudiosxElemento("NombreMateria")),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("SiglaMateria")),s(7),l("ngClass",i.ValidacionplandeestudiosxElemento("Prerrequisitos")),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("SiglasPrerrequisitos")),s(7),l("ngClass",i.ValidacionplandeestudiosxElemento("TipoMateria")),s(3),l("ngForOf",i.tipoMateriaOptions),s(6),l("ngClass",i.ValidacionplandeestudiosxElemento("ModoMateria")),s(3),l("ngForOf",i.modoMateriaOptions),s(6),l("ngIf",!i.newplandeestudios.get("id").value),s(2),l("ngIf",!i.AnimacionCargabtnModalplandeestudios),s(2),l("ngIf",i.AnimacionCargabtnModalplandeestudios),s(),l("ngIf",!i.AnimacionCargabtnModalplandeestudios)}}function ro(a,t){if(a&1){let e=h();o(0,"button",99),f("click",function(){let n=u(e).$implicit;return _(n.action())}),d(1),r()}if(a&2){let e=t.$implicit;s(),w(" ",e.label," ")}}function ao(a,t){if(a&1&&(o(0,"div",97),P(1,"async"),P(2,"async"),g(3,ro,2,1,"button",98),P(4,"async"),r()),a&2){let e,i,n=m();l("ngStyle",y(8,yn,((e=R(1,2,n.menuStateplandeestudios$))==null?null:e.y)+"px",((e=R(2,4,n.menuStateplandeestudios$))==null?null:e.x)+"px")),s(3),l("ngForOf",(i=R(4,6,n.menuStateplandeestudios$))==null?null:i.items)}}function so(a,t){if(a&1){let e=h();o(0,"div",56)(1,"h5",57),d(2,"Componente Gestion de Carreras"),r(),o(3,"button",100),f("click",function(){let n=u(e).$implicit;return _(n.dismiss())}),r()(),o(4,"div",59),x(5,"app-carreras",101),r()}a&2&&(s(5),l("modo","uno")("idAnio","ASDASD"))}function lo(a,t){if(a&1){let e=h();o(0,"div",56)(1,"h5",57),d(2,"Componente Gestion de Materias"),r(),o(3,"button",100),f("click",function(){let n=u(e).$implicit;return _(n.dismiss())}),r()(),o(4,"div",59),x(5,"app-materias",101),r()}a&2&&(s(5),l("modo","uno")("idAnio","ASDASD"))}var Le=class Le{constructor(t,e,i,n,c,p){this._controles=t;this._planest=e;this._tools=i;this._carr=n;this._anios=c;this._auth=p;this.isRelacionDocenteEstudianteLocked=!1;this.relacionDocenteEstudianteOptionsView=[];this.tipoMateriaOptions=[];this.modoMateriaOptions=[];this.relacionDocenteEstudianteOptions=[];this.LvlCursoOptions=[];this.esSuperAdmin=!1;this.plandeestudios=[];this.paginaplandeestudios=1;this.isLoadingplandeestudios=!1;this.AnimacionCargabtnModalplandeestudios=!1;this.filtertxtplandeestudios="";this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.collectionSizeplandeestudios=0;this.pageSizeplandeestudios=10;this.pageSizeOptionsplandeestudios=[5,10,20,50];this.sortColumnsplandeestudios=[];this.menuStateplandeestudios$=this._tools.state$;this.carreras=[];this.anios=[];this.newplandeestudios=this._planest.createFormGroupplandeestudios(),this.newplandeestudiosAnteriorAccion=this._planest.createFormGroupplandeestudios(),this.initModoMateriaWatcher()}ngOnInit(){this.cargarCarreras(),this.cargarAnios(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(t=>{this.esSuperAdmin=t,this.rebuildResolucionOptions(),this.onFiltroChange()})}cargarOptionsDesdeControles(){let t=["TIPOS MATERIAS","MODOS MATERIAS","RELACI\xD3N DOCENTE ESTUDIANTES","LVLCURSO"];this._controles.ObtenerOptionsSelectPorCategorias(t).subscribe({next:e=>{this.tipoMateriaOptions=e?.["TIPOS MATERIAS"]||[],this.modoMateriaOptions=e?.["MODOS MATERIAS"]||[],this.relacionDocenteEstudianteOptions=e?.["RELACI\xD3N DOCENTE ESTUDIANTES"]||[],this.LvlCursoOptions=e?.LVLCURSO||[],this.applyRelacionDocenteRules(this.newplandeestudios?.get("ModoMateria")?.value)},error:()=>{this.tipoMateriaOptions=[],this.modoMateriaOptions=[],this.relacionDocenteEstudianteOptions=[],this.LvlCursoOptions=[],this.relacionDocenteEstudianteOptionsView=[],this.isRelacionDocenteEstudianteLocked=!1}})}initModoMateriaWatcher(){this.modoMateriaSub?.unsubscribe();let t=this.newplandeestudios?.get("ModoMateria");t&&(this.modoMateriaSub=t.valueChanges.subscribe(e=>{this.applyRelacionDocenteRules(e)}),this.applyRelacionDocenteRules(t.value))}normalizeText(t){return(t??"").toString().trim().toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}findOptionValueApprox(t,e){let i=this.normalizeText(t);return(e||[]).find(c=>this.normalizeText(c?.value)===i||this.normalizeText(c?.label)===i)?.value??null}buildAllowedValues(t){let e=new Set;for(let i of t){let n=this.findOptionValueApprox(i,this.relacionDocenteEstudianteOptions);e.add(n??i)}return e}isModoMateria(t,e){return this.normalizeText(t)===this.normalizeText(e)}applyRelacionDocenteRules(t){let e=this.newplandeestudios?.get("RelacionDocenteCursoAEstudiante"),i=(e?.value??"").toString(),n=null,c=!1;this.isModoMateria(t,"1 DOCENTE x MATERIA")||this.isModoMateria(t,"MULTIPLES DOCENTES x MATERIA")?(c=!0,n=this.buildAllowedValues(["NINGUNA"])):this.isModoMateria(t,"MODO INSTRUMENTOS DE ESPECIALIDAD")?n=this.buildAllowedValues(["1 DOCENTE DE ESPECIALIDAD x ESTUDIANTE","2 DOCENTES DE ESPECIALIDAD x ESTUDIANTE","NINGUNA"]):(this.isModoMateria(t,"MODO PR\xC1CTICA DE CONJUNTOS")||this.isModoMateria(t,"MODO PRACTICA DE CONJUNTOS"))&&(n=this.buildAllowedValues(["1 DOCENTE DE PR\xC1CTICA DE CONJUNTO x ESTUDIANTE","1 DOCENTE DE PRACTICA DE CONJUNTO x ESTUDIANTE","NINGUNA"])),this.isRelacionDocenteEstudianteLocked=c;let p=this.relacionDocenteEstudianteOptions||[];if(this.relacionDocenteEstudianteOptionsView=p.map(v=>{let S=n?n.has(v.value):!0;return Be(ae({},v),{disabled:!!v.disabled||!S})}),e){let v=this.findOptionValueApprox("NINGUNA",p)??"NINGUNA",S=n?n.has(i):!0;(c||!S)&&i!==v&&e.setValue(v)}}rebuildResolucionOptions(){let t=new Map;for(let e of this.carreras){let i=(e?.Resolucion??"").toString().trim();if(!i)continue;let n=(e?.Nivel??"").toString().trim(),c=(e?.Area??"").toString().trim(),p=e?.instituciones_id,v=p!=null&&p!==""?Number(p):null,S=(e?.NombreInstitucion??"").toString().trim(),E=n||"SIN NIVEL",b=`${i}|${E}`,M=this.esSuperAdmin&&v?`${v}|${b}`:b,V=`${c?c+" \xB7 ":""}${i} (${E})`,L=this.esSuperAdmin&&v?`${V}${S?" \xB7 "+S:""}`:V;t.has(M)||t.set(M,{key:M,label:L,resolucion:i,nivel:E,instituciones_id:v})}this.resolucionOptions=Array.from(t.values()).sort((e,i)=>e.label.localeCompare(i.label))}onFiltroChange(){if(this.paginaplandeestudios=1,!!!this.filtroAnioId){this.plandeestudios=[],this.collectionSizeplandeestudios=0;return}this.parseResolucionKey(),this.Cargarplandeestudios()}parseResolucionKey(){let t=(this.filtroResolucionKey??"").toString();if(!t){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=t.split("|");if(e.length>=3){let i=Number(e[0]),n=(e[1]??"").toString(),c=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(i)?i:null,this.filtroResolucion=n||null,this.filtroNivelCarrera=c||null;return}if(e.length===2){let i=(e[0]??"").toString(),n=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=i||null,this.filtroNivelCarrera=n||null;return}this.filtroInstitucionId=null,this.filtroResolucion=t,this.filtroNivelCarrera=null}Cargarplandeestudios(){let t=this.filtroAnioId;if(!t){this.plandeestudios=[],this.collectionSizeplandeestudios=0;return}this.isLoadingplandeestudios=!0;let e={anio_id:t,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0};this.filtroResolucion&&(e.resolucion=this.filtroResolucion),this.filtroNivelCarrera&&(e.nivel=this.filtroNivelCarrera),this._planest.Obtenerplandeestudios(e).subscribe({next:i=>{console.log("planes de estudio",i.data),this.plandeestudios=i.data||[],this.collectionSizeplandeestudios=this.plandeestudios.length,this.isLoadingplandeestudios=!1},error:i=>{console.error("Error al cargar plandeestudios",i),this.isLoadingplandeestudios=!1}})}AgregarModificarplandeestudios(){if(this.newplandeestudios.invalid){this.ValidacionTodoElementoplandeestudios(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalplandeestudios=!1;return}else{this.AnimarCargaTablaplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!0,this._tools.MostrarMensajeLoading(),this.newplandeestudiosAnteriorAccion.setValue(this.newplandeestudios.value);let t=this.newplandeestudios.controls.id.value;console.log("INFO A PROCESAR",this.newplandeestudios.value),t?this._planest.Modificarplandeestudios(this.newplandeestudios.value,this.newplandeestudios.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE plandeestudios",e.data),this.Cargarplandeestudios(),this.resetplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR plandeestudios",e),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeError()}):this._planest.Agregarplandeestudios(this.newplandeestudios.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE plandeestudios",e.data),this.Cargarplandeestudios(),this.resetplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR plandeestudios",e),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeError()})}}Seleccionarplandeestudios(t){if(this._tools.MostrarMensajeLoading(),t){if(!this.plandeestudios.find(i=>i.id===t))return;this._planest.Seleccionarplandeestudios(t).subscribe(i=>{Object.keys(this.newplandeestudios.controls).forEach(n=>{this.newplandeestudios.controls[n].setValue(i.data[n])}),console.log("SELECCION DE plandeestudios EXITOSA",this.newplandeestudios.value),this.newplandeestudiosAnteriorAccion.setValue(this.newplandeestudios.value),this.modalGestionplandeestudiosRef=this._tools.openModal(this.modalgestionplandeestudios,"xl"),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL SELECCIONAR plandeestudios",i),this._tools.MostrarMensajeError()})}}Eliminarplandeestudios(t){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._planest.Eliminarplandeestudios(t).subscribe(i=>{console.log(i.data),this.Cargarplandeestudios(),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL ELIMINAR plandeestudios",i),this._tools.MostrarMensajeError()}))})}resetplandeestudios(){this.newplandeestudios=this._planest.createFormGroupplandeestudios(),this.initModoMateriaWatcher(),this._tools.closeModal(this.modalGestionplandeestudiosRef)}AutoCompletarLastplandeestudios(){this.newplandeestudios.setValue(this.newplandeestudiosAnteriorAccion.value),this.newplandeestudios.patchValue({id:0}),console.log("listo",this.newplandeestudios.value)}AnimarCargaTablaplandeestudios(){this.plandeestudios=[],this.isLoadingplandeestudios=!0}ValidacionplandeestudiosxElemento(t){return this._tools.obtenerValidationClass(this.newplandeestudios,t)}ValidacionTodoElementoplandeestudios(){Object.values(this.newplandeestudios.controls).forEach(t=>{t.markAsTouched(),t.markAsDirty()})}onPageSizeChangeplandeestudios(){this.paginaplandeestudios=1}sortByplandeestudios(t,e){this.sortColumnsplandeestudios=this._tools.handleSort(t,e,this.sortColumnsplandeestudios),this.plandeestudios=this._tools.applyMultiSort(this.plandeestudios,this.sortColumnsplandeestudios)}isSortedplandeestudios(t){return this._tools.isSorted(this.sortColumnsplandeestudios,t)}getSortDirplandeestudios(t){return this._tools.getSortDirection(this.sortColumnsplandeestudios,t)}closeMenu(){this._tools.close()}abrirMenuplandeestudios(t,e){t.preventDefault(),t.stopPropagation();let i=[{label:"\u270F Editar",action:()=>this.Seleccionarplandeestudios(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarplandeestudios(e.id)}];this._tools.open(t.clientX,t.clientY,i)}cargarCarreras(){this._carr.Obtenercarreras().subscribe({next:t=>{console.log("data carreras",t),this.carreras=t.data||[],this.rebuildResolucionOptions()},error:t=>{console.error("Error al cargar carreras",t),this.resolucionOptions=[]}})}cargarAnios(){this._anios.ObtenerAniosConPredeterminado().subscribe({next:t=>{if(this.anios=t?.anios||[],this.filtroAnioId===null||this.filtroAnioId===void 0){let e=t?.predeterminado;e?.id?this.filtroAnioId=Number(e.id):this.anios?.length&&(this.filtroAnioId=Number(this.anios[0]?.id))}this.onFiltroChange()},error:t=>{console.error("Error al cargar anios",t)}})}};Le.\u0275fac=function(e){return new(e||Le)(A(Ie),A(Ne),A(ne),A(oe),A(Te),A(te))},Le.\u0275cmp=W({type:Le,selectors:[["app-plandeestudios"]],viewQuery:function(e,i){if(e&1&&de(Sn,7),e&2){let n;me(n=pe())&&(i.modalgestionplandeestudios=n.first)}},hostBindings:function(e,i){e&1&&f("click",function(){return i.closeMenu()},Ce)},standalone:!1,decls:60,vars:20,consts:[["modalgestionplandeestudios",""],["modalOtroComponentecarreras",""],["modalOtroComponentematerias",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"col-sm-6","d-flex","justify-content-start","button",2,"gap","10px"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","d-flex","justify-content-end",2,"gap","10px"],[1,"form-floating",2,"min-width","140px"],["title","Filtrar por A\xF1o",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-floating",2,"min-width","180px"],["title","Filtrar por Resoluci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-sm-3","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],["class","mt-4",4,"ngIf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],["title","Sigla Prerrequisitos",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"small","text-muted"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"form-floating","mb-3","col-sm-6"],["formControlName","anio_id",1,"form-control",3,"ngClass"],["disabled","","selected","",3,"value"],[1,"invalid-feedback"],["formControlName","carreras_id",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-2"],["type","number","placeholder","","formControlName","RangoLvlCurso",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","Rango",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-3"],["type","number","placeholder","","formControlName","Horas",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-5"],["formControlName","LvlCurso",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["type","text","placeholder","","formControlName","NombreMateria",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","SiglaMateria",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","Prerrequisitos",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","SiglasPrerrequisitos",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","TipoMateria",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-4"],["formControlName","ModoMateria",1,"form-control",3,"ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[3,"modo","idAnio"]],template:function(e,i){if(e&1){let n=h();o(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1",6),d(4,"Gesti\xF3n de Plan de Estudios"),r(),o(5,"p",7),d(6,'Administra la informaci\xF3n de los "Planes de estudios", "Materias" y "Carreras" de manera sencilla y eficiente'),r()()()(),o(7,"div",4)(8,"div",8)(9,"button",9),f("click",function(){u(n);let p=Ke(53);return _(i.modalGestionplandeestudiosRef=i._tools.openModal(p,"xl"))}),o(10,"span",10),x(11,"ng-lottie",11),r(),o(12,"span"),d(13,"A\xF1adir plandeestudios "),r(),x(14,"span",12),r(),o(15,"button",9),f("click",function(){u(n);let p=Ke(57);return _(i._tools.openModal(p,"xl"))}),o(16,"span",10),x(17,"ng-lottie",11),r(),o(18,"span"),d(19,"GESTIONAR CARRERAS"),r(),x(20,"span",12),r(),o(21,"button",9),f("click",function(){u(n);let p=Ke(59);return _(i._tools.openModal(p,"xl"))}),o(22,"span",10),x(23,"ng-lottie",11),r(),o(24,"span"),d(25,"GESTIONAR MATERIAS"),r(),x(26,"span",12),r()(),o(27,"div",13)(28,"div",14)(29,"select",15),O("ngModelChange",function(p){return u(n),T(i.filtroAnioId,p)||(i.filtroAnioId=p),_(p)}),f("ngModelChange",function(){return u(n),i.paginaplandeestudios=1,_(i.onFiltroChange())}),o(30,"option",16),d(31,"Seleccione una opci\xF3n"),r(),g(32,Mn,2,2,"option",17),r(),o(33,"label"),d(34,"A\xF1o"),r()(),o(35,"div",18)(36,"select",19),O("ngModelChange",function(p){return u(n),T(i.filtroResolucionKey,p)||(i.filtroResolucionKey=p),_(p)}),f("ngModelChange",function(){return u(n),i.paginaplandeestudios=1,_(i.onFiltroChange())}),o(37,"option",16),d(38,"Seleccione una opci\xF3n"),r(),g(39,wn,2,2,"option",17),r(),o(40,"label"),d(41,"Resoluci\xF3n"),r()()(),o(42,"div",20)(43,"div",21)(44,"span",22),x(45,"ng-lottie",23),r(),o(46,"div",24)(47,"input",25),f("input",function(){return u(n),_(i.paginaplandeestudios=1)}),O("ngModelChange",function(p){return u(n),T(i.filtertxtplandeestudios,p)||(i.filtertxtplandeestudios=p),_(p)}),r(),o(48,"label"),d(49,"Buscar"),r()()()()(),g(50,qn,46,26,"div",26),P(51,"filterByFields"),g(52,oo,105,23,"ng-template",null,0,$)(54,ao,5,11,"div",27),P(55,"async"),g(56,so,6,2,"ng-template",null,1,$)(58,lo,6,2,"ng-template",null,2,$)}if(e&2){let n;s(11),l("options",i._tools.optionsAdicionar),s(6),l("options",i._tools.optionssubgestion),s(6),l("options",i._tools.optionssubgestion),s(6),I("ngModel",i.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",i.anios),s(4),I("ngModel",i.filtroResolucionKey),s(),l("ngValue",null),s(2),l("ngForOf",i.resolucionOptions),s(6),l("options",i._tools.optionslupa),s(2),I("ngModel",i.filtertxtplandeestudios),s(3),l("ngIf",U(51,13,i.plandeestudios,i.filtertxtplandeestudios,Ye(19,En))),s(4),l("ngIf",(n=R(55,17,i.menuStateplandeestudios$))==null?null:n.visible)}},dependencies:[q,K,Q,ve,ye,Z,ee,Se,tt,X,Y,Ee,J,Me,we,Ae,ie,Ve,Re,he,be,ot],encapsulation:2});var rt=Le;var ge=class ge{constructor(t){this.http=t;this.ruta=Ze.ruta}Obtenerplanteldocentesmaterias(t){let e=new Je,i=t;return i?.planteldocentes_id&&(e=e.set("planteldocentes_id",String(i.planteldocentes_id))),i?.anio_id&&(e=e.set("anio_id",String(i.anio_id))),i?.resolucion&&(e=e.set("resolucion",String(i.resolucion))),i?.nivel&&(e=e.set("nivel",String(i.nivel))),i?.instituciones_id&&(e=e.set("instituciones_id",String(i.instituciones_id))),this.http.get(this.ruta+"api/planteldocentesmaterias/",{params:e})}ObtenerplanteldocentesmateriasPorDocente(t){return this.Obtenerplanteldocentesmaterias({planteldocentes_id:t})}AsignarMateriaADocente(t){return this.http.post(this.ruta+"api/planteldocentesmaterias/assign",t)}QuitarMateriaADocente(t){return this.http.post(this.ruta+"api/planteldocentesmaterias/unassign",t)}Agregarplanteldocentesmaterias(t){return this.http.post(this.ruta+"api/planteldocentesmaterias/",t)}Modificarplanteldocentesmaterias(t,e){return this.http.put(this.ruta+"api/planteldocentesmaterias/"+e,t)}Seleccionarplanteldocentesmaterias(t){return this.http.get(this.ruta+"api/planteldocentesmaterias/"+t)}Eliminarplanteldocentesmaterias(t){return this.http.delete(this.ruta+"api/planteldocentesmaterias/"+t)}createFormGroupplanteldocentesmaterias(){return new et({id:new D(0),planteldocentes_id:new D(""),materias_id:new D("")})}};ge.\u0275fac=function(e){return new(e||ge)(We(Xe))},ge.\u0275prov=ze({token:ge,factory:ge.\u0275fac,providedIn:"root"});var at=ge;var Dt=a=>({checked:a,"custom-border":!0});function mo(a,t){if(a&1&&(o(0,"option",12),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.id),s(),C(e.Anio)}}function po(a,t){if(a&1&&(o(0,"option",12),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.key),s(),C(e.label)}}function uo(a,t){if(a&1){let e=h();o(0,"tr")(1,"td"),d(2),r(),o(3,"td"),d(4),r(),o(5,"td")(6,"button",49),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.seleccionarDocenteDemo(n))}),d(7," Seleccionar "),r()()()}if(a&2){let e=t.$implicit,i=m(2);s(2),ue("",e.nombre," (#",e.id,")"),s(2),C(e.cantMaterias||0),s(2),l("disabled",!i.esDocenteSeleccionable(e))}}function _o(a,t){a&1&&(o(0,"tr")(1,"td",50),d(2,"Sin pendientes"),r()())}function go(a,t){if(a&1){let e=h();o(0,"div",41)(1,"div",42)(2,"span"),d(3,"DOCENTES SIN ASIGNACIONES (sin materias asignadas)"),r()(),o(4,"div",23)(5,"div",7)(6,"span",8),x(7,"i",27),r(),o(8,"div",10)(9,"input",43),f("input",function(n){u(e);let c=m();return _(c.filterPendientesDocentes=n.target.value)}),r(),o(10,"label"),d(11,"Buscar (nombre)"),r()()()(),o(12,"div",44)(13,"table",45)(14,"thead")(15,"tr")(16,"th"),d(17,"Docente"),r(),o(18,"th",46),d(19,"Materias asignadas"),r(),o(20,"th",47),d(21,"Acci\xF3n"),r()()(),o(22,"tbody"),g(23,uo,8,4,"tr",48)(24,_o,3,0,"tr",39),r()()()()}if(a&2){let e=m();s(9),l("value",e.filterPendientesDocentes),s(14),l("ngForOf",e.docentesPendientesFiltrados())("ngForTrackBy",e.trackById),s(),l("ngIf",e.docentesPendientesFiltrados().length===0)}}function fo(a,t){if(a&1){let e=h();o(0,"button",51),f("click",function(){let n=u(e).$implicit,c=m();return _(c.seleccionarDocenteDemo(n))}),d(1),o(2,"span",52),d(3),r()()}if(a&2){let e=t.$implicit,i=m();Qe("active",(i.docenteSeleccionadoDemo==null?null:i.docenteSeleccionadoDemo.id)===e.id),l("disabled",!i.esDocenteSeleccionable(e)),s(),ue(" ",e.nombre," (#",e.id,") "),s(2),w(" - ",e.cantMaterias||0," materias")}}function xo(a,t){a&1&&(o(0,"small",52),d(1,"Selecciona un docente para habilitar los toggles."),r())}function Co(a,t){if(a&1&&(o(0,"h3",53),d(1," Docente Seleccionado: "),o(2,"b"),d(3),r()()),a&2){let e=m();s(3),C(e.docenteSeleccionadoDemo.nombre)}}function vo(a,t){if(a&1&&(o(0,"option",12),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.id),s(),C(e.Anio)}}function ho(a,t){if(a&1&&(o(0,"option",12),d(1),r()),a&2){let e=t.$implicit;l("ngValue",e.key),s(),C(e.label)}}function bo(a,t){if(a&1){let e=h();o(0,"div",54)(1,"div",6)(2,"div",7)(3,"span",8),x(4,"i",9),r(),o(5,"div",10)(6,"select",55),O("ngModelChange",function(n){u(e);let c=m();return T(c.filtroAnioId,n)||(c.filtroAnioId=n),_(n)}),f("change",function(){u(e);let n=m();return _(n.onCambioFiltrosAsignacion())}),o(7,"option",12),d(8,"-- Seleccione --"),r(),g(9,vo,2,2,"option",13),r(),o(10,"label",56),d(11,"A\xF1o (Gesti\xF3n)"),r()()()(),o(12,"div",57)(13,"div",7)(14,"span",8),x(15,"i",15),r(),o(16,"div",10)(17,"select",58),O("ngModelChange",function(n){u(e);let c=m();return T(c.filtroResolucionKey,n)||(c.filtroResolucionKey=n),_(n)}),f("change",function(){u(e);let n=m();return _(n.onCambioFiltrosAsignacion())}),o(18,"option",12),d(19,"-- Seleccione --"),r(),g(20,ho,2,2,"option",13),r(),o(21,"label",59),d(22,"Resoluci\xF3n"),r()()()()()}if(a&2){let e=m();s(6),I("ngModel",e.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",e.aniosOptions),s(8),I("ngModel",e.filtroResolucionKey),s(),l("ngValue",""),s(2),l("ngForOf",e.resolucionOptions)}}function So(a,t){if(a&1){let e=h();o(0,"button",71),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.toggleLvlCurso(n))}),d(1),r()}if(a&2){let e=t.$implicit,i=m(2);Qe("active",i.isLvlCursoSeleccionado(e)),s(),w(" ",e," ")}}function Eo(a,t){if(a&1){let e=h();o(0,"button",72),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.toggleParalelo(n))}),d(1),r()}if(a&2){let e=t.$implicit,i=m(2);Qe("active",i.isParaleloSeleccionado(e)),s(),w(" ",e," ")}}function yo(a,t){if(a&1&&(o(0,"div",82),d(1),r()),a&2){let e=t.ngIf;s(),w(" Docentes: ",e," ")}}function Mo(a,t){a&1&&(o(0,"div",83)(1,"span",84),d(2,"Cargando..."),r()())}function wo(a,t){if(a&1){let e=h();o(0,"div",77)(1,"button",78),f("click",function(n){let c=u(e).$implicit,p=m(4);return _(p.toggleAsignacionDemo(c,n))}),o(2,"span",79),d(3),r(),o(4,"span"),d(5),r()(),g(6,yo,2,1,"div",80)(7,Mo,3,0,"div",81),r()}if(a&2){let e=t.$implicit,i=m(4);l("ngClass",pt(7,Dt,i.isAsignadaDemo(e.id))),s(),l("disabled",!i.docenteSeleccionadoDemo||i.isLoadingMateria[e.id]),s(),l("ngClass",i.isAsignadaDemo(e.id)?"bg-success":"bg-secondary"),s(),w(" ",i.isAsignadaDemo(e.id)?"ASIGNADO":"NO"," "),s(2),C((e.sigla?e.sigla+" - ":"")+e.nombre),s(),l("ngIf",i.docentesAsignadosEnMateriaTexto(e.id)),s(),l("ngIf",i.isLoadingMateria[e.id])}}function Ao(a,t){if(a&1&&(o(0,"div")(1,"h5",74),d(2),r(),o(3,"div",75),g(4,wo,8,9,"div",76),r(),x(5,"hr"),r()),a&2){let e=t.$implicit,i=m(3);s(2),C(e),s(2),l("ngForOf",i.materiasPorCategoria(e))}}function Io(a,t){if(a&1&&(dt(0),g(1,Ao,6,2,"div",73),mt()),a&2){let e=m(2);s(),l("ngForOf",e.categoriasDemo())}}function To(a,t){if(a&1&&(o(0,"span"),d(1),r()),a&2){let e=m().$implicit;s(),C(e.lvlCurso)}}function Oo(a,t){if(a&1&&(o(0,"span"),d(1),r()),a&2){let e=m().$implicit;s(),w(" - ",e.paralelo)}}function Vo(a,t){if(a&1&&(o(0,"div",82),d(1),r()),a&2){let e=t.ngIf;s(),w(" Docentes: ",e," ")}}function No(a,t){a&1&&(o(0,"div",83)(1,"span",84),d(2,"Cargando..."),r()())}function Do(a,t){if(a&1){let e=h();o(0,"div",77)(1,"button",78),f("click",function(n){let c=u(e).$implicit,p=m(3);return _(p.toggleAsignacionDemo(c,n))}),o(2,"span",79),d(3),r(),o(4,"span"),d(5),r()(),o(6,"div",82),g(7,To,2,1,"span",39)(8,Oo,2,1,"span",39),r(),g(9,Vo,2,1,"div",80)(10,No,3,0,"div",81),r()}if(a&2){let e=t.$implicit,i=m(3);l("ngClass",pt(9,Dt,i.isAsignadaDemo(e.id))),s(),l("disabled",!i.docenteSeleccionadoDemo||i.isLoadingMateria[e.id]),s(),l("ngClass",i.isAsignadaDemo(e.id)?"bg-success":"bg-secondary"),s(),w(" ",i.isAsignadaDemo(e.id)?"ASIGNADO":"NO"," "),s(2),C((e.sigla?e.sigla+" - ":"")+e.nombre),s(2),l("ngIf",e.lvlCurso),s(),l("ngIf",e.paralelo),s(),l("ngIf",i.docentesAsignadosEnMateriaTexto(e.id)),s(),l("ngIf",i.isLoadingMateria[e.id])}}function Po(a,t){if(a&1&&(dt(0),o(1,"div",75),g(2,Do,11,11,"div",76),r(),mt()),a&2){let e=m(2);s(2),l("ngForOf",e.materiasFiltradasDemo())}}function Ro(a,t){if(a&1){let e=h();o(0,"div")(1,"div",54)(2,"div",60)(3,"div",7)(4,"span",8),x(5,"i",61),r(),o(6,"div",10)(7,"input",62),f("input",function(n){u(e);let c=m();return _(c.filterMateria=n.target.value)}),r(),o(8,"label"),d(9,"Buscar materia (sigla/nombre/ID)"),r()()()(),o(10,"div",63)(11,"div",64)(12,"input",65),f("change",function(){u(e);let n=m();return _(n.toggleModoCategorias())}),r(),o(13,"label",66),d(14,"Con categor\xEDas"),r()(),o(15,"div",67)(16,"small",68),d(17,"Cursos:"),r(),g(18,So,2,3,"button",69),r(),o(19,"div",67)(20,"small",68),d(21,"Paralelos:"),r(),g(22,Eo,2,3,"button",70),r()()(),g(23,Io,2,1,"ng-container",39)(24,Po,3,1,"ng-container",39),r()}if(a&2){let e=m();s(7),l("value",e.filterMateria),s(5),l("checked",e.modoCategorias),s(6),l("ngForOf",e.lvlCursosDetectados()),s(4),l("ngForOf",e.paralelosDetectados()),s(),l("ngIf",e.modoCategorias),s(),l("ngIf",!e.modoCategorias)}}function Fo(a,t){a&1&&(o(0,"tr")(1,"td",87),d(2," Selecciona un docente para ver asignaciones. "),r()())}function ko(a,t){if(a&1){let e=h();o(0,"tr")(1,"td"),d(2),r(),o(3,"td"),d(4),r(),o(5,"td"),d(6),r(),o(7,"td"),d(8),r(),o(9,"td"),d(10),r(),o(11,"td")(12,"button",88),f("click",function(){let n=u(e).$implicit,c=m(2);return _(c.quitarAsignacionTabla(n.materiaId))}),d(13," Quitar "),r()()()}if(a&2){let e=t.$implicit,i=t.index,n=m(2);s(2),C(i+1),s(2),C(e.docente),s(2),C(e.categoria),s(2),C(e.materia),s(2),C(e.paralelo),s(2),l("disabled",!n.docenteSeleccionadoDemo||n.isLoadingMateria[e.materiaId])}}function Lo(a,t){a&1&&(o(0,"tr")(1,"td",89),d(2,"Sin asignaciones (demo)"),r()())}function Go(a,t){if(a&1&&(o(0,"div",44)(1,"table",85)(2,"thead")(3,"tr")(4,"th"),d(5,"#"),r(),o(6,"th"),d(7,"Docente"),r(),o(8,"th"),d(9,"Categoria"),r(),o(10,"th"),d(11,"Materia"),r(),o(12,"th"),d(13,"Paralelo"),r(),o(14,"th"),d(15,"Acci\xF3n"),r()()(),o(16,"tbody",86),g(17,Fo,3,0,"tr",39)(18,ko,14,6,"tr",73)(19,Lo,3,0,"tr",39),r()()()),a&2){let e=m();s(17),l("ngIf",!e.docenteSeleccionadoDemo),s(),l("ngForOf",e.tablaAsignacionesDemo()),s(),l("ngIf",e.docenteSeleccionadoDemo&&e.tablaAsignacionesDemo().length===0)}}var Ge=class Ge{constructor(t,e,i,n,c,p,v){this._mat=t;this._tools=e;this._planteldoc=i;this._planteldocmat=n;this._carreras=c;this._anios=p;this._auth=v;this.ModoBoolean=!1;this.filterDocente="";this.filterMateria="";this.docentesDemo=[];this.materiasDemo=[];this.docenteSeleccionadoDemo=null;this.paraleloDemo="";this.modoCategorias=!0;this.aniosOptions=[];this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.esSuperAdmin=!1;this.carreras=[];this.verPendientesDocentes=!1;this.filterPendientesDocentes="";this.selectedLvlCursos=new Set;this.selectedParalelos=new Set;this.asignacionesDemo=new Map;this.docentesPorMateria=new Map;this.isLoadingMateria={};this.docentes=[];this.materias=[]}ngOnInit(){this.cargarFiltrosAsignacion(),this.cargardocentes(),this._auth.revisarSiEsSuperAdmin().subscribe(t=>{this.esSuperAdmin=t,this.rebuildResolucionOptions(),this.onCambioFiltrosAsignacion()})}cargarFiltrosAsignacion(){this._anios.Obteneranios().subscribe({next:t=>{let e=Array.isArray(t?.data)?t.data:[];this.aniosOptions=e.map(i=>({id:Number(i?.id),Anio:String(i?.Anio??"").trim()})).filter(i=>Number.isFinite(i.id)&&i.id>0&&i.Anio)},error:()=>{this.aniosOptions=[]}}),this._carreras.Obtenercarreras().subscribe({next:t=>{this.carreras=Array.isArray(t?.data)?t.data:[],this.rebuildResolucionOptions()},error:()=>{this.carreras=[],this.rebuildResolucionOptions()}})}rebuildResolucionOptions(){let t=new Map;for(let e of this.carreras||[]){let i=(e?.Resolucion??"").toString().trim();if(!i)continue;let n=(e?.Nivel??"").toString().trim(),c=(e?.Area??"").toString().trim(),p=e?.instituciones_id,v=p!=null&&p!==""?Number(p):null,S=(e?.NombreInstitucion??"").toString().trim(),E=n||"SIN NIVEL",b=`${i}|${E}`,M=this.esSuperAdmin&&v?`${v}|${b}`:b,V=`${c?c+" \xB7 ":""}${i} (${E})`,L=this.esSuperAdmin&&v?`${V}${S?" \xB7 "+S:""}`:V;t.has(M)||t.set(M,{key:M,label:L,resolucion:i,nivel:E,instituciones_id:v})}this.resolucionOptions=Array.from(t.values()).sort((e,i)=>e.label.localeCompare(i.label))}onCambioFiltrosAsignacion(){this.selectedLvlCursos.clear(),this.selectedParalelos.clear(),this.recargarDatosPorFiltro()}togglePendientesDocentes(){this.verPendientesDocentes=!this.verPendientesDocentes}docentesPendientesFiltrados(){let t=(this.filterPendientesDocentes??"").trim().toLowerCase(),e=this.docentesDemo.filter(i=>(i.cantMaterias??0)===0);return t?e.filter(i=>`${i.id} ${i.nombre}`.toLowerCase().includes(t)):e}esDocenteSeleccionable(t){return t?(t.estado??"").toString().trim().toUpperCase()!=="INACTIVO":!1}cargardocentes(){this._planteldoc.Obtenerplanteldocentes().subscribe({next:t=>{if(console.log("data plantel docente",t.data),this.docentes=t.data,this.docentesDemo=(Array.isArray(t.data)?t.data:[]).map(e=>{let i=(e?.Nombres??"").toString().trim(),n=(e?.Apellidos??"").toString().trim(),c=`${i} ${n}`.trim()||`Docente #${e?.id}`,p=(e?.Visibilidad??"").toString().trim().toUpperCase(),v=(e?.Estado??"").toString().trim().toUpperCase();return{id:Number(e?.id),nombre:c,cantMaterias:0,visibilidad:p,estado:v}}).filter(e=>Number.isFinite(e.id)&&(e.visibilidad??"").toString().trim().toUpperCase()==="VISIBLE"),this.docenteSeleccionadoDemo){let e=this.docentesDemo.find(i=>i.id===this.docenteSeleccionadoDemo?.id);(!e||!this.esDocenteSeleccionable(e))&&(this.docenteSeleccionadoDemo=null)}this.recalcularConteosDocentes()},error:t=>{console.error("Error al cargar los docentes:",t)}})}parseResolucionKey(){let t=(this.filtroResolucionKey??"").toString();if(!t){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=t.split("|");if(e.length>=3){let i=Number(e[0]),n=(e[1]??"").toString(),c=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(i)?i:null,this.filtroResolucion=n||null,this.filtroNivelCarrera=c||null;return}if(e.length===2){let i=(e[0]??"").toString(),n=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=i||null,this.filtroNivelCarrera=n||null;return}this.filtroInstitucionId=null,this.filtroResolucion=t,this.filtroNivelCarrera=null}getFiltroParams(){let t=this.filtroAnioId,e=!!(this.filtroResolucionKey&&this.filtroResolucionKey.toString().trim());return!t||!e||(this.parseResolucionKey(),!this.filtroResolucion||!this.filtroNivelCarrera)?null:{anio_id:t,resolucion:this.filtroResolucion,nivel:this.filtroNivelCarrera,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0}}recargarDatosPorFiltro(){let t=this.getFiltroParams();if(!t){this.materias=[],this.materiasDemo=[],this.asignacionesDemo.clear(),this.docentesPorMateria.clear(),this.recalcularConteosDocentes();return}$e({materias:this._mat.Obtenermaterias(t).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error al cargar materias (filtro global)",e),se([])))),asignaciones:this._planteldocmat.Obtenerplanteldocentesmaterias(t).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error al cargar asignaciones (filtro global)",e),se([]))))}).subscribe({next:({materias:e,asignaciones:i})=>{this.materias=e||[],this.materiasDemo=(Array.isArray(e)?e:[]).map(c=>{let p=(c?.NombreMateria??"").toString().trim()||`Materia #${c?.id}`,v=(c?.SiglaMateria??"").toString().trim()||void 0,S=(c?.ModoMateria??"").toString().trim()||void 0,E=(c?.Anio??"SIN ASIGNAR").toString().trim()||"SIN ASIGNAR",b=(c?.Resolucion??"SIN RESOLUCION").toString().trim()||"SIN RESOLUCION",M=(c?.LvlCurso??"SIN CURSO").toString().trim()||"SIN CURSO",V=(c?.Paralelo??"").toString().trim(),L=V?`${M} ${V}`:M;return{id:Number(c?.id),categoria:L,sigla:v,nombre:p,modoMateria:S,lvlCurso:M,paralelo:V,anio:E,resolucion:b}}).filter(c=>Number.isFinite(c.id));let n=new Set(this.materiasDemo.map(c=>c.id));this.asignacionesDemo.clear(),this.docentesPorMateria.clear();for(let c of Array.isArray(i)?i:[]){let p=Number(c.planteldocentes_id??c.planteldocente_id),v=Number(c.materias_id??c.materia_id);!Number.isFinite(p)||!Number.isFinite(v)||n.has(v)&&(this.asignacionesDemo.has(p)||this.asignacionesDemo.set(p,new Set),this.asignacionesDemo.get(p)?.add(v),this.docentesPorMateria.has(v)||this.docentesPorMateria.set(v,new Set),this.docentesPorMateria.get(v)?.add(p))}this.recalcularConteosDocentes()},error:e=>{console.error(e)}})}recalcularConteosDocentes(){Array.isArray(this.docentesDemo)&&(this.docentesDemo=this.docentesDemo.map(t=>{let e=(this.asignacionesDemo.get(t.id)??new Set).size;return Be(ae({},t),{cantMaterias:e})}))}trackById(t,e){return e.id}onToggleChange(t){let e=t.target.checked;this.ModoBoolean=e}docentesFiltradosDemo(){let t=(this.filterDocente??"").trim().toLowerCase();return t?this.docentesDemo.filter(e=>`${e.id} ${e.nombre}`.toLowerCase().includes(t)):this.docentesDemo}seleccionarDocenteDemo(t){this.esDocenteSeleccionable(t)&&(this.docenteSeleccionadoDemo=t)}limpiarDocenteDemo(){this.docenteSeleccionadoDemo=null}materiasFiltradasDemo(){let t=(this.filterMateria??"").trim().toLowerCase(),e=this.materiasDemo;return t&&(e=e.filter(i=>`${i.id} ${i.sigla??""} ${i.nombre} ${i.categoria} ${i.lvlCurso??""} ${i.paralelo??""} ${this.docentesAsignadosEnMateriaTexto(i.id)}`.toLowerCase().includes(t))),this.selectedLvlCursos.size>0&&(e=e.filter(i=>this.selectedLvlCursos.has((i.lvlCurso??"").toString()))),this.selectedParalelos.size>0&&(e=e.filter(i=>this.selectedParalelos.has((i.paralelo??"").toString()))),e}materiasPorCategoria(t){return this.materiasFiltradasDemo().filter(e=>e.categoria===t)}categoriasDemo(){return Array.from(new Set(this.materiasFiltradasDemo().map(t=>t.categoria))).sort((t,e)=>t.localeCompare(e))}toggleModoCategorias(){this.modoCategorias=!this.modoCategorias}lvlCursosDetectados(){return Array.from(new Set(this.materiasDemo.map(t=>t.lvlCurso).filter(Boolean))).sort((t,e)=>t.localeCompare(e))}paralelosDetectados(){return Array.from(new Set(this.materiasDemo.map(t=>t.paralelo).filter(t=>!!t))).sort((t,e)=>t.localeCompare(e))}isLvlCursoSeleccionado(t){return this.selectedLvlCursos.has(t)}toggleLvlCurso(t){this.selectedLvlCursos.has(t)?this.selectedLvlCursos.delete(t):this.selectedLvlCursos.add(t)}isParaleloSeleccionado(t){return this.selectedParalelos.has(t)}toggleParalelo(t){this.selectedParalelos.has(t)?this.selectedParalelos.delete(t):this.selectedParalelos.add(t)}docentesAsignadosEnMateriaTexto(t){let e=this.docentesPorMateria.get(t);return!e||e.size===0?"":Array.from(e).map(n=>this.docentesDemo.find(c=>c.id===n)?.nombre??`#${n}`).filter(Boolean).join(", ")}normalizeModoMateria(t){return(t??"").toString().trim().toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}esModoInstrumentoEspecialidad(t){let e=this.normalizeModoMateria(t.modoMateria);return e.includes("INSTRUMENT")&&e.includes("ESPECIAL")}esModoPracticaConjuntos(t){let e=this.normalizeModoMateria(t.modoMateria);return e.includes("PRACTICA")&&e.includes("CONJUNTO")}esModoUnDocentePorMateria(t){let e=this.normalizeModoMateria(t.modoMateria);return e.includes("1")&&e.includes("DOCENTE")}isAsignadaDemo(t){let e=this.docenteSeleccionadoDemo;return e?(this.asignacionesDemo.get(e.id)??new Set).has(t):!1}toggleAsignacionDemo(t,e){return ct(this,null,function*(){if(e?.preventDefault(),!this.docenteSeleccionadoDemo)return;let i=this.docenteSeleccionadoDemo.id,n=this.asignacionesDemo.get(i)??new Set;this.asignacionesDemo.set(i,n),this.isLoadingMateria[t.id]=!0;try{if(n.has(t.id)){yield new Promise((v,S)=>{this._planteldocmat.QuitarMateriaADocente({planteldocentes_id:i,materias_id:t.id}).subscribe({next:()=>v(),error:E=>S(E)})}),n.delete(t.id);let p=this.docentesPorMateria.get(t.id);p?.delete(i),p&&p.size===0&&this.docentesPorMateria.delete(t.id)}else{if(this.esModoInstrumentoEspecialidad(t)){this._tools.MostrarMensaje("info","NO ES NECESARIO ASIGNAR MATERIAS DE INSTRUMENTO DE ESPECIALIDAD PORQUE LA DETECCION DE ESTUDIANTES SE HACE AUTOMATICO DESDE INSCRIPCIONES DE ESTUDIANTES.");return}if(this.esModoPracticaConjuntos(t)){this._tools.MostrarMensaje("info","NO ES NECESARIO ASIGNAR MATERIAS DE PR\xC1CTICA DE CONJUNTOS PORQUE LA DETECCION DE ESTUDIANTES SE HACE AUTOMATICO DESDE INSCRIPCIONES DE ESTUDIANTES.");return}if(this.esModoUnDocentePorMateria(t)){let p=this.docentesPorMateria.get(t.id);if(p&&p.size>0){let v=this.docentesAsignadosEnMateriaTexto(t.id);this._tools.MostrarMensaje("warning",`No se puede asignar: esta materia es "1 DOCENTE x MATERIA" y ya tiene docente asignado${v?": "+v:"."}`);return}}yield new Promise((p,v)=>{this._planteldocmat.AsignarMateriaADocente({planteldocentes_id:i,materias_id:t.id,Paralelo:this.paraleloDemo||null}).subscribe({next:()=>p(),error:S=>v(S)})}),n.add(t.id),this.docentesPorMateria.has(t.id)||this.docentesPorMateria.set(t.id,new Set),this.docentesPorMateria.get(t.id)?.add(i)}}catch(c){console.error("Error al alternar asignaci\xF3n:",c);let p=c,v=(p?.error?.message??p?.message??"").toString().trim();v?this._tools.MostrarMensaje("error",v):this._tools.MostrarMensajeError()}finally{this.isLoadingMateria[t.id]=!1,this.recalcularConteosDocentes()}})}quitarAsignacionTabla(t){return ct(this,null,function*(){if(!this.docenteSeleccionadoDemo)return;let e=this.materiasDemo.find(i=>i.id===t);e&&(yield this.toggleAsignacionDemo(e))})}tablaAsignacionesDemo(){let t=this.docenteSeleccionadoDemo;if(!t)return[];let e=this.asignacionesDemo.get(t.id)??new Set,i=[];for(let n of e){let c=this.materiasDemo.find(p=>p.id===n);c&&i.push({materiaId:c.id,docente:t.nombre,materia:`${c.sigla?c.sigla+" - ":""}${c.nombre}`,categoria:c.categoria,paralelo:c.paralelo||"-"})}return i}};Ge.\u0275fac=function(e){return new(e||Ge)(A(it),A(ne),A(It),A(at),A(oe),A(Te),A(te))},Ge.\u0275cmp=W({type:Ge,selectors:[["app-asignadormaterias"]],standalone:!1,decls:61,vars:17,consts:[[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"card"],[1,"row","align-items-end","g-2","mb-2"],[1,"col-sm-3"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-calendar"],[1,"form-floating","flex-grow-1"],["id","filtroAnio",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","filtroAnio"],[1,"bi","bi-bookmark"],["id","filtroResolucion",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroResolucion"],[1,"button","col-sm-6","d-flex","justify-content-end"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"card-body"],["class","card mb-3",4,"ngIf"],[1,"row","align-items-end","g-2"],[1,"col-sm-12"],[1,"bi","bi-search"],["type","text","placeholder","Buscar docente",1,"form-control",3,"input","value"],[1,"mt-2","d-flex","flex-wrap","gap-2"],["class","btn btn-outline-secondary btn-sm",3,"active","disabled","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-2"],["class","text-muted",4,"ngIf"],["class","text-primary",4,"ngIf"],[1,"col-sm-4","d-flex","justify-content-end","gap-2"],[1,"form-check","mt-2"],["type","checkbox","id","toggleModo",1,"form-check-input",3,"change"],["for","toggleModo",1,"form-check-label"],["class","row mb-2",4,"ngIf"],[4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"card","mb-3"],[1,"card-header","d-flex","align-items-center","justify-content-between","flex-wrap","gap-2","text-danger"],["type","text","placeholder","Buscar docente pendiente",1,"form-control",3,"input","value"],[1,"table-responsive"],[1,"table","table-sm","table-striped","align-middle","mb-0"],[2,"width","140px"],[2,"width","120px"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-sm","btn-outline-success",3,"click","disabled"],["colspan","3",1,"text-center","py-3"],[1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"],[1,"text-muted"],[1,"text-primary"],[1,"row","mb-2"],["id","filtroAnioTabla",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroAnioTabla"],[1,"col-sm-3","mt-2","mt-sm-0"],["id","filtroResolucionTabla",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroResolucionTabla"],[1,"col-sm-6"],[1,"bi","bi-filter"],["type","text","placeholder","Buscar materia",1,"form-control",3,"input","value"],[1,"col-sm-6","d-flex","justify-content-end","flex-wrap","gap-2","mt-2","mt-sm-0"],[1,"form-check","mt-1"],["type","checkbox","id","toggleCategorias",1,"form-check-input",3,"change","checked"],["for","toggleCategorias",1,"form-check-label"],[1,"d-flex","align-items-center","flex-wrap","gap-1"],[1,"text-muted","me-1"],["type","button","class","btn btn-outline-primary btn-sm",3,"active","click",4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-secondary btn-sm",3,"active","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[4,"ngFor","ngForOf"],[1,"text-center","mt-3"],[1,"d-flex","flex-wrap"],["class","list-group-item col-sm-3 custom-border position-relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"list-group-item","col-sm-3","custom-border","position-relative",3,"ngClass"],["type","button",1,"btn","btn-sm","w-100","text-start",3,"click","disabled"],[1,"me-2","badge",3,"ngClass"],["class","small text-muted mt-1",4,"ngIf"],["class","spinner-border spinner-border-sm text-primary position-absolute top-50 start-50 translate-middle","role","status",4,"ngIf"],[1,"small","text-muted","mt-1"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute","top-50","start-50","translate-middle"],[1,"visually-hidden"],[1,"table","align-middle","table-hover","table-sm"],[1,"table-group-divider"],["colspan","6",1,"text-center","text-muted"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],["colspan","6",1,"text-center"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),d(4,"Asignador de MATERIAS - DOCENTES"),r()()()(),o(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"span",8),x(10,"i",9),r(),o(11,"div",10)(12,"select",11),O("ngModelChange",function(c){return T(i.filtroAnioId,c)||(i.filtroAnioId=c),c}),f("change",function(){return i.onCambioFiltrosAsignacion()}),o(13,"option",12),d(14,"-- Seleccione --"),r(),g(15,mo,2,2,"option",13),r(),o(16,"label",14),d(17,"A\xF1o (Gesti\xF3n)"),r()()()(),o(18,"div",6)(19,"div",7)(20,"span",8),x(21,"i",15),r(),o(22,"div",10)(23,"select",16),O("ngModelChange",function(c){return T(i.filtroResolucionKey,c)||(i.filtroResolucionKey=c),c}),f("change",function(){return i.onCambioFiltrosAsignacion()}),o(24,"option",12),d(25,"-- Seleccione --"),r(),g(26,po,2,2,"option",13),r(),o(27,"label",17),d(28,"Resoluci\xF3n"),r()()()(),o(29,"div",18)(30,"button",19),f("click",function(){return i.togglePendientesDocentes()}),o(31,"span",20),x(32,"ng-lottie",21),r(),o(33,"span"),d(34),r(),x(35,"span",22),r()()(),o(36,"div",23),g(37,go,25,4,"div",24),o(38,"div",25)(39,"div",26)(40,"div",7)(41,"span",8),x(42,"i",27),r(),o(43,"div",10)(44,"input",28),f("input",function(c){return i.filterDocente=c.target.value}),r(),o(45,"label"),d(46,"Buscar docente (nombre o ID)"),r()()(),o(47,"div",29),g(48,fo,4,6,"button",30),r(),o(49,"div",31),g(50,xo,2,0,"small",32)(51,Co,4,1,"h3",33),r()(),o(52,"div",34)(53,"div",35)(54,"input",36),f("change",function(c){return i.onToggleChange(c)}),r(),o(55,"label",37),d(56,"Modo tabla"),r()()()(),x(57,"hr"),g(58,bo,23,6,"div",38)(59,Ro,25,6,"div",39)(60,Go,20,3,"div",40),r()()),e&2&&(s(12),I("ngModel",i.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",i.aniosOptions),s(8),I("ngModel",i.filtroResolucionKey),s(),l("ngValue",""),s(2),l("ngForOf",i.resolucionOptions),s(6),l("options",i._tools.optionseye),s(2),w("",i.verPendientesDocentes?"Ocultar pendientes":"Ver docentes pendientes de asignaci\xF3n"," "),s(3),l("ngIf",i.verPendientesDocentes),s(7),l("value",i.filterDocente),s(4),l("ngForOf",i.docentesFiltradosDemo())("ngForTrackBy",i.trackById),s(2),l("ngIf",!i.docenteSeleccionadoDemo),s(),l("ngIf",i.docenteSeleccionadoDemo),s(7),l("ngIf",i.ModoBoolean),s(),l("ngIf",!i.ModoBoolean),s(),l("ngIf",i.ModoBoolean))},dependencies:[q,K,Q,Z,ee,X,Y,J,ie],styles:[".wrap[_ngcontent-%COMP%]{padding:16px}.head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.card[_ngcontent-%COMP%]{border:1px solid #e6e6e6;border-radius:10px;padding:12px;background:#fff}.card.full[_ngcontent-%COMP%]{grid-column:1/-1}.row3[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr}.row4[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr auto}.lbl[_ngcontent-%COMP%]{font-size:12px;color:#444;margin-bottom:6px}.inp[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #dadada;border-radius:8px}.inp.mini[_ngcontent-%COMP%]{padding:6px 8px}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}button[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #dadada;border-radius:8px;background:#fafafa;cursor:pointer}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.danger[_ngcontent-%COMP%]{border-color:#ffb4b4;background:#fff5f5}.muted[_ngcontent-%COMP%]{opacity:.8}.hint[_ngcontent-%COMP%]{margin-top:8px;font-size:12px;color:#666}.msg[_ngcontent-%COMP%]{margin:10px 0;padding:10px 12px;border-radius:10px}.msg.err[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #ffb4b4;color:#7a0012}.msg.ok[_ngcontent-%COMP%]{background:#f3fff5;border:1px solid #a7f3b6;color:#0b4b1f}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}.chip[_ngcontent-%COMP%]{border-radius:999px}.chip.on[_ngcontent-%COMP%]{border-color:#2563eb;background:#eaf1ff}.table[_ngcontent-%COMP%]{margin-top:8px;overflow:auto}.tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 220px 1fr 110px 160px 1fr 210px;gap:8px;align-items:center;padding:8px;border-top:1px solid #f0f0f0}.th[_ngcontent-%COMP%]{font-weight:700;background:#fafafa;border-top:none;position:sticky;top:0}.mono[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.custom-border[_ngcontent-%COMP%]{border:1px solid #e6e6e6;border-radius:10px;padding:8px;background:#fff}.custom-border[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eaf1ff}.checked[_ngcontent-%COMP%]{border-color:#22c55e!important;background:#f3fff5}.list-group-item[_ngcontent-%COMP%]{cursor:pointer}.btn.active[_ngcontent-%COMP%]{border-color:#2563eb;background:#eaf1ff;color:#0300a3;font-weight:700}@media (max-width: 1100px){.grid[_ngcontent-%COMP%], .row[_ngcontent-%COMP%], .row3[_ngcontent-%COMP%], .row4[_ngcontent-%COMP%]{grid-template-columns:1fr}.tr[_ngcontent-%COMP%]{grid-template-columns:70px 1fr}.th[_ngcontent-%COMP%]{display:none}}"]});var st=Ge;var jo=[{path:"carreras",component:Ve},{path:"materias",component:Re},{path:"plandeestudios",component:rt},{path:"asignadormaterias",component:st}],fe=class fe{};fe.\u0275fac=function(e){return new(e||fe)},fe.\u0275mod=Ue({type:fe}),fe.\u0275inj=He({imports:[ut.forChild(jo),ut]});var lt=fe;var xe=class xe{};xe.\u0275fac=function(e){return new(e||xe)},xe.\u0275mod=Ue({type:xe}),xe.\u0275inj=He({imports:[St,At,wt,lt]});var Pt=xe;export{ot as a,st as b,Pt as c};
