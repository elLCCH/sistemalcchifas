import{a as Xe}from"./chunk-IOCNCHHO.js";import"./chunk-NSZTAK5R.js";import{a as et}from"./chunk-MXKJEPFP.js";import"./chunk-XLXCS43A.js";import{a as Ze}from"./chunk-QRIXDRJK.js";import{a as pe}from"./chunk-MKDQ3MI5.js";import{a as q,e as We,f as Ye}from"./chunk-IQZZ35S3.js";import{a as se}from"./chunk-73MWYJ7T.js";import{a as qe}from"./chunk-X7ZST2NJ.js";import{b as ce}from"./chunk-ZSRVLRBH.js";import{a as Je,b as Ke}from"./chunk-IOZ5TDSV.js";import{b as Ue}from"./chunk-N4MEOVMH.js";import{a as me}from"./chunk-ZYW7YONX.js";import{b as Qe}from"./chunk-UD6YX65Z.js";import"./chunk-NCIXDP2C.js";import{e as ke,g as Ne,k as W}from"./chunk-LEW5N4EV.js";import{b as de}from"./chunk-WL6DQNEU.js";import{d as $e,f as ze,i as Ge}from"./chunk-OXGEW5OA.js";import{b as Re,c as ie,f as ne,g as Fe,h as Ie,j as H,k as oe,o as Ve,p as He,q as Le,r as ae,s as re,t as le,x as je,y as Be}from"./chunk-TKGN7DBU.js";import{a as te}from"./chunk-JISGPZ2J.js";import{Aa as y,Bb as Ce,Ca as fe,Cb as ve,Cc as Oe,Da as he,Db as be,Ea as l,Ec as Z,Fc as ee,Gb as R,Hb as k,Ib as N,Lb as s,Ma as S,Mb as x,Nb as b,Nc as Te,Ob as w,Pb as Ee,Ra as Y,Sa as J,Sb as A,Tb as O,Ub as T,Vc as Se,Wa as _,Wb as j,Yb as Ae,_ as Q,_b as F,ab as xe,bb as K,db as X,ga as u,gc as V,ha as g,ib as p,jb as r,kb as a,lb as h,pb as D,qb as P,sb as v,vb as f,xb as d}from"./chunk-SGF3PIFW.js";import{a as De,b as Pe,m as we}from"./chunk-GG76335P.js";var mt=()=>({standalone:!0});function _t(i,t){if(i&1){let e=v();r(0,"button",61),f("click",function(){u(e);let o=d();return g(o.nuevoHorario())}),s(1," Publicar "),a()}}function ut(i,t){i&1&&(r(0,"div",62)(1,"div",63),s(2,"Cargando horarios..."),a()())}function gt(i,t){i&1&&(r(0,"div",66),s(1," No hay horarios publicados. "),a())}function ft(i,t){if(i&1&&h(0,"img",74),i&2){let e=d().$implicit,n=d(2);p("src",n.ruta+e.institucion_logo,y)("alt",e==null?null:e.institucion_nombre)}}function ht(i,t){if(i&1&&(r(0,"span",75),s(1),a()),i&2){let e=d().$implicit;l(),x(e.horarios.length)}}function xt(i,t){if(i&1&&(r(0,"div",13),s(1),a()),i&2){let e=d().$implicit;l(),b("Gesti\xF3n: ",e==null?null:e.subtitulo)}}function Ct(i,t){if(i&1&&(r(0,"div",13),s(1),a()),i&2){let e=d().$implicit;l(),x(e==null?null:e.descripcion)}}function vt(i,t){if(i&1&&(r(0,"a",82),s(1,"Ver"),a()),i&2){let e=d().$implicit,n=d(3);p("href",n.ruta+e.archivo,y)}}function bt(i,t){if(i&1){let e=v();r(0,"button",83),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.editarHorario(o))}),s(1," Editar "),a()}}function Et(i,t){if(i&1){let e=v();r(0,"button",84),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.eliminarHorario(o))}),s(1," Eliminar "),a()}}function St(i,t){if(i&1&&(r(0,"div",76)(1,"div",77)(2,"div")(3,"div",32),s(4),a(),_(5,xt,2,1,"div",78)(6,Ct,2,1,"div",78),a(),r(7,"div",14),_(8,vt,2,1,"a",79)(9,bt,2,0,"button",80)(10,Et,2,0,"button",81),a()()()),i&2){let e=t.$implicit,n=d(3);l(4),x(e==null?null:e.titulo),l(),p("ngIf",e==null?null:e.subtitulo),l(),p("ngIf",e==null?null:e.descripcion),l(2),p("ngIf",e==null?null:e.archivo),l(),p("ngIf",n.puedeEditarHorario(e)),l(),p("ngIf",n.puedeEditarHorario(e))}}function It(i,t){if(i&1&&(r(0,"div",62)(1,"div",67)(2,"div",68)(3,"div",11)(4,"div",14),_(5,ft,1,2,"img",69),r(6,"div",70),s(7),a()(),_(8,ht,2,1,"span",71),a()(),r(9,"div",72),_(10,St,11,6,"div",73),a()()()),i&2){let e=t.$implicit;l(),k("border-left-color",(e==null?null:e.institucion_color_fuerte)||(e==null?null:e.institucion_color_institucional)||"#0d6efd"),l(),k("background",(e==null?null:e.institucion_color_bajo)||"#f8f9fa"),l(3),p("ngIf",e==null?null:e.institucion_logo),l(2),x(e==null?null:e.institucion_nombre),l(),p("ngIf",e==null||e.horarios==null?null:e.horarios.length),l(2),p("ngForOf",e.horarios)}}function Mt(i,t){if(i&1&&(D(0),_(1,gt,2,0,"div",64)(2,It,11,8,"div",65),P()),i&2){let e=d();l(),p("ngIf",((e.horariosInstituciones==null?null:e.horariosInstituciones.length)??0)===0),l(),p("ngForOf",e.horariosInstituciones)}}function yt(i,t){i&1&&(r(0,"div",85),s(1," No tiene permisos para publicar horarios. "),a())}function Dt(i,t){if(i&1&&(r(0,"div",96),s(1),a()),i&2){let e=d(2);l(),b("Archivo: ",e.horarioFile==null?null:e.horarioFile.name)}}function Pt(i,t){if(i&1&&(r(0,"div",62)(1,"div",97)(2,"div",13),s(3,"Subida"),a(),r(4,"div",98),s(5),a()(),r(6,"div",99),h(7,"div",100),a()()),i&2){let e=d(2);l(5),b("",e.horarioUploadProgress??0,"%"),l(2),k("width",e.horarioUploadProgress??0,"%")}}function wt(i,t){if(i&1){let e=v();D(0),r(1,"div",86),f("dragover",function(o){u(e);let c=d();return g(c.onHorarioDragOver(o))})("dragleave",function(o){u(e);let c=d();return g(c.onHorarioDragLeave(o))})("drop",function(o){u(e);let c=d();return g(c.onHorarioDrop(o))}),r(2,"input",87,0),f("change",function(o){u(e);let c=d();return g(c.onHorarioFileInputChange(o))}),a(),r(4,"div",11)(5,"div")(6,"div",32),s(7,"Arrastra aqu\xED tu archivo"),a(),r(8,"div",13),s(9,"PDF o imagen"),a()(),r(10,"button",88),f("click",function(){u(e);let o=R(3);return g(o.click())}),s(11,"Seleccionar"),a()(),_(12,Dt,2,1,"div",89),a(),_(13,Pt,8,3,"div",17),r(14,"div",90)(15,"div",91)(16,"label",92),s(17,"Gesti\xF3n"),a(),h(18,"input",93),a(),r(19,"div",91)(20,"label",92),s(21,"T\xEDtulo"),a(),h(22,"input",94),a(),r(23,"div",91)(24,"label",92),s(25,"Descripci\xF3n"),a(),h(26,"textarea",95),a()(),P()}if(i&2){let e=d();l(),N("dragging",e.horarioUploadDragging),l(11),p("ngIf",e.horarioFile),l(),p("ngIf",e.horarioUploading||e.horarioUploadProgress!==null),l(),p("formGroup",e.horarioForm)}}function At(i,t){if(i&1){let e=v();r(0,"button",106),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.seleccionarInstitucion(o))}),h(1,"img",107),a()}if(i&2){let e=t.$implicit,n=d(2);N("active",(n.institucionSeleccionada==null?null:n.institucionSeleccionada.id)===(e==null?null:e.id)),p("title",e==null?null:e.Nombre),l(),p("src",n.ruta+e.Logo,y)("alt",e==null?null:e.Nombre)}}function Ot(i,t){if(i&1){let e=v();r(0,"div",101)(1,"div",102)(2,"div",32),s(3,"Filtrar por instituci\xF3n (click en el logo)"),a(),r(4,"button",103),f("click",function(){u(e);let o=d();return g(o.seleccionarInstitucion(null))}),s(5," Quitar filtro "),a()(),r(6,"div",104),_(7,At,2,5,"button",105),a()()}if(i&2){let e=d();l(4),p("disabled",!e.institucionSeleccionada),l(3),p("ngForOf",e.institucionesLogos)}}function Tt(i,t){if(i&1&&(r(0,"option",108),s(1),a()),i&2){let e=t.$implicit;p("value",e.id),l(),x(e.Anio)}}function kt(i,t){i&1&&(r(0,"div",109)(1,"div",110)(2,"div",111)(3,"div",112),s(4,"NO SE ENCONTR\xD3 HORARIOS PUBLICADOS"),a(),r(5,"div",33),s(6,"No se realiz\xF3 la publicaci\xF3n de horarios para esta gesti\xF3n."),a()()()())}function Nt(i,t){if(i&1&&h(0,"img",74),i&2){let e=d(2).$implicit,n=d();p("src",n.ruta+e.institucion_logo,y)("alt",e==null?null:e.institucion_nombre)}}function Rt(i,t){if(i&1&&(r(0,"div",125)(1,"div",126),_(2,Nt,1,2,"img",69),r(3,"div",33),s(4),a()()()),i&2){let e=d().$implicit,n=d();l(),k("border-color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),l(),p("ngIf",e==null?null:e.institucion_logo),l(2),x(e==null?null:e.institucion_nombre)}}function Ft(i,t){if(i&1&&(r(0,"option",108),s(1),a()),i&2){let e=t.$implicit;p("value",e.materia_id),l(),w(" ",e.SiglaMateria," - ",e.NombreMateria," ")}}function Vt(i,t){if(i&1&&(r(0,"div",96),s(1," Seleccionado: "),r(2,"span",32),s(3),a()()),i&2){let e=d().$implicit;l(3),x(e.selectedMateriaNombre)}}function Ht(i,t){if(i&1){let e=v();r(0,"div",113)(1,"div",114)(2,"div",10)(3,"div",115)(4,"div",116)(5,"button",117),f("click",function(){let o=u(e).$implicit,c=d();return g(c.filterHorarioForm.patchValue({txt:o.NivelCurso}))}),s(6),a(),_(7,Rt,5,4,"div",118),a(),r(8,"span",119),s(9),a()(),r(10,"div",62)(11,"label",120),s(12,"Materias"),a(),r(13,"select",121),T("ngModelChange",function(o){let c=u(e).$implicit;return O(c.selectedMateriaId,o)||(c.selectedMateriaId=o),g(o)}),f("ngModelChange",function(o){let c=u(e).$implicit,m=d();return g(m.onMateriaIdChange(c,o))}),r(14,"option",122),s(15,"LISTAR TODO EL CURSO (MEZCLADO)"),a(),_(16,Ft,2,3,"option",39),a()(),r(17,"div",123)(18,"button",124),f("click",function(o){let c=u(e).$implicit,m=d();return g(m.AbrirParalelosPorCurso(c,o))}),s(19," LISTAR "),a()(),_(20,Vt,4,1,"div",89),a()()()}if(i&2){let e=t.$implicit,n=d();l(),k("border-left-color",n.institucionColorFuerte(e==null?null:e.instituciones_id))("background","linear-gradient(180deg,"+n.institucionColorBajo(e==null?null:e.instituciones_id)+" 0%, #ffffff 55%)"),l(4),k("color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),l(),b(" ",e.NivelCurso," "),l(),p("ngIf",(e==null?null:e.institucion_logo)||(e==null?null:e.institucion_nombre)),l(),k("background",n.institucionColorFuerte(e==null?null:e.instituciones_id)),l(),b(" ",e.Turno," "),l(4),A("ngModel",e.selectedMateriaId),p("ngModelOptions",Ae(19,mt)),l(3),p("ngForOf",e.materias),l(2),k("background",n.institucionColorFuerte(e==null?null:e.instituciones_id))("border-color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),l(2),p("ngIf",e.selectedMateriaNombre)}}function Lt(i,t){if(i&1&&(r(0,"option",108),s(1),a()),i&2){let e=t.$implicit;p("value",e.id),l(),x(e.Anio)}}function jt(i,t){if(i&1&&h(0,"img",131),i&2){let e=d().$implicit,n=d();p("src",n.ruta+e.logo,y)}}function Bt(i,t){if(i&1&&(r(0,"span"),s(1),a()),i&2){let e=d(2).$implicit;l(),b("(",e.docentes.especialidad.celular_trabajo,")")}}function Ut(i,t){if(i&1&&(r(0,"span"),s(1),_(2,Bt,2,1,"span",18),a()),i&2){let e=d().$implicit;l(),w(" ",e.docentes.especialidad.nombres," ",e.docentes.especialidad.apellidos," "),l(),p("ngIf",e.docentes.especialidad.celular_trabajo)}}function $t(i,t){if(i&1&&(r(0,"span"),s(1),a()),i&2){let e=d(2).$implicit;l(),b("(",e.docentes.practica_conjuntos.celular_trabajo,")")}}function zt(i,t){if(i&1&&(r(0,"span"),s(1),_(2,$t,2,1,"span",18),a()),i&2){let e=d().$implicit;l(),w(" ",e.docentes.practica_conjuntos.nombres," ",e.docentes.practica_conjuntos.apellidos," "),l(),p("ngIf",e.docentes.practica_conjuntos.celular_trabajo)}}function Gt(i,t){if(i&1&&(r(0,"span"),s(1),a()),i&2){let e=d(2).$implicit;l(),b("(",e.docentes.instrumento_complementario.celular_trabajo,")")}}function Wt(i,t){if(i&1&&(r(0,"span"),s(1),_(2,Gt,2,1,"span",18),a()),i&2){let e=d().$implicit;l(),w(" ",e.docentes.instrumento_complementario.nombres," ",e.docentes.instrumento_complementario.apellidos," "),l(),p("ngIf",e.docentes.instrumento_complementario.celular_trabajo)}}function qt(i,t){if(i&1&&(r(0,"tr")(1,"td"),s(2),a(),r(3,"td"),s(4),a(),r(5,"td"),s(6),a(),r(7,"td"),s(8),a(),r(9,"td"),_(10,Ut,3,3,"span",18),a(),r(11,"td"),_(12,zt,3,3,"span",18),a(),r(13,"td"),_(14,Wt,3,3,"span",18),a()()),i&2){let e=t.$implicit;l(2),w("",e.lvl_curso," ",e.paralelo),l(2),x(e.nombre_materia),l(2),x(e.turno),l(2),x(e.modo_asistencia),l(2),p("ngIf",e.docentes==null||e.docentes.especialidad==null?null:e.docentes.especialidad.nombres),l(2),p("ngIf",e.docentes==null||e.docentes.practica_conjuntos==null?null:e.docentes.practica_conjuntos.nombres),l(2),p("ngIf",e.docentes==null||e.docentes.instrumento_complementario==null?null:e.docentes.instrumento_complementario.nombres)}}function Qt(i,t){if(i&1&&(r(0,"div",101)(1,"div",132),s(2),a(),r(3,"table",133)(4,"thead",134)(5,"tr")(6,"th"),s(7,"Paralelo"),a(),r(8,"th"),s(9,"Materia"),a(),r(10,"th"),s(11,"Turno"),a(),r(12,"th"),s(13,"Modo Asistencia"),a(),r(14,"th"),s(15,"Docente Especialidad"),a(),r(16,"th"),s(17,"Docente Pr\xE1ctica"),a(),r(18,"th"),s(19,"Docente Complementario"),a()()(),r(20,"tbody"),_(21,qt,15,8,"tr",135),a()()()),i&2){let e=t.$implicit;l(2),x(e.nombre),l(19),p("ngForOf",e.materias)}}function Yt(i,t){if(i&1&&(r(0,"div",127)(1,"h4",128),s(2),_(3,jt,1,1,"img",129),a(),_(4,Qt,22,2,"div",130),a()),i&2){let e=t.$implicit;l(2),b(" ",e.nombre," "),l(),p("ngIf",e.logo),l(),p("ngForOf",e.carreras)}}var $=class ${constructor(t,e,n,o,c,m,C,E){this.router=t;this.route=e;this._tools=n;this._anios=o;this._inst=c;this._public=m;this._inicios=C;this._auth=E;this.ruta=te.ruta;this.perfilTipo=null;this.puedePublicarHorarios=!1;this.institucionesIdSesion=null;this.esSuperlcchs=!1;this.horariosInstituciones=[];this.horariosLoading=!1;this.horarioForm=new Ie({titulo:new H(""),subtitulo:new H(""),descripcion:new H("")});this.horarioUploadDragging=!1;this.horarioFile=null;this.horarioTempFilePath=null;this.horarioUploading=!1;this.horarioUploadProgress=null;this.horarioEditId=null;this.horarioEditOriginalArchivo=null;this.horarioSaving=!1;this.cursos=[];this.cursosFiltrados=[];this.instituciones=[];this.institucionesLogos=[];this.institucionSeleccionada=null;this.institucionesById=new Map;this.modalHorarioEl=null;this.modalHorarioHiddenListener=null;this.filtroHorario=!1;this.filterHorarioForm=new Ie({txt:new H("")});this.anio=[];this.gestion_id_seleccionado="";this.CIVerificar="";this.CursosMateriasEstudiante=[]}ngAfterViewInit(){this.modalHorarioEl=document.getElementById("ModalPublicarHorario"),this.modalHorarioEl&&(this.modalHorarioHiddenListener=()=>{this.forceCleanupModalArtifacts()},this.modalHorarioEl.addEventListener("hidden.bs.modal",this.modalHorarioHiddenListener))}ngOnDestroy(){this.modalHorarioEl&&this.modalHorarioHiddenListener&&this.modalHorarioEl.removeEventListener("hidden.bs.modal",this.modalHorarioHiddenListener),this.modalHorarioEl=null,this.modalHorarioHiddenListener=null}ngOnInit(){this.CargarInstituciones(),this.CargarAnio(),this.iniciarFormfilterHorario(),this.iniciarFormHorario(),this._auth.pedirPerfil().subscribe({next:t=>{this.perfilTipo=t?.tipo??null,this.esSuperlcchs=this.perfilTipo==="superlcchs";let e=Number(t?.usuario?.instituciones_id??0);this.institucionesIdSesion=Number.isFinite(e)&&e>0?e:null,this.puedePublicarHorarios=this.perfilTipo==="planteladministrativos"||this.perfilTipo==="superlcchs"},error:()=>{this.perfilTipo=null,this.puedePublicarHorarios=!1,this.esSuperlcchs=!1,this.institucionesIdSesion=null}})}forceCleanupModalArtifacts(){try{document.querySelectorAll(".modal-backdrop").forEach(t=>t.remove()),document.body.classList.remove("modal-open"),document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right")}catch{}}getGestionAnioSeleccionado(){let t=(this.gestion_id_seleccionado??"").toString();return t?((this.anio??[]).find(n=>(n?.id??"").toString()===t)?.Anio??"").toString():""}iniciarFormHorario(){let t=this.getGestionAnioSeleccionado();this.horarioForm.patchValue({titulo:"HORARIO "+(t||new Date().getFullYear()),subtitulo:t||"",descripcion:""},{emitEvent:!1})}get esEdicionHorario(){return this.horarioEditId!=null}nuevoHorario(){this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!0)}editarHorario(t){if(!this.puedeEditarHorario(t)){this._tools.MostrarMensaje("warning","No autorizado");return}this.resetHorarioDraft(!0),this.horarioEditId=Number(t?.id??0)||null,this.horarioEditOriginalArchivo=t?.archivo??null;let e=this.getGestionAnioSeleccionado()||(t?.subtitulo??"");this.horarioForm.patchValue({titulo:(t?.titulo??"").toString(),subtitulo:e.toString(),descripcion:(t?.descripcion??"").toString()},{emitEvent:!1})}cerrarModalHorario(){let t=document.getElementById("ModalPublicarHorario");if(t){try{(q.getOrCreateInstance?q.getOrCreateInstance(t):q.getInstance(t)||new q(t)).hide()}catch{}setTimeout(()=>this.forceCleanupModalArtifacts(),350)}}CargarHorariosPublicados(){this.horariosLoading=!0;let t=this.getGestionAnioSeleccionado(),e=this.institucionSeleccionada?.id!=null?this.institucionSeleccionada.id:void 0;this._public.obtenerHorariosPublicadosFiltrado({anio:t,institucion_id:e}).subscribe({next:n=>{this.horariosInstituciones=Array.isArray(n?.data)?n.data:[],this.horariosLoading=!1},error:n=>{console.error("Error al cargar horarios publicados",n),this.horariosInstituciones=[],this.horariosLoading=!1}})}subirArchivoHorario(t){t&&(this.horarioTempFilePath&&(this._tools.EliminarArchivo(this.horarioTempFilePath),this.horarioTempFilePath=null),this.horarioFile=t,this.horarioUploading=!0,this.horarioUploadProgress=0,this._tools.SubirArchivo(t,"inicioshorarios").subscribe({next:e=>{if(e.type===Se.UploadProgress){let n=e.total??0;n>0&&(this.horarioUploadProgress=Math.round(e.loaded/n*100))}if(e.type===Se.Response){let n=e.body?.filePath;n&&(this.horarioTempFilePath=n),this.horarioUploading=!1,this.horarioUploadProgress=100}},error:e=>{console.log("ERROR SUBIENDO HORARIO",e),this.horarioUploading=!1,this.horarioUploadProgress=null,this._tools.MostrarMensaje("error","Error al subir archivo")}}))}onHorarioFileInputChange(t){let e=t.target;if(!e?.files||e.files.length===0)return;let n=e.files[0];this.subirArchivoHorario(n)}onHorarioDragOver(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!0}onHorarioDragLeave(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!1}onHorarioDrop(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!1;let e=t.dataTransfer?.files?.[0];e&&this.subirArchivoHorario(e)}resetHorarioDraft(t){t&&this.horarioTempFilePath&&this._tools.EliminarArchivo(this.horarioTempFilePath),this.horarioTempFilePath=null,this.horarioFile=null,this.horarioUploading=!1,this.horarioUploadProgress=null,this.iniciarFormHorario()}limpiarHorarioDraft(){this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!0)}puedeEditarHorario(t){if(!this.puedePublicarHorarios)return!1;if(this.esSuperlcchs)return!0;let e=this.institucionesIdSesion;if(!e)return!1;let n=Number(t?.id_institucion??t?.institucion_id??0);return Number.isFinite(n)&&n>0&&n===e}eliminarHorario(t){return we(this,null,function*(){if(!this.puedeEditarHorario(t)){this._tools.MostrarMensaje("warning","No autorizado");return}if(!(yield this._tools.mostrarMensajeConfirm("Eliminar horario","\xBFDesea eliminar este horario? Esta acci\xF3n no se puede deshacer.","warning","Eliminar","Cancelar")))return;let n=Number(t?.id??0);!Number.isFinite(n)||n<=0||this._inicios.Eliminarinicios(n).subscribe({next:()=>{t?.archivo&&this._tools.EliminarArchivo(t.archivo),this._tools.MostrarMensaje("success","Eliminado"),this.horarioEditId===n&&this.limpiarHorarioDraft(),this.CargarHorariosPublicados()},error:o=>{console.error("Error al eliminar horario",o),this._tools.MostrarMensaje("error","No se pudo eliminar")}})})}guardarHorario(){if(!this.puedePublicarHorarios){this._tools.MostrarMensaje("warning","No tiene permisos para publicar horarios");return}if(this.horarioSaving)return;if(this.horarioUploading){this._tools.MostrarMensaje("warning","Espere a que termine la subida");return}let t=this.getGestionAnioSeleccionado();if(!t){this._tools.MostrarMensaje("warning","Seleccione una gesti\xF3n");return}let e=(this.horarioForm.get("titulo")?.value??"").toString().trim(),n=(this.horarioForm.get("descripcion")?.value??"").toString().trim();if(!e){this._tools.MostrarMensaje("warning","Ingrese un t\xEDtulo");return}let o=this.horarioTempFilePath||this.horarioEditOriginalArchivo;if(!o){this._tools.MostrarMensaje("warning","Suba un PDF o imagen");return}let c={categoria:"HORARIO",titulo:e,subtitulo:t,descripcion:n,archivo:o,estado:"ACTIVO",visibilidad:"VISIBLE"};this.horarioSaving=!0;let m=this.horarioEditId!=null,C=()=>{this.horarioSaving=!1,this._tools.MostrarMensaje("success",m?"Horario actualizado":"Horario publicado"),m&&this.horarioTempFilePath&&this.horarioEditOriginalArchivo&&this.horarioEditOriginalArchivo!==this.horarioTempFilePath&&this._tools.EliminarArchivo(this.horarioEditOriginalArchivo),this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!1),this.CargarHorariosPublicados(),this.cerrarModalHorario()},E=I=>{console.error(m?"Error al actualizar horario":"Error al publicar horario",I),this.horarioSaving=!1,this._tools.MostrarMensaje("error",m?"No se pudo actualizar el horario":"No se pudo publicar el horario")};m?this._inicios.Modificarinicios(c,this.horarioEditId).subscribe({next:C,error:E}):this._inicios.Agregarinicios(c).subscribe({next:C,error:E})}iniciarFormfilterHorario(){this.filterHorarioForm.get("txt").valueChanges.subscribe(t=>{console.log("entered data is ",t),this.filtroHorario=!0,this.aplicarFiltros()})}filterHorario(t){this.filterHorarioForm.patchValue({txt:t},{emitEvent:!1}),this.aplicarFiltros()}aplicarFiltros(){let t=(this.filterHorarioForm.get("txt")?.value??"").toString().toUpperCase().trim(),e=this.institucionSeleccionada?.id!=null?String(this.institucionSeleccionada.id):"",n=Array.isArray(this.cursos)?[...this.cursos]:[];e&&(n=n.filter(o=>String(o?.instituciones_id??"")===e)),t&&(n=n.filter(o=>String(o?.NivelCurso??"").toUpperCase().includes(t))),this.cursosFiltrados=n}CargarInstituciones(){this._inst.Obtenerinstituciones().subscribe({next:t=>{console.log("instituciones",t);let n=(Array.isArray(t?.data?.data)?t.data.data:Array.isArray(t?.data)?t.data:[]).filter(o=>String(o?.Visibilidad??"VISIBLE").toUpperCase()==="VISIBLE").filter(o=>String(o?.Estado??"ACTIVO").toUpperCase()==="ACTIVO").sort((o,c)=>String(o?.Nombre??"").localeCompare(String(c?.Nombre??"")));this.instituciones=n,this.institucionesLogos=n.filter(o=>!!o?.Logo),this.institucionesById=new Map((n||[]).map(o=>[String(o?.id??""),o]))},error:t=>{console.error("Error al cargar carreras",t),this.instituciones=[],this.institucionesLogos=[],this.institucionesById=new Map}})}institucionColorFuerte(t){let e=this.institucionesById.get(String(t??""));return e?.ColorFuerte||e?.ColorInstitucional||"#0d6efd"}institucionColorBajo(t){return this.institucionesById.get(String(t??""))?.ColorBajo||"#f8f9fa"}seleccionarInstitucion(t){t?this.institucionSeleccionada?.id===t.id?this.institucionSeleccionada=null:this.institucionSeleccionada=t:this.institucionSeleccionada=null,this.CargarCursosDesdeMaterias(),this.CargarHorariosPublicados()}CargarAnio(){this._anios.Obteneranios().subscribe({next:t=>{console.log("anios",t),this.anio=t.data??[];let e=this.anio.find(n=>(n?.Predeterminado??"")==="SI")??this.anio[0];e?.id&&(this.gestion_id_seleccionado=e.id,this.onGestionChange())},error:t=>{console.error("Error al cargar",t),this.instituciones=[],this.institucionesLogos=[]}})}onGestionChange(){if(this.CargarCursosDesdeMaterias(),this.CargarHorariosPublicados(),!this.esEdicionHorario)this.iniciarFormHorario();else{let t=this.getGestionAnioSeleccionado();this.horarioForm.patchValue({subtitulo:t},{emitEvent:!1})}}CargarCursosDesdeMaterias(){if(!this.gestion_id_seleccionado){this.cursos=[],this.cursosFiltrados=[];return}let t={Anio_id:this.gestion_id_seleccionado};this.institucionSeleccionada?.id!=null&&(t.instituciones_id=this.institucionSeleccionada.id),this._public.obtenerHorariosCursos(t).subscribe({next:e=>{console.log("CURSOS FILTRADOS",e),this.cursos=(e??[]).map(n=>Pe(De({},n),{selectedMateriaId:"",selectedMateriaNombre:""})),this.aplicarFiltros()},error:e=>{console.error("Error al cargar anios",e),this.cursos=[],this.cursosFiltrados=[]}})}onSelectMateria(t,e){t.selectedMateriaId=e?.materia_id??"",t.selectedMateriaNombre=`${e?.SiglaMateria??""} ${e?.NombreMateria??""}`.trim()}onMateriaIdChange(t,e){let n=(e??"").toString(),o=(t?.materias??[]).find(c=>(c?.materia_id??"").toString()===n);o?this.onSelectMateria(t,o):(t.selectedMateriaId="",t.selectedMateriaNombre="")}abrirParalelos(t){console.log("intentanto abrir"),t.ctrlKey?window.open("/publicos/paralelos","_blank"):this.router.navigate(["/publicos/paralelos"])}AbrirParalelosPorCurso(t,e){t.selectedMateriaId?sessionStorage.setItem("HORARIOS_MODO","xMATERIA"):sessionStorage.setItem("HORARIOS_MODO","MEZCLADO"),sessionStorage.setItem("HORARIOS_ANIO_ID",(this.gestion_id_seleccionado??"").toString()),sessionStorage.setItem("HORARIOS_LVL_CURSO",(t.LvlCurso??"").toString()),sessionStorage.setItem("HORARIOS_PARALELO",(t.Paralelo??"").toString()),sessionStorage.setItem("HORARIOS_TURNO",(t.Turno??"").toString()),sessionStorage.setItem("HORARIOS_MATERIA_ID",(t.selectedMateriaId??"").toString()),sessionStorage.setItem("HORARIOS_MATERIA_TITULO",(t.selectedMateriaNombre??"TODAS LAS MATERIAS").toString()),t?.instituciones_id!=null?(sessionStorage.setItem("HORARIOS_INSTITUCION_ID",String(t.instituciones_id)),t?.institucion_nombre&&sessionStorage.setItem("HORARIOS_INSTITUCION_NOMBRE",String(t.institucion_nombre)),t?.institucion_logo&&sessionStorage.setItem("HORARIOS_INSTITUCION_LOGO",String(t.institucion_logo))):(sessionStorage.removeItem("HORARIOS_INSTITUCION_ID"),sessionStorage.removeItem("HORARIOS_INSTITUCION_NOMBRE"),sessionStorage.removeItem("HORARIOS_INSTITUCION_LOGO")),this.abrirParalelos(e)}VerificarCursoParalelo(){console.log(this.CIVerificar,this.gestion_id_seleccionado);let t={CI:this.CIVerificar,Anio_id:this.gestion_id_seleccionado};this._public.CargarMateriasEstudiantesMultiInstitucionPublico(t).subscribe({next:e=>{console.log("CURSOS FILTRADOS",e.data),this.CursosMateriasEstudiante=e.data??[],this.CursosMateriasEstudiante.length==0&&this._tools.MensajeInformacion("ESTUDIANTE A\xDAN SIN MATERIAS ASIGNADAS","SI SU CARNET UTILIZA COMPLEMENTO ENTONCES ESCRIBIR, ejemplo: 12345-H1","error")},error:e=>{console.error("Error al cargar anios",e),this.CursosMateriasEstudiante=[],this._tools.MensajeInformacion("ESTUDIANTE A\xDAN SIN MATERIAS ASIGNADAS","SI SU CARNET UTILIZA COMPLEMENTO ENTONCES ESCRIBIR, ejemplo: 12345-H1","error")}})}};$.\u0275fac=function(e){return new(e||$)(S(Ne),S(ke),S(de),S(pe),S(se),S(me),S(We),S(ce))},$.\u0275cmp=Y({type:$,selectors:[["app-horarios"]],standalone:!1,decls:105,vars:18,consts:[["horarioFileInput",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"container-fluid","py-3"],[1,"row","g-3"],[1,"col-12","col-lg-4"],[1,"card","shadow-sm","border-0","sticky-lg-top","horarios-panel"],[1,"card-body"],[1,"d-flex","align-items-center","justify-content-between","gap-2"],[1,"h5","fw-bold","mb-0"],[1,"small","text-muted"],[1,"d-flex","align-items-center","gap-2"],["type","button","class","btn btn-sm btn-primary","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],["class","mt-3",4,"ngIf"],[4,"ngIf"],["id","ModalPublicarHorario","tabindex","-1","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","alert alert-warning",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"col-12","col-lg-8"],[1,"col-sm-6","alert","alert-info","py-2"],[1,"fw-semibold"],[1,"small"],["class","mb-3",4,"ngIf"],[1,"col-sm-6","row"],[1,"form-floating","mb-3","col-4"],[1,"form-select",3,"ngModelChange","change","ngModel"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"form-floating","mb-3","col-8"],["type","button","data-bs-toggle","modal","data-bs-target","#AveriguarParalelo",1,"btn","btn-primary"],[1,"col-sm-12","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"form-floating",3,"formGroup"],["type","text","formControlName","txt","placeholder","EJ: PRIMERO SUPERIOR",1,"form-control"],["class","container text-center mt-5",4,"ngIf"],["class","col-12 col-md-6 col-lg-4",4,"ngFor","ngForOf"],["id","AveriguarParalelo","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-xl"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"mb-4"],[1,"font-weight-bold","text-center","color-fuente"],[1,"form-group","row"],[1,"form-floating","mb-3","col-6"],[1,"form-label","col-6"],[1,"form-floating","mb-3","col-sm-12"],["type","text","placeholder","",1,"form-control",3,"ngModelChange","ngModel"],[1,"invalid-feedback"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["class","mb-5",4,"ngFor","ngForOf"],["type","button","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",1,"btn","btn-sm","btn-primary",3,"click"],[1,"mt-3"],[1,"text-muted","small"],["class","text-muted small mt-3",4,"ngIf"],["class","mt-3",4,"ngFor","ngForOf"],[1,"text-muted","small","mt-3"],[1,"horario-inst-card"],[1,"horario-inst-header"],["class","institucion-mini-logo",3,"src","alt",4,"ngIf"],[1,"fw-semibold","small"],["class","badge bg-secondary",4,"ngIf"],[1,"horario-inst-body"],["class","horario-item",4,"ngFor","ngForOf"],[1,"institucion-mini-logo",3,"src","alt"],[1,"badge","bg-secondary"],[1,"horario-item"],[1,"d-flex","align-items-start","justify-content-between","gap-2"],["class","small text-muted",4,"ngIf"],["class","btn btn-sm btn-outline-secondary","target","_blank","rel","noopener",3,"href",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-primary","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],["target","_blank","rel","noopener",1,"btn","btn-sm","btn-outline-secondary",3,"href"],["type","button","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",1,"btn","btn-sm","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"alert","alert-warning"],[1,"horario-dropzone",3,"dragover","dragleave","drop"],["type","file","accept","application/pdf,image/*","hidden","",3,"change"],["type","button",1,"btn","btn-primary",3,"click"],["class","small text-muted mt-2",4,"ngIf"],[1,"row","g-2","mt-3",3,"formGroup"],[1,"col-12"],[1,"form-label"],["formControlName","subtitulo","readonly","",1,"form-control"],["formControlName","titulo","placeholder","Ej: HORARIO 2026",1,"form-control"],["formControlName","descripcion","rows","3","placeholder","Detalle (opcional)",1,"form-control"],[1,"small","text-muted","mt-2"],[1,"d-flex","align-items-center","justify-content-between"],[1,"small","fw-semibold"],[1,"progress",2,"height","10px"],["role","progressbar",1,"progress-bar"],[1,"mb-3"],[1,"d-flex","align-items-center","justify-content-between","flex-wrap","gap-2"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click","disabled"],[1,"mt-2","d-flex","flex-wrap","gap-2"],["type","button","class","btn btn-light border institucion-logo-btn",3,"active","title","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-light","border","institucion-logo-btn",3,"click","title"],[1,"institucion-logo",3,"src","alt"],[3,"value"],[1,"container","text-center","mt-5"],[1,"row",2,"display","flex","flex-direction","column","align-items","center","position","relative"],[1,"alert","alert-warning","d-inline-block"],[1,"fw-bold"],[1,"col-12","col-md-6","col-lg-4"],[1,"card","h-100","shadow-sm","border-0","curso-card"],[1,"d-flex","justify-content-between","align-items-start","gap-3"],[1,"min-w-0"],["type","button",1,"btn","btn-link","p-0","fw-bold","text-decoration-none","curso-title",3,"click"],["class","mt-2 d-flex align-items-center gap-2",4,"ngIf"],[1,"badge","curso-badge"],[1,"form-label","fw-semibold","mb-1"],[1,"form-select","form-select-sm",3,"ngModelChange","ngModel","ngModelOptions"],["value",""],[1,"d-grid","gap-2","mt-3"],["type","button",1,"btn","btn-inst","fw-semibold",3,"click"],[1,"mt-2","d-flex","align-items-center","gap-2"],[1,"institucion-pill"],[1,"mb-5"],[1,"fw-bold","mb-2"],["alt","Logo","style","height:32px;vertical-align:middle;",3,"src",4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],["alt","Logo",2,"height","32px","vertical-align","middle",3,"src"],[1,"fw-semibold","text-primary","mb-1"],[1,"table","table-bordered","table-sm"],[1,"table-light"],[4,"ngFor","ngForOf"]],template:function(e,n){e&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),s(4,"HORARIOS Y LISTAS DE ESTUDIANTES"),a(),r(5,"p",5),s(6,"Verifique su horario/curso/materia/paralelo"),a()()()(),r(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div")(14,"div",12),s(15,"HORARIOS"),a(),r(16,"div",13),s(17,"Publicados por instituci\xF3n"),a()(),r(18,"div",14),_(19,_t,2,0,"button",15),r(20,"button",16),f("click",function(){return n.CargarHorariosPublicados()}),s(21,"Actualizar"),a()()(),_(22,ut,3,0,"div",17)(23,Mt,3,2,"ng-container",18),a()()(),r(24,"div",19)(25,"div",20)(26,"div",21)(27,"div",22)(28,"h5",23),s(29),a(),r(30,"button",24),f("click",function(){return n.limpiarHorarioDraft()}),a()(),r(31,"div",25),_(32,yt,2,0,"div",26)(33,wt,27,5,"ng-container",18),a(),r(34,"div",27)(35,"button",28),f("click",function(){return n.limpiarHorarioDraft()}),s(36,"Cancelar"),a(),r(37,"button",29),f("click",function(){return n.guardarHorario()}),s(38),a()()()()(),r(39,"div",30)(40,"div",2)(41,"div",31)(42,"div",32),s(43,"C\xF3mo usar"),a(),r(44,"div",33),s(45,"1) Seleccione gesti\xF3n \u2192 se listar\xE1n los cursos"),a(),r(46,"div",33),s(47,"2) En cada curso, elija una materia (opcional) y pulse \u201CLISTAR\u201D"),a(),h(48,"hr"),r(49,"div",33),s(50,'i) Busque el estado de sus materias usando el boton "AVERIGUAR CURSO PARALELO" '),a(),_(51,Ot,8,2,"div",34),a(),r(52,"div",35)(53,"div",36)(54,"select",37),T("ngModelChange",function(c){return O(n.gestion_id_seleccionado,c)||(n.gestion_id_seleccionado=c),c}),f("change",function(){return n.onGestionChange()}),r(55,"option",38),s(56,"Seleccione una opci\xF3n"),a(),_(57,Tt,2,2,"option",39),a(),r(58,"label"),s(59,"Gesti\xF3n"),a()(),r(60,"div",40)(61,"button",41),s(62,"AVERIGUAR CURSO PARALELO (POR CI)"),a()(),r(63,"div",2)(64,"div",42)(65,"div",43)(66,"div",44),h(67,"input",45),r(68,"label"),s(69,"Buscar"),a()()()()()()(),_(70,kt,7,0,"div",46),r(71,"div",7),_(72,Ht,21,20,"div",47),a()()()(),r(73,"div",48)(74,"div",49)(75,"div",21)(76,"div",22)(77,"h5",23),s(78," CONSULTAR CURSO Y PARALELO"),a(),h(79,"button",50),a(),r(80,"div",25)(81,"div",51)(82,"h3",52),s(83,"DEBE INTRODUCIR SU CARNET CORRECTAMENTE. EJEMPLO: 4567814 - 12345-H1 (si tiene complemento)"),a(),r(84,"div",53)(85,"div",54)(86,"select",37),T("ngModelChange",function(c){return O(n.gestion_id_seleccionado,c)||(n.gestion_id_seleccionado=c),c}),f("change",function(){return n.CargarCursosDesdeMaterias()}),r(87,"option",38),s(88,"Seleccione una opci\xF3n"),a(),_(89,Lt,2,2,"option",39),a(),r(90,"label"),s(91,"SE BUSCAR\xC1 LA INFORMACION PARA LA GESTI\xD3N"),a()(),r(92,"label",55),s(93,"SI DESEA VERIFICAR EN OTRA GESTION SELECCIONE OTRA. "),a()(),r(94,"div",53)(95,"div",56)(96,"input",57),T("ngModelChange",function(c){return O(n.CIVerificar,c)||(n.CIVerificar=c),c}),a(),r(97,"label"),s(98,"CARNET (SOLO N\xDAMEROS, SI TIENE COMPLEMENTO SU CI COLOCAR SEGUIDO)"),a(),r(99,"div",58),s(100,"Este campo es obligatorio*"),a()(),r(101,"button",59),f("click",function(){return n.VerificarCursoParalelo()}),s(102,"BUSCAR"),a()()(),_(103,Yt,5,3,"div",60),a(),h(104,"div",27),a()()()),e&2&&(l(19),p("ngIf",n.puedePublicarHorarios),l(3),p("ngIf",n.horariosLoading),l(),p("ngIf",!n.horariosLoading),l(6),x(n.esEdicionHorario?"Editar horario":"Publicar horario"),l(3),p("ngIf",!n.puedePublicarHorarios),l(),p("ngIf",n.puedePublicarHorarios),l(4),p("disabled",!n.puedePublicarHorarios||n.horarioUploading||n.horarioSaving),l(),b(" ",n.esEdicionHorario?"Guardar cambios":"Publicar"," "),l(13),p("ngIf",n.institucionesLogos==null?null:n.institucionesLogos.length),l(3),A("ngModel",n.gestion_id_seleccionado),l(3),p("ngForOf",n.anio),l(9),p("formGroup",n.filterHorarioForm),l(4),p("ngIf",n.cursosFiltrados.length===0),l(2),p("ngForOf",n.cursosFiltrados),l(14),A("ngModel",n.gestion_id_seleccionado),l(3),p("ngForOf",n.anio),l(7),A("ngModel",n.CIVerificar),l(7),p("ngForOf",n.CursosMateriasEstudiante))},dependencies:[Z,ee,re,le,ie,ae,ne,Fe,oe,He,Le],styles:['@charset "UTF-8";.no-horario-svg[_ngcontent-%COMP%]{width:200px;height:200px;margin:50px auto auto;display:block}.institucion-logo-btn[_ngcontent-%COMP%]{padding:6px;border-radius:12px;line-height:0}.institucion-logo-btn.active[_ngcontent-%COMP%]{outline:2px solid rgba(25,135,84,.5);box-shadow:0 0 0 .25rem #19875426}.institucion-logo[_ngcontent-%COMP%]{width:44px;height:44px;object-fit:contain;display:block}.institucion-mini-logo[_ngcontent-%COMP%]{width:22px;height:22px;object-fit:contain;display:block}.horarios-panel[_ngcontent-%COMP%]{top:12px}.horario-dropzone[_ngcontent-%COMP%]{border:2px dashed rgba(13,110,253,.35);border-radius:12px;padding:12px;background:#fff;transition:background .12s ease,border-color .12s ease}.horario-dropzone.dragging[_ngcontent-%COMP%]{background:#0d6efd0d;border-color:#0d6efda6}.horario-inst-card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.08);border-left:6px solid #0d6efd;border-radius:12px;overflow:hidden;background:#fff}.horario-inst-header[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.06)}.horario-inst-body[_ngcontent-%COMP%]{padding:10px 12px}.horario-item[_ngcontent-%COMP%]{padding:10px 0;border-bottom:1px dashed rgba(0,0,0,.08)}.horario-item[_ngcontent-%COMP%]:last-child{border-bottom:0}.curso-card[_ngcontent-%COMP%]{border-left:6px solid #0d6efd;border-radius:14px;overflow:hidden;transition:transform .12s ease,box-shadow .12s ease}.curso-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1.25rem #00000014!important}.curso-title[_ngcontent-%COMP%]{text-align:left;line-height:1.15}.curso-badge[_ngcontent-%COMP%]{color:#fff;font-weight:700;letter-spacing:.2px}.institucion-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#ffffffbf;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.btn-inst[_ngcontent-%COMP%]{color:#fff}.btn-inst[_ngcontent-%COMP%]:hover{filter:brightness(.95);color:#fff}.btn-inst[_ngcontent-%COMP%]:disabled{opacity:.65}']});var _e=$;var Jt=["modalDetalleDocente"],Kt=["modalAccionesGrupales"],L=(i,t)=>({"bi-caret-up":i,"bi-caret-down":t});function Xt(i,t){if(i&1){let e=v();r(0,"div",44)(1,"input",45),T("ngModelChange",function(o){u(e);let c=d(2);return O(c.edicionDocentesActiva,o)||(c.edicionDocentesActiva=o),g(o)}),f("change",function(){u(e);let o=d(2);return g(o.onToggleEdicionDocentes())}),a(),r(2,"label",46),s(3,"Edici\xF3n de docentes"),a()()}if(i&2){let e=d(2);l(),A("ngModel",e.edicionDocentesActiva)}}function Zt(i,t){if(i&1){let e=v();r(0,"button",47),f("click",function(){u(e);let o=d(2);return g(o.GenerarReporteListaEstudiantes())}),r(1,"span",48),h(2,"ng-lottie",49),a(),r(3,"span"),s(4,"GENERAR LISTA DE ESTUDIANTES"),a(),h(5,"span",50),a()}if(i&2){let e=d(2);l(2),p("options",e._tools.optionsarchive)}}function ei(i,t){if(i&1){let e=v();r(0,"button",51),f("click",function(){u(e);let o=d(2);return g(o.copiarListaExcel())}),r(1,"span",48),h(2,"ng-lottie",49),a(),r(3,"span"),s(4,"COPIAR (EXCEL)"),a(),h(5,"span",50),a()}if(i&2){let e=d(2);l(2),p("options",e._tools.optionsUpload)}}function ti(i,t){if(i&1){let e=v();r(0,"button",51),f("click",function(){u(e);let o=d(2);return g(o.abrirAccionesGrupales())}),r(1,"span",48),h(2,"ng-lottie",49),a(),r(3,"span"),s(4,"ACCIONES GRUPALES"),a(),h(5,"span",50),a()}if(i&2){let e=d(2);l(2),p("options",e._tools.optionstripleengranaje)}}function ii(i,t){if(i&1){let e=v();r(0,"div",52)(1,"div",53)(2,"input",54),T("ngModelChange",function(o){u(e);let c=d(2);return O(c.reportarconInstrumentos,o)||(c.reportarconInstrumentos=o),g(o)}),a(),r(3,"label",55),s(4,"con Especialidad"),a()(),r(5,"div",53)(6,"input",56),T("ngModelChange",function(o){u(e);let c=d(2);return O(c.reportarcondocentesEspecialidad,o)||(c.reportarcondocentesEspecialidad=o),g(o)}),a(),r(7,"label",57),s(8,"con Docentes Especialidad"),a()()()}if(i&2){let e=d(2);l(2),A("ngModel",e.reportarconInstrumentos),l(4),A("ngModel",e.reportarcondocentesEspecialidad)}}function ni(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(2);p("ngClass",F(1,L,e.getSortDirest("Ap_Paterno")==="asc",e.getSortDirest("Ap_Paterno")==="desc"))}}function oi(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(2);p("ngClass",F(1,L,e.getSortDirest("Ap_Materno")==="asc",e.getSortDirest("Ap_Materno")==="desc"))}}function ai(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(2);p("ngClass",F(1,L,e.getSortDirest("Nombre")==="asc",e.getSortDirest("Nombre")==="desc"))}}function ri(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(3);p("ngClass",F(1,L,e.getSortDirest("Docente_Especialidad_Apellidos")==="asc",e.getSortDirest("Docente_Especialidad_Apellidos")==="desc"))}}function li(i,t){if(i&1){let e=v();r(0,"th",59),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Especialidad_Apellidos",o))}),s(1," Doc. Especialidad "),_(2,ri,1,4,"i",34),a()}if(i&2){let e=d(2);l(2),p("ngIf",e.isSortedest("Docente_Especialidad_Apellidos"))}}function si(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(3);p("ngClass",F(1,L,e.getSortDirest("Docente_Practica_Conjuntos_Apellidos")==="asc",e.getSortDirest("Docente_Practica_Conjuntos_Apellidos")==="desc"))}}function ci(i,t){if(i&1){let e=v();r(0,"th",60),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Practica_Conjuntos_Apellidos",o))}),s(1," Doc. Prac. Conj. "),_(2,si,1,4,"i",34),a()}if(i&2){let e=d(2);l(2),p("ngIf",e.isSortedest("Docente_Practica_Conjuntos_Apellidos"))}}function di(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(3);p("ngClass",F(1,L,e.getSortDirest("Docente_Instrumento_Complementario_Apellidos")==="asc",e.getSortDirest("Docente_Instrumento_Complementario_Apellidos")==="desc"))}}function pi(i,t){if(i&1){let e=v();r(0,"th",61),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Instrumento_Complementario_Apellidos",o))}),s(1," Doc. Inst. Comp. "),_(2,di,1,4,"i",34),a()}if(i&2){let e=d(2);l(2),p("ngIf",e.isSortedest("Docente_Instrumento_Complementario_Apellidos"))}}function mi(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(3);p("ngClass",F(1,L,e.getSortDirest("InstrumentoMusical")==="asc",e.getSortDirest("InstrumentoMusical")==="desc"))}}function _i(i,t){if(i&1){let e=v();r(0,"th",33),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("InstrumentoMusical",o))}),s(1," Especialidad "),_(2,mi,1,4,"i",34),a()}if(i&2){let e=d(2);l(2),p("ngIf",e.isSortedest("InstrumentoMusical"))}}function ui(i,t){if(i&1&&h(0,"i",58),i&2){let e=d(3);p("ngClass",F(1,L,e.getSortDirest("InstrumentoMusicalSecundario")==="asc",e.getSortDirest("InstrumentoMusicalSecundario")==="desc"))}}function gi(i,t){if(i&1){let e=v();r(0,"th",62),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("InstrumentoMusicalSecundario",o))}),s(1," Instr. Secundario "),_(2,ui,1,4,"i",34),a()}if(i&2){let e=d(2);l(2),p("ngIf",e.isSortedest("InstrumentoMusicalSecundario"))}}function fi(i,t){i&1&&(r(0,"th",32),s(1,"CELULAR_EST"),a())}function hi(i,t){i&1&&(r(0,"th",32),s(1,"PADRE"),a())}function xi(i,t){i&1&&(r(0,"th",32),s(1,"MADRE"),a())}function Ci(i,t){i&1&&(r(0,"tr")(1,"td",32)(2,"div",63)(3,"span",64),s(4,"Cargando..."),a()()()()),i&2&&(l(),xe("colspan",5))}function vi(i,t){i&1&&(r(0,"tr")(1,"td",32),s(2,"No hay datos disponibles"),a()()),i&2&&(l(),xe("colspan",5))}function bi(i,t){if(i&1&&(r(0,"div",70),s(1),a()),i&2){let e=d().$implicit;l(),b("CI: ",e.CI)}}function Ei(i,t){if(i&1&&(r(0,"div",70),s(1),a()),i&2){let e=d().$implicit;l(),b(" ",e.Sexo)}}function Si(i,t){if(i&1&&(r(0,"span"),s(1),a()),i&2){let e=d(2).$implicit;l(),b("Edad: ",e.Edad)}}function Ii(i,t){if(i&1&&(r(0,"div",70),_(1,Si,2,1,"span",41),a()),i&2){let e=d(3);l(),p("ngIf",e.verdetallado)}}function Mi(i,t){if(i&1&&(r(0,"div",71),s(1),a()),i&2){let e=d().$implicit;l(),b(" Asig. ",e.CantidadMateriasAsignadas)}}function yi(i,t){if(i&1&&(r(0,"span"),s(1),a()),i&2){let e=d(2).$implicit;l(),b("Est. ",e.Categoria)}}function Di(i,t){if(i&1&&(r(0,"div",70),_(1,yi,2,1,"span",41),a()),i&2){let e=d(3);l(),p("ngIf",e.verdetallado)}}function Pi(i,t){i&1&&(r(0,"span"),s(1,"A\xDAN SIN DESIGNAR"),a())}function wi(i,t){if(i&1){let e=v();r(0,"a",74),f("click",function(o){return u(e),g(o.stopPropagation())}),r(1,"span",48),h(2,"ng-lottie",75),a(),r(3,"span"),s(4),a(),h(5,"span",50),a()}if(i&2){let e=d(3).$implicit,n=d(2);p("href",j("https://api.whatsapp.com/send?phone=591",e.Docente_Especialidad_CelularTrabajo),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.Docente_Especialidad_CelularTrabajo)}}function Ai(i,t){if(i&1&&(D(0),K(1,Pi,2,0,"span")(2,wi,6,4,"a",73),r(3,"div",70),s(4),a(),P()),i&2){let e=d(2).$implicit;l(),X(e.Docente_Especialidad_Apellidos==null&&e.Docente_Especialidad_Nombres==null?1:2),l(3),w("",e.Docente_Especialidad_Apellidos," ",e.Docente_Especialidad_Nombres)}}function Oi(i,t){i&1&&(r(0,"div",79),s(1,"Guardando..."),a())}function Ti(i,t){if(i&1){let e=v();r(0,"div",76)(1,"input",77),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),a()(),_(2,Oi,2,0,"div",78)}if(i&2){let e=d(2).$implicit,n=d(2);l(),p("formControl",n.docEdicionInput),l(),p("ngIf",n.isGuardandoDocente(n.getRowInfoId(e),"planteldocadmins_id"))}}function ki(i,t){if(i&1){let e=v();r(0,"td",72),f("click",function(o){u(e);let c=d().$implicit,m=d(2);return g(m.edicionDocentesActiva?m.activarEdicionDocente(c,"planteldocadmins_id",o):null)}),_(1,Ai,5,3,"ng-container",8)(2,Ti,3,2,"ng-template",null,3,V),a()}if(i&2){let e=R(3),n=d().$implicit,o=d(2);N("docente-cell-editable",o.edicionDocentesActiva&&o.puedeEditarDocentes)("docente-cell-active",o.edicionDocentesActiva&&o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_id")),l(),p("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_id"))("ngIfElse",e)}}function Ni(i,t){i&1&&(r(0,"span"),s(1,"NINGUNO(A)"),a())}function Ri(i,t){if(i&1){let e=v();r(0,"a",74),f("click",function(o){return u(e),g(o.stopPropagation())}),r(1,"span",48),h(2,"ng-lottie",75),a(),r(3,"span"),s(4),a(),h(5,"span",50),a()}if(i&2){let e=d(3).$implicit,n=d(2);p("href",j("https://api.whatsapp.com/send?phone=591",e.Docente_Practica_Conjuntos_CelularTrabajo),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.Docente_Practica_Conjuntos_CelularTrabajo)}}function Fi(i,t){if(i&1&&(D(0),K(1,Ni,2,0,"span")(2,Ri,6,4,"a",73),r(3,"div",70),s(4),a(),P()),i&2){let e=d(2).$implicit;l(),X(e.Docente_Practica_Conjuntos_Apellidos==null&&e.Docente_Practica_Conjuntos_Nombres==null?1:2),l(3),w("",e.Docente_Practica_Conjuntos_Apellidos," ",e.Docente_Practica_Conjuntos_Nombres)}}function Vi(i,t){i&1&&(r(0,"div",79),s(1,"Guardando..."),a())}function Hi(i,t){if(i&1){let e=v();r(0,"div",76)(1,"input",77),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),a()(),_(2,Vi,2,0,"div",78)}if(i&2){let e=d(2).$implicit,n=d(2);l(),p("formControl",n.docEdicionInput),l(),p("ngIf",n.isGuardandoDocente(n.getRowInfoId(e),"planteldocadmins_idPC"))}}function Li(i,t){if(i&1){let e=v();r(0,"td",72),f("click",function(o){u(e);let c=d().$implicit,m=d(2);return g(m.edicionDocentesActiva?m.activarEdicionDocente(c,"planteldocadmins_idPC",o):null)}),_(1,Fi,5,3,"ng-container",8)(2,Hi,3,2,"ng-template",null,4,V),a()}if(i&2){let e=R(3),n=d().$implicit,o=d(2);N("docente-cell-editable",o.edicionDocentesActiva&&o.puedeEditarDocentes)("docente-cell-active",o.edicionDocentesActiva&&o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_idPC")),l(),p("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_idPC"))("ngIfElse",e)}}function ji(i,t){i&1&&(r(0,"span"),s(1,"NINGUNO(A)"),a())}function Bi(i,t){if(i&1){let e=v();r(0,"a",74),f("click",function(o){return u(e),g(o.stopPropagation())}),r(1,"span",48),h(2,"ng-lottie",75),a(),r(3,"span"),s(4),a(),h(5,"span",50),a()}if(i&2){let e=d(3).$implicit,n=d(2);p("href",j("https://api.whatsapp.com/send?phone=591",e.Docente_Instrumento_Complementario_CelularTrabajo),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.Docente_Instrumento_Complementario_CelularTrabajo)}}function Ui(i,t){if(i&1&&(D(0),K(1,ji,2,0,"span")(2,Bi,6,4,"a",73),r(3,"div",70),s(4),a(),P()),i&2){let e=d(2).$implicit;l(),X(e.Docente_Instrumento_Complementario_Apellidos==null&&e.Docente_Instrumento_Complementario_Nombres==null?1:2),l(3),w("",e.Docente_Instrumento_Complementario_Apellidos," ",e.Docente_Instrumento_Complementario_Nombres)}}function $i(i,t){i&1&&(r(0,"div",79),s(1,"Guardando..."),a())}function zi(i,t){if(i&1){let e=v();r(0,"div",76)(1,"input",77),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),a()(),_(2,$i,2,0,"div",78)}if(i&2){let e=d(2).$implicit,n=d(2);l(),p("formControl",n.docEdicionInput),l(),p("ngIf",n.isGuardandoDocente(n.getRowInfoId(e),"planteldocadmins_idOtros"))}}function Gi(i,t){if(i&1){let e=v();r(0,"td",72),f("click",function(o){u(e);let c=d().$implicit,m=d(2);return g(m.edicionDocentesActiva?m.activarEdicionDocente(c,"planteldocadmins_idOtros",o):null)}),_(1,Ui,5,3,"ng-container",8)(2,zi,3,2,"ng-template",null,5,V),a()}if(i&2){let e=R(3),n=d().$implicit,o=d(2);N("docente-cell-editable",o.edicionDocentesActiva&&o.puedeEditarDocentes)("docente-cell-active",o.edicionDocentesActiva&&o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_idOtros")),l(),p("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(o.getRowInfoId(n),"planteldocadmins_idOtros"))("ngIfElse",e)}}function Wi(i,t){if(i&1&&(r(0,"div",70),s(1),a()),i&2){let e=d(3).$implicit;l(),b(" (Est. ",e.Categoria,")")}}function qi(i,t){if(i&1&&(D(0),s(1),_(2,Wi,2,1,"div",66),P()),i&2){let e=d(2).$implicit,n=d(2);l(),b(" ",e.InstrumentoMusical||"SIN ESPECIALIDAD"," "),l(),p("ngIf",n.verdetallado)}}function Qi(i,t){if(i&1&&(r(0,"option",85),s(1),a()),i&2){let e=t.$implicit;p("ngValue",e.value)("disabled",e.disabled),l(),x(e.label)}}function Yi(i,t){i&1&&(r(0,"div",79),s(1,"Guardando..."),a())}function Ji(i,t){if(i&1){let e=v();r(0,"div",81)(1,"select",82),f("click",function(o){return u(e),g(o.stopPropagation())})("ngModelChange",function(o){u(e);let c=d(2).$implicit,m=d(2);return g(m.onInstrumentoChange(c,"InstrumentoMusical",o))}),r(2,"option",83),s(3,"-- Sin especialidad --"),a(),_(4,Qi,2,3,"option",84),a(),r(5,"label"),s(6,"Especialidad"),a()(),_(7,Yi,2,0,"div",78)}if(i&2){let e=d(2).$implicit,n=d(2);l(),p("ngModel",e.InstrumentoMusical),l(),p("ngValue",""),l(2),p("ngForOf",n.InstrumentoMusicalOptions),l(3),p("ngIf",n.isGuardandoInstrumento(n.getRowInfoId(e),"InstrumentoMusical"))}}function Ki(i,t){if(i&1&&(r(0,"td",80),_(1,qi,3,2,"ng-container",8)(2,Ji,8,4,"ng-template",null,6,V),a()),i&2){let e=R(3),n=d(3);l(),p("ngIf",!n.edicionDocentesActiva)("ngIfElse",e)}}function Xi(i,t){if(i&1&&(r(0,"div",70),s(1),a()),i&2){let e=d(3).$implicit;l(),b(" Edad: ",e.Edad)}}function Zi(i,t){if(i&1&&(D(0),s(1),_(2,Xi,2,1,"div",66),P()),i&2){let e=d(2).$implicit,n=d(2);l(),b(" ",e.InstrumentoMusicalSecundario||"SIN INSTR. SEC."," "),l(),p("ngIf",n.verdetallado)}}function en(i,t){if(i&1&&(r(0,"option",85),s(1),a()),i&2){let e=t.$implicit;p("ngValue",e.value)("disabled",e.disabled),l(),x(e.label)}}function tn(i,t){i&1&&(r(0,"div",79),s(1,"Guardando..."),a())}function nn(i,t){if(i&1){let e=v();r(0,"div",81)(1,"select",82),f("click",function(o){return u(e),g(o.stopPropagation())})("ngModelChange",function(o){u(e);let c=d(2).$implicit,m=d(2);return g(m.onInstrumentoChange(c,"InstrumentoMusicalSecundario",o))}),r(2,"option",83),s(3,"-- Sin instr. secundario --"),a(),_(4,en,2,3,"option",84),a(),r(5,"label"),s(6,"Instr. Secundario"),a()(),_(7,tn,2,0,"div",78)}if(i&2){let e=d(2).$implicit,n=d(2);l(),p("ngModel",e.InstrumentoMusicalSecundario),l(),p("ngValue",""),l(2),p("ngForOf",n.InstrumentoMusicalSecundarioOptions),l(3),p("ngIf",n.isGuardandoInstrumento(n.getRowInfoId(e),"InstrumentoMusicalSecundario"))}}function on(i,t){if(i&1&&(r(0,"td",80),_(1,Zi,3,2,"ng-container",8)(2,nn,8,4,"ng-template",null,7,V),a()),i&2){let e=R(3),n=d(3);l(),p("ngIf",!n.edicionDocentesActiva)("ngIfElse",e)}}function an(i,t){if(i&1&&(r(0,"td")(1,"a",73)(2,"span",48),h(3,"ng-lottie",75),a(),r(4,"span"),s(5),a(),h(6,"span",50),a(),r(7,"div",70),s(8),a()()),i&2){let e=d().$implicit,n=d(2);l(),p("href",j("https://api.whatsapp.com/send?phone=591",e.Celular),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.Celular),l(3),x(e.Nombre_Padre)}}function rn(i,t){if(i&1&&(r(0,"td")(1,"a",73)(2,"span",48),h(3,"ng-lottie",75),a(),r(4,"span"),s(5),a(),h(6,"span",50),a(),r(7,"div",70),s(8),a()()),i&2){let e=d().$implicit,n=d(2);l(),p("href",j("https://api.whatsapp.com/send?phone=591",e.NumCelP),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.NumCelP),l(3),x(e.Nombre_Padre)}}function ln(i,t){if(i&1&&(r(0,"td")(1,"a",73)(2,"span",48),h(3,"ng-lottie",75),a(),r(4,"span"),s(5),a(),h(6,"span",50),a(),r(7,"div",70),s(8),a()()),i&2){let e=d().$implicit,n=d(2);l(),p("href",j("https://api.whatsapp.com/send?phone=591",e.NumCelM),y),l(2),p("options",n._tools.optionsWhatsApp),l(2),x(e.NumCelM),l(3),x(e.Nombre_Madre)}}function sn(i,t){if(i&1){let e=v();r(0,"tr",65),f("contextmenu",function(){let o=u(e).$implicit,c=d(2);return g(c.abrirMenuest(c.event,o))}),r(1,"td",32),s(2),a(),r(3,"td"),s(4),_(5,bi,2,1,"div",66),a(),r(6,"td"),s(7),_(8,Ei,2,1,"div",66)(9,Ii,2,1,"div",66),a(),r(10,"td"),s(11),_(12,Mi,2,1,"div",67)(13,Di,2,1,"div",66),a(),_(14,ki,4,6,"td",68)(15,Li,4,6,"td",68)(16,Gi,4,6,"td",68)(17,Ki,4,2,"td",69)(18,on,4,2,"td",69)(19,an,9,5,"td",41)(20,rn,9,5,"td",41)(21,ln,9,5,"td",41),a()}if(i&2){let e=t.$implicit,n=t.index,o=d(2);l(2),x((o.paginaest-1)*o.pageSizeest+(n+1)),l(2),b("",e.Ap_Paterno," "),l(),p("ngIf",o.verdetallado),l(2),b("",e.Ap_Materno," "),l(),p("ngIf",o.verdetallado),l(),p("ngIf",!o.mostrarCamposMusicales),l(2),b("",e.Nombre," "),l(),p("ngIf",o.verdetallado),l(),p("ngIf",!o.mostrarCamposMusicales),l(),p("ngIf",o.mostrarCamposMusicales),l(),p("ngIf",o.mostrarCamposMusicales),l(),p("ngIf",o.mostrarCamposMusicales),l(),p("ngIf",o.mostrarCamposMusicales),l(),p("ngIf",o.mostrarCamposMusicales),l(),p("ngIf",o.verdetallado),l(),p("ngIf",o.verdetallado),l(),p("ngIf",o.verdetallado)}}function cn(i,t){if(i&1){let e=v();r(0,"div",90)(1,"div",91),s(2,"Dejar vac\xEDo (quitar docente)"),a(),r(3,"button",92),f("click",function(o){u(e);let c=d(3);return o.stopPropagation(),g(c.quitarDocenteEdicion())}),s(4," Quitar "),a()()}if(i&2){let e=d(3);l(3),p("disabled",e.isGuardandoDocente(e.edicionDocenteActivo.infoId,e.edicionDocenteActivo.field))}}function dn(i,t){i&1&&(r(0,"div",93),s(1,"Sin resultados"),a())}function pn(i,t){if(i&1&&(r(0,"span",100),s(1),a()),i&2){let e=d().$implicit,n=d(3);l(),b(" | No tomado en Cuenta: ",n.getConteoDocenteSinModo(e.id))}}function mn(i,t){if(i&1){let e=v();r(0,"div",94),f("click",function(o){let c=u(e).$implicit,m=d(3);return o.stopPropagation(),g(m.seleccionarDocenteEdicion(c))}),r(1,"div",95)(2,"div",96),s(3),a(),r(4,"small",97),s(5),_(6,pn,2,1,"span",98),a()(),r(7,"button",99),f("click",function(o){let c=u(e).$implicit,m=d(3);return g(m.abrirDetalleDocente(c,o))}),s(8,"Detalle"),a()()}if(i&2){let e=t.$implicit,n=d(3);N("disabled",n.docenteInactivo(e)),l(2),N("text-muted",n.docenteInactivo(e)),l(),x(n.getNombreCompletoDocente(e)),l(2),b(" Estudiantes: ",n.getConteoDocenteOk(e.id)," "),l(),p("ngIf",n.getConteoDocenteSinModo(e.id)>0)}}function _n(i,t){if(i&1&&(r(0,"div",86),_(1,cn,5,1,"div",87)(2,dn,2,0,"div",88)(3,mn,9,7,"div",89),a()),i&2){let e=d(2);k("top",e.docenteOverlayTop,"px")("left",e.docenteOverlayLeft,"px")("width",e.docenteOverlayWidth,"px"),l(),p("ngIf",e.edicionDocentesActiva&&e.edicionDocenteActivo),l(),p("ngIf",e.docentesFiltradosEdicion.length===0),l(),p("ngForOf",e.docentesFiltradosEdicion)}}function un(i,t){if(i&1){let e=v();D(0),r(1,"div",9)(2,"div",10)(3,"div",11)(4,"h1",12),s(5,"Lista de Estudiantes "),a(),r(6,"p",13)(7,"span",14),s(8),a(),s(9),r(10,"span",15),s(11),a()()()()(),r(12,"div",10)(13,"div",16)(14,"div",17)(15,"div",18)(16,"span",19),h(17,"ng-lottie",20),a(),r(18,"div",21)(19,"input",22),T("ngModelChange",function(o){u(e);let c=d();return O(c.filtertxtest,o)||(c.filtertxtest=o),g(o)}),f("ngModelChange",function(){u(e);let o=d();return g(o.onFilterTxtEstChange())}),a(),r(20,"label"),s(21,"Buscar"),a()()(),_(22,Xt,4,1,"div",23),a()()(),r(23,"div",24),_(24,Zt,6,1,"button",25)(25,ei,6,1,"button",26)(26,ti,6,1,"button",26)(27,ii,9,2,"div",27),a(),r(28,"div",28)(29,"div",29)(30,"table",30)(31,"thead",31)(32,"tr")(33,"th",32),s(34,"#"),a(),r(35,"th",33),f("click",function(o){u(e);let c=d();return g(c.sortByest("Ap_Paterno",o))}),s(36," Ap_Paterno "),_(37,ni,1,4,"i",34),a(),r(38,"th",33),f("click",function(o){u(e);let c=d();return g(c.sortByest("Ap_Materno",o))}),s(39," Ap_Materno "),_(40,oi,1,4,"i",34),a(),r(41,"th",33),f("click",function(o){u(e);let c=d();return g(c.sortByest("Nombre",o))}),s(42," Nombre "),_(43,ai,1,4,"i",34),a(),_(44,li,3,1,"th",35)(45,ci,3,1,"th",36)(46,pi,3,1,"th",37)(47,_i,3,1,"th",38)(48,gi,3,1,"th",39)(49,fi,2,0,"th",40)(50,hi,2,0,"th",40)(51,xi,2,0,"th",40),a()(),r(52,"tbody"),_(53,Ci,5,1,"tr",41)(54,vi,3,1,"tr",41)(55,sn,22,17,"tr",42),a()()()(),_(56,_n,4,9,"div",43),P()}if(i&2){let e=d();l(8),w("",e.lvlCurso," ",e.paralelo),l(),b(" Turno ",e.turno," "),l(2),x(e.siglaYMateria),l(6),p("options",e._tools.optionslupa),l(2),A("ngModel",e.filtertxtest),l(3),p("ngIf",e.puedeEditarDocentes&&e.mostrarCamposMusicales),l(2),p("ngIf",e.visionOpciones),l(),p("ngIf",e.habilitarCopiaExcel),l(),p("ngIf",e.puedeEditarDocentes&&e.mostrarCamposMusicales),l(),p("ngIf",e.visionOpciones&&e.mostrarCamposMusicales),l(10),p("ngIf",e.isSortedest("Ap_Paterno")),l(3),p("ngIf",e.isSortedest("Ap_Materno")),l(3),p("ngIf",e.isSortedest("Nombre")),l(),p("ngIf",e.mostrarCamposMusicales),l(),p("ngIf",e.mostrarCamposMusicales),l(),p("ngIf",e.mostrarCamposMusicales),l(),p("ngIf",e.mostrarCamposMusicales),l(),p("ngIf",e.mostrarCamposMusicales),l(),p("ngIf",e.verdetallado),l(),p("ngIf",e.verdetallado),l(),p("ngIf",e.verdetallado),l(2),p("ngIf",e.isLoadingest),l(),p("ngIf",!e.isLoadingest&&(!e.estFiltrados||e.estFiltrados.length===0)),l(),p("ngForOf",e.estFiltrados),l(),p("ngIf",e.mostrarListaDocEdicion&&e.puedeEditarDocentes)}}function gn(i,t){i&1&&(r(0,"div",9)(1,"div",101),s(2," Debe iniciar sesi\xF3n para acceder a este sitio. "),a()())}function fn(i,t){i&1&&(r(0,"span",120),s(1,"OK Oficial"),a())}function hn(i,t){i&1&&(r(0,"span",121),s(1,"No tomado en Cuenta"),a())}function xn(i,t){if(i&1&&(r(0,"tr")(1,"td",32),s(2),a(),r(3,"td"),s(4),a(),r(5,"td"),s(6),a(),r(7,"td"),s(8),a(),r(9,"td"),s(10),a(),r(11,"td",32),_(12,fn,2,0,"span",118)(13,hn,2,0,"span",119),a(),r(14,"td",32),s(15),a(),r(16,"td",32),s(17),a(),r(18,"td",32),s(19),a(),r(20,"td",32),s(21),a()()),i&2){let e=t.$implicit,n=t.index,o=d(2);l(2),x(n+1),l(2),x(o.anioId),l(2),x(o.lvlCurso),l(2),x(o.paralelo),l(2),Ee("",e==null?null:e.Ap_Paterno," ",e==null?null:e.Ap_Materno," ",e==null?null:e.Nombre),l(2),p("ngIf",o.tieneModoMateria(e,o.detalleDocenteMeta==null?null:o.detalleDocenteMeta.field)),l(),p("ngIf",!o.tieneModoMateria(e,o.detalleDocenteMeta==null?null:o.detalleDocenteMeta.field)),l(2),x(e==null?null:e.CI),l(2),x(e==null?null:e.Edad),l(2),x(e==null?null:e.Sexo),l(2),x(o.turno)}}function Cn(i,t){if(i&1&&(r(0,"div",70),s(1),a()),i&2){let e=d(2);l(),b(" Nota: \u201CNo tomado en Cuenta\u201D significa que el estudiante no tiene la materia asignada por lo tanto no se cuenta en estadistica con ",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.modo_label,". ")}}function vn(i,t){if(i&1){let e=v();r(0,"div",102)(1,"div")(2,"h5",103),s(3,"Detalle por docente"),a(),r(4,"div",104),s(5),a()(),r(6,"button",105),f("click",function(){let o=u(e).$implicit;return g(o.dismiss("close"))}),a()(),r(7,"div",106)(8,"div",107)(9,"table",108)(10,"thead")(11,"tr")(12,"th",109),s(13,"#"),a(),r(14,"th"),s(15,"A\xF1o"),a(),r(16,"th"),s(17,"Curso"),a(),r(18,"th"),s(19,"Paralelo"),a(),r(20,"th"),s(21,"Nombre"),a(),r(22,"th",110),s(23,"Modo"),a(),r(24,"th",111),s(25,"CI"),a(),r(26,"th",112),s(27,"Edad"),a(),r(28,"th",113),s(29,"Sexo"),a(),r(30,"th",114),s(31,"Turno"),a()()(),r(32,"tbody"),_(33,xn,22,13,"tr",115),a()()(),_(34,Cn,2,1,"div",66),a(),r(35,"div",116)(36,"button",117),f("click",function(){let o=u(e).$implicit;return g(o.close("ok"))}),r(37,"span",48),h(38,"ng-lottie",49),a(),r(39,"span"),s(40,"CERRAR"),a(),h(41,"span",50),a()()}if(i&2){let e=d();l(5),b(" ",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.docente_nombre," "),l(28),p("ngForOf",e.detalleDocenteRows),l(),p("ngIf",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.modo_label),l(4),p("options",e._tools.optionscancelar)}}function bn(i,t){if(i&1&&(r(0,"option",138),s(1),a()),i&2){let e=t.$implicit;p("value",e),l(),x(e)}}function En(i,t){if(i&1&&(r(0,"span",100),s(1),a()),i&2){let e=d().$implicit,n=d(3);l(),b(" | No tomado en Cuenta: ",n.getBulkConteoDocenteSinModo(e.id))}}function Sn(i,t){if(i&1){let e=v();r(0,"div",94),f("click",function(o){let c=u(e).$implicit,m=d(3);return g(m.seleccionarDocenteBulk(c,o))}),r(1,"div",95)(2,"div",96),s(3),a(),r(4,"small",97),s(5),_(6,En,2,1,"span",98),a()(),r(7,"button",99),f("click",function(o){let c=u(e).$implicit,m=d(3);return g(m.abrirDetalleDocenteBulk(c,o))}),s(8,"Detalle"),a()()}if(i&2){let e=t.$implicit,n=d(3);N("disabled",n.docenteInactivo(e)),l(2),N("text-muted",n.docenteInactivo(e)),l(),x(n.getNombreCompletoDocente(e)),l(2),b(" Estudiantes: ",n.getBulkConteoDocenteOk(e.id)," "),l(),p("ngIf",n.getBulkConteoDocenteSinModo(e.id)>0)}}function In(i,t){if(i&1&&(r(0,"div",139),_(1,Sn,9,7,"div",89),a()),i&2){let e=d(2);l(),p("ngForOf",e.bulkDocentesFiltrados)}}function Mn(i,t){if(i&1&&(r(0,"div",140),s(1," Seleccionado: "),r(2,"span",96),s(3),a()()),i&2){let e=d(2);l(3),x(e.getNombreCompletoDocente(e.bulkDocenteSeleccionado))}}function yn(i,t){if(i&1&&(r(0,"tr")(1,"td",141),s(2),a()()),i&2){let e=d(2);l(2),b("Seleccione tipo y ",e.getBulkEspecialidadLabel()," para ver estudiantes.")}}function Dn(i,t){if(i&1&&(D(0),s(1),P()),i&2){let e=d().$implicit;l(),b(" ",(e==null?null:e.InstrumentoMusical)||"SIN ESPECIALIDAD"," ")}}function Pn(i,t){if(i&1&&(D(0),s(1),P()),i&2){let e=d().$implicit;l(),b(" ",(e==null?null:e.InstrumentoMusicalSecundario)||"SIN ESPECIALIDAD"," ")}}function wn(i,t){if(i&1){let e=v();r(0,"tr")(1,"td",32)(2,"input",142),f("ngModelChange",function(o){let c=u(e).$implicit,m=d(2);return g(m.bulkSeleccionMap[m.getRowInfoId(c)]=o)}),a()(),r(3,"td"),s(4),a(),r(5,"td"),s(6),a(),r(7,"td"),_(8,Dn,2,1,"ng-container",41)(9,Pn,2,1,"ng-container",41),a()()}if(i&2){let e=t.$implicit,n=d(2);l(2),p("ngModel",n.bulkSeleccionMap[n.getRowInfoId(e)]),l(2),x(e==null?null:e.CI),l(2),Ee("",e==null?null:e.Ap_Paterno," ",e==null?null:e.Ap_Materno," ",e==null?null:e.Nombre),l(2),p("ngIf",n.bulkModo!=="DOC_INSTR_COMPLEMENTARIO"),l(),p("ngIf",n.bulkModo==="DOC_INSTR_COMPLEMENTARIO")}}function An(i,t){if(i&1){let e=v();r(0,"div",102)(1,"div")(2,"h5",103),s(3,"Acciones grupales"),a(),r(4,"div",104),s(5,"Se aplicar\xE1 sobre el contenido actual de la tabla filtrada."),a()(),r(6,"button",105),f("click",function(){let o=u(e).$implicit;return g(o.dismiss("close"))}),a()(),r(7,"div",106)(8,"div",122)(9,"div",123)(10,"div",21)(11,"select",124),T("ngModelChange",function(o){u(e);let c=d();return O(c.bulkModo,o)||(c.bulkModo=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onBulkModoChange())}),r(12,"option",83),s(13,"Seleccione..."),a(),r(14,"option",83),s(15,"Doc. Especialidad"),a(),r(16,"option",83),s(17,"Doc. Pr\xE1ctica de Conjuntos"),a(),r(18,"option",83),s(19,"Doc. Instr. Complementario"),a()(),r(20,"label",96),s(21,"Tipo de columna"),a()()(),r(22,"div",123)(23,"div",21)(24,"select",125),T("ngModelChange",function(o){u(e);let c=d();return O(c.bulkEspecialidadSelected,o)||(c.bulkEspecialidadSelected=o),g(o)}),f("change",function(){u(e);let o=d();return g(o.onBulkEspecialidadChange())}),r(25,"option",126),s(26,"Seleccione..."),a(),_(27,bn,2,2,"option",127),a(),r(28,"label",96),s(29),a()()(),r(30,"div",123)(31,"div",21)(32,"input",128),f("focus",function(){u(e);let o=d();return g(o.onBulkDocInputFocus())})("input",function(){u(e);let o=d();return g(o.onBulkDocInputChange())}),a(),r(33,"label",96),s(34,"Docente"),a()(),_(35,In,2,1,"div",129)(36,Mn,4,1,"div",130),a()(),h(37,"hr",131),r(38,"div",132)(39,"div",96),s(40,"Estudiantes a modificar"),a(),r(41,"div",104),s(42),a()(),r(43,"div",133)(44,"table",108)(45,"thead")(46,"tr")(47,"th",109),s(48,"OK"),a(),r(49,"th",134),s(50,"CI"),a(),r(51,"th"),s(52,"Nombre"),a(),r(53,"th",135),s(54),a()()(),r(55,"tbody"),_(56,yn,3,1,"tr",41)(57,wn,10,7,"tr",115),a()()()(),r(58,"div",116)(59,"button",136),f("click",function(){let o=u(e).$implicit;return g(o.dismiss("cancel"))}),r(60,"span",48),h(61,"ng-lottie",49),a(),r(62,"span"),s(63,"CERRAR"),a(),h(64,"span",50),a(),r(65,"button",137),f("click",function(){u(e);let o=d();return g(o.ejecutarAccionGrupal())}),r(66,"span",48),h(67,"ng-lottie",49),a(),r(68,"span"),s(69,"APLICAR CAMBIOS"),a(),h(70,"span",50),a()()}if(i&2){let e=d();l(11),A("ngModel",e.bulkModo),l(),p("ngValue",null),l(2),p("ngValue","DOC_ESPECIALIDAD"),l(2),p("ngValue","DOC_PRACTICA_CONJUNTOS"),l(2),p("ngValue","DOC_INSTR_COMPLEMENTARIO"),l(6),A("ngModel",e.bulkEspecialidadSelected),p("disabled",!e.bulkModo),l(3),p("ngForOf",e.bulkEspecialidadOptions),l(2),x(e.getBulkEspecialidadLabel()),l(3),p("formControl",e.bulkDocInput)("disabled",!e.bulkModo||!e.bulkEspecialidadSelected),l(3),p("ngIf",e.bulkMostrarListaDoc&&e.bulkDocentesFiltrados.length>0),l(),p("ngIf",e.bulkDocenteSeleccionado),l(6),w("Seleccionados: ",e.getBulkSeleccionadosCount()," / ",(e.bulkRowsCandidatos==null?null:e.bulkRowsCandidatos.length)||0),l(12),x(e.getBulkEspecialidadLabel()),l(2),p("ngIf",!e.bulkRowsCandidatos||e.bulkRowsCandidatos.length===0),l(),p("ngForOf",e.bulkRowsCandidatos),l(2),p("disabled",e.bulkGuardando),l(2),p("options",e._tools.optionscancelar),l(4),p("disabled",e.bulkGuardando),l(2),p("options",e._tools.optionstripleengranaje)}}var z=class z{constructor(t,e,n,o,c,m,C,E,I){this._reportes=t;this._anios=e;this._tools=n;this._planteldoc=o;this._public=c;this._auth=m;this._inst=C;this._infoest=E;this._controles=I;this.ruta=te.ruta;this.est=[];this.estRespaldo=[];this.admin=[];this.filterpost="";this.ModoSimple=!1;this.materiaId=null;this.anioId=null;this.lvlCurso=null;this.paralelo=null;this.institucionId=null;this.modo="";this.verdetallado=!1;this.esxMateria=!0;this.nameInst="";this.siglaYMateria="";this.turno="";this.visionOpciones=!1;this.requiereLogin=!1;this.tipoPerfil=null;this.puedeEditarDocentes=!1;this.mostrarCamposMusicales=!1;this.habilitarCopiaExcel=!1;this.bloqueoOtraInstitucion=!1;this.edicionDocentesActiva=!1;this.edicionDocenteActivo=null;this.docEdicionInput=new H("");this.mostrarListaDocEdicion=!1;this.docentesFiltradosEdicion=[];this.docenteOverlayTop=0;this.docenteOverlayLeft=0;this.docenteOverlayWidth=320;this.docenteOverlayAnchorEl=null;this.overlayDocentePrevState=null;this.guardandoDocenteMap={};this.conteoDocentesOkMap={};this.conteoDocentesSinModoMap={};this.InstrumentoMusicalOptions=[];this.InstrumentoMusicalSecundarioOptions=[];this.guardandoInstrumentoMap={};this.instrumentosOptionsCargando=!1;this.instrumentosOptionsCargadas=!1;this.detalleDocenteMeta=null;this.detalleDocenteRows=[];this.bulkModo=null;this.bulkEspecialidadOptions=[];this.bulkEspecialidadSelected="";this.bulkRowsCandidatos=[];this.bulkDocInput=new H("");this.bulkDocentesFiltrados=[];this.bulkDocenteSeleccionado=null;this.bulkMostrarListaDoc=!1;this.bulkSeleccionMap={};this.bulkGuardando=!1;this.bulkConteoOkMap={};this.bulkConteoSinModoMap={};this.habilitarCamposMusicales=!1;this.paginaest=1;this.isLoadingest=!0;this.AnimacionCargabtnModalest=!1;this.filtertxtest="";this.estFiltrados=[];this.collectionSizeest=0;this.pageSizeest=10;this.pageSizeOptionsest=[5,10,20,50];this.sortColumnsest=[];this.planteldocente=[];this.reportarconInstrumentos=!1;this.reportarcondocentesEspecialidad=!1;this.copiadoNombres=!1;this.copiadoEspecialidades=!1;this.copiadoSexos=!1;this.copiadoTodos=!1;this.copiadoCarnets=!1}ngOnInit(){this.materiaId=sessionStorage.getItem("HORARIOS_MATERIA_ID"),this.anioId=sessionStorage.getItem("HORARIOS_ANIO_ID"),this.lvlCurso=sessionStorage.getItem("HORARIOS_LVL_CURSO"),this.paralelo=sessionStorage.getItem("HORARIOS_PARALELO"),this.institucionId=sessionStorage.getItem("HORARIOS_INSTITUCION_ID"),this.modo=sessionStorage.getItem("HORARIOS_MODO"),this.nameInst=sessionStorage.getItem("HORARIOS_INSTITUCION_NOMBRE"),this.siglaYMateria=sessionStorage.getItem("HORARIOS_MATERIA_TITULO"),this.turno=sessionStorage.getItem("HORARIOS_TURNO"),(this.materiaId==null||this.materiaId==""||this.materiaId==null)&&(this.esxMateria=!1),this._auth.pedirPerfil().subscribe({next:t=>{if(console.log("perfil obtenido",t),!t){this.requiereLogin=!0,this.tipoPerfil=null,this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this._tools.MostrarMensaje("info","Debe iniciar sesi\xF3n para acceder a este sitio."),this.actualizarMostrarCamposMusicales();return}this.requiereLogin=!1,this.tipoPerfil=t?.tipo??null;let e=(t?.tipo??"").toString(),n=e==="superlcchs"||e==="usuarioslcchs",o=n||e==="planteladministrativos",c=e==="planteldocentes",m=e==="estudiantesifas",C=Number(t?.usuario?.instituciones_id??0),E=Number(this.institucionId??0),I=!n&&C>0&&E>0&&C!==E;this.habilitarCopiaExcel=!m,this.visionOpciones=o||c,this.puedeEditarDocentes=o,this.verdetallado=o||c,I?(this.bloqueoOtraInstitucion=!0,this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.habilitarCopiaExcel=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this._tools.MostrarMensaje("info","Est\xE1 viendo otra instituci\xF3n: se deshabilit\xF3 el detallado, impresi\xF3n y edici\xF3n de docentes.")):this.bloqueoOtraInstitucion=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.puedeEditarDocentes&&(this.CargarPlantelDocente(),this.setupBuscadorDocenteEdicion()),m?this.esxMateria?this.CargarEstudiantesMateriaPublico():this.CargarEstudiantesMezcladosMateriasPublico():(o||c)&&!I?this.esxMateria?this.CargarEstudiantesMateriaPrivado():this.CargarEstudiantesMezcladosMateriasPrivado():(this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.esxMateria?this.CargarEstudiantesMateriaPublico():this.CargarEstudiantesMezcladosMateriasPublico()),this.cargarCaractisticasInstitucionActual(this.institucionId)},error:t=>{console.error("Error al cargar",t),this.requiereLogin=!0,this.tipoPerfil=null,this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this._tools.MostrarMensaje("info","Debe iniciar sesi\xF3n para acceder a este sitio."),this.actualizarMostrarCamposMusicales()}})}setupBuscadorDocenteEdicion(){this.docEdicionInput.valueChanges.subscribe(t=>{let e=(t??"").toString();if(e===""){this.docentesFiltradosEdicion=[];return}if(e.trim()===""){this.docentesFiltradosEdicion=this.filtrarPlantelDocentes("",!0);return}this.docentesFiltradosEdicion=this.filtrarPlantelDocentes(e.toLowerCase().trim()),this.reposicionarOverlayDocentes()})}abrirOverlayDocentes(t){if(!this.puedeEditarDocentes)return;let e=t?.target??null;e&&(this.docenteOverlayAnchorEl=e,this.mostrarListaDocEdicion=!0,this.reposicionarOverlayDocentes())}reposicionarOverlayDocentes(){if(!this.mostrarListaDocEdicion||!this.docenteOverlayAnchorEl)return;let t=this.docenteOverlayAnchorEl.getBoundingClientRect(),e=window?.innerWidth??1200,n=560,o=Math.max(320,Math.min(720,e-24)),c=Math.max(n,t.width);this.docenteOverlayWidth=Math.min(o,c),this.docenteOverlayTop=t.bottom+2;let m=Math.max(0,e-this.docenteOverlayWidth-12);this.docenteOverlayLeft=Math.min(t.left,m)}salirModoEdicionDocente(){this.overlayDocentePrevState=null,this.edicionDocenteActivo=null,this.mostrarListaDocEdicion=!1,this.docentesFiltradosEdicion=[],this.docEdicionInput.setValue("",{emitEvent:!1}),this.docenteOverlayAnchorEl=null}onToggleEdicionDocentes(){if(!this.edicionDocentesActiva){this.edicionDocenteActivo=null,this.docEdicionInput.setValue("",{emitEvent:!1}),this.docentesFiltradosEdicion=[],this.mostrarListaDocEdicion=!1;return}if(!this.puedeEditarDocentes){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}if(!this.visionOpciones){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","La edici\xF3n solo est\xE1 disponible en modo privado");return}if(!this.habilitarCamposMusicales){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","Edici\xF3n disponible solo para instituciones musicales");return}}activarEdicionDocente(t,e,n){if(n&&(n.preventDefault?.(),n.stopPropagation?.()),!this.edicionDocentesActiva||!this.visionOpciones||!this.puedeEditarDocentes)return;let o=Number(t?.id??t?.info_id??0);if(!Number.isFinite(o)||o<=0){this._tools.MostrarMensaje("warning","No se pudo identificar la inscripci\xF3n (infoestudiantesifas.id)");return}this.edicionDocenteActivo={infoId:o,field:e},this.docEdicionInput.setValue("",{emitEvent:!1}),this.docentesFiltradosEdicion=[],this.mostrarListaDocEdicion=!0,this.recalcularConteoDocentes(e)}isCeldaDocenteActiva(t,e){let n=Number(t??0);return!!this.edicionDocenteActivo&&this.edicionDocenteActivo.infoId===n&&this.edicionDocenteActivo.field===e}docenteInactivo(t){return this.normalizarTexto(t?.Estado)==="INACTIVO"}getNombreCompletoDocente(t){let e=(t?.Nombres??"").toString().trim(),n=(t?.Apellidos??"").toString().trim();return`${e} ${n}`.trim()}filtrarPlantelDocentes(t,e=!1){let n=String(this.institucionId??"").trim(),o=(this.planteldocente||[]).filter(c=>!(this.normalizarTexto(c?.Visibilidad)==="OCULTO"||n&&String(c?.instituciones_id)!==n)).sort((c,m)=>this.getNombreCompletoDocente(c).localeCompare(this.getNombreCompletoDocente(m)));return e?o.slice(0,50):t?o.filter(c=>this.getNombreCompletoDocente(c).toLowerCase().includes(t)).slice(0,25):[]}recalcularConteoDocentes(t){let e={},n={};(this.est||[]).forEach(o=>{let c=Number(o?.[t]??0);if(!c)return;let m=String(c);this.tieneModoParaField(o,t)?e[m]=(e[m]??0)+1:n[m]=(n[m]??0)+1}),this.conteoDocentesOkMap=e,this.conteoDocentesSinModoMap=n}getModoFlagField(t){return t==="planteldocadmins_id"?"TieneModoEspecialidad":t==="planteldocadmins_idPC"?"TieneModoPracticaConjuntos":"TieneModoInstrumentoComplementario"}getModoLabel(t){return t==="planteldocadmins_id"?"MODO INSTRUMENTOS DE ESPECIALIDAD":t==="planteldocadmins_idPC"?"MODO PR\xC1CTICA DE CONJUNTOS":"MODO INSTRUMENTO COMPLEMENTARIO"}tieneModoParaField(t,e){let n=this.getModoFlagField(e),o=t?.[n];return o===!0||o===1||o==="1"||o==="true"}tieneModoMateria(t,e){return e?this.tieneModoParaField(t,e):!0}getConteoDocenteOk(t){let e=String(t??"");return Number(this.conteoDocentesOkMap?.[e]??0)||0}getConteoDocenteSinModo(t){let e=String(t??"");return Number(this.conteoDocentesSinModoMap?.[e]??0)||0}getConteoDocente(t){let e=String(t??"");return(Number(this.conteoDocentesOkMap?.[e]??0)||0)+(Number(this.conteoDocentesSinModoMap?.[e]??0)||0)}seleccionarDocenteEdicion(t){if(!t||this.docenteInactivo(t))return;if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes"),this.salirModoEdicionDocente(),this.edicionDocentesActiva=!1;return}if(!this.edicionDocentesActiva||!this.edicionDocenteActivo){this._tools.MostrarMensaje("warning","Seleccione una celda de docente");return}let e=Number(t?.id??0);if(!Number.isFinite(e)||e<=0)return;let n=this.edicionDocenteActivo.infoId,o=this.edicionDocenteActivo.field;this.guardarDocenteEnFila(n,o,e,t),this.salirModoEdicionDocente()}aplicarDocenteEnRowVisual(t,e,n){if(!t)return;if(!n){if(t[e]=null,e==="planteldocadmins_id"){t.Docente_Especialidad_Apellidos=null,t.Docente_Especialidad_Nombres=null,t.Docente_Especialidad_CelularTrabajo=null;return}if(e==="planteldocadmins_idPC"){t.Docente_Practica_Conjuntos_Apellidos=null,t.Docente_Practica_Conjuntos_Nombres=null,t.Docente_Practica_Conjuntos_CelularTrabajo=null;return}t.Docente_Instrumento_Complementario_Apellidos=null,t.Docente_Instrumento_Complementario_Nombres=null,t.Docente_Instrumento_Complementario_CelularTrabajo=null;return}t[e]=Number(n?.id??0)||null;let o=(n?.Apellidos??"").toString().trim(),c=(n?.Nombres??"").toString().trim(),m=(n?.CelularTrabajo??"").toString().trim();if(e==="planteldocadmins_id"){t.Docente_Especialidad_Apellidos=o||null,t.Docente_Especialidad_Nombres=c||null,t.Docente_Especialidad_CelularTrabajo=m||null;return}if(e==="planteldocadmins_idPC"){t.Docente_Practica_Conjuntos_Apellidos=o||null,t.Docente_Practica_Conjuntos_Nombres=c||null,t.Docente_Practica_Conjuntos_CelularTrabajo=m||null;return}t.Docente_Instrumento_Complementario_Apellidos=o||null,t.Docente_Instrumento_Complementario_Nombres=c||null,t.Docente_Instrumento_Complementario_CelularTrabajo=m||null}quitarDocenteEdicion(){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}if(!this.edicionDocentesActiva||!this.edicionDocenteActivo){this._tools.MostrarMensaje("warning","Seleccione una celda de docente");return}let t=this.edicionDocenteActivo.infoId,e=this.edicionDocenteActivo.field;this.guardarDocenteEnFila(t,e,null,null),this.salirModoEdicionDocente()}guardarDocenteEnFila(t,e,n,o,c=!1){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}let m=`${t}:${e}`;this.guardandoDocenteMap[m]=!0;let C={id:t};C[e]=n,this._infoest.Modificarinfoestudiantesifas(C,t,{force:c}).subscribe({next:()=>{let E=(this.est||[]).find(I=>Number(I?.id??0)===Number(t));E&&this.aplicarDocenteEnRowVisual(E,e,o),this.guardandoDocenteMap[m]=!1,this._tools.MostrarMensaje("success",n?"Docente actualizado":"Docente quitado"),this.recalcularConteoDocentes(e)},error:E=>{let I=E?.status,M=!!E?.error?.requires_confirmation,G=E?.error?.anio;if(I===409&&M){this._tools.mostrarMensajeConfirm("Inscripci\xF3n duplicada",`Ya existe una inscripci\xF3n del estudiante en esta instituci\xF3n para la gesti\xF3n ${G??"actual"}. \xBFDesea guardar igualmente?`,"warning","S\xED, guardar","No, cancelar").then(ye=>{ye?this.guardarDocenteEnFila(t,e,n,o,!0):this.guardandoDocenteMap[m]=!1});return}console.error("Error al actualizar docente",E),this.guardandoDocenteMap[m]=!1,this._tools.MostrarMensaje("error","No se pudo actualizar el docente")}})}onInstrumentoChange(t,e,n,o){if(o&&(o.preventDefault?.(),o.stopPropagation?.()),!this.edicionDocentesActiva||!this.visionOpciones||!this.puedeEditarDocentes)return;let c=Number(t?.id??t?.info_id??0);if(!Number.isFinite(c)||c<=0){this._tools.MostrarMensaje("warning","No se pudo identificar la inscripci\xF3n (infoestudiantesifas.id)");return}let m=(n??"").toString(),C=(t?.[e]??"").toString();m!==C&&this.guardarInstrumentoEnFila(c,e,m)}guardarInstrumentoEnFila(t,e,n,o=!1){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar instrumentos");return}let c=`${t}:${e}`;this.guardandoInstrumentoMap[c]=!0;let m={id:t};m[e]=n,this._infoest.Modificarinfoestudiantesifas(m,t,{force:o}).subscribe({next:()=>{let C=(this.est||[]).find(E=>Number(E?.id??0)===Number(t));C&&(C[e]=n),this.guardandoInstrumentoMap[c]=!1,this._tools.MostrarMensaje("success","Instrumento actualizado")},error:C=>{let E=C?.status,I=!!C?.error?.requires_confirmation,M=C?.error?.anio;if(E===409&&I){this._tools.mostrarMensajeConfirm("Inscripci\xF3n duplicada",`Ya existe una inscripci\xF3n del estudiante en esta instituci\xF3n para la gesti\xF3n ${M??"actual"}. \xBFDesea guardar igualmente?`,"warning","S\xED, guardar","No, cancelar").then(G=>{G?this.guardarInstrumentoEnFila(t,e,n,!0):this.guardandoInstrumentoMap[c]=!1});return}console.error("Error al actualizar instrumento",C),this.guardandoInstrumentoMap[c]=!1,this._tools.MostrarMensaje("error","No se pudo actualizar el instrumento")}})}isGuardandoInstrumento(t,e){let n=`${Number(t??0)}:${e}`;return!!this.guardandoInstrumentoMap?.[n]}isGuardandoDocente(t,e){let n=`${Number(t??0)}:${e}`;return!!this.guardandoDocenteMap?.[n]}abrirDetalleDocente(t,e){if(e&&(e.preventDefault?.(),e.stopPropagation?.()),!t)return;let n=Number(t?.id??0);if(!n)return;if(!this.modalDetalleDocente){this._tools.MostrarMensaje("error","No se encontr\xF3 el template del modal de detalle");return}let o=this.edicionDocenteActivo?.field??"planteldocadmins_id",c=this.getModoLabel(o);this.overlayDocentePrevState={mostrar:this.mostrarListaDocEdicion,anchor:this.docenteOverlayAnchorEl,top:this.docenteOverlayTop,left:this.docenteOverlayLeft,width:this.docenteOverlayWidth,inputValue:this.docEdicionInput.value,filtrados:[...this.docentesFiltradosEdicion||[]],edicionActiva:this.edicionDocentesActiva},this.mostrarListaDocEdicion=!1,this.detalleDocenteMeta={docente_id:n,docente_nombre:this.getNombreCompletoDocente(t),field:o,modo_label:c},this.detalleDocenteRows=(this.est||[]).filter(C=>Number(C?.[o]??0)===n),this.modalDetalleDocenteRef=this._tools.openModal(this.modalDetalleDocente,"xl",{scrollable:!0,windowClass:"modal-paralelos-detalle"});let m=this.overlayDocentePrevState;this.modalDetalleDocenteRef.result.finally(()=>{m&&(this.overlayDocentePrevState=null,this.puedeEditarDocentes&&(!m.edicionActiva||!this.edicionDocentesActiva||m.mostrar&&(this.docenteOverlayAnchorEl=m.anchor,this.docenteOverlayTop=m.top,this.docenteOverlayLeft=m.left,this.docenteOverlayWidth=m.width,this.docentesFiltradosEdicion=m.filtrados,this.docEdicionInput.setValue(m.inputValue??"",{emitEvent:!1}),this.mostrarListaDocEdicion=!0,this.reposicionarOverlayDocentes())))}).catch(()=>{})}closeMenu(t){if(this.overlayDocentePrevState)return;let e=t?.target;e?.closest?.("ngb-modal-window")||e?.closest?.(".modal")||e?.closest?.(".modal-backdrop")||e?.closest?.(".docente-edicion-buscador")||e?.closest?.(".docente-edicion-overlay")||this.salirModoEdicionDocente()}onResize(){this.reposicionarOverlayDocentes()}onScroll(){this.reposicionarOverlayDocentes()}onKeydown(t){t?.key==="Escape"&&this.mostrarListaDocEdicion&&(t.preventDefault(),this.salirModoEdicionDocente())}actualizarMostrarCamposMusicales(){this.mostrarCamposMusicales=!!this.habilitarCamposMusicales&&!this.requiereLogin&&this.tipoPerfil!=="estudiantesifas",this.habilitarCopiaExcel=!this.requiereLogin&&!!this.tipoPerfil&&this.tipoPerfil!=="estudiantesifas"&&!this.bloqueoOtraInstitucion,this.puedeEditarDocentes||(this.edicionDocentesActiva=!1,this.salirModoEdicionDocente())}abrirAccionesGrupales(){if(!this.puedeEditarDocentes||!this.mostrarCamposMusicales||this.bloqueoOtraInstitucion){this._tools.MostrarMensaje("info","Acciones grupales no disponibles");return}this.bulkModo=null,this.bulkEspecialidadOptions=[],this.bulkEspecialidadSelected="",this.bulkRowsCandidatos=[],this.bulkDocenteSeleccionado=null,this.bulkDocInput.setValue("",{emitEvent:!1}),this.bulkDocentesFiltrados=[],this.bulkMostrarListaDoc=!1,this.bulkSeleccionMap={},this.bulkGuardando=!1,this.bulkConteoOkMap={},this.bulkConteoSinModoMap={},this.setupBulkBuscadorDocente(),this.modalAccionesGrupalesRef=this._tools.openModal(this.modalAccionesGrupales,"xl",{scrollable:!0,windowClass:"modal-paralelos-acciones-grupales"})}setupBulkBuscadorDocente(){}getBulkField(){return this.bulkModo==="DOC_ESPECIALIDAD"?"planteldocadmins_id":this.bulkModo==="DOC_PRACTICA_CONJUNTOS"?"planteldocadmins_idPC":this.bulkModo==="DOC_INSTR_COMPLEMENTARIO"?"planteldocadmins_idOtros":null}getBulkEspecialidadField(){return this.bulkModo==="DOC_INSTR_COMPLEMENTARIO"?"InstrumentoMusicalSecundario":this.bulkModo==="DOC_ESPECIALIDAD"||this.bulkModo==="DOC_PRACTICA_CONJUNTOS"?"InstrumentoMusical":null}getBulkEspecialidadLabel(){return this.bulkModo==="DOC_INSTR_COMPLEMENTARIO"?"Instrumento Complementario":"Especialidad"}onBulkModoChange(){this.bulkDocenteSeleccionado=null,this.bulkDocInput.setValue("",{emitEvent:!1}),this.bulkDocentesFiltrados=[],this.bulkMostrarListaDoc=!1,this.bulkEspecialidadSelected="",this.bulkEspecialidadOptions=this.detectarEspecialidadesDesdeTabla(),this.bulkRowsCandidatos=[],this.bulkSeleccionMap={},this.bulkConteoOkMap={},this.bulkConteoSinModoMap={}}detectarEspecialidadesDesdeTabla(){let t=this.getBulkEspecialidadField();if(!t)return[];let e=Array.isArray(this.estFiltrados)?this.estFiltrados:[],n=new Set,o=!1;e.forEach(m=>{let C=(m?.[t]??"").toString().trim();if(!C){o=!0;return}n.add(C)});let c=Array.from(n.values()).sort((m,C)=>m.localeCompare(C));return o&&c.unshift("SIN ESPECIALIDAD"),c}onBulkEspecialidadChange(){this.bulkDocenteSeleccionado=null,this.bulkDocInput.setValue("",{emitEvent:!1}),this.bulkDocentesFiltrados=[],this.bulkMostrarListaDoc=!1;let t=this.getBulkEspecialidadField(),e=this.getBulkField();if(!t||!e){this.bulkRowsCandidatos=[],this.bulkSeleccionMap={},this.bulkConteoOkMap={},this.bulkConteoSinModoMap={};return}let n=(this.bulkEspecialidadSelected??"").toString().trim(),o=n==="SIN ESPECIALIDAD"?"":n,c=Array.isArray(this.estFiltrados)?this.estFiltrados:[];this.bulkRowsCandidatos=c.filter(I=>{let M=(I?.[t]??"").toString().trim();return o===""?M==="":M===o});let m={};this.bulkRowsCandidatos.forEach(I=>{let M=Number(I?.id??I?.info_id??0);M>0&&(m[String(M)]=!0)}),this.bulkSeleccionMap=m;let{okMap:C,sinMap:E}=this.recalcularConteoDocentesEnRows(this.bulkRowsCandidatos,e);this.bulkConteoOkMap=C,this.bulkConteoSinModoMap=E}onBulkDocInputFocus(){this.bulkMostrarListaDoc=!0,this.actualizarBulkDocentesFiltrados()}onBulkDocInputChange(){this.bulkMostrarListaDoc=!0,this.actualizarBulkDocentesFiltrados()}actualizarBulkDocentesFiltrados(){let t=(this.bulkDocInput.value??"").toString(),e=t.toLowerCase().trim();if(t===""){this.bulkDocentesFiltrados=[];return}if(e===""){this.bulkDocentesFiltrados=this.filtrarPlantelDocentes("",!0);return}this.bulkDocentesFiltrados=this.filtrarPlantelDocentes(e)}getBulkConteoDocenteOk(t){let e=String(t??"");return Number(this.bulkConteoOkMap?.[e]??0)||0}getBulkConteoDocenteSinModo(t){let e=String(t??"");return Number(this.bulkConteoSinModoMap?.[e]??0)||0}recalcularConteoDocentesEnRows(t,e){let n={},o={};return(t||[]).forEach(c=>{let m=Number(c?.[e]??0);if(!m)return;let C=String(m);this.tieneModoParaField(c,e)?n[C]=(n[C]??0)+1:o[C]=(o[C]??0)+1}),{okMap:n,sinMap:o}}seleccionarDocenteBulk(t,e){e?.preventDefault?.(),e?.stopPropagation?.(),!(!t||this.docenteInactivo(t))&&(this.bulkDocenteSeleccionado=t,this.bulkMostrarListaDoc=!1)}abrirDetalleDocenteBulk(t,e){if(e?.preventDefault?.(),e?.stopPropagation?.(),!t)return;let n=Number(t?.id??0);if(!n)return;let o=this.getBulkField()??"planteldocadmins_id",c=this.getModoLabel(o);this.detalleDocenteMeta={docente_id:n,docente_nombre:this.getNombreCompletoDocente(t),field:o,modo_label:c},this.detalleDocenteRows=(this.bulkRowsCandidatos||[]).filter(m=>Number(m?.[o]??0)===n),this.modalDetalleDocenteRef=this._tools.openModal(this.modalDetalleDocente,"xl",{scrollable:!0,windowClass:"modal-paralelos-detalle"})}getBulkSeleccionadosCount(){return Object.entries(this.bulkSeleccionMap||{}).filter(([,e])=>!!e).map(([e])=>Number(e)).filter(e=>Number.isFinite(e)&&e>0).length}getNombreDocenteEnRow(t,e){return e==="planteldocadmins_id"?`${t?.Docente_Especialidad_Apellidos??""} ${t?.Docente_Especialidad_Nombres??""}`.trim():e==="planteldocadmins_idPC"?`${t?.Docente_Practica_Conjuntos_Apellidos??""} ${t?.Docente_Practica_Conjuntos_Nombres??""}`.trim():`${t?.Docente_Instrumento_Complementario_Apellidos??""} ${t?.Docente_Instrumento_Complementario_Nombres??""}`.trim()}getRowInfoId(t){let e=Number(t?.id??t?.info_id??0);return Number.isFinite(e)?e:0}ejecutarAccionGrupal(){if(this.bulkGuardando)return;let t=this.getBulkField();if(!t){this._tools.MostrarMensaje("warning","Seleccione el tipo de columna");return}if(!this.bulkEspecialidadSelected){this._tools.MostrarMensaje("warning",`Seleccione ${this.getBulkEspecialidadLabel()}`);return}let e=Number(this.bulkDocenteSeleccionado?.id??0);if(!e){this._tools.MostrarMensaje("warning","Seleccione el docente");return}let n=Object.entries(this.bulkSeleccionMap||{}).filter(([,c])=>!!c).map(([c])=>Number(c)).filter(c=>Number.isFinite(c)&&c>0);if(n.length===0){this._tools.MostrarMensaje("warning","No hay estudiantes seleccionados");return}let o={ids:n,field:t,docente_id:e};this.bulkGuardando=!0,this._infoest.BulkUpdateDocente(o).subscribe({next:c=>{let m=this.bulkDocenteSeleccionado;(this.est||[]).forEach(C=>{let E=Number(C?.id??C?.info_id??0);n.includes(E)&&(C[t]=e,this.aplicarDocenteEnRowVisual(C,t,m))}),this.aplicarFiltroEstudiantes(),this.recalcularConteoDocentes(t),this.bulkGuardando=!1,this._tools.MostrarMensaje("success",`Actualizaci\xF3n grupal realizada (${c?.affected??n.length})`);try{this.modalAccionesGrupalesRef?.close?.("ok")}catch{}},error:c=>{console.error("Error bulk update",c),this.bulkGuardando=!1,this._tools.MostrarMensaje("error","No se pudo realizar la actualizaci\xF3n grupal")}})}cargarCaractisticasInstitucionActual(t){if(!t){this.habilitarCamposMusicales=!1,this.actualizarMostrarCamposMusicales();return}this._inst.Seleccionarinstituciones(t).subscribe({next:e=>{console.log("ins",e);var o=(e?.data?.Caractisticas??"").toString();this.habilitarCamposMusicales=this.normalizarTexto(o).includes("INSTITUTO MUSICAL"),this.actualizarMostrarCamposMusicales(),this.habilitarCamposMusicales&&this.puedeEditarDocentes&&this.cargarOptionsInstrumentosDesdeControles()},error:()=>{this.habilitarCamposMusicales=!1,this.actualizarMostrarCamposMusicales()}})}cargarOptionsInstrumentosDesdeControles(){if(this.instrumentosOptionsCargando||this.instrumentosOptionsCargadas)return;this.instrumentosOptionsCargando=!0;let t=["ESPECIALIDAD","ESPECIALIDAD SECUNDARIA"];this._controles.ObtenerOptionsSelectPorCategorias(t).subscribe({next:e=>{this.InstrumentoMusicalOptions=e?.ESPECIALIDAD||[],this.InstrumentoMusicalSecundarioOptions=e?.["ESPECIALIDAD SECUNDARIA"]||[],this.instrumentosOptionsCargando=!1,this.instrumentosOptionsCargadas=!0},error:()=>{this.InstrumentoMusicalOptions=[],this.InstrumentoMusicalSecundarioOptions=[],this.instrumentosOptionsCargando=!1,this.instrumentosOptionsCargadas=!1}})}normalizarTexto(t){return(t??"").toString().trim().toUpperCase()}onFilterTxtEstChange(){this.paginaest=1,this.aplicarFiltroEstudiantes()}normalizarBusqueda(t){let e=(t??"").toString();try{return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase()}catch{return e.trim().toUpperCase()}}textoIndexadoEstudiante(t){let e=`${t?.Ap_Paterno??""} ${t?.Ap_Materno??""}`.trim(),n=`${t?.Nombre??""}`.trim(),o=`${t?.CI??""}`.trim(),c=`${t?.Sexo??""}`.trim(),m=`${t?.InstrumentoMusical??""}`.trim();return`${e} ${n} ${o} ${c} ${m}`.trim()}aplicarFiltroEstudiantes(){let t=Array.isArray(this.est)?this.est:[],e=this.normalizarBusqueda(this.filtertxtest);e?this.estFiltrados=t.filter(n=>this.normalizarBusqueda(this.textoIndexadoEstudiante(n)).includes(e)):this.estFiltrados=t,this.collectionSizeest=this.estFiltrados.length}AnimarCargaTablaest(){this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!0}onPageSizeChangeest(){this.paginaest=1}obtenerOrdenDefaultEstudiantes(){return[{column:"Ap_Paterno",direction:"asc"},{column:"Ap_Materno",direction:"asc"},{column:"Nombre",direction:"asc"}]}aplicarOrdenEstudiantes(){let t=this.sortColumnsest&&this.sortColumnsest.length>0?this.sortColumnsest:this.obtenerOrdenDefaultEstudiantes();this.est=this._tools.applyMultiSort(this.est,t)}sortByest(t,e){this.sortColumnsest=this._tools.handleSort(t,e,this.sortColumnsest),this.est=this._tools.applyMultiSort(this.est,this.sortColumnsest),this.aplicarFiltroEstudiantes()}isSortedest(t){return this._tools.isSorted(this.sortColumnsest,t)}getSortDirest(t){return this._tools.getSortDirection(this.sortColumnsest,t)}CargarEstudiantesMateriaPublico(){this.isLoadingest=!0;let t={materiaId:this.materiaId,anioId:this.anioId};this._public.CargarEstudiantesMateriaPublico(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes publicos",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMezcladosMateriasPublico(){this.isLoadingest=!0;let t={anioId:this.anioId,LvlCurso:this.lvlCurso,Paralelo:this.paralelo,institucionId:this.institucionId};this._public.CargarEstudiantesMezcladosMateriasPublico(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes publicos",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMateriaPrivado(){this.isLoadingest=!0;let t={materiaId:this.materiaId,anioId:this.anioId};this._public.CargarEstudiantesMateriaPrivado(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes Privados",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMezcladosMateriasPrivado(){this.isLoadingest=!0;let t={anioId:this.anioId,LvlCurso:this.lvlCurso,Paralelo:this.paralelo,institucionId:this.institucionId};this._public.CargarEstudiantesMezcladosMateriasPrivado(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes Privados",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}copiarListaExcel(){if(!this.habilitarCopiaExcel){this._tools.MostrarMensaje("info","No tiene permisos para copiar esta lista");return}let t=Array.isArray(this.estFiltrados)?this.estFiltrados:[];if(t.length===0){this._tools.MostrarMensaje("info","No hay datos para copiar");return}let e=[];t.forEach(o=>{let c=`${o?.Ap_Paterno??""} ${o?.Ap_Materno??""}`.trim(),m=`${o?.Nombre??""}`.trim(),C=`${c} ${m}`.trim(),E=`${o?.CI??""}`.toString().trim(),I=`${o?.InstrumentoMusical??""}`.trim(),M=this.normalizarBusqueda(o?.Sexo??""),G=M.startsWith("F")||M.includes("FEM"),it=M.startsWith("M")||M.includes("MASC")?"X":"",nt=G?"X":"";e.push([C,E,I,it,nt].join("	"))});let n=e.join(`
`);this.copiarTextoPortapapeles(n).then(()=>this._tools.MostrarMensaje("success",`Copiado para Excel (${t.length} filas)`)).catch(()=>this._tools.MostrarMensaje("error","No se pudo copiar al portapapeles"))}copiarTextoPortapapeles(t){let e=window?.navigator;return e?.clipboard?.writeText?e.clipboard.writeText(t):new Promise((n,o)=>{try{let c=document.createElement("textarea");c.value=t,c.style.position="fixed",c.style.left="-10000px",c.style.top="0",document.body.appendChild(c),c.focus(),c.select();let m=document.execCommand("copy");document.body.removeChild(c),m?n():o()}catch{o()}})}CargarPlantelDocente(){this._planteldoc.Obtenerplanteldocentes().subscribe({next:t=>{console.log("plateldoc",t),this.planteldocente=t.data??[]},error:t=>{console.error("Error al cargar",t)}})}GenerarQRDocente(t,e){console.log(t+" "+e),this._reportes.GeneradorQRDinamico("QR DEL NUMERO DE CELULAR DE "+t,"Numero de Celular de Trabajo: "+e,e)}GenerarReporteListaEstudiantes(){this._reportes.GenerarListaAlumnos2026(this.est,this.anioId,this.lvlCurso,this.paralelo,this.institucionId,this.modo,this.materiaId,this.reportarconInstrumentos,this.reportarcondocentesEspecialidad)}AccionCopiarNombres(){var t="";this.est.forEach(e=>{var n=e.Ap_Paterno+" "+e.Ap_Materno+" "+e.Nombre;t=t+n+`
`}),this.copyText(t),this.copiadoNombres=!0,setTimeout(()=>{this.copiadoNombres=!1},1500)}AccionCopiarEspecialidades(){var t="";this.est.forEach(e=>{var n=e.Especialidad;t=t+n+`
`}),this.copyText(t),this.copiadoEspecialidades=!0,setTimeout(()=>{this.copiadoEspecialidades=!1},1500)}AccionCopiarSexos(){var t="";this.est.forEach(e=>{var n=e.Sexo;t=t+n+`
`}),this.copyText(t),this.copiadoSexos=!0,setTimeout(()=>{this.copiadoSexos=!1},1500)}AccionCopiarTodos(){var t="";this.est.forEach(e=>{var n=e.CI,o=e.Especialidad,c=e.Sexo,m=e.Ap_Paterno+" "+e.Ap_Materno+" "+e.Nombre;c=="FEMENINO"?t=t+m+"	"+n+"	"+o+`		X
`:t=t+m+"	"+n+"	"+o+`	X	
`}),this.copyText(t),this.copiadoTodos=!0,setTimeout(()=>{this.copiadoTodos=!1},1500)}AccionCopiarCarnets(){var t="";this.est.forEach(e=>{var n=e.CI;t=t+n+`
`}),this.copyText(t),this.copiadoCarnets=!0,setTimeout(()=>{this.copiadoCarnets=!1},1500)}copyText(t){let e=document.createElement("textarea");e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.opacity="0",e.value=t,document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.copy=!0,setTimeout(()=>{this.copy=!1},2e3)}};z.\u0275fac=function(e){return new(e||z)(S(Xe),S(pe),S(de),S(Ze),S(me),S(ce),S(se),S(et),S(qe))},z.\u0275cmp=Y({type:z,selectors:[["app-paralelos"]],viewQuery:function(e,n){if(e&1&&(Ce(Jt,7),Ce(Kt,7)),e&2){let o;ve(o=be())&&(n.modalDetalleDocente=o.first),ve(o=be())&&(n.modalAccionesGrupales=o.first)}},hostBindings:function(e,n){e&1&&f("click",function(c){return n.closeMenu(c)},he)("resize",function(){return n.onResize()},fe)("scroll",function(){return n.onScroll()},fe)("keydown",function(c){return n.onKeydown(c)},he)},standalone:!1,decls:7,vars:2,consts:[["loginRequerido",""],["modalDetalleDocente",""],["modalAccionesGrupales",""],["editDocAdmin",""],["editDocPC",""],["editDocOtros",""],["editInstrumentoMusical",""],["editInstrumentoMusicalSec",""],[4,"ngIf","ngIfElse"],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"fw-bold",2,"color","blue"],[2,"color","brown"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"w-100"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"ngModelChange","ngModel"],["class","form-check form-switch mt-2 paralelos-switch",4,"ngIf"],[1,"paralelos-actions","mt-2"],["class","btn mouse-dir secondary d-flex align-items-center","style","gap: 8px;",3,"click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style","gap: 8px;",3,"click",4,"ngIf"],["class","paralelos-inline-switches",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],["title","Docente de Especialidad","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Docente de Pr\xE1ctica de Conjuntos","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Docente de Instrumento Complementario","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Instrumento Complementario","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["class","text-center",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],["class","docente-edicion-overlay list-group",3,"top","left","width",4,"ngIf"],[1,"form-check","form-switch","mt-2","paralelos-switch"],["type","checkbox","role","switch","id","chkEdicionDocentes",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","chkEdicionDocentes",1,"form-check-label","fw-semibold","text-dark"],[1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"paralelos-btn-icon"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"paralelos-inline-switches"],[1,"form-check","form-switch","text-dark","fw-semibold"],["type","checkbox","role","switch","id","reportarconInstrumentosxd",1,"form-check-input",3,"ngModelChange","ngModel"],["for","reportarconInstrumentosxd",1,"form-check-label"],["type","checkbox","role","switch","id","reportarcondocentesEspecialidadxd",1,"form-check-input",3,"ngModelChange","ngModel"],["for","reportarcondocentesEspecialidadxd",1,"form-check-label"],[1,"bi",3,"ngClass"],["title","Docente de Especialidad",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Docente de Pr\xE1ctica de Conjuntos",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Docente de Instrumento Complementario",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Instrumento Complementario",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],["class","small text-muted",4,"ngIf"],["class","small text-muted","title","Cantidad de asignaciones",4,"ngIf"],["class","docente-cell","style","min-width: 240px;",3,"docente-cell-editable","docente-cell-active","click",4,"ngIf"],["style","min-width: 210px;",4,"ngIf"],[1,"small","text-muted"],["title","Cantidad de asignaciones",1,"small","text-muted"],[1,"docente-cell",2,"min-width","240px",3,"click"],["target","_blank","title","CONTACTARSE",1,"btn","mouse-dir","success","btn-sm","d-inline-flex","align-items-center",2,"gap","6px",3,"href"],["target","_blank","title","CONTACTARSE",1,"btn","mouse-dir","success","btn-sm","d-inline-flex","align-items-center",2,"gap","6px",3,"click","href"],["width","34px","height","34px",3,"options"],[1,"docente-edicion-buscador","position-relative"],["type","text","placeholder","Buscar docente...",1,"form-control","form-control-sm",3,"focus","click","keydown.escape","formControl"],["class","small text-muted mt-1",4,"ngIf"],[1,"small","text-muted","mt-1"],[2,"min-width","210px"],[1,"form-floating","paralelos-floating"],[1,"form-select","form-select-sm",3,"click","ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],[3,"ngValue","disabled"],[1,"docente-edicion-overlay","list-group"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngIf"],["class","list-group-item text-muted",4,"ngIf"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"disabled","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"fw-semibold","text-truncate"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],[1,"list-group-item","text-muted"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"click"],[1,"me-2"],[1,"fw-semibold"],[1,"text-muted"],["class","text-danger fw-semibold",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"text-danger","fw-semibold"],["role","alert",1,"alert","alert-warning","text-center"],[1,"modal-header"],[1,"modal-title"],[1,"text-muted","small"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"table-responsive",2,"max-height","65vh"],[1,"table","table-sm","table-striped","align-middle"],[1,"text-center",2,"width","40px"],[1,"text-center",2,"width","140px"],[1,"text-center",2,"width","120px"],[1,"text-center",2,"width","70px"],[1,"text-center",2,"width","90px"],[1,"text-center",2,"width","110px"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"badge","bg-success"],[1,"badge","bg-danger"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-select",3,"ngModelChange","change","ngModel"],[1,"form-select",3,"ngModelChange","change","ngModel","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Buscar docente...",1,"form-control",3,"focus","input","formControl","disabled"],["class","list-group mt-2",4,"ngIf"],["class","small text-muted mt-2",4,"ngIf"],[1,"my-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"table-responsive","mt-2",2,"max-height","55vh"],[2,"width","120px"],[2,"width","160px"],["type","button",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click","disabled"],["type","button",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click","disabled"],[3,"value"],[1,"list-group","mt-2"],[1,"small","text-muted","mt-2"],["colspan","4",1,"text-center","text-muted"],["type","checkbox",1,"form-check-input","paralelos-check",3,"ngModelChange","ngModel"]],template:function(e,n){if(e&1&&_(0,un,57,26,"ng-container",8)(1,gn,3,0,"ng-template",null,0,V)(3,vn,42,4,"ng-template",null,1,V)(5,An,71,22,"ng-template",null,2,V),e&2){let o=R(2);p("ngIf",!n.requiereLogin)("ngIfElse",o)}},dependencies:[Oe,Z,ee,re,le,ie,Re,ae,ne,oe,Ve,Ue],styles:['@charset "UTF-8";[_nghost-%COMP%]     .docente-edicion-overlay{position:fixed;z-index:1040;max-height:520px;overflow:auto;box-shadow:0 6px 18px #0000001f;border-radius:.5rem;background:#fff}[_nghost-%COMP%]     .docente-edicion-overlay .list-group-item{padding-top:.6rem;padding-bottom:.6rem}[_nghost-%COMP%]     .docente-edicion-overlay .list-group-item>.me-2{flex:1;min-width:0}[_nghost-%COMP%]     .docente-edicion-overlay .fw-semibold{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]     .modal.modal-paralelos-detalle{z-index:1060}[_nghost-%COMP%]     .modal.modal-paralelos-detalle .modal-content{min-height:220px}[_nghost-%COMP%]     .modal.modal-paralelos-detalle .modal-body{overflow:auto}[_nghost-%COMP%]     .docente-edicion-buscador .list-group-item.disabled{pointer-events:none;opacity:.6}[_nghost-%COMP%]     td.docente-cell{position:relative;overflow:visible}[_nghost-%COMP%]     .paralelos-actions{display:flex;flex-wrap:wrap;align-items:center;gap:10px}[_nghost-%COMP%]     .paralelos-btn-icon{display:flex;align-items:center;justify-content:center;width:30px;height:30px}[_nghost-%COMP%]     a.btn.mouse-dir.success.btn-sm{padding-top:.25rem;padding-bottom:.25rem}[_nghost-%COMP%]     a.btn.mouse-dir.success.btn-sm .paralelos-btn-icon{width:26px;height:26px}[_nghost-%COMP%]     .paralelos-inline-switches{display:flex;flex-wrap:wrap;gap:14px;align-items:center}[_nghost-%COMP%]     .paralelos-switch .form-check-input, [_nghost-%COMP%]     .paralelos-inline-switches .form-check-input{cursor:pointer}[_nghost-%COMP%]     .paralelos-check.form-check-input{cursor:pointer;transform:scale(1.15);transform-origin:center}[_nghost-%COMP%]     td.docente-cell.docente-cell-editable{cursor:pointer;background-color:rgba(var(--bs-warning-rgb),.08);box-shadow:inset 0 0 0 1px rgba(var(--bs-warning-rgb),.35);transition:background-color .12s ease,box-shadow .12s ease}[_nghost-%COMP%]     td.docente-cell.docente-cell-editable:hover{background-color:rgba(var(--bs-warning-rgb),.12);box-shadow:0 0 0 .18rem rgba(var(--bs-warning-rgb),.22)}[_nghost-%COMP%]     td.docente-cell.docente-cell-active{background-color:rgba(var(--bs-warning-rgb),.16);box-shadow:0 0 0 .22rem rgba(var(--bs-warning-rgb),.26)}[_nghost-%COMP%]     .paralelos-floating{min-height:44px}[_nghost-%COMP%]     .paralelos-floating>.form-select{padding-top:1.25rem;padding-bottom:.35rem}[_nghost-%COMP%]     .paralelos-floating>label{padding-top:.4rem;padding-bottom:.2rem;font-size:.78rem;opacity:.8}']});var ue=z;var On=[{path:"inicio",component:Ye},{path:"horarios",component:_e},{path:"paralelos",component:ue},{path:"planteldocentes",loadComponent:()=>import("./chunk-I2R62I57.js").then(i=>i.Planteldocentes)},{path:"planteladministrativos",loadComponent:()=>import("./chunk-2H46O45I.js").then(i=>i.Planteladministrativos)},{path:"eventos",loadComponent:()=>import("./chunk-7YEFKE47.js").then(i=>i.EventosPublicosComponent)},{path:"eventos/:id",loadComponent:()=>import("./chunk-7K74B5BD.js").then(i=>i.EventoInscripcionComponent)}],B=class B{};B.\u0275fac=function(e){return new(e||B)},B.\u0275mod=J({type:B}),B.\u0275inj=Q({imports:[W.forChild(On),W]});var ge=B;var U=class U{};U.\u0275fac=function(e){return new(e||U)},U.\u0275mod=J({type:U}),U.\u0275inj=Q({imports:[Te,je,Be,ge,Qe,$e,Ge,ze,W,Je,Ke]});var tt=U;export{tt as PublicosModule};
