import{a as E}from"./chunk-NCIXDP2C.js";import{e as O,h as A,k as L}from"./chunk-LEW5N4EV.js";import{b as K}from"./chunk-YB5XT4DU.js";import"./chunk-OXGEW5OA.js";import{c as R,e as f,f as $,g as q,h as g,j as s,l as j,o as G,p as B,q as H,r as J,s as Q,t as U,y as z}from"./chunk-TKGN7DBU.js";import{a as V}from"./chunk-5RMZ5E5A.js";import{Ea as r,Ec as T,Fc as D,Lb as l,Ma as C,Mb as _,Nb as P,Nc as k,Ob as h,Ra as w,Wa as p,Yb as x,ga as S,ha as b,ib as a,jb as o,kb as n,lb as d,sb as M,vb as N,xb as m}from"./chunk-SGF3PIFW.js";import{a as I,b as F}from"./chunk-GG76335P.js";var Y=()=>["/publicos/eventos"],X=()=>[];function Z(t,i){t&1&&(o(0,"div",5),l(1,"Cargando..."),n())}function ee(t,i){t&1&&(o(0,"div",6),l(1,"Evento no disponible."),n())}function te(t,i){if(t&1&&(o(0,"span"),l(1),n()),t&2){let e=m(2);r(),P("\xB7 ",e.evento==null?null:e.evento.Lugar)}}function ne(t,i){if(t&1&&(o(0,"div",27)(1,"h6"),l(2,"Descripci\xF3n"),n(),o(3,"div",30),l(4),n()()),t&2){let e=m(2);r(4),_(e.evento==null?null:e.evento.Descripcion)}}function ie(t,i){if(t&1&&(o(0,"div",27)(1,"h6"),l(2,"Requisitos"),n(),o(3,"div",30),l(4),n()()),t&2){let e=m(2);r(4),_(e.evento==null?null:e.evento.Requisitos)}}function oe(t,i){if(t&1&&(o(0,"div",27)(1,"h6"),l(2,"Pago"),n(),o(3,"div",5),l(4),n(),o(5,"small",31),l(6,"El estado de pago se registra como PENDIENTE."),n()()),t&2){let e=m(2);r(4),h("Monto: ",e.evento==null?null:e.evento.Monto," ",(e.evento==null?null:e.evento.Moneda)||"BS")}}function re(t,i){if(t&1&&(o(0,"div",27)(1,"div",32),l(2," Registro enviado. ID de inscripci\xF3n: "),o(3,"strong"),l(4),n()()()),t&2){let e=m(2);r(4),_(e.enviadoId)}}function ae(t,i){if(t&1&&d(0,"input",42),t&2){let e=m().$implicit,c=m(5);a("type",e.type||"text")("formControl",c.dynamicForm.get(e.key))}}function le(t,i){if(t&1&&d(0,"textarea",43),t&2){let e=m().$implicit,c=m(5);a("formControl",c.dynamicForm.get(e.key))}}function ce(t,i){if(t&1&&(o(0,"option",45),l(1),n()),t&2){let e=i.$implicit;a("ngValue",e),r(),_(e)}}function me(t,i){if(t&1&&(o(0,"select",44)(1,"option",45),l(2,"--"),n(),p(3,ce,2,2,"option",46),n()),t&2){let e=m().$implicit,c=m(5);a("formControl",c.dynamicForm.get(e.key)),r(),a("ngValue",""),r(2),a("ngForOf",e.options||x(3,X))}}function de(t,i){if(t&1&&(o(0,"div",17)(1,"label",18),l(2),n(),p(3,ae,1,2,"input",39)(4,le,1,1,"textarea",40)(5,me,4,4,"select",41),n()),t&2){let e=i.$implicit;r(2),_(e.label||e.key),r(),a("ngIf",!e.type||e.type==="text"||e.type==="number"||e.type==="date"),r(),a("ngIf",e.type==="textarea"),r(),a("ngIf",e.type==="select")}}function pe(t,i){if(t&1&&(o(0,"div",35)(1,"div",36)(2,"strong"),l(3),n()(),o(4,"div",10)(5,"div",37),p(6,de,6,4,"div",38),n()()()),t&2){let e=i.$implicit;r(3),_(e.title),r(3),a("ngForOf",e.fields)}}function se(t,i){if(t&1&&(o(0,"div"),p(1,pe,7,2,"div",34),n()),t&2){let e=m(3);r(),a("ngForOf",e.dynamicPhases)}}function ve(t,i){if(t&1&&d(0,"input",42),t&2){let e=m().$implicit,c=m(4);a("type",e.type||"text")("formControl",c.dynamicForm.get(e.key))}}function _e(t,i){if(t&1&&d(0,"textarea",43),t&2){let e=m().$implicit,c=m(4);a("formControl",c.dynamicForm.get(e.key))}}function fe(t,i){if(t&1&&(o(0,"option",45),l(1),n()),t&2){let e=i.$implicit;a("ngValue",e),r(),_(e)}}function ue(t,i){if(t&1&&(o(0,"select",44)(1,"option",45),l(2,"--"),n(),p(3,fe,2,2,"option",46),n()),t&2){let e=m().$implicit,c=m(4);a("formControl",c.dynamicForm.get(e.key)),r(),a("ngValue",""),r(2),a("ngForOf",e.options||x(3,X))}}function xe(t,i){if(t&1&&(o(0,"div",17)(1,"label",18),l(2),n(),p(3,ve,1,2,"input",39)(4,_e,1,1,"textarea",40)(5,ue,4,4,"select",41),n()),t&2){let e=i.$implicit;r(2),_(e.label||e.key),r(),a("ngIf",!e.type||e.type==="text"||e.type==="number"||e.type==="date"),r(),a("ngIf",e.type==="textarea"),r(),a("ngIf",e.type==="select")}}function ge(t,i){if(t&1&&(o(0,"div",37),p(1,xe,6,4,"div",38),n()),t&2){let e=m(3);r(),a("ngForOf",e.dynamicFields)}}function ye(t,i){if(t&1&&(o(0,"div",27),d(1,"hr"),o(2,"h6"),l(3,"Informaci\xF3n adicional"),n(),p(4,se,2,1,"div",12)(5,ge,2,1,"div",33),n()),t&2){let e=m(2);r(4),a("ngIf",e.dynamicPhases.length>0),r(),a("ngIf",e.dynamicPhases.length===0&&e.dynamicFields.length>0)}}function Ce(t,i){if(t&1&&(o(0,"div",27),d(1,"hr"),o(2,"h6"),l(3,"Pago (opcional)"),n(),o(4,"form",16)(5,"div",23)(6,"label",18),l(7,"M\xE9todo de pago"),n(),d(8,"input",47),n(),o(9,"div",23)(10,"label",18),l(11,"Fecha de pago"),n(),d(12,"input",48),n(),o(13,"div",49)(14,"label",18),l(15,"Comprobante (URL/ruta)"),n(),d(16,"input",50),n()()()),t&2){let e=m(2);r(4),a("formGroup",e.frm)}}function he(t,i){if(t&1){let e=M();o(0,"div",7)(1,"div",8)(2,"div",9)(3,"div",10)(4,"h3",11),l(5),n(),o(6,"div",5),l(7),p(8,te,2,1,"span",12),n(),p(9,ne,5,1,"div",13)(10,ie,5,1,"div",13)(11,oe,7,2,"div",13)(12,re,5,1,"div",13),n()()(),o(13,"div",14)(14,"div",9)(15,"div",10)(16,"h5",15),l(17,"Formulario de inscripci\xF3n"),n(),o(18,"form",16)(19,"div",17)(20,"label",18),l(21,"Apellido paterno"),n(),d(22,"input",19),n(),o(23,"div",17)(24,"label",18),l(25,"Apellido materno"),n(),d(26,"input",20),n(),o(27,"div",21)(28,"label",18),l(29,"Nombres"),n(),d(30,"input",22),n(),o(31,"div",23)(32,"label",18),l(33,"Carnet"),n(),d(34,"input",24),n(),o(35,"div",17)(36,"label",18),l(37,"Celular"),n(),d(38,"input",25),n(),o(39,"div",17)(40,"label",18),l(41,"Correo"),n(),d(42,"input",26),n()(),p(43,ye,6,2,"div",13)(44,Ce,17,1,"div",13),o(45,"div",27),d(46,"hr"),o(47,"label",18),l(48,"Observaci\xF3n"),n(),d(49,"textarea",28),n(),o(50,"div",27)(51,"button",29),N("click",function(){S(e);let v=m();return b(v.enviar())}),l(52,"Enviar inscripci\xF3n"),n()()()()()()}if(t&2){let e=m();r(5),_(e.evento==null?null:e.evento.NombreEvento),r(2),h("",e.evento==null?null:e.evento.Anio," \xB7 ",e.evento==null?null:e.evento.ModoInscripcion," "),r(),a("ngIf",e.evento==null?null:e.evento.Lugar),r(),a("ngIf",e.evento==null?null:e.evento.Descripcion),r(),a("ngIf",e.evento==null?null:e.evento.Requisitos),r(),a("ngIf",(e.evento==null?null:e.evento.TienePago)==1),r(),a("ngIf",e.enviadoId),r(6),a("formGroup",e.frm),r(25),a("ngIf",e.dynamicPhases.length>0||e.dynamicFields.length>0),r(),a("ngIf",e.tienePago)}}var u=class u{constructor(i,e){this.route=i;this._tools=e;this.ruta=V.ruta;this.eventoId=null;this.evento=null;this.isLoading=!1;this.frm=new g({Ap_Paterno:new s("",[f.required]),Ap_Materno:new s("",[f.required]),Nombres:new s("",[f.required]),Carnet:new s("",[f.required]),Celular:new s(""),Correo:new s(""),MetodoPago:new s(""),FechaPago:new s(""),ComprobantePago:new s(""),Observacion:new s("")});this.schema=null;this.dynamicForm=new g({});this.dynamicPhases=[];this.dynamicFields=[];this.enviadoId=null}ngOnInit(){let i=Number(this.route.snapshot.paramMap.get("id")??0);if(this.eventoId=i>0?i:null,!this.eventoId){this._tools.MostrarMensaje("warning","Evento inv\xE1lido");return}this.cargarEvento(this.eventoId)}parseSchema(i){let e=(i??"").toString().trim();if(!e)return null;try{return JSON.parse(e)}catch{return null}}addControlForField(i){let e=(i?.key??"").toString().trim();if(!e)return;let c=i?.required?[f.required]:[];this.dynamicForm.addControl(e,new s("",c))}buildDynamicForm(i){if(this.dynamicForm=new g({}),this.dynamicPhases=[],this.dynamicFields=[],!i)return;let e=i?.phases??[];if(e.length>0){this.dynamicPhases=e.map(v=>({title:(v?.title??"Fase").toString(),fields:(v?.fields??[]).filter(y=>!!y?.key)}));for(let v of this.dynamicPhases)for(let y of v.fields)this.addControlForField(y);return}let c=(i?.fields??[]).filter(v=>!!v?.key);this.dynamicFields=c;for(let v of c)this.addControlForField(v)}cargarEvento(i){this.isLoading=!0,E.get(this.ruta+"api/public/eventos/"+i).then(e=>{this.evento=e?.data?.data??null,this.schema=this.parseSchema(this.evento?.InputsEspecial),this.buildDynamicForm(this.schema),this.isLoading=!1}).catch(()=>{this.evento=null,this.isLoading=!1,this._tools.MostrarMensaje("error","No se pudo cargar el evento")})}get tienePago(){return this.evento?.TienePago==1}enviar(){if(this.frm.invalid||this.dynamicForm.invalid){this._tools.MostrarMensajeFrmIncompleto();return}if(!this.eventoId)return;let i=F(I({},this.frm.value),{DatosEspeciales:this.dynamicForm.value});this.tienePago||(i.MetodoPago="",i.FechaPago="",i.ComprobantePago=""),this._tools.MostrarMensajeLoading(),E.post(this.ruta+"api/public/eventos/"+this.eventoId+"/inscripcion",i).then(e=>{this.enviadoId=e?.data?.data?.id??null,this._tools.MostrarMensajeSuccess()}).catch(e=>{let c=e?.response?.data?.error??"No se pudo registrar";this._tools.MostrarMensaje("error",c)})}};u.\u0275fac=function(e){return new(e||u)(C(O),C(K))},u.\u0275cmp=w({type:u,selectors:[["app-evento-inscripcion"]],decls:6,vars:5,consts:[[1,"container-fluid"],[1,"btn","btn-link","px-0","mb-2",3,"routerLink"],["class","text-muted",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","row g-3",4,"ngIf"],[1,"text-muted"],[1,"alert","alert-danger"],[1,"row","g-3"],[1,"col-lg-5"],[1,"card"],[1,"card-body"],[1,"mb-1"],[4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"col-lg-7"],[1,"mb-3"],[1,"row","g-2",3,"formGroup"],[1,"col-md-6"],[1,"form-label"],["formControlName","Ap_Paterno",1,"form-control"],["formControlName","Ap_Materno",1,"form-control"],[1,"col-md-8"],["formControlName","Nombres",1,"form-control"],[1,"col-md-4"],["formControlName","Carnet",1,"form-control"],["formControlName","Celular",1,"form-control"],["formControlName","Correo",1,"form-control"],[1,"mt-3"],["rows","2","formControlName","Observacion",1,"form-control"],[1,"btn","btn-primary","w-100",3,"click"],[1,"text-muted",2,"white-space","pre-wrap"],[1,"text-muted","d-block"],[1,"alert","alert-success","mb-0"],["class","row g-2",4,"ngIf"],["class","card mb-2",4,"ngFor","ngForOf"],[1,"card","mb-2"],[1,"card-header","py-2"],[1,"row","g-2"],["class","col-md-6",4,"ngFor","ngForOf"],["class","form-control",3,"type","formControl",4,"ngIf"],["class","form-control","rows","2",3,"formControl",4,"ngIf"],["class","form-select",3,"formControl",4,"ngIf"],[1,"form-control",3,"type","formControl"],["rows","2",1,"form-control",3,"formControl"],[1,"form-select",3,"formControl"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","MetodoPago","placeholder","QR / Dep\xF3sito / Efectivo",1,"form-control"],["type","date","formControlName","FechaPago",1,"form-control"],[1,"col-md-12"],["formControlName","ComprobantePago",1,"form-control"]],template:function(e,c){e&1&&(o(0,"div",0)(1,"a",1),l(2,"\u2190 Volver a eventos"),n(),p(3,Z,2,0,"div",2)(4,ee,2,0,"div",3)(5,he,53,11,"div",4),n()),e&2&&(r(),a("routerLink",x(4,Y)),r(2),a("ngIf",c.isLoading),r(),a("ngIf",!c.isLoading&&!c.evento),r(),a("ngIf",!c.isLoading&&c.evento))},dependencies:[k,T,D,L,A,z,j,Q,U,R,J,$,q,G,B,H],styles:[".card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{line-height:1.1}"]});var W=u;export{W as EventoInscripcionComponent};
