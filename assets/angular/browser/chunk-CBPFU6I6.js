import{a as xe}from"./chunk-5YOBPPYD.js";import{a as fe}from"./chunk-YBOEBBAE.js";import{a as T}from"./chunk-XDAG4MPO.js";import{b as ge}from"./chunk-P4K6CI26.js";import{a as ue,b as ve}from"./chunk-NHQGIU22.js";import{b as _e}from"./chunk-KCTZUZJH.js";import{e as ne,g as ae,h as re,k as oe}from"./chunk-PWQJWZZZ.js";import"./chunk-5VY7FQQV.js";import{c as le,f as ce,k as se,m as de,u as pe,x as me}from"./chunk-ROSYCBC4.js";import{a as h}from"./chunk-JISGPZ2J.js";import{$b as U,Aa as j,Dc as X,Ea as n,F as x,Fc as Z,Gb as Q,Gc as ee,Hb as Y,Ib as J,Lb as l,Ma as y,Mb as w,Mc as te,Nb as u,Ob as L,Oc as ie,Ra as W,Tb as O,U as b,Ub as D,Vb as R,Wa as m,Yc as V,Z as A,Zb as M,_b as K,ac as B,ba as F,dc as q,fc as z,ga as v,ha as g,i as f,ib as o,jb as r,kb as a,lb as p,sb as k,vb as I,w as H,xb as d}from"./chunk-SPNCLBHB.js";import"./chunk-GG76335P.js";var C=class C{constructor(t){this.http=t;this.base=`${h.apiUrl}${h.apiRoutes.lchaula.base}`}getById(t){return this.http.get(`${this.base}/tareas/${t}`).pipe(T())}update(t,e){return this.http.put(`${this.base}/tareas/${t}`,e).pipe(T())}};C.\u0275fac=function(e){return new(e||C)(F(V))},C.\u0275prov=A({token:C,factory:C.\u0275fac,providedIn:"root"});var $=C;var S=class S{constructor(t){this.http=t;this.base=`${h.apiUrl}${h.apiRoutes.lchaula.base}`}listByTarea(t){return this.http.get(`${this.base}/tareas/${t}/entregas`).pipe(T())}submit(t,e){return this.http.post(`${this.base}/tareas/${t}/entregar`,e).pipe(T())}calificar(t,e){return this.http.post(`${this.base}/entregas/${t}/calificar`,e).pipe(T())}};S.\u0275fac=function(e){return new(e||S)(F(V))},S.\u0275prov=A({token:S,factory:S.\u0275fac,providedIn:"root"});var N=S;var Ie=i=>["/lchaula/aula",i],ye=()=>({standalone:!0}),we=(i,t,e)=>({"bg-success-subtle text-success":i,"bg-warning-subtle text-warning":t,"bg-secondary-subtle text-secondary":e}),he=()=>[],Pe=(i,t)=>({"bg-success text-white":i,"bg-warning text-dark":t}),ke=(i,t)=>({"bi-check-circle":i,"bi-hourglass-split":t}),Me=(i,t,e)=>({"bg-success":i,"bg-warning":t,"bg-danger":e});function Ae(i,t){i&1&&(r(0,"div",4),p(1,"app-spinner-local",5),a())}function Fe(i,t){if(i&1&&(r(0,"a",33),p(1,"i",34),a()),i&2){let e=d(2);o("routerLink",K(1,Ie,e.tarea.publicacion.aulas_virtuales_id))}}function je(i,t){if(i&1&&(r(0,"span"),l(1),a()),i&2){let e=d(3);n(),u(" - ",e.tarea.publicacion.aula.materia_curso)}}function Oe(i,t){if(i&1&&(r(0,"span"),l(1),a()),i&2){let e=d(3);n(),u(" ",e.tarea.publicacion.aula.materia_paralelo)}}function De(i,t){if(i&1&&(r(0,"span"),l(1),a()),i&2){let e=d(3);n(),u(" (",e.tarea.publicacion.aula.materia_turno,")")}}function Re(i,t){if(i&1&&(r(0,"span",35),p(1,"i",36),l(2),m(3,je,2,1,"span",3)(4,Oe,2,1,"span",3)(5,De,2,1,"span",3),a()),i&2){let e=d(2);n(2),u("",e.tarea.publicacion.aula.materia_nombre," "),n(),o("ngIf",e.tarea.publicacion.aula.materia_curso),n(),o("ngIf",e.tarea.publicacion.aula.materia_paralelo),n(),o("ngIf",e.tarea.publicacion.aula.materia_turno)}}function Ve(i,t){if(i&1&&(r(0,"span",37),p(1,"i",38),l(2),a()),i&2){let e=d(2);n(2),u("Fecha l\xEDmite: ",e.formatFecha(e.tarea.fecha_entrega)," ")}}function $e(i,t){if(i&1&&(r(0,"span"),l(1),a()),i&2){let e=d(3);n(),u("(",e.tarea.limite_tardia_horas,"h)")}}function Ne(i,t){if(i&1&&(r(0,"span",39),p(1,"i",40),l(2,"Entrega tardia permitida "),m(3,$e,2,1,"span",3),a()),i&2){let e=d(2);n(3),o("ngIf",e.tarea==null?null:e.tarea.limite_tardia_horas)}}function Le(i,t){if(i&1&&p(0,"quill-editor",41),i&2){let e=d(2);o("ngModel",e.tarea.publicacion.descripcion)("modules",e.modulesQuillShow)("readOnly",!0)("ngModelOptions",M(4,ye))}}function Ue(i,t){i&1&&(r(0,"div",42),l(1," Sin descripcion. "),a())}function Be(i,t){i&1&&(r(0,"div",28)(1,"div",48),p(2,"i",49),r(3,"div",50),l(4,"Ningun estudiante ha entregado aun."),a()()())}function qe(i,t){i&1&&(r(0,"div",75),p(1,"i",76),a())}function ze(i,t){if(i&1&&p(0,"img",77),i&2){let e=d().$implicit,c=d(4);o("src",c.publicBaseUrl+e.estudiante_foto,j)}}function Ge(i,t){if(i&1&&(r(0,"span",78),l(1),a()),i&2){let e=d().$implicit;n(),u("(Estudiante ID: ",e.infoestudiantesifas_id,")")}}function He(i,t){if(i&1&&(r(0,"span"),l(1),a()),i&2){let e=d().$implicit;n(),u("Reentregas: ",e.numero_reentrega)}}function We(i,t){if(i&1&&(r(0,"div",82),l(1),a()),i&2){let e=d(2).$implicit;n(),u(" ",e.calificacion.comentario_docente," ")}}function Qe(i,t){if(i&1&&(r(0,"div",79)(1,"div",80),l(2),a(),m(3,We,2,1,"div",81),a()),i&2){let e=d().$implicit,c=d(4);n(2),L(" ",e.calificacion.puntaje_obtenido," / ",c.tarea==null?null:c.tarea.puntaje_maximo," "),n(),o("ngIf",e.calificacion.comentario_docente)}}function Ye(i,t){if(i&1&&(r(0,"div",83)(1,"div",84),p(2,"i",85),l(3,"Comentario:"),a(),r(4,"div",86),l(5),a()()),i&2){let e=d().$implicit;n(5),w(e.comentario_estudiante)}}function Je(i,t){if(i&1&&(r(0,"a",90),p(1,"i",91),r(2,"span",92),l(3),a(),p(4,"i",93),a()),i&2){let e=t.$implicit,c=d(6);o("href",c.publicBaseUrl+((e==null||e.archivo==null?null:e.archivo.ruta)||""),j),n(3),w((e==null||e.archivo==null?null:e.archivo.nombre_original)||"archivo")}}function Ke(i,t){if(i&1&&(r(0,"div",83)(1,"div",84),p(2,"i",87),l(3,"Archivos adjuntos:"),a(),r(4,"div",88),m(5,Je,5,2,"a",89),a()()),i&2){let e=d().$implicit,c=d(4);n(5),o("ngForOf",c.archivosEntregaDocente[e.id])}}function Xe(i,t){i&1&&(r(0,"div",83)(1,"div",94),p(2,"i",87),l(3,"Sin archivos adjuntos"),a()())}function Ze(i,t){if(i&1){let e=k();r(0,"div",52)(1,"div",53),m(2,qe,2,0,"div",54)(3,ze,1,1,"img",55),r(4,"div",10)(5,"div",56),l(6),m(7,Ge,2,1,"span",57),a(),r(8,"div",58)(9,"span"),p(10,"i",59),l(11),a(),r(12,"span",60),l(13),a(),m(14,He,2,1,"span",3),a()(),m(15,Qe,4,3,"div",61),a(),m(16,Ye,6,1,"div",62)(17,Ke,6,1,"div",62)(18,Xe,4,0,"div",62),r(19,"div",63)(20,"div",64)(21,"div",65)(22,"div",66)(23,"input",67),R("ngModelChange",function(s){let _=v(e).$implicit,E=d(4);return D(E.califForm[_.id].puntaje,s)||(E.califForm[_.id].puntaje=s),g(s)}),a(),r(24,"label",68),l(25,"Puntaje"),a()()(),r(26,"div",69)(27,"div",66)(28,"input",70),R("ngModelChange",function(s){let _=v(e).$implicit,E=d(4);return D(E.califForm[_.id].comentario,s)||(E.califForm[_.id].comentario=s),g(s)}),a(),r(29,"label",68),l(30,"Feedback (opcional)"),a()()(),r(31,"div",65)(32,"button",71),I("click",function(){let s=v(e).$implicit,_=d(4);return g(_.calificar(s.id))}),p(33,"i",72),l(34," Calificar "),a()()(),r(35,"div",73),p(36,"i",74),l(37,"Esta calificacion es solo referencial, no afecta el registro oficial. "),a()()()}if(i&2){let e=t.$implicit,c=t.index,s=d(4);J("bg-light",c%2===0),n(2),o("ngIf",!(e!=null&&e.estudiante_foto)),n(),o("ngIf",e==null?null:e.estudiante_foto),n(3),L(" ",(e==null?null:e.estudiante_nombres)||""," ",(e==null?null:e.estudiante_apellidos)||""," "),n(),o("ngIf",!(e!=null&&e.estudiante_nombres)),n(4),w(s.formatFecha(e.fecha_entrega)||"Sin fecha"),n(),o("ngClass",B(22,we,e.estado==="ENTREGADO",e.estado==="PENDIENTE",e.estado!=="ENTREGADO"&&e.estado!=="PENDIENTE")),n(),u(" ",e.estado," "),n(),o("ngIf",e.numero_reentrega),n(),o("ngIf",e==null?null:e.calificacion),n(),o("ngIf",e.comentario_estudiante),n(),o("ngIf",(s.archivosEntregaDocente[e.id]||M(26,he)).length>0),n(),o("ngIf",(s.archivosEntregaDocente[e.id]||M(27,he)).length===0),n(5),o("id","puntaje_"+e.id),O("ngModel",s.califForm[e.id].puntaje),o("max",s.tarea==null?null:s.tarea.puntaje_maximo),n(),o("for","puntaje_"+e.id),n(4),o("id","feedback_"+e.id),O("ngModel",s.califForm[e.id].comentario),n(),o("for","feedback_"+e.id)}}function et(i,t){if(i&1&&(r(0,"div"),m(1,Ze,38,28,"div",51),a()),i&2){let e=d(3);n(),o("ngForOf",e.entregas)}}function tt(i,t){if(i&1&&(r(0,"div",43)(1,"div",44)(2,"h5",26),p(3,"i",45),l(4,"Entregas de estudiantes"),a(),r(5,"span",46),l(6),a()(),m(7,Be,5,0,"div",47)(8,et,2,1,"div",3),a()),i&2){let e=d(2);n(6),w(e.entregas.length),n(),o("ngIf",e.entregas.length===0),n(),o("ngIf",e.entregas.length>0)}}function it(i,t){if(i&1&&(r(0,"div",73),l(1),a()),i&2){let e=d(5);n(),u(' "',e.entregaPropia.calificacion.comentario_docente,'" ')}}function nt(i,t){if(i&1&&(r(0,"div",108)(1,"div",82),l(2,"Tu calificacion"),a(),r(3,"div",109),l(4),r(5,"span",110),l(6),a()(),m(7,it,2,1,"div",111),r(8,"div",112),p(9,"i",74),l(10,"Calificacion referencial "),a()()),i&2){let e=d(4);n(4),u(" ",e.entregaPropia.calificacion.puntaje_obtenido," "),n(2),u("/ ",e.tarea==null?null:e.tarea.puntaje_maximo),n(),o("ngIf",e.entregaPropia.calificacion.comentario_docente)}}function at(i,t){if(i&1&&(r(0,"div",101)(1,"div",106)(2,"span",35),p(3,"i",59),l(4),a(),r(5,"span",35),l(6),a()(),m(7,nt,11,3,"div",107),a()),i&2){let e=d(3);n(4),u("",e.formatFecha(e.entregaPropia.fecha_entrega)||"Sin fecha"," "),n(2),u(" Reentregas: ",e.entregaPropia.numero_reentrega||0," "),n(),o("ngIf",e.entregaPropia==null?null:e.entregaPropia.calificacion)}}function rt(i,t){i&1&&(r(0,"div",113),p(1,"i",74),l(2,"Aun no has entregado esta tarea. "),a())}function ot(i,t){i&1&&(r(0,"div",125),l(1," Sin archivos subidos. "),a())}function lt(i,t){if(i&1&&(r(0,"a",133),p(1,"i",91),r(2,"span",134),l(3),a()()),i&2){let e=d().$implicit,c=d(5);o("href",c.publicBaseUrl+e.archivo.ruta,j),n(3),w((e==null||e.archivo==null?null:e.archivo.nombre_original)||"archivo")}}function ct(i,t){if(i&1&&(r(0,"span",82),l(1),q(2,"number"),a()),i&2){let e=d().$implicit;n(),u(" ",z(2,1,e.archivo.tamano/1024/1024,"1.1-1")," MB ")}}function st(i,t){if(i&1){let e=k();r(0,"div",128),m(1,lt,4,2,"a",129),r(2,"span",130),m(3,ct,3,4,"span",81),r(4,"button",131),I("click",function(){let s=v(e).$implicit,_=d(5);return g(_.deleteArchivoEntrega(s.archivo.id))}),p(5,"i",132),a()()()}if(i&2){let e=t.$implicit;n(),o("ngIf",e==null||e.archivo==null?null:e.archivo.ruta),n(2),o("ngIf",e==null||e.archivo==null?null:e.archivo.tamano)}}function dt(i,t){if(i&1&&(r(0,"div",126),m(1,st,6,2,"div",127),a()),i&2){let e=d(4);n(),o("ngForOf",e.archivosEntrega)}}function pt(i,t){if(i&1){let e=k();r(0,"div")(1,"div",114)(2,"div",115),p(3,"i",87),l(4,"Tus archivos"),a(),r(5,"span",116),l(6),q(7,"number"),a()(),r(8,"div",117),p(9,"div",118),a(),m(10,ot,2,0,"div",119)(11,dt,2,1,"div",120),r(12,"div",121)(13,"div",122),I("dragover",function(s){v(e);let _=d(3);return g(_.onDragOver(s))})("dragleave",function(s){v(e);let _=d(3);return g(_.onDragLeave(s))})("drop",function(s){v(e);let _=d(3);return g(_.onDropEntrega(_.entregaPropia.id,s))})("click",function(){v(e);let s=Q(20);return g(s.click())}),p(14,"i",123),r(15,"div",73),l(16,"Arrastra archivos aqui o haz clic para seleccionar"),a(),r(17,"div",82),l(18,"Maximo 20 MB en total"),a()(),r(19,"input",124,0),I("change",function(s){v(e);let _=d(3);return g(_.onUploadEntregaFiles(_.entregaPropia.id,s))}),a()()()}if(i&2){let e=d(3);n(6),u(" ",z(7,6,e.getUploadSizeMB(),"1.1-1")," / 20 MB "),n(3),Y("width",e.getUploadPercent(),"%"),o("ngClass",B(9,Me,e.getUploadPercent()<70,e.getUploadPercent()>=70&&e.getUploadPercent()<90,e.getUploadPercent()>=90)),n(),o("ngIf",e.archivosEntrega.length===0),n(),o("ngIf",e.archivosEntrega.length>0)}}function mt(i,t){if(i&1){let e=k();r(0,"div",95)(1,"div",96)(2,"div",97)(3,"h5",26),p(4,"i",98),l(5),a()(),r(6,"div",28),m(7,at,8,3,"div",99)(8,rt,3,0,"div",100),r(9,"div",101)(10,"label",102),l(11,"Tu comentario (opcional)"),a(),r(12,"quill-editor",103),R("ngModelChange",function(s){v(e);let _=d(2);return D(_.comentarioEntrega,s)||(_.comentarioEntrega=s),g(s)}),a()(),r(13,"button",104),I("click",function(){v(e);let s=d(2);return g(s.submitEntrega())}),p(14,"i",105),l(15),a(),m(16,pt,21,13,"div",3),a()()()}if(i&2){let e=d(2);n(2),o("ngClass",U(10,Pe,(e.entregaPropia==null?null:e.entregaPropia.estado)==="ENTREGADO",!e.entregaPropia||(e.entregaPropia==null?null:e.entregaPropia.estado)!=="ENTREGADO")),n(2),o("ngClass",U(13,ke,(e.entregaPropia==null?null:e.entregaPropia.estado)==="ENTREGADO",!e.entregaPropia||(e.entregaPropia==null?null:e.entregaPropia.estado)!=="ENTREGADO")),n(),u(" ",(e.entregaPropia==null?null:e.entregaPropia.estado)==="ENTREGADO"?"Entregado":"Tu trabajo"," "),n(2),o("ngIf",e.entregaPropia),n(),o("ngIf",!e.entregaPropia),n(4),O("ngModel",e.comentarioEntrega),o("ngModelOptions",M(16,ye))("modules",e.modulesQuillEdicion),n(3),u(" ",e.entregaPropia?"Reentregar":"Entregar tarea"," "),n(),o("ngIf",e.entregaPropia)}}function _t(i,t){if(i&1&&(r(0,"div")(1,"div",6)(2,"div",7)(3,"div",8),m(4,Fe,2,3,"a",9),r(5,"div",10)(6,"div",11)(7,"span",12),p(8,"i",13),l(9,"TAREA"),a(),m(10,Re,6,4,"span",14),a(),r(11,"h1",15),l(12),a()()(),r(13,"div",16),m(14,Ve,3,1,"span",17),r(15,"span",18),p(16,"i",19),l(17),a(),m(18,Ne,4,1,"span",20),a(),p(19,"hr",21),a()(),r(20,"div",22)(21,"div",23)(22,"div",24)(23,"div",25)(24,"h5",26),p(25,"i",27),l(26,"Instrucciones"),a()(),r(27,"div",28),m(28,Le,1,5,"quill-editor",29)(29,Ue,2,0,"div",30),a()(),m(30,tt,9,3,"div",31),a(),m(31,mt,17,17,"div",32),a()()),i&2){let e=d();n(4),o("ngIf",e.tarea==null||e.tarea.publicacion==null?null:e.tarea.publicacion.aulas_virtuales_id),n(6),o("ngIf",e.tarea==null||e.tarea.publicacion==null||e.tarea.publicacion.aula==null?null:e.tarea.publicacion.aula.materia_nombre),n(2),u(" ",(e.tarea==null||e.tarea.publicacion==null?null:e.tarea.publicacion.titulo)||"Tarea #"+(e.tarea==null?null:e.tarea.id)," "),n(2),o("ngIf",e.tarea==null?null:e.tarea.fecha_entrega),n(3),u("Puntaje max: ",e.tarea==null?null:e.tarea.puntaje_maximo," "),n(),o("ngIf",e.tarea==null?null:e.tarea.permitir_entrega_tardia),n(10),o("ngIf",e.tarea==null||e.tarea.publicacion==null?null:e.tarea.publicacion.descripcion),n(),o("ngIf",!(!(e.tarea==null||e.tarea.publicacion==null)&&e.tarea.publicacion.descripcion)),n(),o("ngIf",e.isAdminLike),n(),o("ngIf",!e.isAdminLike)}}var P=class P{constructor(t,e,c,s,_,E,G){this.route=t;this.tareasService=e;this.entregasService=c;this.archivosService=s;this.auth=_;this.toast=E;this.router=G;this.publicBaseUrl=h.ruta||h.apiUrl||"";this.loading=!1;this.tareaId=0;this.isAdminLike=!1;this.tarea=null;this.entregas=[];this.comentarioEntrega="";this.entregaPropia=null;this.archivosEntrega=[];this.archivosEntregaDocente={};this.modulesQuillEdicion={toolbar:[["bold","italic","underline","strike"],[{align:[]}],[{size:["small",!1,"large"]}],[{color:[]},{background:[]}],[{font:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","video"],["clean"]]};this.modulesQuillShow={toolbar:!1};this.califForm={}}ngOnInit(){if(this.tareaId=Number(this.route.snapshot.paramMap.get("id")||0),!this.tareaId){this.toast.error("Tarea invalida");return}this.auth.revisarSiesAdmin().subscribe({next:t=>{this.isAdminLike=t,this.load()},error:()=>{this.isAdminLike=!1,this.load()}})}load(){this.loading=!0,this.tareasService.getById(this.tareaId).pipe(b(t=>this.tarea=t),x(t=>(this.loading=!1,t.status===403||t.status===401?(this.toast.error("No tienes acceso a esta tarea"),this.router.navigate(["/inicio"])):this.toast.error(t.message),f))).subscribe(()=>this.loadEntregas())}loadEntregas(){this.entregasService.listByTarea(this.tareaId).pipe(b(t=>{this.entregas=t,this.loading=!1,this.isAdminLike?(this.entregaPropia=null,this.archivosEntrega=[],this.entregas.forEach(e=>this.loadArchivosEntregaDocente(e.id))):(this.entregaPropia=this.entregas.length>0?this.entregas[0]:null,this.entregaPropia&&this.loadArchivosEntrega(this.entregaPropia.id)),this.entregas.forEach(e=>{if(!this.califForm[e.id]){let c=e?.calificacion;this.califForm[e.id]={puntaje:c?.puntaje_obtenido??null,comentario:c?.comentario_docente??""}}})}),x(t=>(this.loading=!1,this.toast.error(t.message),f))).subscribe()}submitEntrega(){this.entregasService.submit(this.tareaId,{comentario_estudiante:this.comentarioEntrega}).pipe(b(t=>{this.toast.success("Entrega registrada"),this.entregaPropia=t,this.comentarioEntrega="",this.loadEntregas()}),x(t=>(this.toast.error(t.message),f))).subscribe()}calificar(t){let e={puntaje_obtenido:this.califForm[t]?.puntaje,comentario_docente:this.califForm[t]?.comentario};this.entregasService.calificar(t,e).pipe(b(()=>{this.toast.success("Calificacion guardada"),this.loadEntregas()}),x(c=>(this.toast.error(c.message),f))).subscribe()}loadArchivosEntrega(t){this.archivosService.list("ENTREGA",t).pipe(b(e=>this.archivosEntrega=e),x(()=>f)).subscribe()}onUploadEntregaFiles(t,e){let c=e.target;if(!c.files||c.files.length===0)return;let s=Array.from(c.files);this.uploadEntregaFiles(t,s),c.value=""}uploadEntregaFiles(t,e){let c=e.map(s=>this.archivosService.upload(s,"ENTREGA",t));H(c).pipe(b(()=>{this.toast.success(e.length+" archivo(s) subido(s)"),this.loadArchivosEntrega(t)}),x(s=>(this.toast.error(s.message||"Error al subir. Verifica el limite de 20MB."),this.loadArchivosEntrega(t),f))).subscribe()}onDragOver(t){t.preventDefault(),t.stopPropagation(),t.currentTarget?.classList.add("drop-zone-active")}onDragLeave(t){t.preventDefault(),t.stopPropagation(),t.currentTarget?.classList.remove("drop-zone-active")}onDropEntrega(t,e){e.preventDefault(),e.stopPropagation(),e.currentTarget?.classList.remove("drop-zone-active");let c=e.dataTransfer?.files;c&&c.length>0&&this.uploadEntregaFiles(t,Array.from(c))}formatFecha(t){if(!t)return"";let e=new Date(t);if(isNaN(e.getTime()))return String(t);let c=String(e.getDate()).padStart(2,"0"),s=String(e.getMonth()+1).padStart(2,"0"),_=e.getFullYear(),E=String(e.getHours()).padStart(2,"0"),G=String(e.getMinutes()).padStart(2,"0");return`${c}/${s}/${_} ${E}:${G}`}getUploadSizeMB(){let t=0;return this.archivosEntrega.forEach(e=>{e?.archivo?.tamano&&(t+=Number(e.archivo.tamano))}),t/(1024*1024)}getUploadPercent(){return Math.min(100,this.getUploadSizeMB()/20*100)}deleteArchivoEntrega(t){if(!confirm("\xBFEliminar este archivo?"))return;let e=this.entregaPropia?.id;this.archivosService.deleteArchivo(t).pipe(b(()=>{this.toast.success("Archivo eliminado"),e&&this.loadArchivosEntrega(e)}),x(c=>(this.toast.error(c.message||"Error al eliminar archivo"),f))).subscribe()}loadArchivosEntregaDocente(t){this.archivosService.list("ENTREGA",t).pipe(b(e=>this.archivosEntregaDocente[t]=e),x(()=>f)).subscribe()}};P.\u0275fac=function(e){return new(e||P)(y(ne),y($),y(N),y(xe),y(_e),y(ge),y(ae))},P.\u0275cmp=W({type:P,selectors:[["app-lchaula-tarea"]],decls:3,vars:2,consts:[["entregaFileInput",""],[1,"container","mt-4"],["class","py-4 text-black",4,"ngIf"],[4,"ngIf"],[1,"py-4","text-black"],["textShow","Cargando tarea..."],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","align-items-center","gap-3","mb-2"],["class","btn btn-sm btn-outline-secondary rounded-circle","title","Volver al aula",3,"routerLink",4,"ngIf"],[1,"flex-grow-1"],[1,"d-flex","align-items-center","gap-2","mb-1"],[1,"badge","bg-warning","text-dark"],[1,"bi","bi-journal-check","me-1"],["class","badge bg-light text-dark border",4,"ngIf"],[1,"display-6","fw-bold","titulosGlobales","mb-0"],[1,"d-flex","flex-wrap","gap-2","ms-5","ps-2"],["class","badge bg-danger-subtle text-danger border",4,"ngIf"],[1,"badge","bg-warning-subtle","text-warning","border"],[1,"bi","bi-star","me-1"],["class","badge bg-info-subtle text-info border",4,"ngIf"],[1,"mt-3","mb-0"],[1,"row","g-4"],[1,"col-12","col-lg-8"],[1,"card","shadow-sm","border-0"],[1,"card-header","bg-light","border-0"],[1,"mb-0"],[1,"bi","bi-file-text","me-2"],[1,"card-body"],["class","quill-readonly-wrapper",3,"ngModel","modules","readOnly","ngModelOptions",4,"ngIf"],["class","text-muted",4,"ngIf"],["class","card shadow-sm border-0 mt-4",4,"ngIf"],["class","col-12 col-lg-4",4,"ngIf"],["title","Volver al aula",1,"btn","btn-sm","btn-outline-secondary","rounded-circle",3,"routerLink"],[1,"bi","bi-arrow-left"],[1,"badge","bg-light","text-dark","border"],[1,"bi","bi-book","me-1"],[1,"badge","bg-danger-subtle","text-danger","border"],[1,"bi","bi-calendar-event","me-1"],[1,"badge","bg-info-subtle","text-info","border"],[1,"bi","bi-clock-history","me-1"],[1,"quill-readonly-wrapper",3,"ngModel","modules","readOnly","ngModelOptions"],[1,"text-muted"],[1,"card","shadow-sm","border-0","mt-4"],[1,"card-header","bg-light","border-0","d-flex","align-items-center","justify-content-between"],[1,"bi","bi-people","me-2"],[1,"badge","bg-primary"],["class","card-body",4,"ngIf"],[1,"text-center","py-4"],[1,"bi","bi-inbox","display-4","text-muted","opacity-50"],[1,"text-muted","mt-2"],["class","border-bottom p-3",3,"bg-light",4,"ngFor","ngForOf"],[1,"border-bottom","p-3"],[1,"d-flex","align-items-center","gap-3","mb-3"],["class",`student-avatar rounded-circle bg-primary-subtle text-primary
                            d-flex align-items-center justify-content-center flex-shrink-0`,4,"ngIf"],["class","student-avatar rounded-circle object-fit-cover flex-shrink-0","alt","foto",3,"src",4,"ngIf"],[1,"fw-bold"],["class","text-muted fw-normal",4,"ngIf"],[1,"d-flex","flex-wrap","gap-2","small","text-muted"],[1,"bi","bi-clock","me-1"],[1,"badge",3,"ngClass"],["class","text-end",4,"ngIf"],["class","mb-3 ms-5 ps-2",4,"ngIf"],[1,"ms-5","ps-2"],[1,"row","g-2","align-items-end"],[1,"col-md-3"],[1,"form-floating"],["type","number","placeholder","Puntaje",1,"form-control","form-control-sm",3,"ngModelChange","id","ngModel","max"],[3,"for"],[1,"col-md-6"],["type","text","placeholder","Feedback",1,"form-control","form-control-sm",3,"ngModelChange","id","ngModel"],[1,"btn","btn-success","w-100",3,"click"],[1,"bi","bi-check-lg","me-1"],[1,"small","text-muted","mt-1"],[1,"bi","bi-info-circle","me-1"],[1,"student-avatar","rounded-circle","bg-primary-subtle","text-primary","d-flex","align-items-center","justify-content-center","flex-shrink-0"],[1,"bi","bi-person-fill",2,"font-size","1.3rem"],["alt","foto",1,"student-avatar","rounded-circle","object-fit-cover","flex-shrink-0",3,"src"],[1,"text-muted","fw-normal"],[1,"text-end"],[1,"badge","bg-success","fs-6"],["class","text-muted small",4,"ngIf"],[1,"text-muted","small"],[1,"mb-3","ms-5","ps-2"],[1,"small","text-muted","mb-1"],[1,"bi","bi-chat-left-text","me-1"],[1,"small","bg-white","rounded","p-2","border"],[1,"bi","bi-paperclip","me-1"],[1,"d-flex","flex-wrap","gap-2"],["class","btn btn-sm btn-outline-secondary d-inline-flex align-items-center gap-1","target","_blank","rel","noopener",3,"href",4,"ngFor","ngForOf"],["target","_blank","rel","noopener",1,"btn","btn-sm","btn-outline-secondary","d-inline-flex","align-items-center","gap-1",3,"href"],[1,"bi","bi-file-earmark"],[1,"text-truncate",2,"max-width","180px"],[1,"bi","bi-download"],[1,"small","text-muted"],[1,"col-12","col-lg-4"],[1,"card","shadow-sm","border-0","sticky-top",2,"top","1rem"],[1,"card-header","border-0",3,"ngClass"],[1,"bi","me-2",3,"ngClass"],["class","mb-3",4,"ngIf"],["class","alert alert-light border small mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label","small","text-muted"],["placeholder","Escribe un comentario...",1,"quill-container-wrapper",3,"ngModelChange","ngModel","ngModelOptions","modules"],[1,"btn","btn-primary","w-100","mb-3",3,"click"],[1,"bi","bi-send","me-1"],[1,"d-flex","flex-wrap","gap-2","small"],["class","mt-3 p-3 bg-success-subtle rounded-3 text-center",4,"ngIf"],[1,"mt-3","p-3","bg-success-subtle","rounded-3","text-center"],[1,"display-6","fw-bold","text-success"],[1,"fs-5","text-muted"],["class","small text-muted mt-1",4,"ngIf"],[1,"text-muted","small","mt-2"],[1,"alert","alert-light","border","small","mb-3"],[1,"d-flex","align-items-center","justify-content-between","mb-2"],[1,"fw-semibold","small"],[1,"badge","bg-light","text-dark","border","small"],[1,"progress","mb-2",2,"height","6px"],[1,"progress-bar",3,"ngClass"],["class","text-muted small mb-2",4,"ngIf"],["class","list-group list-group-flush mb-2",4,"ngIf"],[1,"mt-2"],[1,"drop-zone","p-3","text-center","rounded-3",3,"dragover","dragleave","drop","click"],[1,"bi","bi-cloud-arrow-up","fs-4","text-primary"],["type","file","multiple","",1,"d-none",3,"change"],[1,"text-muted","small","mb-2"],[1,"list-group","list-group-flush","mb-2"],["class","list-group-item px-0 d-flex align-items-center justify-content-between",4,"ngFor","ngForOf"],[1,"list-group-item","px-0","d-flex","align-items-center","justify-content-between"],["target","_blank","rel","noopener","class","text-truncate text-decoration-none d-flex align-items-center gap-1",3,"href",4,"ngIf"],[1,"d-flex","align-items-center","gap-2"],["title","Eliminar archivo",1,"btn","btn-sm","btn-outline-danger","px-1","py-0",3,"click"],[1,"bi","bi-trash"],["target","_blank","rel","noopener",1,"text-truncate","text-decoration-none","d-flex","align-items-center","gap-1",3,"href"],[1,"text-truncate",2,"max-width","160px"]],template:function(e,c){e&1&&(r(0,"div",1),m(1,Ae,2,0,"div",2)(2,_t,32,10,"div",3),a()),e&2&&(n(),o("ngIf",c.loading),n(),o("ngIf",!c.loading&&c.tarea))},dependencies:[ie,X,Z,ee,me,le,de,ce,pe,se,oe,re,fe,ve,ue,te],styles:["[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #dee2e6;cursor:pointer;transition:border-color .2s,background-color .2s}.drop-zone[_ngcontent-%COMP%]:hover{border-color:var(--bs-primary);background-color:rgba(var(--bs-primary-rgb),.04)}.drop-zone-active[_ngcontent-%COMP%]{border-color:var(--bs-primary)!important;background-color:rgba(var(--bs-primary-rgb),.08)!important}.student-avatar[_ngcontent-%COMP%]{width:44px;height:44px;min-width:44px}.quill-readonly-wrapper[_ngcontent-%COMP%]     .ql-container{border:none!important}.quill-readonly-wrapper[_ngcontent-%COMP%]     .ql-editor{padding:0;min-height:auto}.quill-container-wrapper[_ngcontent-%COMP%]     .ql-toolbar{border-radius:.375rem .375rem 0 0}.quill-container-wrapper[_ngcontent-%COMP%]     .ql-container{border-radius:0 0 .375rem .375rem;min-height:80px}"]});var Ee=P;export{Ee as TareaComponent};
