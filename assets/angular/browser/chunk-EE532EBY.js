import{a as ne,b as tt}from"./chunk-B3ZFSLO6.js";import{a as wt}from"./chunk-DUXQYQIP.js";import{a as Te}from"./chunk-5EUTDLE7.js";import{a as St}from"./chunk-BDYLTSXV.js";import{a as Ie}from"./chunk-X2UZLZXS.js";import{b as ee}from"./chunk-A5M3HUGQ.js";import{b as Mt}from"./chunk-2XFHIHYO.js";import{b as te}from"./chunk-OXONTOT5.js";import{a as Et,b as yt}from"./chunk-X5D4Q5JT.js";import{k as dt}from"./chunk-2UZ5XJOB.js";import{b as ie}from"./chunk-5XGECW57.js";import{g as Ae}from"./chunk-3IGMLI3N.js";import{c as Se,e as F,f as Q,g as Ee,h as Ze,j as O,k as Y,l as ye,m as et,o as bt,p as Me,q as we,r as J,s as X,t as Z}from"./chunk-F4JB6MJU.js";import{a as Xe}from"./chunk-5RMZ5E5A.js";import{Ab as me,Ac as U,Ba as ve,Bb as pe,Ca as s,Cc as q,Dc as K,Eb as qe,Ec as Ce,F as ce,Gb as Ke,Gc as he,Jb as c,Ka as E,Kb as v,Kc as be,Lb as S,Lc as ht,Mb as ue,Nb as Ct,Pa as H,Qa as Ue,Qb as y,Rb as M,Rc as Ye,Sa as vt,Sb as w,Ua as g,Vc as Je,Wb as Qe,Xb as ct,Yb as b,Z as ze,_ as He,_a as B,ac as N,ba as We,bc as R,dc as W,ec as $,ga as p,gb as l,ha as u,hb as n,ib as o,jb as x,k as se,nb as st,ob as lt,q as le,qb as C,tb as f,vb as m,w as $e,za as j,zb as de}from"./chunk-4IB5NCLX.js";import{a as ae,b as Be,m as at}from"./chunk-GG76335P.js";var Ft=["modalgestioncarreras"],z=(a,i)=>({"bi-caret-up":a,"bi-caret-down":i}),kt=(a,i)=>({top:a,left:i});function Lt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m(2);l("ngClass",b(1,z,e.getSortDircarreras("NombreInstitucion")==="asc",e.getSortDircarreras("NombreInstitucion")==="desc"))}}function Gt(a,i){if(a&1){let e=C();n(0,"th",23),f("click",function(r){p(e);let d=m();return u(d.sortBycarreras("NombreInstitucion",r))}),c(1," Instituci\xF3n "),g(2,Lt,1,4,"i",24),o()}if(a&2){let e=m();s(2),l("ngIf",e.isSortedcarreras("NombreInstitucion"))}}function jt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("NombreCarrera")==="asc",e.getSortDircarreras("NombreCarrera")==="desc"))}}function Bt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Area")==="asc",e.getSortDircarreras("Area")==="desc"))}}function $t(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Mencion")==="asc",e.getSortDircarreras("Mencion")==="desc"))}}function zt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Resolucion")==="asc",e.getSortDircarreras("Resolucion")==="desc"))}}function Ht(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Nivel")==="asc",e.getSortDircarreras("Nivel")==="desc"))}}function Wt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("HorasTotales")==="asc",e.getSortDircarreras("HorasTotales")==="desc"))}}function Ut(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Visibilidad")==="asc",e.getSortDircarreras("Visibilidad")==="desc"))}}function qt(a,i){if(a&1&&x(0,"i",32),a&2){let e=m();l("ngClass",b(1,z,e.getSortDircarreras("Estado")==="asc",e.getSortDircarreras("Estado")==="desc"))}}function Kt(a,i){if(a&1&&(n(0,"tr")(1,"td",21)(2,"div",33)(3,"span",34),c(4,"Cargando..."),o()()()()),a&2){let e=m();s(),B("colspan",e.esSuperAdmin?11:10)}}function Qt(a,i){if(a&1&&(n(0,"tr")(1,"td",21),c(2,"No hay datos disponibles"),o()()),a&2){let e=m();s(),B("colspan",e.esSuperAdmin?11:10)}}function Yt(a,i){if(a&1&&(n(0,"td"),c(1),o()),a&2){let e=m().$implicit;s(),v(e.NombreInstitucion)}}function Jt(a,i){if(a&1&&x(0,"img",41),a&2){let e=m(2);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function Xt(a,i){if(a&1&&x(0,"ng-lottie",42),a&2){let e=m(2);l("options",e._tools.optionsEditar)}}function Zt(a,i){if(a&1&&x(0,"img",41),a&2){let e=m(2);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function ei(a,i){if(a&1&&x(0,"ng-lottie",42),a&2){let e=m(2);l("options",e._tools.optionsEliminar)}}function ti(a,i){if(a&1){let e=C();n(0,"tr",35),f("contextmenu",function(r){let d=p(e).$implicit,_=m();return u(_.abrirMenucarreras(r,d))}),n(1,"td",21),c(2),o(),g(3,Yt,2,1,"td",25),n(4,"td"),c(5),o(),n(6,"td"),c(7),o(),n(8,"td"),c(9),o(),n(10,"td"),c(11),o(),n(12,"td"),c(13),o(),n(14,"td"),c(15),o(),n(16,"td"),c(17),o(),n(18,"td"),c(19),o(),n(20,"td",36)(21,"button",37),f("click",function(){let r=p(e).$implicit,d=m();return u(d.Seleccionarcarreras(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m();return u(d._tools.hoverBotonMap["edicioncarreras-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m();return u(d._tools.hoverBotonMap["edicioncarreras-"+r.id]=!1)}),g(22,Jt,1,1,"img",38)(23,Xt,1,1,"ng-lottie",39),o(),n(24,"button",40),f("click",function(){let r=p(e).$implicit,d=m();return u(d.Eliminarcarreras(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m();return u(d._tools.hoverBotonMap["eliminacioncarreras-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m();return u(d._tools.hoverBotonMap["eliminacioncarreras-"+r.id]=!1)}),g(25,Zt,1,1,"img",38)(26,ei,1,1,"ng-lottie",39),o()()()}if(a&2){let e=i.index,t=i.$implicit,r=m();s(2),v((r.paginacarreras-1)*r.pageSizecarreras+(e+1)),s(),l("ngIf",r.esSuperAdmin),s(2),v(t.NombreCarrera),s(2),v(t.Area),s(2),v(t.Mencion),s(2),v(t.Resolucion),s(2),v(t.Nivel),s(2),v(t.HorasTotales),s(2),v(t.Visibilidad),s(2),v(t.Estado),s(3),l("ngIf",!r._tools.hoverBotonMap["edicioncarreras-"+t.id]),s(),l("ngIf",r._tools.hoverBotonMap["edicioncarreras-"+t.id]),s(2),l("ngIf",!r._tools.hoverBotonMap["eliminacioncarreras-"+t.id]),s(),l("ngIf",r._tools.hoverBotonMap["eliminacioncarreras-"+t.id])}}function ii(a,i){if(a&1&&(n(0,"option",43),c(1),o()),a&2){let e=i.$implicit;l("value",e),s(),S("",e," por p\xE1gina")}}function ni(a,i){if(a&1&&(n(0,"option",43),c(1),o()),a&2){let e=i.$implicit;l("value",e.id),s(),v(e.Nombre)}}function oi(a,i){if(a&1&&(n(0,"div",84)(1,"select",85),g(2,ni,2,2,"option",30),o(),n(3,"label"),c(4,"Instituci\xF3n"),o(),n(5,"div",52),c(6,"Este campo es obligatorio*"),o()()),a&2){let e=m(2);s(),l("ngClass",e.ValidacioncarrerasxElemento("instituciones_id")),s(),l("ngForOf",e.instituciones)}}function ri(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function ai(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function si(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function li(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function ci(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function di(a,i){if(a&1&&(n(0,"option",86),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function mi(a,i){if(a&1){let e=C();n(0,"button",89),f("click",function(){p(e);let r=m(3);return u(r.AutoCompletarLastcarreras())}),n(1,"span",8),x(2,"ng-lottie",9),o(),n(3,"span"),c(4,"AUTO COMPLETAR "),o(),x(5,"span",10),o()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function pi(a,i){if(a&1&&(n(0,"div",87),g(1,mi,6,1,"button",88),o()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalcarreras)}}function ui(a,i){if(a&1){let e=C();n(0,"button",90),f("click",function(){p(e);let r=m().$implicit,d=m();return r.dismiss(),u(d.resetcarreras())}),n(1,"span",8),x(2,"ng-lottie",9),o(),n(3,"span"),c(4,"CANCELAR"),o(),x(5,"span",10),o()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function _i(a,i){if(a&1){let e=C();n(0,"button",91),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarcarreras())}),x(1,"span",92),o()}a&2&&l("disabled",!0)}function gi(a,i){if(a&1){let e=C();n(0,"button",93),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarcarreras())}),n(1,"span",8),x(2,"ng-lottie",9),o(),n(3,"span"),c(4),o(),x(5,"span",10),o()}if(a&2){let e,t,r=m(2);s(2),l("options",(e=r.newcarreras.get("id"))!=null&&e.value?r._tools.optionsEditar:r._tools.optionsAdicionar),s(2),v((t=r.newcarreras.get("id"))!=null&&t.value?"MODIFICAR":"REGISTRAR")}}function fi(a,i){if(a&1){let e=C();n(0,"div",44)(1,"h4",45),c(2),o(),n(3,"button",46),f("click",function(){let r=p(e).$implicit,d=m();return r.dismiss(),u(d.resetcarreras())}),o()(),n(4,"div",47)(5,"form",48),g(6,oi,7,2,"div",49),n(7,"div",2)(8,"div",50)(9,"input",51),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"Area"))}),o(),n(10,"label"),c(11,"Area"),o(),n(12,"div",52),c(13,"Este campo es obligatorio*"),o()(),n(14,"div",50)(15,"input",53),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"Mencion"))}),o(),n(16,"label"),c(17,"Mencion"),o(),n(18,"div",52),c(19,"Este campo es obligatorio*"),o()(),n(20,"div",50)(21,"input",54),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"Resolucion"))}),o(),n(22,"label"),c(23,"Resolucion"),o(),n(24,"div",52),c(25,"Este campo es obligatorio*"),o()(),n(26,"div",50)(27,"input",55),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"NombreCarrera"))}),o(),n(28,"label"),c(29,"Nombre de Carrera"),o(),n(30,"div",52),c(31,"Este campo es obligatorio*"),o()()(),n(32,"div",2)(33,"div",56)(34,"input",57),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"HorasTotales"))}),o(),n(35,"label"),c(36,"Horas Totales"),o(),n(37,"div",52),c(38,"Este campo es obligatorio*"),o()(),n(39,"div",56)(40,"select",58)(41,"option",59),c(42,"Seleccione una opci\xF3n"),o(),g(43,ri,2,3,"option",60),o(),n(44,"label"),c(45,"Nivel"),o(),n(46,"div",52),c(47,"Este campo es obligatorio*"),o()(),n(48,"div",56)(49,"select",61)(50,"option",59),c(51,"Seleccione una opci\xF3n"),o(),g(52,ai,2,3,"option",60),o(),n(53,"label"),c(54,"Cantidad Evaluaciones"),o(),n(55,"div",52),c(56,"Este campo es obligatorio*"),o()()(),n(57,"div",2)(58,"div",50),x(59,"input",62),n(60,"label"),c(61,"Limite M\xE1ximo Te\xF3rico"),o(),n(62,"div",52),c(63,"Este campo es obligatorio*"),o()(),n(64,"div",50),x(65,"input",63),n(66,"label"),c(67,"Limite M\xE1ximo Pr\xE1ctico"),o(),n(68,"div",52),c(69,"Este campo es obligatorio*"),o()(),n(70,"div",50),x(71,"input",64),n(72,"label"),c(73,"Nota M\xEDnima Aprobaci\xF3n"),o(),n(74,"div",52),c(75,"Este campo es obligatorio*"),o()(),n(76,"div",50),x(77,"input",65),n(78,"label"),c(79,"Nota M\xEDnima 2da Instancia"),o(),n(80,"div",52),c(81,"Este campo es obligatorio*"),o()()(),n(82,"div",2)(83,"div",56)(84,"input",66),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"TituloOficial"))}),o(),n(85,"label"),c(86,"Titulo Oficial"),o(),n(87,"div",52),c(88,"Este campo es obligatorio*"),o()(),n(89,"div",56)(90,"select",67)(91,"option",59),c(92,"Seleccione una opci\xF3n"),o(),g(93,si,2,3,"option",60),o(),n(94,"label"),c(95,"Programa"),o(),n(96,"div",52),c(97,"Este campo es obligatorio*"),o()(),n(98,"div",56)(99,"input",68),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"Duracion"))}),o(),n(100,"label"),c(101,"Duracion"),o(),n(102,"div",52),c(103,"Este campo es obligatorio*"),o()()(),n(104,"div",2)(105,"div",69)(106,"input",70),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"Capacitacion"))}),o(),n(107,"label"),c(108,"Capacitaci\xF3n"),o(),n(109,"div",52),c(110,"Este campo es obligatorio*"),o()(),n(111,"div",69)(112,"input",71),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newcarreras,"CarreraProfesional"))}),o(),n(113,"label"),c(114,"Carrera Profesional"),o(),n(115,"div",52),c(116,"Este campo es obligatorio*"),o()()(),n(117,"div",2)(118,"div",56)(119,"select",72)(120,"option",59),c(121,"Seleccione una opci\xF3n"),o(),g(122,li,2,3,"option",60),o(),n(123,"label"),c(124,"Modalidad"),o(),n(125,"div",52),c(126,"Este campo es obligatorio*"),o()(),n(127,"div",56)(128,"select",73)(129,"option",59),c(130,"Seleccione una opci\xF3n"),o(),g(131,ci,2,3,"option",60),o(),n(132,"label"),c(133,"Visibilidad"),o(),n(134,"div",52),c(135,"Este campo es obligatorio*"),o()(),n(136,"div",56)(137,"select",74)(138,"option",59),c(139,"Seleccione una opci\xF3n"),o(),g(140,di,2,3,"option",60),o(),n(141,"label"),c(142,"Estado"),o(),n(143,"div",52),c(144,"Este campo es obligatorio*"),o()(),n(145,"div",75)(146,"label"),c(147,"Descripci\xF3n"),o(),x(148,"quill-editor",76),n(149,"div",52),c(150,"Este campo es obligatorio*"),o()()()()(),n(151,"div",77),g(152,pi,2,1,"div",78),n(153,"div",79),g(154,ui,6,1,"button",80),o(),n(155,"div",81),g(156,_i,2,1,"button",82)(157,gi,6,2,"button",83),o()()}if(a&2){let e,t=m();s(2),S("",(e=t.newcarreras.get("id"))!=null&&e.value?"Modificar":"Registrar"," carreras"),s(3),l("formGroup",t.newcarreras),s(),l("ngIf",t.esSuperAdmin),s(3),l("ngClass",t.ValidacioncarrerasxElemento("Area")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Mencion")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Resolucion")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("NombreCarrera")),s(7),l("ngClass",t.ValidacioncarrerasxElemento("HorasTotales")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Nivel")),s(3),l("ngForOf",t.nivelcarreraOptions),s(6),l("ngClass",t.ValidacioncarrerasxElemento("CantidadEvaluaciones")),s(3),l("ngForOf",t.cantidadevaluacionesOptions),s(7),l("ngClass",t.ValidacioncarrerasxElemento("LimiteMaxTeorico")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("LimiteMaxPractico")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("NotaAprobacion")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("NotaMinRevalida")),s(7),l("ngClass",t.ValidacioncarrerasxElemento("TituloOficial")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Programa")),s(3),l("ngForOf",t.programaOptions),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Duracion")),s(7),l("ngClass",t.ValidacioncarrerasxElemento("Capacitacion")),s(6),l("ngClass",t.ValidacioncarrerasxElemento("CarreraProfesional")),s(7),l("ngClass",t.ValidacioncarrerasxElemento("Modalidad")),s(3),l("ngForOf",t.modalidadOptions),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Visibilidad")),s(3),l("ngForOf",t.visibilidadOptions),s(6),l("ngClass",t.ValidacioncarrerasxElemento("Estado")),s(3),l("ngForOf",t.estadoOptions),s(8),l("modules",t.modulesQuillEdicion)("ngClass",t.ValidacioncarrerasxElemento("Descripcion")),s(4),l("ngIf",!t.newcarreras.get("id").value),s(2),l("ngIf",!t.AnimacionCargabtnModalcarreras),s(2),l("ngIf",t.AnimacionCargabtnModalcarreras),s(),l("ngIf",!t.AnimacionCargabtnModalcarreras)}}function xi(a,i){if(a&1){let e=C();n(0,"button",96),f("click",function(){let r=p(e).$implicit;return u(r.action())}),c(1),o()}if(a&2){let e=i.$implicit;s(),S(" ",e.label," ")}}function vi(a,i){if(a&1&&(n(0,"div",94),N(1,"async"),N(2,"async"),g(3,xi,2,1,"button",95),N(4,"async"),o()),a&2){let e,t,r=m();l("ngStyle",b(8,kt,((e=R(1,2,r.menuStatecarreras$))==null?null:e.y)+"px",((e=R(2,4,r.menuStatecarreras$))==null?null:e.x)+"px")),s(3),l("ngForOf",(t=R(4,6,r.menuStatecarreras$))==null?null:t.items)}}var Oe=class Oe{constructor(i,e,t,r,d){this._carr=i;this._tools=e;this._inst=t;this._controles=r;this._auth=d;this.modulesQuillEdicion={toolbar:[["bold","italic","underline","strike"],[{align:[]}],[{size:["small",!1,"large"]}],[{color:[]},{background:[]}],[{font:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","video"],["clean"]]};this.modulesQuillShow={toolbar:!1};this.esSuperAdmin=!1;this.estadoOptions=[];this.visibilidadOptions=[];this.programaOptions=[];this.modalidadOptions=[];this.nivelcarreraOptions=[];this.cantidadevaluacionesOptions=[];this.carreras=[];this.paginacarreras=1;this.isLoadingcarreras=!0;this.AnimacionCargabtnModalcarreras=!1;this.filtertxtcarreras="";this.collectionSizecarreras=0;this.pageSizecarreras=10;this.pageSizeOptionscarreras=[5,10,20,50];this.sortColumnscarreras=[];this.menuStatecarreras$=this._tools.state$;this.instituciones=[];this.newcarreras=this._carr.createFormGroupcarreras(),this.newcarrerasAnteriorAccion=this._carr.createFormGroupcarreras()}ngOnInit(){this.Cargarcarreras(),this.cargarInstituciones(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(i=>this.esSuperAdmin=i)}cargarOptionsDesdeControles(){let i=["ESTADO","VISIBILIDAD","PROGRAMA","MODALIDAD","NIVEL DE CARRERA","CANTIDAD DE EVALUACIONES"];this._controles.ObtenerOptionsSelectPorCategorias(i).subscribe({next:e=>{this.estadoOptions=e?.ESTADO||[],this.visibilidadOptions=e?.VISIBILIDAD||[],this.programaOptions=e?.PROGRAMA||[],this.modalidadOptions=e?.MODALIDAD||[],this.nivelcarreraOptions=e?.["NIVEL DE CARRERA"]||[],this.cantidadevaluacionesOptions=e?.["CANTIDAD DE EVALUACIONES"]||[]},error:()=>{this.estadoOptions=[],this.visibilidadOptions=[],this.programaOptions=[],this.modalidadOptions=[],this.nivelcarreraOptions=[],this.cantidadevaluacionesOptions=[]}})}abrirModalNuevoCarreras(){this.modalGestioncarrerasRef=this._tools.openModal(this.modalgestioncarreras,"xl")}Cargarcarreras(){this.isLoadingcarreras=!0,this._carr.Obtenercarreras().subscribe({next:i=>{console.log(i),this.carreras=i.data||[],this.collectionSizecarreras=this.carreras.length,this.isLoadingcarreras=!1},error:i=>{console.error("Error al cargar carreras",i),this.isLoadingcarreras=!1}})}AgregarModificarcarreras(){if(this.newcarreras.invalid){this.ValidacionTodoElementocarreras(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalcarreras=!1;return}else{this.AnimarCargaTablacarreras(),this.AnimacionCargabtnModalcarreras=!0,this._tools.MostrarMensajeLoading(),this.newcarrerasAnteriorAccion.setValue(this.newcarreras.value);let i=this.newcarreras.controls.id.value;console.log("INFO A PROCESAR",this.newcarreras.value),i?this._carr.Modificarcarreras(this.newcarreras.value,this.newcarreras.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE carreras",e.data),this.Cargarcarreras(),this.resetcarreras(),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR carreras",e),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeError()}):this._carr.Agregarcarreras(this.newcarreras.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE carreras",e.data),this.Cargarcarreras(),this.resetcarreras(),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR carreras",e),this.AnimacionCargabtnModalcarreras=!1,this._tools.MostrarMensajeError()})}}Seleccionarcarreras(i){if(this._tools.MostrarMensajeLoading(),i){if(!this.carreras.find(t=>t.id===i))return;this._carr.Seleccionarcarreras(i).subscribe(t=>{Object.keys(this.newcarreras.controls).forEach(r=>{this.newcarreras.controls[r].setValue(t.data[r])}),console.log("SELECCION DE carreras EXITOSA",this.newcarreras.value),this.newcarrerasAnteriorAccion.setValue(this.newcarreras.value),this.modalGestioncarrerasRef=this._tools.openModal(this.modalgestioncarreras,"xl"),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL SELECCIONAR carreras",t),this._tools.MostrarMensajeError()})}}Eliminarcarreras(i){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._carr.Eliminarcarreras(i).subscribe(t=>{console.log(t.data),this.Cargarcarreras(),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL ELIMINAR carreras",t),this._tools.MostrarMensajeError()}))})}resetcarreras(){this.newcarreras=this._carr.createFormGroupcarreras(),this._tools.closeModal(this.modalGestioncarrerasRef)}AutoCompletarLastcarreras(){this.newcarreras.setValue(this.newcarrerasAnteriorAccion.value),this.newcarreras.patchValue({id:0}),console.log("listo",this.newcarreras.value)}AnimarCargaTablacarreras(){this.carreras=[],this.isLoadingcarreras=!0}ValidacioncarrerasxElemento(i){return this._tools.obtenerValidationClass(this.newcarreras,i)}ValidacionTodoElementocarreras(){Object.values(this.newcarreras.controls).forEach(i=>{i.markAsTouched(),i.markAsDirty()})}onPageSizeChangecarreras(){this.paginacarreras=1}sortBycarreras(i,e){this.sortColumnscarreras=this._tools.handleSort(i,e,this.sortColumnscarreras),this.carreras=this._tools.applyMultiSort(this.carreras,this.sortColumnscarreras)}isSortedcarreras(i){return this._tools.isSorted(this.sortColumnscarreras,i)}getSortDircarreras(i){return this._tools.getSortDirection(this.sortColumnscarreras,i)}closeMenu(){this._tools.close()}abrirMenucarreras(i,e){i.preventDefault(),i.stopPropagation(),console.log("aS",e);let t=[{label:"\u270F Editar",action:()=>this.Seleccionarcarreras(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarcarreras(e.id)}];this._tools.open(i.clientX,i.clientY,t)}cargarInstituciones(){this._inst.Obtenerinstituciones().subscribe({next:i=>{console.log(i),this.instituciones=i.data||[]},error:i=>{console.error("Error al cargar instituciones",i)}})}};Oe.\u0275fac=function(e){return new(e||Oe)(E(ne),E(ie),E(St),E(Ie),E(ee))},Oe.\u0275cmp=H({type:Oe,selectors:[["app-carreras"]],viewQuery:function(e,t){if(e&1&&de(Ft,7),e&2){let r;me(r=pe())&&(t.modalgestioncarreras=r.first)}},hostBindings:function(e,t){e&1&&f("click",function(){return t.closeMenu()},ve)},standalone:!1,decls:70,vars:31,consts:[["modalgestioncarreras",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"button","col-sm-3","d-flex","justify-content-start"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],["class","form-floating mb-3 col-sm-12",4,"ngIf"],[1,"form-floating","mb-3","col-sm-3"],["type","text","placeholder","","formControlName","Area",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"invalid-feedback"],["type","text","placeholder","","formControlName","Mencion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","Resolucion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","NombreCarrera",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"form-floating","mb-3","col-sm-4"],["type","text","placeholder","","formControlName","HorasTotales",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Nivel",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","CantidadEvaluaciones",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","LimiteMaxTeorico",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","LimiteMaxPractico",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","NotaAprobacion",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","NotaMinRevalida",1,"form-control",3,"ngClass"],["type","text","placeholder","","formControlName","TituloOficial",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Programa",1,"form-control",3,"ngClass"],["type","text","placeholder","","formControlName","Duracion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"form-floating","mb-3","col-sm-6"],["type","text","placeholder","","formControlName","Capacitacion",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","CarreraProfesional",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","Modalidad",1,"form-control",3,"ngClass"],["formControlName","Visibilidad",1,"form-control",3,"ngClass"],["formControlName","Estado",1,"form-control",3,"ngClass"],[1,"mb-3","col-sm-12"],["placeholder","","formControlName","Descripcion",1,"quill-container-wrapper",2,"text-transform","uppercase",3,"modules","ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[1,"form-floating","mb-3","col-sm-12"],["formControlName","instituciones_id",1,"form-control",3,"ngClass"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"]],template:function(e,t){if(e&1){let r=C();n(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),c(4,"Gesti\xF3n de carreras"),o(),n(5,"p",5),c(6,"Administra la informaci\xF3n de los carreras de manera sencilla y eficiente"),o()()()(),n(7,"div",2)(8,"div",6)(9,"button",7),f("click",function(){return p(r),u(t.abrirModalNuevoCarreras())}),n(10,"span",8),x(11,"ng-lottie",9),o(),n(12,"span"),c(13,"A\xF1adir carreras "),o(),x(14,"span",10),o()(),n(15,"div",11)(16,"div",12)(17,"span",13),x(18,"ng-lottie",14),o(),n(19,"div",15)(20,"input",16),f("input",function(){return p(r),u(t.paginacarreras=1)}),w("ngModelChange",function(_){return p(r),M(t.filtertxtcarreras,_)||(t.filtertxtcarreras=_),u(_)}),o(),n(21,"label"),c(22,"Buscar"),o()()()()(),n(23,"div",17)(24,"div",18)(25,"table",19)(26,"thead",20)(27,"tr")(28,"th",21),c(29,"#"),o(),g(30,Gt,3,1,"th",22),n(31,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("NombreCarrera",_))}),c(32," NombreCarrera "),g(33,jt,1,4,"i",24),o(),n(34,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Area",_))}),c(35," Area "),g(36,Bt,1,4,"i",24),o(),n(37,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Mencion",_))}),c(38," Mencion "),g(39,$t,1,4,"i",24),o(),n(40,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Resolucion",_))}),c(41," Resolucion "),g(42,zt,1,4,"i",24),o(),n(43,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Nivel",_))}),c(44," Nivel "),g(45,Ht,1,4,"i",24),o(),n(46,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("HorasTotales",_))}),c(47," HorasTotales "),g(48,Wt,1,4,"i",24),o(),n(49,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Visibilidad",_))}),c(50," Visibilidad "),g(51,Ut,1,4,"i",24),o(),n(52,"th",23),f("click",function(_){return p(r),u(t.sortBycarreras("Estado",_))}),c(53," Estado "),g(54,qt,1,4,"i",24),o(),n(55,"th",21),c(56,"ACCIONES"),o()()(),n(57,"tbody"),g(58,Kt,5,1,"tr",25)(59,Qt,3,1,"tr",25)(60,ti,27,14,"tr",26),N(61,"slice"),o()()(),n(62,"div",27)(63,"ngb-pagination",28),w("pageChange",function(_){return p(r),M(t.paginacarreras,_)||(t.paginacarreras=_),u(_)}),o(),n(64,"select",29),w("ngModelChange",function(_){return p(r),M(t.pageSizecarreras,_)||(t.pageSizecarreras=_),u(_)}),f("change",function(){return p(r),u(t.onPageSizeChangecarreras())}),g(65,ii,2,2,"option",30),o()()(),g(66,fi,158,34,"ng-template",null,0,$)(68,vi,5,11,"div",31),N(69,"async")}if(e&2){let r;s(11),l("options",t._tools.optionsAdicionar),s(7),l("options",t._tools.optionslupa),s(2),y("ngModel",t.filtertxtcarreras),s(10),l("ngIf",t.esSuperAdmin),s(3),l("ngIf",t.isSortedcarreras("NombreCarrera")),s(3),l("ngIf",t.isSortedcarreras("Area")),s(3),l("ngIf",t.isSortedcarreras("Mencion")),s(3),l("ngIf",t.isSortedcarreras("Resolucion")),s(3),l("ngIf",t.isSortedcarreras("Nivel")),s(3),l("ngIf",t.isSortedcarreras("HorasTotales")),s(3),l("ngIf",t.isSortedcarreras("Visibilidad")),s(3),l("ngIf",t.isSortedcarreras("Estado")),s(4),l("ngIf",t.isLoadingcarreras),s(),l("ngIf",!t.isLoadingcarreras&&(!t.carreras||t.carreras.length===0)),s(),l("ngForOf",W(61,25,t.carreras,(t.paginacarreras-1)*t.pageSizecarreras,t.paginacarreras*t.pageSizecarreras)),s(3),y("page",t.paginacarreras),l("collectionSize",t.collectionSizecarreras)("pageSize",t.pageSizecarreras)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),y("ngModel",t.pageSizecarreras),s(),l("ngForOf",t.pageSizeOptionscarreras),s(3),l("ngIf",(r=R(69,29,t.menuStatecarreras$))==null?null:r.visible)}},dependencies:[U,q,K,Ce,ye,X,Z,Se,et,J,Q,Ee,Y,Me,we,Ae,te,Et,he,be],encapsulation:2});var Ve=Oe;var _e=class _e{constructor(i){this.http=i;this.ruta=Xe.ruta}Obtenerplandeestudios(i){let e=new Ye,t=i||{};return t?.anio_id&&(e=e.set("anio_id",String(t.anio_id))),t?.resolucion&&(e=e.set("resolucion",String(t.resolucion))),t?.nivel&&(e=e.set("nivel",String(t.nivel))),t?.instituciones_id&&(e=e.set("instituciones_id",String(t.instituciones_id))),this.http.get(this.ruta+"api/plandeestudios/",{params:e})}Agregarplandeestudios(i){return this.http.post(this.ruta+"api/plandeestudios/",i)}Modificarplandeestudios(i,e){return this.http.put(this.ruta+"api/plandeestudios/"+e,i)}Seleccionarplandeestudios(i){return this.http.get(this.ruta+"api/plandeestudios/"+i)}Eliminarplandeestudios(i){return this.http.delete(this.ruta+"api/plandeestudios/"+i)}createFormGroupplandeestudios(){return new Ze({id:new O(0),carreras_id:new O("",[F.required]),Rango:new O("",[F.required]),RangoLvlCurso:new O("",[F.required]),LvlCurso:new O("",[F.required]),Horas:new O("",[F.required]),anio_id:new O("",[F.required]),ModoMateria:new O("1 DOCENTE x MATERIA",[F.required]),NombreMateria:new O("",[F.required]),SiglaMateria:new O("",[F.required]),Prerrequisitos:new O(""),SiglasPrerrequisitos:new O(""),TipoMateria:new O("TE\xD3RICO",[F.required]),RelacionDocenteCursoAEstudiante:new O("NINGUNA",[F.required])})}};_e.\u0275fac=function(e){return new(e||_e)(We(Je))},_e.\u0275prov=ze({token:_e,factory:_e.\u0275fac,providedIn:"root"});var Ne=_e;var De=class De{transform(i,e,t=[],r=!0){if(!i||!Array.isArray(i)||i.length===0)return[];let d=(e??"").toString().trim();if(!d)return i;let _=d.split(/\s+/g).map(A=>this.normalizarTexto(A).toLowerCase()).filter(Boolean);if(_.length===0)return i;let h=t?.length?t:Object.keys(i[0]);return i.filter(A=>{let I=h.map(T=>{let D=typeof T=="function"?T(A):this.getByPath(A,T);return this.normalizarTexto(D).toLowerCase()}).filter(Boolean),V=T=>I.some(D=>D.includes(T));return r?_.every(V):_.some(V)})}getByPath(i,e){return!i||!e?"":e.includes(".")?e.split(".").reduce((t,r)=>t?.[r],i):i?.[e]}normalizarTexto(i){return i==null?"":String(i).normalize("NFD").replace(/[\u0300-\u036f]/g,"")}};De.\u0275fac=function(e){return new(e||De)},De.\u0275pipe=vt({name:"filterByFields",type:De,pure:!0,standalone:!1});var Pe=De;var Si=["modalAccionesMaterias"],Ei=["modalgestionmaterias"],yi=()=>["LvlCurso","Paralelo","Turno","NombreMateria","SiglaMateria","ModoAsistencia","EstadoHabilitacion","EstadoEnvio","Anio","Resolucion","Nivel","NombreCarrera","NombreInstitucion"],ke=(a,i)=>({"bi-caret-up":a,"bi-caret-down":i}),Mi=(a,i)=>({top:a,left:i});function wi(a,i){if(a&1&&(n(0,"option",15),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.id),s(),v(e.Anio)}}function Ai(a,i){if(a&1&&(n(0,"option",15),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.key),s(),v(e.label)}}function Ii(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("LvlCurso")==="asc",e.getSortDirmaterias("LvlCurso")==="desc"))}}function Ti(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("Paralelo")==="asc",e.getSortDirmaterias("Paralelo")==="desc"))}}function Oi(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("Turno")==="asc",e.getSortDirmaterias("Turno")==="desc"))}}function Vi(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("NombreMateria")==="asc",e.getSortDirmaterias("NombreMateria")==="desc"))}}function Ni(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("ModoAsistencia")==="asc",e.getSortDirmaterias("ModoAsistencia")==="desc"))}}function Di(a,i){if(a&1&&x(0,"i",40),a&2){let e=m(2);l("ngClass",b(1,ke,e.getSortDirmaterias("EstadoHabilitacion")==="asc",e.getSortDirmaterias("EstadoHabilitacion")==="desc"))}}function Pi(a,i){a&1&&(n(0,"tr")(1,"td",31)(2,"div",41)(3,"span",42),c(4,"Cargando..."),o()()()()),a&2&&(s(),B("colspan",9))}function Ri(a,i){a&1&&(n(0,"tr")(1,"td",31),c(2,"No hay datos disponibles"),o()()),a&2&&(s(),B("colspan",9))}function Fi(a,i){if(a&1&&x(0,"img",50),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function ki(a,i){if(a&1&&x(0,"ng-lottie",51),a&2){let e=m(3);l("options",e._tools.optionsEditar)}}function Li(a,i){if(a&1&&x(0,"img",50),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function Gi(a,i){if(a&1&&x(0,"ng-lottie",51),a&2){let e=m(3);l("options",e._tools.optionsEliminar)}}function ji(a,i){if(a&1){let e=C();n(0,"tr",43),f("contextmenu",function(r){let d=p(e).$implicit,_=m(2);return u(_.abrirMenumaterias(r,d))}),n(1,"td",31),c(2),o(),n(3,"td"),c(4),n(5,"div",44),c(6),o()(),n(7,"td"),c(8),o(),n(9,"td"),c(10),o(),n(11,"td"),c(12),n(13,"div",44),c(14),o()(),n(15,"td"),c(16),o(),n(17,"td"),c(18),o(),n(19,"td",45)(20,"button",46),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.Seleccionarmaterias(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["edicionmaterias-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["edicionmaterias-"+r.id]=!1)}),g(21,Fi,1,1,"img",47)(22,ki,1,1,"ng-lottie",48),o(),n(23,"button",49),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.Eliminarmaterias(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["eliminacionmaterias-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["eliminacionmaterias-"+r.id]=!1)}),g(24,Li,1,1,"img",47)(25,Gi,1,1,"ng-lottie",48),o()()()}if(a&2){let e=i.$implicit,t=i.index,r=m(2);s(2),v((r.paginamaterias-1)*r.pageSizematerias+(t+1)),s(2),S(" ",e.LvlCurso," "),s(2),v(e.Nivel),s(2),v(e.Paralelo),s(2),v(e.Turno),s(2),S("",e.NombreMateria," "),s(2),ue("A\xF1o: ",e.Anio," \xB7 Res: ",e.Resolucion),s(2),v(e.ModoAsistencia),s(2),v(e.EstadoHabilitacion),s(3),l("ngIf",!r._tools.hoverBotonMap["edicionmaterias-"+e.id]),s(),l("ngIf",r._tools.hoverBotonMap["edicionmaterias-"+e.id]),s(2),l("ngIf",!r._tools.hoverBotonMap["eliminacionmaterias-"+e.id]),s(),l("ngIf",r._tools.hoverBotonMap["eliminacionmaterias-"+e.id])}}function Bi(a,i){if(a&1&&(n(0,"option",52),c(1),o()),a&2){let e=i.$implicit;l("value",e),s(),S("",e," por p\xE1gina")}}function $i(a,i){if(a&1){let e=C();n(0,"div",27)(1,"div",28)(2,"table",29)(3,"thead",30)(4,"tr")(5,"th",31),c(6,"#"),o(),n(7,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("LvlCurso",r))}),c(8," LvlCurso "),g(9,Ii,1,4,"i",33),o(),n(10,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("Paralelo",r))}),c(11," Paralelo "),g(12,Ti,1,4,"i",33),o(),n(13,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("Turno",r))}),c(14," Turno "),g(15,Oi,1,4,"i",33),o(),n(16,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("NombreMateria",r))}),c(17," NombreMateria "),g(18,Vi,1,4,"i",33),o(),n(19,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("ModoAsistencia",r))}),c(20," ModoAsistencia "),g(21,Ni,1,4,"i",33),o(),n(22,"th",32),f("click",function(r){p(e);let d=m();return u(d.sortBymaterias("EstadoHabilitacion",r))}),c(23," EstadoHabilitacion "),g(24,Di,1,4,"i",33),o(),n(25,"th",31),c(26,"ACCIONES"),o()()(),n(27,"tbody"),g(28,Pi,5,1,"tr",34)(29,Ri,3,1,"tr",34)(30,ji,26,14,"tr",35),N(31,"slice"),o()()(),n(32,"div",36)(33,"ngb-pagination",37),w("pageChange",function(r){p(e);let d=m();return M(d.paginamaterias,r)||(d.paginamaterias=r),u(r)}),o(),n(34,"select",38),w("ngModelChange",function(r){p(e);let d=m();return M(d.pageSizematerias,r)||(d.pageSizematerias=r),u(r)}),f("change",function(){p(e);let r=m();return u(r.onPageSizeChangematerias())}),g(35,Bi,2,2,"option",39),o()()()}if(a&2){let e=i.ngIf,t=m();s(9),l("ngIf",t.isSortedmaterias("LvlCurso")),s(3),l("ngIf",t.isSortedmaterias("Paralelo")),s(3),l("ngIf",t.isSortedmaterias("Turno")),s(3),l("ngIf",t.isSortedmaterias("NombreMateria")),s(3),l("ngIf",t.isSortedmaterias("ModoAsistencia")),s(3),l("ngIf",t.isSortedmaterias("EstadoHabilitacion")),s(4),l("ngIf",t.isLoadingmaterias),s(),l("ngIf",!t.isLoadingmaterias&&e.length===0),s(),l("ngForOf",W(31,18,e,(t.paginamaterias-1)*t.pageSizematerias,t.paginamaterias*t.pageSizematerias)),s(3),y("page",t.paginamaterias),l("collectionSize",e.length)("pageSize",t.pageSizematerias)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),y("ngModel",t.pageSizematerias),s(),l("ngForOf",t.pageSizeOptionsmaterias)}}function zi(a,i){if(a&1){let e=C();n(0,"div",80),f("click",function(){let r=p(e).$implicit,d=m(3);return u(d.seleccionarPlan(r))}),n(1,"div",81)(2,"h6",82),c(3),o(),n(4,"small"),c(5),o()(),n(6,"p",82),c(7),o()()}if(a&2){let e=i.$implicit;s(3),Ct(" ",e.RangoLvlCurso," | ",e.NombreMateria," (",e.SiglaMateria,") "),s(2),v(e.Anio),s(2),S(" Resoluci\xF3n: ",e.Resolucion," ")}}function Hi(a,i){if(a&1&&(n(0,"div",78),g(1,zi,8,5,"div",79),o()),a&2){let e=m(2);s(),l("ngForOf",e.planesFiltrados)}}function Wi(a,i){a&1&&(n(0,"div",83),c(1," Este campo es obligatorio* "),o())}function Ui(a,i){if(a&1&&(n(0,"option",84),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function qi(a,i){if(a&1&&(n(0,"option",84),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Ki(a,i){if(a&1&&(n(0,"option",84),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Qi(a,i){if(a&1&&(n(0,"option",84),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Yi(a,i){if(a&1){let e=C();n(0,"button",87),f("click",function(){p(e);let r=m(3);return u(r.AutoCompletarLastmaterias())}),n(1,"span",9),x(2,"ng-lottie",10),o(),n(3,"span"),c(4,"AUTO COMPLETAR "),o(),x(5,"span",11),o()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function Ji(a,i){if(a&1&&(n(0,"div",85),g(1,Yi,6,1,"button",86),o()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalmaterias)}}function Xi(a,i){if(a&1){let e=C();n(0,"button",88),f("click",function(){p(e);let r=m().$implicit,d=m();return r.dismiss(),u(d.resetmaterias())}),n(1,"span",9),x(2,"ng-lottie",10),o(),n(3,"span"),c(4,"CANCELAR"),o(),x(5,"span",11),o()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function Zi(a,i){if(a&1){let e=C();n(0,"button",89),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarmaterias())}),x(1,"span",90),o()}a&2&&l("disabled",!0)}function en(a,i){if(a&1){let e=C();n(0,"button",91),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarmaterias())}),n(1,"span",9),x(2,"ng-lottie",10),o(),n(3,"span"),c(4),o(),x(5,"span",11),o()}if(a&2){let e,t,r=m(2);s(2),l("options",(e=r.newmaterias.get("id"))!=null&&e.value?r._tools.optionsEditar:r._tools.optionsAdicionar),s(2),v((t=r.newmaterias.get("id"))!=null&&t.value?"MODIFICAR":"REGISTRAR")}}function tn(a,i){if(a&1){let e=C();n(0,"div",53)(1,"h4",54),c(2),o(),n(3,"button",55),f("click",function(){let r=p(e).$implicit,d=m();return r.dismiss(),u(d.resetmaterias())}),o()(),n(4,"div",56)(5,"form",57)(6,"div",58)(7,"input",59),f("focus",function(){p(e);let r=m();return u(r.mostrarLista=!0)}),o(),g(8,Hi,2,1,"div",60)(9,Wi,2,0,"div",61),o(),n(10,"div",62)(11,"input",63),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newmaterias,"Paralelo"))}),o(),n(12,"label"),c(13,"Paralelo"),o(),n(14,"div",64),c(15,"Este campo es obligatorio*"),o()(),n(16,"div",62)(17,"select",65)(18,"option",66),c(19,"Seleccione una opci\xF3n"),o(),g(20,Ui,2,3,"option",67),o(),n(21,"label"),c(22,"Turno"),o(),n(23,"div",64),c(24,"Este campo es obligatorio*"),o()(),n(25,"div",62)(26,"select",68)(27,"option",66),c(28,"Seleccione una opci\xF3n"),o(),g(29,qi,2,3,"option",67),o(),n(30,"label"),c(31,"ModoAsistencia"),o(),n(32,"div",64),c(33,"Este campo es obligatorio*"),o()(),n(34,"div",62)(35,"select",69)(36,"option",66),c(37,"Seleccione una opci\xF3n"),o(),g(38,Ki,2,3,"option",67),o(),n(39,"label"),c(40,"EstadoHabilitacion"),o(),n(41,"div",64),c(42,"Este campo es obligatorio*"),o()(),n(43,"div",62)(44,"select",70)(45,"option",66),c(46,"Seleccione una opci\xF3n"),o(),g(47,Qi,2,3,"option",67),o(),n(48,"label"),c(49,"EstadoEnvio"),o(),n(50,"div",64),c(51,"Este campo es obligatorio*"),o()()()(),n(52,"div",71),g(53,Ji,2,1,"div",72),n(54,"div",73),g(55,Xi,6,1,"button",74),o(),n(56,"div",75),g(57,Zi,2,1,"button",76)(58,en,6,2,"button",77),o()()}if(a&2){let e,t,r=m();s(2),S("",(e=r.newmaterias.get("id"))!=null&&e.value?"Modificar":"Registrar"," materias"),s(3),l("formGroup",r.newmaterias),s(2),l("formControl",r.planInput),s(),l("ngIf",r.mostrarLista&&r.planInput.value),s(),l("ngIf",(t=r.newmaterias.get("plandeestudios_id"))==null?null:t.invalid),s(2),l("ngClass",r.ValidacionmateriasxElemento("Paralelo")),s(6),l("ngClass",r.ValidacionmateriasxElemento("Turno")),s(3),l("ngForOf",r.turnoOptions),s(6),l("ngClass",r.ValidacionmateriasxElemento("ModoAsistencia")),s(3),l("ngForOf",r.modoAsistenciaOptions),s(6),l("ngClass",r.ValidacionmateriasxElemento("EstadoHabilitacion")),s(3),l("ngForOf",r.estadoHabilitacionOptions),s(6),l("ngClass",r.ValidacionmateriasxElemento("EstadoEnvio")),s(3),l("ngForOf",r.estadoEnvioOptions),s(6),l("ngIf",!r.newmaterias.get("id").value),s(2),l("ngIf",!r.AnimacionCargabtnModalmaterias),s(2),l("ngIf",r.AnimacionCargabtnModalmaterias),s(),l("ngIf",!r.AnimacionCargabtnModalmaterias)}}function nn(a,i){if(a&1){let e=C();n(0,"button",94),f("click",function(){let r=p(e).$implicit;return u(r.action())}),c(1),o()}if(a&2){let e=i.$implicit;s(),S(" ",e.label," ")}}function on(a,i){if(a&1&&(n(0,"div",92),N(1,"async"),N(2,"async"),g(3,nn,2,1,"button",93),N(4,"async"),o()),a&2){let e,t,r=m();l("ngStyle",b(8,Mi,((e=R(1,2,r.menuStatematerias$))==null?null:e.y)+"px",((e=R(2,4,r.menuStatematerias$))==null?null:e.x)+"px")),s(3),l("ngForOf",(t=R(4,6,r.menuStatematerias$))==null?null:t.items)}}function rn(a,i){if(a&1&&(n(0,"option",15),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e),s(),v(e)}}function an(a,i){if(a&1&&(n(0,"option",15),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e),s(),v(e)}}function sn(a,i){if(a&1){let e=C();n(0,"div",97)(1,"div",23)(2,"select",104),w("ngModelChange",function(r){p(e);let d=m(2);return M(d.paraleloActualGrupal,r)||(d.paraleloActualGrupal=r),u(r)}),n(3,"option",15),c(4,"Seleccione una opci\xF3n"),o(),g(5,an,2,2,"option",16),o(),n(6,"label"),c(7,"Paralelo actual"),o()()()}if(a&2){let e=m(2);s(2),y("ngModel",e.paraleloActualGrupal),s(),l("ngValue",""),s(2),l("ngForOf",e.paralelosGrupalOptions)}}function ln(a,i){if(a&1){let e=C();n(0,"div",97)(1,"div",23)(2,"input",105),w("ngModelChange",function(r){p(e);let d=m(2);return M(d.paraleloNuevoGrupal,r)||(d.paraleloNuevoGrupal=r),u(r)}),o(),n(3,"label"),c(4,"Nuevo paralelo"),o()(),n(5,"div",106),c(6,"Se valida que no exista en el mismo A\xF1o + Resoluci\xF3n."),o()()}if(a&2){let e=m(2);s(2),y("ngModel",e.paraleloNuevoGrupal)}}function cn(a,i){if(a&1&&(n(0,"option",109),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),v(e.label)}}function dn(a,i){if(a&1){let e=C();n(0,"div",97)(1,"div",23)(2,"select",107),w("ngModelChange",function(r){p(e);let d=m(2);return M(d.turnoGrupal,r)||(d.turnoGrupal=r),u(r)}),n(3,"option",15),c(4,"(No cambiar realizar cambios)"),o(),g(5,cn,2,3,"option",108),o(),n(6,"label"),c(7,"Turno"),o()()()}if(a&2){let e=m(2);s(2),y("ngModel",e.turnoGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.turnoOptions)}}function mn(a,i){if(a&1&&(n(0,"option",109),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),v(e.label)}}function pn(a,i){if(a&1){let e=C();n(0,"div",97)(1,"div",23)(2,"select",110),w("ngModelChange",function(r){p(e);let d=m(2);return M(d.modoAsistenciaGrupal,r)||(d.modoAsistenciaGrupal=r),u(r)}),n(3,"option",15),c(4,"(No cambiar realizar cambios)"),o(),g(5,mn,2,3,"option",108),o(),n(6,"label"),c(7,"ModoAsistencia"),o()()()}if(a&2){let e=m(2);s(2),y("ngModel",e.modoAsistenciaGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.modoAsistenciaOptions)}}function un(a,i){if(a&1&&(n(0,"option",109),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.value)("disabled",e.disabled),s(),v(e.label)}}function _n(a,i){if(a&1){let e=C();n(0,"div",97)(1,"div",23)(2,"select",111),w("ngModelChange",function(r){p(e);let d=m(2);return M(d.estadoHabilitacionGrupal,r)||(d.estadoHabilitacionGrupal=r),u(r)}),n(3,"option",15),c(4,"(No cambiar realizar cambios)"),o(),g(5,un,2,3,"option",108),o(),n(6,"label"),c(7,"EstadoHabilitacion"),o()()()}if(a&2){let e=m(2);s(2),y("ngModel",e.estadoHabilitacionGrupal),s(),l("ngValue",null),s(2),l("ngForOf",e.estadoHabilitacionOptions)}}function gn(a,i){a&1&&(n(0,"button",112),x(1,"span",90),o()),a&2&&l("disabled",!0)}function fn(a,i){if(a&1){let e=C();n(0,"button",113),f("click",function(){p(e);let r=m(2);return u(r.ejecutarAccionGrupal())}),n(1,"span",9),x(2,"ng-lottie",10),o(),n(3,"span"),c(4,"EJECUTAR"),o(),x(5,"span",11),o()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionstrengranaje)}}function xn(a,i){if(a&1){let e=C();n(0,"div",53)(1,"h5",54),c(2,"Acciones grupales de materias"),o(),n(3,"button",95),f("click",function(){let r=p(e).$implicit;return u(r.dismiss())}),o()(),n(4,"div",56)(5,"div",96),c(6,"Se aplicar\xE1 sobre el filtro actual (A\xF1o + Resoluci\xF3n)."),o(),n(7,"div",3)(8,"div",97)(9,"div",23)(10,"select",98),w("ngModelChange",function(r){p(e);let d=m();return M(d.accionGrupal,r)||(d.accionGrupal=r),u(r)}),n(11,"option",15),c(12,"A\xF1adir todas las materias del curso"),o(),n(13,"option",15),c(14,"Modificar paralelo del curso"),o(),n(15,"option",15),c(16,"Eliminar materias del curso (por paralelo)"),o()(),n(17,"label"),c(18,"Acci\xF3n"),o()()(),n(19,"div",97)(20,"div",23)(21,"select",99),w("ngModelChange",function(r){p(e);let d=m();return M(d.cursoGrupal,r)||(d.cursoGrupal=r),u(r)}),f("ngModelChange",function(){p(e);let r=m();return u(r.onCursoGrupalChange())}),n(22,"option",15),c(23,"Seleccione una opci\xF3n"),o(),g(24,rn,2,2,"option",16),o(),n(25,"label"),c(26,"Curso (LvlCurso)"),o()()(),g(27,sn,8,3,"div",100)(28,ln,7,1,"div",100)(29,dn,8,3,"div",100)(30,pn,8,3,"div",100)(31,_n,8,3,"div",100),o()(),n(32,"div",71)(33,"div",73)(34,"button",101),f("click",function(){let r=p(e).$implicit;return u(r.dismiss())}),n(35,"span",9),x(36,"ng-lottie",10),o(),n(37,"span"),c(38,"CANCELAR"),o(),x(39,"span",11),o()(),n(40,"div",75),g(41,gn,2,1,"button",102)(42,fn,6,1,"button",103),o()()}if(a&2){let e=m();s(10),y("ngModel",e.accionGrupal),s(),l("ngValue","agregar"),s(2),l("ngValue","modificar"),s(2),l("ngValue","eliminar"),s(6),y("ngModel",e.cursoGrupal),s(),l("ngValue",""),s(2),l("ngForOf",e.cursosGrupalOptions),s(3),l("ngIf",e.accionGrupal!=="agregar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(),l("ngIf",e.accionGrupal!=="eliminar"),s(3),l("disabled",e.isProcesandoAccionGrupal),s(2),l("options",e._tools.optionscancelar),s(5),l("ngIf",e.isProcesandoAccionGrupal),s(),l("ngIf",!e.isProcesandoAccionGrupal)}}var Re=class Re{constructor(i,e,t,r,d,_,h){this._mat=i;this._tools=e;this._planest=t;this._controles=r;this._carr=d;this._anios=_;this._auth=h;this.esSuperAdmin=!1;this.estadoHabilitacionOptions=[];this.estadoEnvioOptions=[];this.modoAsistenciaOptions=[];this.turnoOptions=[];this.accionGrupal="agregar";this.cursoGrupal="";this.paraleloActualGrupal="";this.paraleloNuevoGrupal="";this.turnoGrupal=null;this.modoAsistenciaGrupal=null;this.estadoHabilitacionGrupal=null;this.estadoEnvioGrupal=null;this.cursosGrupalOptions=[];this.paralelosGrupalOptions=[];this.planesFiltroActual=[];this.isProcesandoAccionGrupal=!1;this.materias=[];this.paginamaterias=1;this.isLoadingmaterias=!1;this.AnimacionCargabtnModalmaterias=!1;this.filtertxtmaterias="";this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.collectionSizematerias=0;this.pageSizematerias=10;this.pageSizeOptionsmaterias=[5,10,20,50];this.sortColumnsmaterias=[];this.menuStatematerias$=this._tools.state$;this.carreras=[];this.anios=[];this.plandeestudios=[];this.planInput=new O("");this.planesFiltrados=[];this.mostrarLista=!1;this.newmaterias=this._mat.createFormGroupmaterias(),this.newmateriasAnteriorAccion=this._mat.createFormGroupmaterias()}ngOnInit(){this.cargarCarreras(),this.cargarAnios(),this.cargarplandeestudios(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(i=>{this.esSuperAdmin=i,this.rebuildResolucionOptions(),this.onFiltroChange()}),this.planesFiltrados=[],this.planInput.valueChanges.subscribe(i=>{let e=i?.toLowerCase()||"";if(!e){this.planesFiltrados=[];return}this.planesFiltrados=this.plandeestudios.filter(t=>`${t.RangoLvlCurso} ${t.NombreMateria} ${t.SiglaMateria} ${t.Anio} ${t.Resolucion}`.toLowerCase().includes(e))})}cargarOptionsDesdeControles(){let i=["ESTADO DE HABILITACI\xD3N","ESTADO DE ENVIO","MODO DE ASISTENCIA","TURNO"];this._controles.ObtenerOptionsSelectPorCategorias(i).subscribe({next:e=>{this.estadoHabilitacionOptions=e?.["ESTADO DE HABILITACI\xD3N"]||[],this.estadoEnvioOptions=e?.["ESTADO DE ENVIO"]||[],this.modoAsistenciaOptions=e?.["MODO DE ASISTENCIA"]||[],this.turnoOptions=e?.TURNO||[]},error:()=>{this.estadoHabilitacionOptions=[],this.estadoEnvioOptions=[],this.modoAsistenciaOptions=[],this.turnoOptions=[]}})}abrirModalNuevoMaterias(){this.modalGestionmateriasRef=this._tools.openModal(this.modalgestionmaterias,"xl")}abrirModalAccionesMaterias(){let i=this.getFiltroParams();if(!i){this._tools.MostrarMensaje("warning","Seleccione A\xF1o y Resoluci\xF3n para continuar");return}this.isProcesandoAccionGrupal=!0,this._tools.MostrarMensajeLoading(),$e({materias:this._mat.Obtenermaterias(i).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error cargando materias (modal grupal)",e),se([])))),planes:this._planest.Obtenerplandeestudios(i).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error cargando planes (modal grupal)",e),se([]))))}).subscribe({next:({materias:e,planes:t})=>{this.materias=e||[],this.collectionSizematerias=this.materias.length,this.planesFiltroActual=t||[];let r=new Set;for(let d of this.planesFiltroActual){let _=(d?.LvlCurso??"").toString().trim();_&&r.add(_)}this.cursosGrupalOptions=Array.from(r.values()).sort((d,_)=>d.localeCompare(_)),this.accionGrupal="agregar",this.cursoGrupal="",this.paraleloActualGrupal="",this.paraleloNuevoGrupal="",this.paralelosGrupalOptions=[],this.turnoGrupal=null,this.modoAsistenciaGrupal=null,this.estadoHabilitacionGrupal=null,this.estadoEnvioGrupal=null,this.modalAccionesMateriasRef=this._tools.openModal(this.modalAccionesMaterias,"xl")},error:e=>{console.error(e),this._tools.MostrarMensajeError()},complete:()=>{this.isProcesandoAccionGrupal=!1}})}onCursoGrupalChange(){let i=this.upper(this.cursoGrupal),e=new Set;for(let t of this.materias||[]){let r=this.upper(t?.LvlCurso),d=this.upper(t?.Paralelo);i&&r===i&&d&&e.add(d)}this.paralelosGrupalOptions=Array.from(e.values()).sort((t,r)=>t.localeCompare(r)),this.paraleloActualGrupal=""}ejecutarAccionGrupal(){let i=this.getFiltroParams();if(!i){this._tools.MostrarMensaje("warning","Seleccione A\xF1o y Resoluci\xF3n (incluye Nivel) para continuar");return}let e=this.upper(this.cursoGrupal),t=this.upper(this.paraleloNuevoGrupal),r=this.upper(this.paraleloActualGrupal),d=(this.turnoGrupal??"").toString().trim(),_=(this.modoAsistenciaGrupal??"").toString().trim(),h=(this.estadoHabilitacionGrupal??"").toString().trim(),A=(this.estadoEnvioGrupal??"").toString().trim(),I={};if(i.nivel&&(I.nivel=i.nivel),d&&(I.Turno=d),_&&(I.ModoAsistencia=_),h&&(I.EstadoHabilitacion=h),A&&(I.EstadoEnvio=A),!e){this._tools.MostrarMensaje("warning","Seleccione un curso (LvlCurso)");return}if(this.accionGrupal!=="eliminar"&&!t){this._tools.MostrarMensaje("warning","Ingrese el nuevo paralelo");return}if(this.accionGrupal!=="agregar"&&!r){this._tools.MostrarMensaje("warning","Seleccione el paralelo actual");return}this.isProcesandoAccionGrupal=!0,this._tools.MostrarMensajeLoading(),this._mat.Obtenermaterias(i).pipe(le(V=>V?.data||[]),ce(V=>(console.error("Error refrescando materias (acci\xF3n grupal)",V),se([])))).subscribe({next:V=>{let T=(L,P,re=[])=>{let Pt=new Set(re.map(je=>Number(je)));return(V||[]).some(je=>{let Rt=Number(je?.id);return Pt.has(Rt)?!1:this.upper(je?.LvlCurso)===P&&this.upper(je?.Paralelo)===L})},D=L=>(V||[]).filter(P=>this.upper(P?.LvlCurso)===e&&this.upper(P?.Paralelo)===L);if(this.accionGrupal==="agregar"){if(T(t,e)){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","Ese paralelo ya existe para el mismo A\xF1o y Resoluci\xF3n");return}this._mat.AgregarMateriasGrupal(ae({anio_id:i.anio_id,resolucion:i.resolucion,nivel:i.nivel,instituciones_id:i.instituciones_id,lvlcurso:e,paralelo_nuevo:t},I)).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:L=>{console.error("Error en alta grupal de materias (bulk)",L);let P=L?.error?.message;P?this._tools.MostrarMensaje("warning",P):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}});return}let k=D(r);if(!k.length){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","No hay materias para ese curso y paralelo");return}if(this.accionGrupal==="modificar"){let L=k.map(P=>Number(P?.id)).filter(P=>Number.isFinite(P));if(T(t,e,L)){this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensaje("warning","Ese paralelo ya existe para el mismo A\xF1o y Resoluci\xF3n");return}this._mat.ActualizarParaleloGrupal(ae({anio_id:i.anio_id,resolucion:i.resolucion,nivel:i.nivel,instituciones_id:i.instituciones_id,lvlcurso:e,paralelo_actual:r,paralelo_nuevo:t},I)).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:P=>{console.error("Error en modificaci\xF3n grupal de paralelo (bulk)",P);let re=P?.error?.message;re?this._tools.MostrarMensaje("warning",re):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}});return}this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","Se eliminar\xE1n todas las materias del curso/paralelo seleccionado","warning","SI, ESTOY SEGURO","NO").then(L=>{if(!L){this.isProcesandoAccionGrupal=!1;return}this._mat.EliminarMateriasGrupal({anio_id:i.anio_id,resolucion:i.resolucion,nivel:i.nivel,instituciones_id:i.instituciones_id,lvlcurso:e,paralelo_actual:r}).subscribe({next:()=>{this._tools.MostrarMensajeSuccess(),this.Cargarmaterias(),this._tools.closeModal(this.modalAccionesMateriasRef)},error:P=>{console.error("Error en eliminaci\xF3n grupal de materias (bulk)",P);let re=P?.error?.message;re?this._tools.MostrarMensaje("warning",re):this._tools.MostrarMensajeError(),this.isProcesandoAccionGrupal=!1},complete:()=>{this.isProcesandoAccionGrupal=!1}})})},error:()=>{this.isProcesandoAccionGrupal=!1,this._tools.MostrarMensajeError()}})}upper(i){return(i??"").toString().trim().toUpperCase()}getFiltroParams(){let i=this.filtroAnioId,e=!!(this.filtroResolucionKey&&this.filtroResolucionKey.toString().trim());return!i||!e||(this.parseResolucionKey(),!this.filtroResolucion||!this.filtroNivelCarrera)?null:{anio_id:i,resolucion:this.filtroResolucion,nivel:this.filtroNivelCarrera,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0}}rebuildResolucionOptions(){let i=new Map;for(let e of this.carreras){let t=(e?.Resolucion??"").toString().trim();if(!t)continue;let r=(e?.Nivel??"").toString().trim(),d=(e?.Area??"").toString().trim(),_=e?.instituciones_id,h=_!=null&&_!==""?Number(_):null,A=(e?.NombreInstitucion??"").toString().trim(),I=r||"SIN NIVEL",V=`${t}|${I}`,T=this.esSuperAdmin&&h?`${h}|${V}`:V,D=`${d?d+" \xB7 ":""}${t} (${I})`,k=this.esSuperAdmin&&h?`${D}${A?" \xB7 "+A:""}`:D;i.has(T)||i.set(T,{key:T,label:k,resolucion:t,nivel:I,instituciones_id:h})}this.resolucionOptions=Array.from(i.values()).sort((e,t)=>e.label.localeCompare(t.label))}onFiltroChange(){if(this.paginamaterias=1,!!!this.filtroAnioId){this.materias=[],this.collectionSizematerias=0;return}this.parseResolucionKey(),this.Cargarmaterias()}parseResolucionKey(){let i=(this.filtroResolucionKey??"").toString();if(!i){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=i.split("|");if(e.length>=3){let t=Number(e[0]),r=(e[1]??"").toString(),d=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(t)?t:null,this.filtroResolucion=r||null,this.filtroNivelCarrera=d||null;return}if(e.length===2){let t=(e[0]??"").toString(),r=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=t||null,this.filtroNivelCarrera=r||null;return}this.filtroInstitucionId=null,this.filtroResolucion=i,this.filtroNivelCarrera=null}Cargarmaterias(){let i=this.filtroAnioId;if(!i){this.materias=[],this.collectionSizematerias=0;return}this.isLoadingmaterias=!0;let e={anio_id:i,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0};this.filtroResolucion&&(e.resolucion=this.filtroResolucion),this.filtroNivelCarrera&&(e.nivel=this.filtroNivelCarrera),this._mat.Obtenermaterias(e).subscribe({next:t=>{console.log(t),this.materias=t.data||[],this.collectionSizematerias=this.materias.length,this.isLoadingmaterias=!1},error:t=>{console.error("Error al cargar materias",t),this.isLoadingmaterias=!1}})}AgregarModificarmaterias(){if(this.newmaterias.invalid){this.ValidacionTodoElementomaterias(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalmaterias=!1;return}else{this.AnimarCargaTablamaterias(),this.AnimacionCargabtnModalmaterias=!0,this._tools.MostrarMensajeLoading(),this.newmateriasAnteriorAccion.setValue(this.newmaterias.value);let i=this.newmaterias.controls.id.value;console.log("INFO A PROCESAR",this.newmaterias.value),i?this._mat.Modificarmaterias(this.newmaterias.value,this.newmaterias.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE materias",e.data),this.Cargarmaterias(),this.resetmaterias(),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR materias",e),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeError()}):this._mat.Agregarmaterias(this.newmaterias.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE materias",e.data),this.Cargarmaterias(),this.resetmaterias(),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR materias",e),this.AnimacionCargabtnModalmaterias=!1,this._tools.MostrarMensajeError()})}}Seleccionarmaterias(i){if(this._tools.MostrarMensajeLoading(),i){if(!this.materias.find(t=>t.id===i))return;this._mat.Seleccionarmaterias(i).subscribe(t=>{Object.keys(this.newmaterias.controls).forEach(r=>{this.newmaterias.controls[r].setValue(t.data[r])}),console.log("SELECCION DE materias EXITOSA",this.newmaterias.value),this.newmateriasAnteriorAccion.setValue(this.newmaterias.value),this.modalGestionmateriasRef=this._tools.openModal(this.modalgestionmaterias,"xl"),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL SELECCIONAR materias",t),this._tools.MostrarMensajeError()})}}Eliminarmaterias(i){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._mat.Eliminarmaterias(i).subscribe(t=>{console.log(t.data),this.Cargarmaterias(),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL ELIMINAR materias",t),this._tools.MostrarMensajeError()}))})}resetmaterias(){this.newmaterias=this._mat.createFormGroupmaterias(),this._tools.closeModal(this.modalGestionmateriasRef)}AutoCompletarLastmaterias(){this.newmaterias.setValue(this.newmateriasAnteriorAccion.value),this.newmaterias.patchValue({id:0}),console.log("listo",this.newmaterias.value)}AnimarCargaTablamaterias(){this.materias=[],this.isLoadingmaterias=!0}ValidacionmateriasxElemento(i){return this._tools.obtenerValidationClass(this.newmaterias,i)}ValidacionTodoElementomaterias(){Object.values(this.newmaterias.controls).forEach(i=>{i.markAsTouched(),i.markAsDirty()})}onPageSizeChangematerias(){this.paginamaterias=1}sortBymaterias(i,e){this.sortColumnsmaterias=this._tools.handleSort(i,e,this.sortColumnsmaterias),this.materias=this._tools.applyMultiSort(this.materias,this.sortColumnsmaterias)}isSortedmaterias(i){return this._tools.isSorted(this.sortColumnsmaterias,i)}getSortDirmaterias(i){return this._tools.getSortDirection(this.sortColumnsmaterias,i)}closeMenu(){this._tools.close()}abrirMenumaterias(i,e){i.preventDefault(),i.stopPropagation(),console.log("aS",e);let t=[{label:"\u270F Editar",action:()=>this.Seleccionarmaterias(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarmaterias(e.id)}];this._tools.open(i.clientX,i.clientY,t)}cargarCarreras(){this._carr.Obtenercarreras().subscribe({next:i=>{this.carreras=i.data||[],this.rebuildResolucionOptions()},error:i=>{console.error("Error al cargar carreras",i)}})}cargarAnios(){this._anios.ObtenerAniosConPredeterminado().subscribe({next:i=>{if(this.anios=i?.anios||[],this.filtroAnioId===null||this.filtroAnioId===void 0){let e=i?.predeterminado;e?.id?this.filtroAnioId=Number(e.id):this.anios?.length&&(this.filtroAnioId=Number(this.anios[0]?.id))}this.onFiltroChange()},error:i=>{console.error("Error al cargar anios",i)}})}cargarplandeestudios(){this._planest.Obtenerplandeestudios().subscribe({next:i=>{console.log(i.data),this.plandeestudios=i.data||[]},error:i=>{console.error("Error al cargar plandeestudios",i)}})}seleccionarPlan(i){this.planInput.setValue(`${i.NombreMateria} (${i.SiglaMateria})`,{emitEvent:!1}),this.newmaterias.get("plandeestudios_id")?.setValue(i.id),this.mostrarLista=!1}};Re.\u0275fac=function(e){return new(e||Re)(E(tt),E(ie),E(Ne),E(Ie),E(ne),E(Te),E(ee))},Re.\u0275cmp=H({type:Re,selectors:[["app-materias"]],viewQuery:function(e,t){if(e&1&&(de(Si,7),de(Ei,7)),e&2){let r;me(r=pe())&&(t.modalAccionesMaterias=r.first),me(r=pe())&&(t.modalgestionmaterias=r.first)}},hostBindings:function(e,t){e&1&&f("click",function(){return t.closeMenu()},ve)},standalone:!1,decls:52,vars:19,consts:[["modalgestionmaterias",""],["modalAccionesMaterias",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"col-sm-6","d-flex","justify-content-start","button",2,"gap","10px"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","d-flex","justify-content-end",2,"gap","10px"],[1,"form-floating",2,"min-width","140px"],["title","Filtrar por A\xF1o",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-floating",2,"min-width","180px"],["title","Filtrar por Resoluci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],["class","mt-4",4,"ngIf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"small","text-muted"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"col-sm-12","mb-3","position-relative"],["type","text","placeholder","Buscar plan de estudios","autocomplete","off",1,"form-control",3,"focus","formControl"],["class","list-group position-absolute w-100","style","z-index: 1000;",4,"ngIf"],["class","invalid-feedback d-block",4,"ngIf"],[1,"form-floating","mb-3","col-sm-12"],["type","text","placeholder","","formControlName","Paralelo",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],[1,"invalid-feedback"],["formControlName","Turno",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["formControlName","ModoAsistencia",1,"form-control",3,"ngClass"],["formControlName","EstadoHabilitacion",1,"form-control",3,"ngClass"],["formControlName","EstadoEnvio",1,"form-control",3,"ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[1,"list-group","position-absolute","w-100",2,"z-index","1000"],["class","list-group-item list-group-item-action",3,"click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"click"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"invalid-feedback","d-block"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"text-muted","mb-3"],[1,"col-sm-6","mb-3"],["title","Acci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],["title","Curso",1,"form-control",3,"ngModelChange","ngModel"],["class","col-sm-6 mb-3",4,"ngIf"],["title","Cancelar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click","disabled"],["class","btn mouse-dir success","title","Procesando",3,"disabled",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style","gap: 8px;","title","Ejecutar",3,"click",4,"ngIf"],["title","Paralelo actual",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","",1,"form-control",2,"text-transform","uppercase",3,"ngModelChange","ngModel"],[1,"form-text"],["title","Turno",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],[3,"ngValue","disabled"],["title","Modo de asistencia",1,"form-control",3,"ngModelChange","ngModel"],["title","Estado de habilitaci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],["title","Procesando",1,"btn","mouse-dir","success",3,"disabled"],["title","Ejecutar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"]],template:function(e,t){if(e&1){let r=C();n(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1",5),c(4,"Gesti\xF3n de materias"),o(),n(5,"p",6),c(6,"Administra la informaci\xF3n de los materias de manera sencilla y eficiente"),o()()()(),n(7,"div",3)(8,"div",7)(9,"button",8),f("click",function(){return p(r),u(t.abrirModalNuevoMaterias())}),n(10,"span",9),x(11,"ng-lottie",10),o(),n(12,"span"),c(13,"A\xF1adir materias "),o(),x(14,"span",11),o(),n(15,"button",8),f("click",function(){return p(r),u(t.abrirModalAccionesMaterias())}),n(16,"span",9),x(17,"ng-lottie",10),o(),n(18,"span"),c(19,"Acciones Grupales"),o(),x(20,"span",11),o()(),n(21,"div",12)(22,"div",13)(23,"select",14),w("ngModelChange",function(_){return p(r),M(t.filtroAnioId,_)||(t.filtroAnioId=_),u(_)}),f("ngModelChange",function(){return p(r),t.paginamaterias=1,u(t.onFiltroChange())}),n(24,"option",15),c(25,"Seleccione una opci\xF3n"),o(),g(26,wi,2,2,"option",16),o(),n(27,"label"),c(28,"A\xF1o"),o()(),n(29,"div",17)(30,"select",18),w("ngModelChange",function(_){return p(r),M(t.filtroResolucionKey,_)||(t.filtroResolucionKey=_),u(_)}),f("ngModelChange",function(){return p(r),t.paginamaterias=1,u(t.onFiltroChange())}),n(31,"option",15),c(32,"Seleccione una opci\xF3n"),o(),g(33,Ai,2,2,"option",16),o(),n(34,"label"),c(35,"Resoluci\xF3n"),o()()(),n(36,"div",19)(37,"div",20)(38,"span",21),x(39,"ng-lottie",22),o(),n(40,"div",23)(41,"input",24),f("input",function(){return p(r),u(t.paginamaterias=1)}),w("ngModelChange",function(_){return p(r),M(t.filtertxtmaterias,_)||(t.filtertxtmaterias=_),u(_)}),o(),n(42,"label"),c(43,"Buscar"),o()()()()(),g(44,$i,36,22,"div",25),N(45,"filterByFields"),g(46,tn,59,18,"ng-template",null,0,$)(48,on,5,11,"div",26),N(49,"async"),g(50,xn,43,16,"ng-template",null,1,$)}if(e&2){let r;s(11),l("options",t._tools.optionsAdicionar),s(6),l("options",t._tools.optionssubgestion),s(6),y("ngModel",t.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",t.anios),s(4),y("ngModel",t.filtroResolucionKey),s(),l("ngValue",null),s(2),l("ngForOf",t.resolucionOptions),s(6),l("options",t._tools.optionslupa),s(2),y("ngModel",t.filtertxtmaterias),s(3),l("ngIf",W(45,12,t.materias,t.filtertxtmaterias,Qe(18,yi))),s(4),l("ngIf",(r=R(49,16,t.menuStatematerias$))==null?null:r.visible)}},dependencies:[U,q,K,Ce,ye,X,Z,Se,J,Q,Ee,Y,bt,Me,we,Ae,te,he,be,Pe],styles:[".dropdown-list[_ngcontent-%COMP%]{position:absolute;width:100%;max-height:280px;overflow-y:auto;background:#fff;border:1px solid #ced4da;z-index:1000}.dropdown-item[_ngcontent-%COMP%]{padding:8px 12px;cursor:pointer}.dropdown-item[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.row-item[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 80px 140px;gap:12px;align-items:center}.center[_ngcontent-%COMP%]{text-align:center;font-weight:500}.right[_ngcontent-%COMP%]{text-align:right;white-space:nowrap}"]});var Fe=Re;var Cn=["modalgestionplandeestudios"],hn=()=>["RangoLvlCurso","Rango","LvlCurso","NombreMateria","SiglaMateria","SiglasPrerrequisitos","TipoMateria","ModoMateria","Horas","Anio","Resolucion","Nivel","NombreCarrera","NombreInstitucion"],G=(a,i)=>({"bi-caret-up":a,"bi-caret-down":i}),bn=(a,i)=>({top:a,left:i});function Sn(a,i){if(a&1&&(n(0,"option",16),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.id),s(),v(e.Anio)}}function En(a,i){if(a&1&&(n(0,"option",16),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.key),s(),v(e.label)}}function yn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(3);l("ngClass",b(1,G,e.getSortDirplandeestudios("NombreInstitucion")==="asc",e.getSortDirplandeestudios("NombreInstitucion")==="desc"))}}function Mn(a,i){if(a&1){let e=C();n(0,"th",34),f("click",function(r){p(e);let d=m(2);return u(d.sortByplandeestudios("NombreInstitucion",r))}),c(1," Nombre Institucion "),g(2,yn,1,4,"i",35),o()}if(a&2){let e=m(2);s(2),l("ngIf",e.isSortedplandeestudios("NombreInstitucion"))}}function wn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("RangoLvlCurso")==="asc",e.getSortDirplandeestudios("RangoLvlCurso")==="desc"))}}function An(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("Rango")==="asc",e.getSortDirplandeestudios("Rango")==="desc"))}}function In(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("LvlCurso")==="asc",e.getSortDirplandeestudios("LvlCurso")==="desc"))}}function Tn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("NombreMateria")==="asc",e.getSortDirplandeestudios("NombreMateria")==="desc"))}}function On(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("Horas")==="asc",e.getSortDirplandeestudios("Horas")==="desc"))}}function Vn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("SiglaMateria")==="asc",e.getSortDirplandeestudios("SiglaMateria")==="desc"))}}function Nn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("SiglasPrerrequisitos")==="asc",e.getSortDirplandeestudios("SiglasPrerrequisitos")==="desc"))}}function Dn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("TipoMateria")==="asc",e.getSortDirplandeestudios("TipoMateria")==="desc"))}}function Pn(a,i){if(a&1&&x(0,"i",43),a&2){let e=m(2);l("ngClass",b(1,G,e.getSortDirplandeestudios("ModoMateria")==="asc",e.getSortDirplandeestudios("ModoMateria")==="desc"))}}function Rn(a,i){if(a&1&&(n(0,"tr")(1,"td",32)(2,"div",44)(3,"span",45),c(4,"Cargando..."),o()()()()),a&2){let e=m(2);s(),B("colspan",e.esSuperAdmin?14:13)}}function Fn(a,i){if(a&1&&(n(0,"tr")(1,"td",32),c(2,"No hay datos disponibles"),o()()),a&2){let e=m(2);s(),B("colspan",e.esSuperAdmin?14:13)}}function kn(a,i){if(a&1&&(n(0,"td"),c(1),o()),a&2){let e=m().$implicit;s(),v(e.NombreInstitucion)}}function Ln(a,i){if(a&1&&x(0,"img",53),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"pencil.svg",j)}}function Gn(a,i){if(a&1&&x(0,"ng-lottie",54),a&2){let e=m(3);l("options",e._tools.optionsEditar)}}function jn(a,i){if(a&1&&x(0,"img",53),a&2){let e=m(3);l("src",e._tools.rutabtniconsanimaciones+"delete.svg",j)}}function Bn(a,i){if(a&1&&x(0,"ng-lottie",54),a&2){let e=m(3);l("options",e._tools.optionsEliminar)}}function $n(a,i){if(a&1){let e=C();n(0,"tr",46),f("contextmenu",function(r){let d=p(e).$implicit,_=m(2);return u(_.abrirMenuplandeestudios(r,d))}),n(1,"td",32),c(2),o(),g(3,kn,2,1,"td",37),n(4,"td",32),c(5),o(),n(6,"td",32),c(7),o(),n(8,"td"),c(9),n(10,"div",47),c(11),o()(),n(12,"td"),c(13),n(14,"div",47),c(15),o()(),n(16,"td",32),c(17),o(),n(18,"td"),c(19),o(),n(20,"td"),c(21),o(),n(22,"td"),c(23),o(),n(24,"td"),c(25),o(),n(26,"td",48)(27,"button",49),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.Seleccionarplandeestudios(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["edicionplandeestudios-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["edicionplandeestudios-"+r.id]=!1)}),g(28,Ln,1,1,"img",50)(29,Gn,1,1,"ng-lottie",51),o(),n(30,"button",52),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.Eliminarplandeestudios(r.id))})("mouseenter",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["eliminacionplandeestudios-"+r.id]=!0)})("mouseleave",function(){let r=p(e).$implicit,d=m(2);return u(d._tools.hoverBotonMap["eliminacionplandeestudios-"+r.id]=!1)}),g(31,jn,1,1,"img",50)(32,Bn,1,1,"ng-lottie",51),o()()()}if(a&2){let e=i.$implicit,t=i.index,r=m(2);s(2),v((r.paginaplandeestudios-1)*r.pageSizeplandeestudios+(t+1)),s(),l("ngIf",r.esSuperAdmin),s(2),S(" ",e.RangoLvlCurso," "),s(2),v(e.Rango),s(2),S("",e.LvlCurso," "),s(2),S(" ",e.Nivel),s(2),S("",e.NombreMateria," "),s(2),ue("A\xF1o: ",e.Anio," \xB7 Res: ",e.Resolucion),s(2),v(e.Horas),s(2),v(e.SiglaMateria),s(2),v(e.SiglasPrerrequisitos),s(2),v(e.TipoMateria),s(2),v(e.ModoMateria),s(3),l("ngIf",!r._tools.hoverBotonMap["edicionplandeestudios-"+e.id]),s(),l("ngIf",r._tools.hoverBotonMap["edicionplandeestudios-"+e.id]),s(2),l("ngIf",!r._tools.hoverBotonMap["eliminacionplandeestudios-"+e.id]),s(),l("ngIf",r._tools.hoverBotonMap["eliminacionplandeestudios-"+e.id])}}function zn(a,i){if(a&1&&(n(0,"option",55),c(1),o()),a&2){let e=i.$implicit;l("value",e),s(),S("",e," por p\xE1gina")}}function Hn(a,i){if(a&1){let e=C();n(0,"div",28)(1,"div",29)(2,"table",30)(3,"thead",31)(4,"tr")(5,"th",32),c(6,"#"),o(),g(7,Mn,3,1,"th",33),n(8,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("RangoLvlCurso",r))}),c(9," Nivel "),g(10,wn,1,4,"i",35),o(),n(11,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("Rango",r))}),c(12," Rango "),g(13,An,1,4,"i",35),o(),n(14,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("LvlCurso",r))}),c(15," Nivel Curso "),g(16,In,1,4,"i",35),o(),n(17,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("NombreMateria",r))}),c(18," NombreMateria "),g(19,Tn,1,4,"i",35),o(),n(20,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("Horas",r))}),c(21," Horas "),g(22,On,1,4,"i",35),o(),n(23,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("SiglaMateria",r))}),c(24," Sigla "),g(25,Vn,1,4,"i",35),o(),n(26,"th",36),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("SiglasPrerrequisitos",r))}),c(27," Sigla Pre. "),g(28,Nn,1,4,"i",35),o(),n(29,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("TipoMateria",r))}),c(30," TipoMateria "),g(31,Dn,1,4,"i",35),o(),n(32,"th",34),f("click",function(r){p(e);let d=m();return u(d.sortByplandeestudios("ModoMateria",r))}),c(33," Modo Materia "),g(34,Pn,1,4,"i",35),o(),n(35,"th",32),c(36,"ACCIONES"),o()()(),n(37,"tbody"),g(38,Rn,5,1,"tr",37)(39,Fn,3,1,"tr",37)(40,$n,33,18,"tr",38),N(41,"slice"),o()()(),n(42,"div",39)(43,"ngb-pagination",40),w("pageChange",function(r){p(e);let d=m();return M(d.paginaplandeestudios,r)||(d.paginaplandeestudios=r),u(r)}),o(),n(44,"select",41),w("ngModelChange",function(r){p(e);let d=m();return M(d.pageSizeplandeestudios,r)||(d.pageSizeplandeestudios=r),u(r)}),f("change",function(){p(e);let r=m();return u(r.onPageSizeChangeplandeestudios())}),g(45,zn,2,2,"option",42),o()()()}if(a&2){let e=i.ngIf,t=m();s(7),l("ngIf",t.esSuperAdmin),s(3),l("ngIf",t.isSortedplandeestudios("RangoLvlCurso")),s(3),l("ngIf",t.isSortedplandeestudios("Rango")),s(3),l("ngIf",t.isSortedplandeestudios("LvlCurso")),s(3),l("ngIf",t.isSortedplandeestudios("NombreMateria")),s(3),l("ngIf",t.isSortedplandeestudios("Horas")),s(3),l("ngIf",t.isSortedplandeestudios("SiglaMateria")),s(3),l("ngIf",t.isSortedplandeestudios("SiglasPrerrequisitos")),s(3),l("ngIf",t.isSortedplandeestudios("TipoMateria")),s(3),l("ngIf",t.isSortedplandeestudios("ModoMateria")),s(4),l("ngIf",t.isLoadingplandeestudios),s(),l("ngIf",!t.isLoadingplandeestudios&&e.length===0),s(),l("ngForOf",W(41,22,e,(t.paginaplandeestudios-1)*t.pageSizeplandeestudios,t.paginaplandeestudios*t.pageSizeplandeestudios)),s(3),y("page",t.paginaplandeestudios),l("collectionSize",e.length)("pageSize",t.pageSizeplandeestudios)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),y("ngModel",t.pageSizeplandeestudios),s(),l("ngForOf",t.pageSizeOptionsplandeestudios)}}function Wn(a,i){if(a&1&&(n(0,"option",55),c(1),o()),a&2){let e=i.$implicit;l("value",e.id),s(),v(e.Anio)}}function Un(a,i){if(a&1&&(n(0,"option",55),c(1),o()),a&2){let e=i.$implicit,t=m(2);l("value",e.id),s(),S(" ",t.esSuperAdmin?e.NombreCarrera+" ("+e.NombreInstitucion+" | "+e.Resolucion+(e.Nivel?" ("+e.Nivel+")":"")+")":e.NombreCarrera+" ("+e.Resolucion+(e.Nivel?" ("+e.Nivel+")":"")+")"," ")}}function qn(a,i){if(a&1&&(n(0,"option",89),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Kn(a,i){if(a&1&&(n(0,"option",89),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Qn(a,i){if(a&1&&(n(0,"option",89),c(1),o()),a&2){let e=i.$implicit;l("value",e.value)("disabled",e.disabled),s(),v(e.label)}}function Yn(a,i){if(a&1){let e=C();n(0,"button",92),f("click",function(){p(e);let r=m(3);return u(r.AutoCompletarLastplandeestudios())}),n(1,"span",10),x(2,"ng-lottie",11),o(),n(3,"span"),c(4,"AUTO COMPLETAR "),o(),x(5,"span",12),o()}if(a&2){let e=m(3);s(2),l("options",e._tools.optionsautocompletar)}}function Jn(a,i){if(a&1&&(n(0,"div",90),g(1,Yn,6,1,"button",91),o()),a&2){let e=m(2);s(),l("ngIf",!e.AnimacionCargabtnModalplandeestudios)}}function Xn(a,i){if(a&1){let e=C();n(0,"button",93),f("click",function(){p(e);let r=m().$implicit,d=m();return r.dismiss(),u(d.resetplandeestudios())}),n(1,"span",10),x(2,"ng-lottie",11),o(),n(3,"span"),c(4,"CANCELAR"),o(),x(5,"span",12),o()}if(a&2){let e=m(2);s(2),l("options",e._tools.optionscancelar)}}function Zn(a,i){if(a&1){let e=C();n(0,"button",94),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarplandeestudios())}),x(1,"span",95),o()}a&2&&l("disabled",!0)}function eo(a,i){if(a&1){let e=C();n(0,"button",96),f("click",function(){p(e);let r=m(2);return u(r.AgregarModificarplandeestudios())}),n(1,"span",10),x(2,"ng-lottie",11),o(),n(3,"span"),c(4),o(),x(5,"span",12),o()}if(a&2){let e,t,r=m(2);s(2),l("options",(e=r.newplandeestudios.get("id"))!=null&&e.value?r._tools.optionsEditar:r._tools.optionsAdicionar),s(2),v((t=r.newplandeestudios.get("id"))!=null&&t.value?"MODIFICAR":"REGISTRAR")}}function to(a,i){if(a&1){let e=C();n(0,"div",56)(1,"h4",57),c(2),o(),n(3,"button",58),f("click",function(){let r=p(e).$implicit,d=m();return r.dismiss(),u(d.resetplandeestudios())}),o()(),n(4,"div",59)(5,"form",60)(6,"div",4)(7,"div",61)(8,"select",62)(9,"option",63),c(10,"Seleccione una opci\xF3n"),o(),g(11,Wn,2,2,"option",42),o(),n(12,"label"),c(13,"A\xF1o"),o(),n(14,"div",64),c(15,"Este campo es obligatorio*"),o()(),n(16,"div",61)(17,"select",65)(18,"option",63),c(19,"Seleccione una opci\xF3n"),o(),g(20,Un,2,2,"option",42),o(),n(21,"label"),c(22,"Carrera"),o(),n(23,"div",64),c(24,"Este campo es obligatorio*"),o()()(),n(25,"div",4)(26,"div",66),x(27,"input",67),n(28,"label"),c(29,"Nivel"),o(),n(30,"div",64),c(31,"Este campo es obligatorio*"),o()(),n(32,"div",66),x(33,"input",68),n(34,"label"),c(35,"Rango"),o(),n(36,"div",64),c(37,"Este campo es obligatorio*"),o()(),n(38,"div",69),x(39,"input",70),n(40,"label"),c(41,"Horas"),o(),n(42,"div",64),c(43,"Este campo es obligatorio*"),o()(),n(44,"div",71)(45,"select",72)(46,"option",73),c(47,"Seleccione una opci\xF3n"),o(),g(48,qn,2,3,"option",74),o(),n(49,"label"),c(50,"Nivel del Curso"),o(),n(51,"div",64),c(52,"Este campo es obligatorio*"),o()()(),n(53,"div",4)(54,"div",61)(55,"input",75),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newplandeestudios,"NombreMateria"))}),o(),n(56,"label"),c(57,"Nombre Materia"),o(),n(58,"div",64),c(59,"Este campo es obligatorio*"),o()(),n(60,"div",61)(61,"input",76),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newplandeestudios,"SiglaMateria"))}),o(),n(62,"label"),c(63,"Sigla Materia"),o(),n(64,"div",64),c(65,"Este campo es obligatorio*"),o()()(),n(66,"div",4)(67,"div",61)(68,"input",77),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newplandeestudios,"Prerrequisitos"))}),o(),n(69,"label"),c(70,"Prerrequisitos"),o(),n(71,"div",64),c(72,"Este campo es obligatorio*"),o()(),n(73,"div",61)(74,"input",78),f("change",function(r){p(e);let d=m();return u(d._tools.EscribirEnMayuscula(r,d.newplandeestudios,"SiglasPrerrequisitos"))}),o(),n(75,"label"),c(76,"Siglas Prerrequisitos"),o(),n(77,"div",64),c(78,"Este campo es obligatorio*"),o()()(),n(79,"div",4)(80,"div",66)(81,"select",79)(82,"option",73),c(83,"Seleccione una opci\xF3n"),o(),g(84,Kn,2,3,"option",74),o(),n(85,"label"),c(86,"Tipo de Materia"),o(),n(87,"div",64),c(88,"Este campo es obligatorio*"),o()(),n(89,"div",80)(90,"select",81)(91,"option",73),c(92,"Seleccione una opci\xF3n"),o(),g(93,Qn,2,3,"option",74),o(),n(94,"label"),c(95,"Modo de Materia"),o(),n(96,"div",64),c(97,"Este campo es obligatorio*"),o()()()()(),n(98,"div",82),g(99,Jn,2,1,"div",83),n(100,"div",84),g(101,Xn,6,1,"button",85),o(),n(102,"div",86),g(103,Zn,2,1,"button",87)(104,eo,6,2,"button",88),o()()}if(a&2){let e,t=m();s(2),S("",(e=t.newplandeestudios.get("id"))!=null&&e.value?"Modificar":"Registrar"," plandeestudios"),s(3),l("formGroup",t.newplandeestudios),s(3),l("ngClass",t.ValidacionplandeestudiosxElemento("anio_id")),s(3),l("ngForOf",t.anios),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("carreras_id")),s(3),l("ngForOf",t.carreras),s(7),l("ngClass",t.ValidacionplandeestudiosxElemento("RangoLvlCurso")),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("Rango")),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("Horas")),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("LvlCurso")),s(3),l("ngForOf",t.LvlCursoOptions),s(7),l("ngClass",t.ValidacionplandeestudiosxElemento("NombreMateria")),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("SiglaMateria")),s(7),l("ngClass",t.ValidacionplandeestudiosxElemento("Prerrequisitos")),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("SiglasPrerrequisitos")),s(7),l("ngClass",t.ValidacionplandeestudiosxElemento("TipoMateria")),s(3),l("ngForOf",t.tipoMateriaOptions),s(6),l("ngClass",t.ValidacionplandeestudiosxElemento("ModoMateria")),s(3),l("ngForOf",t.modoMateriaOptions),s(6),l("ngIf",!t.newplandeestudios.get("id").value),s(2),l("ngIf",!t.AnimacionCargabtnModalplandeestudios),s(2),l("ngIf",t.AnimacionCargabtnModalplandeestudios),s(),l("ngIf",!t.AnimacionCargabtnModalplandeestudios)}}function io(a,i){if(a&1){let e=C();n(0,"button",99),f("click",function(){let r=p(e).$implicit;return u(r.action())}),c(1),o()}if(a&2){let e=i.$implicit;s(),S(" ",e.label," ")}}function no(a,i){if(a&1&&(n(0,"div",97),N(1,"async"),N(2,"async"),g(3,io,2,1,"button",98),N(4,"async"),o()),a&2){let e,t,r=m();l("ngStyle",b(8,bn,((e=R(1,2,r.menuStateplandeestudios$))==null?null:e.y)+"px",((e=R(2,4,r.menuStateplandeestudios$))==null?null:e.x)+"px")),s(3),l("ngForOf",(t=R(4,6,r.menuStateplandeestudios$))==null?null:t.items)}}function oo(a,i){if(a&1){let e=C();n(0,"div",56)(1,"h5",57),c(2,"Componente Gestion de Carreras"),o(),n(3,"button",100),f("click",function(){let r=p(e).$implicit;return u(r.dismiss())}),o()(),n(4,"div",59),x(5,"app-carreras",101),o()}a&2&&(s(5),l("modo","uno")("idAnio","ASDASD"))}function ro(a,i){if(a&1){let e=C();n(0,"div",56)(1,"h5",57),c(2,"Componente Gestion de Materias"),o(),n(3,"button",100),f("click",function(){let r=p(e).$implicit;return u(r.dismiss())}),o()(),n(4,"div",59),x(5,"app-materias",101),o()}a&2&&(s(5),l("modo","uno")("idAnio","ASDASD"))}var Le=class Le{constructor(i,e,t,r,d,_){this._controles=i;this._planest=e;this._tools=t;this._carr=r;this._anios=d;this._auth=_;this.isRelacionDocenteEstudianteLocked=!1;this.relacionDocenteEstudianteOptionsView=[];this.tipoMateriaOptions=[];this.modoMateriaOptions=[];this.relacionDocenteEstudianteOptions=[];this.LvlCursoOptions=[];this.esSuperAdmin=!1;this.plandeestudios=[];this.paginaplandeestudios=1;this.isLoadingplandeestudios=!1;this.AnimacionCargabtnModalplandeestudios=!1;this.filtertxtplandeestudios="";this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.collectionSizeplandeestudios=0;this.pageSizeplandeestudios=10;this.pageSizeOptionsplandeestudios=[5,10,20,50];this.sortColumnsplandeestudios=[];this.menuStateplandeestudios$=this._tools.state$;this.carreras=[];this.anios=[];this.newplandeestudios=this._planest.createFormGroupplandeestudios(),this.newplandeestudiosAnteriorAccion=this._planest.createFormGroupplandeestudios(),this.initModoMateriaWatcher()}ngOnInit(){this.cargarCarreras(),this.cargarAnios(),this.cargarOptionsDesdeControles(),this._auth.revisarSiEsSuperAdmin().subscribe(i=>{this.esSuperAdmin=i,this.rebuildResolucionOptions(),this.onFiltroChange()})}cargarOptionsDesdeControles(){let i=["TIPOS MATERIAS","MODOS MATERIAS","RELACI\xD3N DOCENTE ESTUDIANTES","LVLCURSO"];this._controles.ObtenerOptionsSelectPorCategorias(i).subscribe({next:e=>{this.tipoMateriaOptions=e?.["TIPOS MATERIAS"]||[],this.modoMateriaOptions=e?.["MODOS MATERIAS"]||[],this.relacionDocenteEstudianteOptions=e?.["RELACI\xD3N DOCENTE ESTUDIANTES"]||[],this.LvlCursoOptions=e?.LVLCURSO||[],this.applyRelacionDocenteRules(this.newplandeestudios?.get("ModoMateria")?.value)},error:()=>{this.tipoMateriaOptions=[],this.modoMateriaOptions=[],this.relacionDocenteEstudianteOptions=[],this.LvlCursoOptions=[],this.relacionDocenteEstudianteOptionsView=[],this.isRelacionDocenteEstudianteLocked=!1}})}initModoMateriaWatcher(){this.modoMateriaSub?.unsubscribe();let i=this.newplandeestudios?.get("ModoMateria");i&&(this.modoMateriaSub=i.valueChanges.subscribe(e=>{this.applyRelacionDocenteRules(e)}),this.applyRelacionDocenteRules(i.value))}normalizeText(i){return(i??"").toString().trim().toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}findOptionValueApprox(i,e){let t=this.normalizeText(i);return(e||[]).find(d=>this.normalizeText(d?.value)===t||this.normalizeText(d?.label)===t)?.value??null}buildAllowedValues(i){let e=new Set;for(let t of i){let r=this.findOptionValueApprox(t,this.relacionDocenteEstudianteOptions);e.add(r??t)}return e}isModoMateria(i,e){return this.normalizeText(i)===this.normalizeText(e)}applyRelacionDocenteRules(i){let e=this.newplandeestudios?.get("RelacionDocenteCursoAEstudiante"),t=(e?.value??"").toString(),r=null,d=!1;this.isModoMateria(i,"1 DOCENTE x MATERIA")||this.isModoMateria(i,"MULTIPLES DOCENTES x MATERIA")?(d=!0,r=this.buildAllowedValues(["NINGUNA"])):this.isModoMateria(i,"MODO INSTRUMENTOS DE ESPECIALIDAD")?r=this.buildAllowedValues(["1 DOCENTE DE ESPECIALIDAD x ESTUDIANTE","2 DOCENTES DE ESPECIALIDAD x ESTUDIANTE","NINGUNA"]):(this.isModoMateria(i,"MODO PR\xC1CTICA DE CONJUNTOS")||this.isModoMateria(i,"MODO PRACTICA DE CONJUNTOS"))&&(r=this.buildAllowedValues(["1 DOCENTE DE PR\xC1CTICA DE CONJUNTO x ESTUDIANTE","1 DOCENTE DE PRACTICA DE CONJUNTO x ESTUDIANTE","NINGUNA"])),this.isRelacionDocenteEstudianteLocked=d;let _=this.relacionDocenteEstudianteOptions||[];if(this.relacionDocenteEstudianteOptionsView=_.map(h=>{let A=r?r.has(h.value):!0;return Be(ae({},h),{disabled:!!h.disabled||!A})}),e){let h=this.findOptionValueApprox("NINGUNA",_)??"NINGUNA",A=r?r.has(t):!0;(d||!A)&&t!==h&&e.setValue(h)}}rebuildResolucionOptions(){let i=new Map;for(let e of this.carreras){let t=(e?.Resolucion??"").toString().trim();if(!t)continue;let r=(e?.Nivel??"").toString().trim(),d=(e?.Area??"").toString().trim(),_=e?.instituciones_id,h=_!=null&&_!==""?Number(_):null,A=(e?.NombreInstitucion??"").toString().trim(),I=r||"SIN NIVEL",V=`${t}|${I}`,T=this.esSuperAdmin&&h?`${h}|${V}`:V,D=`${d?d+" \xB7 ":""}${t} (${I})`,k=this.esSuperAdmin&&h?`${D}${A?" \xB7 "+A:""}`:D;i.has(T)||i.set(T,{key:T,label:k,resolucion:t,nivel:I,instituciones_id:h})}this.resolucionOptions=Array.from(i.values()).sort((e,t)=>e.label.localeCompare(t.label))}onFiltroChange(){if(this.paginaplandeestudios=1,!!!this.filtroAnioId){this.plandeestudios=[],this.collectionSizeplandeestudios=0;return}this.parseResolucionKey(),this.Cargarplandeestudios()}parseResolucionKey(){let i=(this.filtroResolucionKey??"").toString();if(!i){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=i.split("|");if(e.length>=3){let t=Number(e[0]),r=(e[1]??"").toString(),d=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(t)?t:null,this.filtroResolucion=r||null,this.filtroNivelCarrera=d||null;return}if(e.length===2){let t=(e[0]??"").toString(),r=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=t||null,this.filtroNivelCarrera=r||null;return}this.filtroInstitucionId=null,this.filtroResolucion=i,this.filtroNivelCarrera=null}Cargarplandeestudios(){let i=this.filtroAnioId;if(!i){this.plandeestudios=[],this.collectionSizeplandeestudios=0;return}this.isLoadingplandeestudios=!0;let e={anio_id:i,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0};this.filtroResolucion&&(e.resolucion=this.filtroResolucion),this.filtroNivelCarrera&&(e.nivel=this.filtroNivelCarrera),this._planest.Obtenerplandeestudios(e).subscribe({next:t=>{console.log("planes de estudio",t.data),this.plandeestudios=t.data||[],this.collectionSizeplandeestudios=this.plandeestudios.length,this.isLoadingplandeestudios=!1},error:t=>{console.error("Error al cargar plandeestudios",t),this.isLoadingplandeestudios=!1}})}AgregarModificarplandeestudios(){if(this.newplandeestudios.invalid){this.ValidacionTodoElementoplandeestudios(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalplandeestudios=!1;return}else{this.AnimarCargaTablaplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!0,this._tools.MostrarMensajeLoading(),this.newplandeestudiosAnteriorAccion.setValue(this.newplandeestudios.value);let i=this.newplandeestudios.controls.id.value;console.log("INFO A PROCESAR",this.newplandeestudios.value),i?this._planest.Modificarplandeestudios(this.newplandeestudios.value,this.newplandeestudios.value.id).subscribe(e=>{console.log("SE MODIFICO CORRECTAMENTE plandeestudios",e.data),this.Cargarplandeestudios(),this.resetplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL MODIFICAR plandeestudios",e),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeError()}):this._planest.Agregarplandeestudios(this.newplandeestudios.value).subscribe(e=>{console.log("SE A\xD1ADIO CORRECTAMENTE plandeestudios",e.data),this.Cargarplandeestudios(),this.resetplandeestudios(),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeSuccess()},e=>{console.log("ERROR AL A\xD1ADIR plandeestudios",e),this.AnimacionCargabtnModalplandeestudios=!1,this._tools.MostrarMensajeError()})}}Seleccionarplandeestudios(i){if(this._tools.MostrarMensajeLoading(),i){if(!this.plandeestudios.find(t=>t.id===i))return;this._planest.Seleccionarplandeestudios(i).subscribe(t=>{Object.keys(this.newplandeestudios.controls).forEach(r=>{this.newplandeestudios.controls[r].setValue(t.data[r])}),console.log("SELECCION DE plandeestudios EXITOSA",this.newplandeestudios.value),this.newplandeestudiosAnteriorAccion.setValue(this.newplandeestudios.value),this.modalGestionplandeestudiosRef=this._tools.openModal(this.modalgestionplandeestudios,"xl"),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL SELECCIONAR plandeestudios",t),this._tools.MostrarMensajeError()})}}Eliminarplandeestudios(i){this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(e=>{e&&(this._tools.MostrarMensajeLoading(),this._planest.Eliminarplandeestudios(i).subscribe(t=>{console.log(t.data),this.Cargarplandeestudios(),this._tools.MostrarMensajeSuccess()},t=>{console.log("ERROR AL ELIMINAR plandeestudios",t),this._tools.MostrarMensajeError()}))})}resetplandeestudios(){this.newplandeestudios=this._planest.createFormGroupplandeestudios(),this.initModoMateriaWatcher(),this._tools.closeModal(this.modalGestionplandeestudiosRef)}AutoCompletarLastplandeestudios(){this.newplandeestudios.setValue(this.newplandeestudiosAnteriorAccion.value),this.newplandeestudios.patchValue({id:0}),console.log("listo",this.newplandeestudios.value)}AnimarCargaTablaplandeestudios(){this.plandeestudios=[],this.isLoadingplandeestudios=!0}ValidacionplandeestudiosxElemento(i){return this._tools.obtenerValidationClass(this.newplandeestudios,i)}ValidacionTodoElementoplandeestudios(){Object.values(this.newplandeestudios.controls).forEach(i=>{i.markAsTouched(),i.markAsDirty()})}onPageSizeChangeplandeestudios(){this.paginaplandeestudios=1}sortByplandeestudios(i,e){this.sortColumnsplandeestudios=this._tools.handleSort(i,e,this.sortColumnsplandeestudios),this.plandeestudios=this._tools.applyMultiSort(this.plandeestudios,this.sortColumnsplandeestudios)}isSortedplandeestudios(i){return this._tools.isSorted(this.sortColumnsplandeestudios,i)}getSortDirplandeestudios(i){return this._tools.getSortDirection(this.sortColumnsplandeestudios,i)}closeMenu(){this._tools.close()}abrirMenuplandeestudios(i,e){i.preventDefault(),i.stopPropagation();let t=[{label:"\u270F Editar",action:()=>this.Seleccionarplandeestudios(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarplandeestudios(e.id)}];this._tools.open(i.clientX,i.clientY,t)}cargarCarreras(){this._carr.Obtenercarreras().subscribe({next:i=>{console.log("data carreras",i),this.carreras=i.data||[],this.rebuildResolucionOptions()},error:i=>{console.error("Error al cargar carreras",i),this.resolucionOptions=[]}})}cargarAnios(){this._anios.ObtenerAniosConPredeterminado().subscribe({next:i=>{if(this.anios=i?.anios||[],this.filtroAnioId===null||this.filtroAnioId===void 0){let e=i?.predeterminado;e?.id?this.filtroAnioId=Number(e.id):this.anios?.length&&(this.filtroAnioId=Number(this.anios[0]?.id))}this.onFiltroChange()},error:i=>{console.error("Error al cargar anios",i)}})}};Le.\u0275fac=function(e){return new(e||Le)(E(Ie),E(Ne),E(ie),E(ne),E(Te),E(ee))},Le.\u0275cmp=H({type:Le,selectors:[["app-plandeestudios"]],viewQuery:function(e,t){if(e&1&&de(Cn,7),e&2){let r;me(r=pe())&&(t.modalgestionplandeestudios=r.first)}},hostBindings:function(e,t){e&1&&f("click",function(){return t.closeMenu()},ve)},standalone:!1,decls:60,vars:20,consts:[["modalgestionplandeestudios",""],["modalOtroComponentecarreras",""],["modalOtroComponentematerias",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"col-sm-6","d-flex","justify-content-start","button",2,"gap","10px"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"col-sm-3","d-flex","justify-content-end",2,"gap","10px"],[1,"form-floating",2,"min-width","140px"],["title","Filtrar por A\xF1o",1,"form-control",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-floating",2,"min-width","180px"],["title","Filtrar por Resoluci\xF3n",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-sm-3","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],["class","mt-4",4,"ngIf"],["class","context-menu",3,"ngStyle",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],["title","Sigla Prerrequisitos",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bi",3,"ngClass"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"small","text-muted"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],[1,"form-floating","mb-3","col-sm-6"],["formControlName","anio_id",1,"form-control",3,"ngClass"],["disabled","","selected","",3,"value"],[1,"invalid-feedback"],["formControlName","carreras_id",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-2"],["type","number","placeholder","","formControlName","RangoLvlCurso",1,"form-control",3,"ngClass"],["type","number","placeholder","","formControlName","Rango",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-3"],["type","number","placeholder","","formControlName","Horas",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-5"],["formControlName","LvlCurso",1,"form-control",3,"ngClass"],["disabled","",3,"value"],[3,"value","disabled",4,"ngFor","ngForOf"],["type","text","placeholder","","formControlName","NombreMateria",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","SiglaMateria",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","Prerrequisitos",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["type","text","placeholder","","formControlName","SiglasPrerrequisitos",1,"form-control",2,"text-transform","uppercase",3,"change","ngClass"],["formControlName","TipoMateria",1,"form-control",3,"ngClass"],[1,"form-floating","mb-3","col-sm-4"],["formControlName","ModoMateria",1,"form-control",3,"ngClass"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],[3,"value","disabled"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[1,"context-menu",3,"ngStyle"],["class","context-item",3,"click",4,"ngFor","ngForOf"],[1,"context-item",3,"click"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[3,"modo","idAnio"]],template:function(e,t){if(e&1){let r=C();n(0,"div",3)(1,"div",4)(2,"div",5)(3,"h1",6),c(4,"Gesti\xF3n de Plan de Estudios"),o(),n(5,"p",7),c(6,'Administra la informaci\xF3n de los "Planes de estudios", "Materias" y "Carreras" de manera sencilla y eficiente'),o()()()(),n(7,"div",4)(8,"div",8)(9,"button",9),f("click",function(){p(r);let _=qe(53);return u(t.modalGestionplandeestudiosRef=t._tools.openModal(_,"xl"))}),n(10,"span",10),x(11,"ng-lottie",11),o(),n(12,"span"),c(13,"A\xF1adir plandeestudios "),o(),x(14,"span",12),o(),n(15,"button",9),f("click",function(){p(r);let _=qe(57);return u(t._tools.openModal(_,"xl"))}),n(16,"span",10),x(17,"ng-lottie",11),o(),n(18,"span"),c(19,"GESTIONAR CARRERAS"),o(),x(20,"span",12),o(),n(21,"button",9),f("click",function(){p(r);let _=qe(59);return u(t._tools.openModal(_,"xl"))}),n(22,"span",10),x(23,"ng-lottie",11),o(),n(24,"span"),c(25,"GESTIONAR MATERIAS"),o(),x(26,"span",12),o()(),n(27,"div",13)(28,"div",14)(29,"select",15),w("ngModelChange",function(_){return p(r),M(t.filtroAnioId,_)||(t.filtroAnioId=_),u(_)}),f("ngModelChange",function(){return p(r),t.paginaplandeestudios=1,u(t.onFiltroChange())}),n(30,"option",16),c(31,"Seleccione una opci\xF3n"),o(),g(32,Sn,2,2,"option",17),o(),n(33,"label"),c(34,"A\xF1o"),o()(),n(35,"div",18)(36,"select",19),w("ngModelChange",function(_){return p(r),M(t.filtroResolucionKey,_)||(t.filtroResolucionKey=_),u(_)}),f("ngModelChange",function(){return p(r),t.paginaplandeestudios=1,u(t.onFiltroChange())}),n(37,"option",16),c(38,"Seleccione una opci\xF3n"),o(),g(39,En,2,2,"option",17),o(),n(40,"label"),c(41,"Resoluci\xF3n"),o()()(),n(42,"div",20)(43,"div",21)(44,"span",22),x(45,"ng-lottie",23),o(),n(46,"div",24)(47,"input",25),f("input",function(){return p(r),u(t.paginaplandeestudios=1)}),w("ngModelChange",function(_){return p(r),M(t.filtertxtplandeestudios,_)||(t.filtertxtplandeestudios=_),u(_)}),o(),n(48,"label"),c(49,"Buscar"),o()()()()(),g(50,Hn,46,26,"div",26),N(51,"filterByFields"),g(52,to,105,23,"ng-template",null,0,$)(54,no,5,11,"div",27),N(55,"async"),g(56,oo,6,2,"ng-template",null,1,$)(58,ro,6,2,"ng-template",null,2,$)}if(e&2){let r;s(11),l("options",t._tools.optionsAdicionar),s(6),l("options",t._tools.optionssubgestion),s(6),l("options",t._tools.optionssubgestion),s(6),y("ngModel",t.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",t.anios),s(4),y("ngModel",t.filtroResolucionKey),s(),l("ngValue",null),s(2),l("ngForOf",t.resolucionOptions),s(6),l("options",t._tools.optionslupa),s(2),y("ngModel",t.filtertxtplandeestudios),s(3),l("ngIf",W(51,13,t.plandeestudios,t.filtertxtplandeestudios,Qe(19,hn))),s(4),l("ngIf",(r=R(55,17,t.menuStateplandeestudios$))==null?null:r.visible)}},dependencies:[U,q,K,Ce,ye,X,Z,Se,et,J,Q,Ee,Y,Me,we,Ae,te,Ve,Fe,he,be,Pe],encapsulation:2});var it=Le;var ge=class ge{constructor(i){this.http=i;this.ruta=Xe.ruta}Obtenerplanteldocentesmaterias(i){let e=new Ye,t=i;return t?.planteldocentes_id&&(e=e.set("planteldocentes_id",String(t.planteldocentes_id))),t?.anio_id&&(e=e.set("anio_id",String(t.anio_id))),t?.resolucion&&(e=e.set("resolucion",String(t.resolucion))),t?.nivel&&(e=e.set("nivel",String(t.nivel))),t?.instituciones_id&&(e=e.set("instituciones_id",String(t.instituciones_id))),this.http.get(this.ruta+"api/planteldocentesmaterias/",{params:e})}ObtenerplanteldocentesmateriasPorDocente(i){return this.Obtenerplanteldocentesmaterias({planteldocentes_id:i})}AsignarMateriaADocente(i){return this.http.post(this.ruta+"api/planteldocentesmaterias/assign",i)}QuitarMateriaADocente(i){return this.http.post(this.ruta+"api/planteldocentesmaterias/unassign",i)}Agregarplanteldocentesmaterias(i){return this.http.post(this.ruta+"api/planteldocentesmaterias/",i)}Modificarplanteldocentesmaterias(i,e){return this.http.put(this.ruta+"api/planteldocentesmaterias/"+e,i)}Seleccionarplanteldocentesmaterias(i){return this.http.get(this.ruta+"api/planteldocentesmaterias/"+i)}Eliminarplanteldocentesmaterias(i){return this.http.delete(this.ruta+"api/planteldocentesmaterias/"+i)}createFormGroupplanteldocentesmaterias(){return new Ze({id:new O(0),planteldocentes_id:new O(""),materias_id:new O("")})}};ge.\u0275fac=function(e){return new(e||ge)(We(Je))},ge.\u0275prov=ze({token:ge,factory:ge.\u0275fac,providedIn:"root"});var nt=ge;var Nt=a=>({checked:a,"custom-border":!0});function so(a,i){if(a&1&&(n(0,"option",12),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.id),s(),v(e.Anio)}}function lo(a,i){if(a&1&&(n(0,"option",12),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.key),s(),v(e.label)}}function co(a,i){if(a&1){let e=C();n(0,"tr")(1,"td"),c(2),o(),n(3,"td"),c(4),o(),n(5,"td")(6,"button",49),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.seleccionarDocenteDemo(r))}),c(7," Seleccionar "),o()()()}if(a&2){let e=i.$implicit,t=m(2);s(2),ue("",e.nombre," (#",e.id,")"),s(2),v(e.cantMaterias||0),s(2),l("disabled",!t.esDocenteSeleccionable(e))}}function mo(a,i){a&1&&(n(0,"tr")(1,"td",50),c(2,"Sin pendientes"),o()())}function po(a,i){if(a&1){let e=C();n(0,"div",41)(1,"div",42)(2,"span"),c(3,"DOCENTES SIN ASIGNACIONES (sin materias asignadas)"),o()(),n(4,"div",23)(5,"div",7)(6,"span",8),x(7,"i",27),o(),n(8,"div",10)(9,"input",43),f("input",function(r){p(e);let d=m();return u(d.filterPendientesDocentes=r.target.value)}),o(),n(10,"label"),c(11,"Buscar (nombre)"),o()()()(),n(12,"div",44)(13,"table",45)(14,"thead")(15,"tr")(16,"th"),c(17,"Docente"),o(),n(18,"th",46),c(19,"Materias asignadas"),o(),n(20,"th",47),c(21,"Acci\xF3n"),o()()(),n(22,"tbody"),g(23,co,8,4,"tr",48)(24,mo,3,0,"tr",39),o()()()()}if(a&2){let e=m();s(9),l("value",e.filterPendientesDocentes),s(14),l("ngForOf",e.docentesPendientesFiltrados())("ngForTrackBy",e.trackById),s(),l("ngIf",e.docentesPendientesFiltrados().length===0)}}function uo(a,i){if(a&1){let e=C();n(0,"button",51),f("click",function(){let r=p(e).$implicit,d=m();return u(d.seleccionarDocenteDemo(r))}),c(1),n(2,"span",52),c(3),o()()}if(a&2){let e=i.$implicit,t=m();Ke("active",(t.docenteSeleccionadoDemo==null?null:t.docenteSeleccionadoDemo.id)===e.id),l("disabled",!t.esDocenteSeleccionable(e)),s(),ue(" ",e.nombre," (#",e.id,") "),s(2),S(" - ",e.cantMaterias||0," materias")}}function _o(a,i){a&1&&(n(0,"small",52),c(1,"Selecciona un docente para habilitar los toggles."),o())}function go(a,i){if(a&1&&(n(0,"h3",53),c(1," Docente Seleccionado: "),n(2,"b"),c(3),o()()),a&2){let e=m();s(3),v(e.docenteSeleccionadoDemo.nombre)}}function fo(a,i){if(a&1&&(n(0,"option",12),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.id),s(),v(e.Anio)}}function xo(a,i){if(a&1&&(n(0,"option",12),c(1),o()),a&2){let e=i.$implicit;l("ngValue",e.key),s(),v(e.label)}}function vo(a,i){if(a&1){let e=C();n(0,"div",54)(1,"div",6)(2,"div",7)(3,"span",8),x(4,"i",9),o(),n(5,"div",10)(6,"select",55),w("ngModelChange",function(r){p(e);let d=m();return M(d.filtroAnioId,r)||(d.filtroAnioId=r),u(r)}),f("change",function(){p(e);let r=m();return u(r.onCambioFiltrosAsignacion())}),n(7,"option",12),c(8,"-- Seleccione --"),o(),g(9,fo,2,2,"option",13),o(),n(10,"label",56),c(11,"A\xF1o (Gesti\xF3n)"),o()()()(),n(12,"div",57)(13,"div",7)(14,"span",8),x(15,"i",15),o(),n(16,"div",10)(17,"select",58),w("ngModelChange",function(r){p(e);let d=m();return M(d.filtroResolucionKey,r)||(d.filtroResolucionKey=r),u(r)}),f("change",function(){p(e);let r=m();return u(r.onCambioFiltrosAsignacion())}),n(18,"option",12),c(19,"-- Seleccione --"),o(),g(20,xo,2,2,"option",13),o(),n(21,"label",59),c(22,"Resoluci\xF3n"),o()()()()()}if(a&2){let e=m();s(6),y("ngModel",e.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",e.aniosOptions),s(8),y("ngModel",e.filtroResolucionKey),s(),l("ngValue",""),s(2),l("ngForOf",e.resolucionOptions)}}function Co(a,i){if(a&1){let e=C();n(0,"button",71),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.toggleLvlCurso(r))}),c(1),o()}if(a&2){let e=i.$implicit,t=m(2);Ke("active",t.isLvlCursoSeleccionado(e)),s(),S(" ",e," ")}}function ho(a,i){if(a&1){let e=C();n(0,"button",72),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.toggleParalelo(r))}),c(1),o()}if(a&2){let e=i.$implicit,t=m(2);Ke("active",t.isParaleloSeleccionado(e)),s(),S(" ",e," ")}}function bo(a,i){if(a&1&&(n(0,"div",82),c(1),o()),a&2){let e=i.ngIf;s(),S(" Docentes: ",e," ")}}function So(a,i){a&1&&(n(0,"div",83)(1,"span",84),c(2,"Cargando..."),o()())}function Eo(a,i){if(a&1){let e=C();n(0,"div",77)(1,"button",78),f("click",function(r){let d=p(e).$implicit,_=m(4);return u(_.toggleAsignacionDemo(d,r))}),n(2,"span",79),c(3),o(),n(4,"span"),c(5),o()(),g(6,bo,2,1,"div",80)(7,So,3,0,"div",81),o()}if(a&2){let e=i.$implicit,t=m(4);l("ngClass",ct(7,Nt,t.isAsignadaDemo(e.id))),s(),l("disabled",!t.docenteSeleccionadoDemo||t.isLoadingMateria[e.id]),s(),l("ngClass",t.isAsignadaDemo(e.id)?"bg-success":"bg-secondary"),s(),S(" ",t.isAsignadaDemo(e.id)?"ASIGNADO":"NO"," "),s(2),v((e.sigla?e.sigla+" - ":"")+e.nombre),s(),l("ngIf",t.docentesAsignadosEnMateriaTexto(e.id)),s(),l("ngIf",t.isLoadingMateria[e.id])}}function yo(a,i){if(a&1&&(n(0,"div")(1,"h5",74),c(2),o(),n(3,"div",75),g(4,Eo,8,9,"div",76),o(),x(5,"hr"),o()),a&2){let e=i.$implicit,t=m(3);s(2),v(e),s(2),l("ngForOf",t.materiasPorCategoria(e))}}function Mo(a,i){if(a&1&&(st(0),g(1,yo,6,2,"div",73),lt()),a&2){let e=m(2);s(),l("ngForOf",e.categoriasDemo())}}function wo(a,i){if(a&1&&(n(0,"span"),c(1),o()),a&2){let e=m().$implicit;s(),v(e.lvlCurso)}}function Ao(a,i){if(a&1&&(n(0,"span"),c(1),o()),a&2){let e=m().$implicit;s(),S(" - ",e.paralelo)}}function Io(a,i){if(a&1&&(n(0,"div",82),c(1),o()),a&2){let e=i.ngIf;s(),S(" Docentes: ",e," ")}}function To(a,i){a&1&&(n(0,"div",83)(1,"span",84),c(2,"Cargando..."),o()())}function Oo(a,i){if(a&1){let e=C();n(0,"div",77)(1,"button",78),f("click",function(r){let d=p(e).$implicit,_=m(3);return u(_.toggleAsignacionDemo(d,r))}),n(2,"span",79),c(3),o(),n(4,"span"),c(5),o()(),n(6,"div",82),g(7,wo,2,1,"span",39)(8,Ao,2,1,"span",39),o(),g(9,Io,2,1,"div",80)(10,To,3,0,"div",81),o()}if(a&2){let e=i.$implicit,t=m(3);l("ngClass",ct(9,Nt,t.isAsignadaDemo(e.id))),s(),l("disabled",!t.docenteSeleccionadoDemo||t.isLoadingMateria[e.id]),s(),l("ngClass",t.isAsignadaDemo(e.id)?"bg-success":"bg-secondary"),s(),S(" ",t.isAsignadaDemo(e.id)?"ASIGNADO":"NO"," "),s(2),v((e.sigla?e.sigla+" - ":"")+e.nombre),s(2),l("ngIf",e.lvlCurso),s(),l("ngIf",e.paralelo),s(),l("ngIf",t.docentesAsignadosEnMateriaTexto(e.id)),s(),l("ngIf",t.isLoadingMateria[e.id])}}function Vo(a,i){if(a&1&&(st(0),n(1,"div",75),g(2,Oo,11,11,"div",76),o(),lt()),a&2){let e=m(2);s(2),l("ngForOf",e.materiasFiltradasDemo())}}function No(a,i){if(a&1){let e=C();n(0,"div")(1,"div",54)(2,"div",60)(3,"div",7)(4,"span",8),x(5,"i",61),o(),n(6,"div",10)(7,"input",62),f("input",function(r){p(e);let d=m();return u(d.filterMateria=r.target.value)}),o(),n(8,"label"),c(9,"Buscar materia (sigla/nombre/ID)"),o()()()(),n(10,"div",63)(11,"div",64)(12,"input",65),f("change",function(){p(e);let r=m();return u(r.toggleModoCategorias())}),o(),n(13,"label",66),c(14,"Con categor\xEDas"),o()(),n(15,"div",67)(16,"small",68),c(17,"Cursos:"),o(),g(18,Co,2,3,"button",69),o(),n(19,"div",67)(20,"small",68),c(21,"Paralelos:"),o(),g(22,ho,2,3,"button",70),o()()(),g(23,Mo,2,1,"ng-container",39)(24,Vo,3,1,"ng-container",39),o()}if(a&2){let e=m();s(7),l("value",e.filterMateria),s(5),l("checked",e.modoCategorias),s(6),l("ngForOf",e.lvlCursosDetectados()),s(4),l("ngForOf",e.paralelosDetectados()),s(),l("ngIf",e.modoCategorias),s(),l("ngIf",!e.modoCategorias)}}function Do(a,i){a&1&&(n(0,"tr")(1,"td",87),c(2," Selecciona un docente para ver asignaciones. "),o()())}function Po(a,i){if(a&1){let e=C();n(0,"tr")(1,"td"),c(2),o(),n(3,"td"),c(4),o(),n(5,"td"),c(6),o(),n(7,"td"),c(8),o(),n(9,"td"),c(10),o(),n(11,"td")(12,"button",88),f("click",function(){let r=p(e).$implicit,d=m(2);return u(d.quitarAsignacionTabla(r.materiaId))}),c(13," Quitar "),o()()()}if(a&2){let e=i.$implicit,t=i.index,r=m(2);s(2),v(t+1),s(2),v(e.docente),s(2),v(e.categoria),s(2),v(e.materia),s(2),v(e.paralelo),s(2),l("disabled",!r.docenteSeleccionadoDemo||r.isLoadingMateria[e.materiaId])}}function Ro(a,i){a&1&&(n(0,"tr")(1,"td",89),c(2,"Sin asignaciones (demo)"),o()())}function Fo(a,i){if(a&1&&(n(0,"div",44)(1,"table",85)(2,"thead")(3,"tr")(4,"th"),c(5,"#"),o(),n(6,"th"),c(7,"Docente"),o(),n(8,"th"),c(9,"Categoria"),o(),n(10,"th"),c(11,"Materia"),o(),n(12,"th"),c(13,"Paralelo"),o(),n(14,"th"),c(15,"Acci\xF3n"),o()()(),n(16,"tbody",86),g(17,Do,3,0,"tr",39)(18,Po,14,6,"tr",73)(19,Ro,3,0,"tr",39),o()()()),a&2){let e=m();s(17),l("ngIf",!e.docenteSeleccionadoDemo),s(),l("ngForOf",e.tablaAsignacionesDemo()),s(),l("ngIf",e.docenteSeleccionadoDemo&&e.tablaAsignacionesDemo().length===0)}}var Ge=class Ge{constructor(i,e,t,r,d,_,h){this._mat=i;this._tools=e;this._planteldoc=t;this._planteldocmat=r;this._carreras=d;this._anios=_;this._auth=h;this.ModoBoolean=!1;this.filterDocente="";this.filterMateria="";this.docentesDemo=[];this.materiasDemo=[];this.docenteSeleccionadoDemo=null;this.paraleloDemo="";this.modoCategorias=!0;this.aniosOptions=[];this.filtroAnioId=null;this.filtroResolucionKey="";this.filtroResolucion=null;this.filtroNivelCarrera=null;this.filtroInstitucionId=null;this.resolucionOptions=[];this.esSuperAdmin=!1;this.carreras=[];this.verPendientesDocentes=!1;this.filterPendientesDocentes="";this.selectedLvlCursos=new Set;this.selectedParalelos=new Set;this.asignacionesDemo=new Map;this.docentesPorMateria=new Map;this.isLoadingMateria={};this.docentes=[];this.materias=[]}ngOnInit(){this.cargarFiltrosAsignacion(),this.cargardocentes(),this._auth.revisarSiEsSuperAdmin().subscribe(i=>{this.esSuperAdmin=i,this.rebuildResolucionOptions(),this.onCambioFiltrosAsignacion()})}cargarFiltrosAsignacion(){this._anios.Obteneranios().subscribe({next:i=>{let e=Array.isArray(i?.data)?i.data:[];this.aniosOptions=e.map(t=>({id:Number(t?.id),Anio:String(t?.Anio??"").trim()})).filter(t=>Number.isFinite(t.id)&&t.id>0&&t.Anio)},error:()=>{this.aniosOptions=[]}}),this._carreras.Obtenercarreras().subscribe({next:i=>{this.carreras=Array.isArray(i?.data)?i.data:[],this.rebuildResolucionOptions()},error:()=>{this.carreras=[],this.rebuildResolucionOptions()}})}rebuildResolucionOptions(){let i=new Map;for(let e of this.carreras||[]){let t=(e?.Resolucion??"").toString().trim();if(!t)continue;let r=(e?.Nivel??"").toString().trim(),d=(e?.Area??"").toString().trim(),_=e?.instituciones_id,h=_!=null&&_!==""?Number(_):null,A=(e?.NombreInstitucion??"").toString().trim(),I=r||"SIN NIVEL",V=`${t}|${I}`,T=this.esSuperAdmin&&h?`${h}|${V}`:V,D=`${d?d+" \xB7 ":""}${t} (${I})`,k=this.esSuperAdmin&&h?`${D}${A?" \xB7 "+A:""}`:D;i.has(T)||i.set(T,{key:T,label:k,resolucion:t,nivel:I,instituciones_id:h})}this.resolucionOptions=Array.from(i.values()).sort((e,t)=>e.label.localeCompare(t.label))}onCambioFiltrosAsignacion(){this.selectedLvlCursos.clear(),this.selectedParalelos.clear(),this.recargarDatosPorFiltro()}togglePendientesDocentes(){this.verPendientesDocentes=!this.verPendientesDocentes}docentesPendientesFiltrados(){let i=(this.filterPendientesDocentes??"").trim().toLowerCase(),e=this.docentesDemo.filter(t=>(t.cantMaterias??0)===0);return i?e.filter(t=>`${t.id} ${t.nombre}`.toLowerCase().includes(i)):e}esDocenteSeleccionable(i){return i?(i.estado??"").toString().trim().toUpperCase()!=="INACTIVO":!1}cargardocentes(){this._planteldoc.Obtenerplanteldocentes().subscribe({next:i=>{if(console.log("data plantel docente",i.data),this.docentes=i.data,this.docentesDemo=(Array.isArray(i.data)?i.data:[]).map(e=>{let t=(e?.Nombres??"").toString().trim(),r=(e?.Apellidos??"").toString().trim(),d=`${t} ${r}`.trim()||`Docente #${e?.id}`,_=(e?.Visibilidad??"").toString().trim().toUpperCase(),h=(e?.Estado??"").toString().trim().toUpperCase();return{id:Number(e?.id),nombre:d,cantMaterias:0,visibilidad:_,estado:h}}).filter(e=>Number.isFinite(e.id)&&(e.visibilidad??"").toString().trim().toUpperCase()==="VISIBLE"),this.docenteSeleccionadoDemo){let e=this.docentesDemo.find(t=>t.id===this.docenteSeleccionadoDemo?.id);(!e||!this.esDocenteSeleccionable(e))&&(this.docenteSeleccionadoDemo=null)}this.recalcularConteosDocentes()},error:i=>{console.error("Error al cargar los docentes:",i)}})}parseResolucionKey(){let i=(this.filtroResolucionKey??"").toString();if(!i){this.filtroResolucion=null,this.filtroNivelCarrera=null,this.filtroInstitucionId=null;return}let e=i.split("|");if(e.length>=3){let t=Number(e[0]),r=(e[1]??"").toString(),d=e.slice(2).join("|");this.filtroInstitucionId=Number.isFinite(t)?t:null,this.filtroResolucion=r||null,this.filtroNivelCarrera=d||null;return}if(e.length===2){let t=(e[0]??"").toString(),r=(e[1]??"").toString();this.filtroInstitucionId=null,this.filtroResolucion=t||null,this.filtroNivelCarrera=r||null;return}this.filtroInstitucionId=null,this.filtroResolucion=i,this.filtroNivelCarrera=null}getFiltroParams(){let i=this.filtroAnioId,e=!!(this.filtroResolucionKey&&this.filtroResolucionKey.toString().trim());return!i||!e||(this.parseResolucionKey(),!this.filtroResolucion||!this.filtroNivelCarrera)?null:{anio_id:i,resolucion:this.filtroResolucion,nivel:this.filtroNivelCarrera,instituciones_id:this.esSuperAdmin?this.filtroInstitucionId??void 0:void 0}}recargarDatosPorFiltro(){let i=this.getFiltroParams();if(!i){this.materias=[],this.materiasDemo=[],this.asignacionesDemo.clear(),this.docentesPorMateria.clear(),this.recalcularConteosDocentes();return}$e({materias:this._mat.Obtenermaterias(i).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error al cargar materias (filtro global)",e),se([])))),asignaciones:this._planteldocmat.Obtenerplanteldocentesmaterias(i).pipe(le(e=>e?.data||[]),ce(e=>(console.error("Error al cargar asignaciones (filtro global)",e),se([]))))}).subscribe({next:({materias:e,asignaciones:t})=>{this.materias=e||[],this.materiasDemo=(Array.isArray(e)?e:[]).map(d=>{let _=(d?.NombreMateria??"").toString().trim()||`Materia #${d?.id}`,h=(d?.SiglaMateria??"").toString().trim()||void 0,A=(d?.ModoMateria??"").toString().trim()||void 0,I=(d?.Anio??"SIN ASIGNAR").toString().trim()||"SIN ASIGNAR",V=(d?.Resolucion??"SIN RESOLUCION").toString().trim()||"SIN RESOLUCION",T=(d?.LvlCurso??"SIN CURSO").toString().trim()||"SIN CURSO",D=(d?.Paralelo??"").toString().trim(),k=D?`${T} ${D}`:T;return{id:Number(d?.id),categoria:k,sigla:h,nombre:_,modoMateria:A,lvlCurso:T,paralelo:D,anio:I,resolucion:V}}).filter(d=>Number.isFinite(d.id));let r=new Set(this.materiasDemo.map(d=>d.id));this.asignacionesDemo.clear(),this.docentesPorMateria.clear();for(let d of Array.isArray(t)?t:[]){let _=Number(d.planteldocentes_id??d.planteldocente_id),h=Number(d.materias_id??d.materia_id);!Number.isFinite(_)||!Number.isFinite(h)||r.has(h)&&(this.asignacionesDemo.has(_)||this.asignacionesDemo.set(_,new Set),this.asignacionesDemo.get(_)?.add(h),this.docentesPorMateria.has(h)||this.docentesPorMateria.set(h,new Set),this.docentesPorMateria.get(h)?.add(_))}this.recalcularConteosDocentes()},error:e=>{console.error(e)}})}recalcularConteosDocentes(){Array.isArray(this.docentesDemo)&&(this.docentesDemo=this.docentesDemo.map(i=>{let e=(this.asignacionesDemo.get(i.id)??new Set).size;return Be(ae({},i),{cantMaterias:e})}))}trackById(i,e){return e.id}onToggleChange(i){let e=i.target.checked;this.ModoBoolean=e}docentesFiltradosDemo(){let i=(this.filterDocente??"").trim().toLowerCase();return i?this.docentesDemo.filter(e=>`${e.id} ${e.nombre}`.toLowerCase().includes(i)):this.docentesDemo}seleccionarDocenteDemo(i){this.esDocenteSeleccionable(i)&&(this.docenteSeleccionadoDemo=i)}limpiarDocenteDemo(){this.docenteSeleccionadoDemo=null}materiasFiltradasDemo(){let i=(this.filterMateria??"").trim().toLowerCase(),e=this.materiasDemo;return i&&(e=e.filter(t=>`${t.id} ${t.sigla??""} ${t.nombre} ${t.categoria} ${t.lvlCurso??""} ${t.paralelo??""} ${this.docentesAsignadosEnMateriaTexto(t.id)}`.toLowerCase().includes(i))),this.selectedLvlCursos.size>0&&(e=e.filter(t=>this.selectedLvlCursos.has((t.lvlCurso??"").toString()))),this.selectedParalelos.size>0&&(e=e.filter(t=>this.selectedParalelos.has((t.paralelo??"").toString()))),e}materiasPorCategoria(i){return this.materiasFiltradasDemo().filter(e=>e.categoria===i)}categoriasDemo(){return Array.from(new Set(this.materiasFiltradasDemo().map(i=>i.categoria))).sort((i,e)=>i.localeCompare(e))}toggleModoCategorias(){this.modoCategorias=!this.modoCategorias}lvlCursosDetectados(){return Array.from(new Set(this.materiasDemo.map(i=>i.lvlCurso).filter(Boolean))).sort((i,e)=>i.localeCompare(e))}paralelosDetectados(){return Array.from(new Set(this.materiasDemo.map(i=>i.paralelo).filter(i=>!!i))).sort((i,e)=>i.localeCompare(e))}isLvlCursoSeleccionado(i){return this.selectedLvlCursos.has(i)}toggleLvlCurso(i){this.selectedLvlCursos.has(i)?this.selectedLvlCursos.delete(i):this.selectedLvlCursos.add(i)}isParaleloSeleccionado(i){return this.selectedParalelos.has(i)}toggleParalelo(i){this.selectedParalelos.has(i)?this.selectedParalelos.delete(i):this.selectedParalelos.add(i)}docentesAsignadosEnMateriaTexto(i){let e=this.docentesPorMateria.get(i);return!e||e.size===0?"":Array.from(e).map(r=>this.docentesDemo.find(d=>d.id===r)?.nombre??`#${r}`).filter(Boolean).join(", ")}normalizeModoMateria(i){return(i??"").toString().trim().toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}esModoInstrumentoEspecialidad(i){let e=this.normalizeModoMateria(i.modoMateria);return e.includes("INSTRUMENT")&&e.includes("ESPECIAL")}esModoPracticaConjuntos(i){let e=this.normalizeModoMateria(i.modoMateria);return e.includes("PRACTICA")&&e.includes("CONJUNTO")}esModoUnDocentePorMateria(i){let e=this.normalizeModoMateria(i.modoMateria);return e.includes("1")&&e.includes("DOCENTE")}isAsignadaDemo(i){let e=this.docenteSeleccionadoDemo;return e?(this.asignacionesDemo.get(e.id)??new Set).has(i):!1}toggleAsignacionDemo(i,e){return at(this,null,function*(){if(e?.preventDefault(),!this.docenteSeleccionadoDemo)return;let t=this.docenteSeleccionadoDemo.id,r=this.asignacionesDemo.get(t)??new Set;this.asignacionesDemo.set(t,r),this.isLoadingMateria[i.id]=!0;try{if(r.has(i.id)){yield new Promise((h,A)=>{this._planteldocmat.QuitarMateriaADocente({planteldocentes_id:t,materias_id:i.id}).subscribe({next:()=>h(),error:I=>A(I)})}),r.delete(i.id);let _=this.docentesPorMateria.get(i.id);_?.delete(t),_&&_.size===0&&this.docentesPorMateria.delete(i.id)}else{if(this.esModoInstrumentoEspecialidad(i)){this._tools.MostrarMensaje("info","NO ES NECESARIO ASIGNAR MATERIAS DE INSTRUMENTO DE ESPECIALIDAD PORQUE LA DETECCION DE ESTUDIANTES SE HACE AUTOMATICO DESDE INSCRIPCIONES DE ESTUDIANTES.");return}if(this.esModoPracticaConjuntos(i)){this._tools.MostrarMensaje("info","NO ES NECESARIO ASIGNAR MATERIAS DE PR\xC1CTICA DE CONJUNTOS PORQUE LA DETECCION DE ESTUDIANTES SE HACE AUTOMATICO DESDE INSCRIPCIONES DE ESTUDIANTES.");return}if(this.esModoUnDocentePorMateria(i)){let _=this.docentesPorMateria.get(i.id);if(_&&_.size>0){let h=this.docentesAsignadosEnMateriaTexto(i.id);this._tools.MostrarMensaje("warning",`No se puede asignar: esta materia es "1 DOCENTE x MATERIA" y ya tiene docente asignado${h?": "+h:"."}`);return}}yield new Promise((_,h)=>{this._planteldocmat.AsignarMateriaADocente({planteldocentes_id:t,materias_id:i.id,Paralelo:this.paraleloDemo||null}).subscribe({next:()=>_(),error:A=>h(A)})}),r.add(i.id),this.docentesPorMateria.has(i.id)||this.docentesPorMateria.set(i.id,new Set),this.docentesPorMateria.get(i.id)?.add(t)}}catch(d){console.error("Error al alternar asignaci\xF3n:",d);let _=d,h=(_?.error?.message??_?.message??"").toString().trim();h?this._tools.MostrarMensaje("error",h):this._tools.MostrarMensajeError()}finally{this.isLoadingMateria[i.id]=!1,this.recalcularConteosDocentes()}})}quitarAsignacionTabla(i){return at(this,null,function*(){if(!this.docenteSeleccionadoDemo)return;let e=this.materiasDemo.find(t=>t.id===i);e&&(yield this.toggleAsignacionDemo(e))})}tablaAsignacionesDemo(){let i=this.docenteSeleccionadoDemo;if(!i)return[];let e=this.asignacionesDemo.get(i.id)??new Set,t=[];for(let r of e){let d=this.materiasDemo.find(_=>_.id===r);d&&t.push({materiaId:d.id,docente:i.nombre,materia:`${d.sigla?d.sigla+" - ":""}${d.nombre}`,categoria:d.categoria,paralelo:d.paralelo||"-"})}return t}};Ge.\u0275fac=function(e){return new(e||Ge)(E(tt),E(ie),E(wt),E(nt),E(ne),E(Te),E(ee))},Ge.\u0275cmp=H({type:Ge,selectors:[["app-asignadormaterias"]],standalone:!1,decls:61,vars:17,consts:[[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"card"],[1,"row","align-items-end","g-2","mb-2"],[1,"col-sm-3"],[1,"input-group"],[1,"input-group-text"],[1,"bi","bi-calendar"],[1,"form-floating","flex-grow-1"],["id","filtroAnio",1,"form-select",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","filtroAnio"],[1,"bi","bi-bookmark"],["id","filtroResolucion",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroResolucion"],[1,"button","col-sm-6","d-flex","justify-content-end"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],[1,"card-body"],["class","card mb-3",4,"ngIf"],[1,"row","align-items-end","g-2"],[1,"col-sm-12"],[1,"bi","bi-search"],["type","text","placeholder","Buscar docente",1,"form-control",3,"input","value"],[1,"mt-2","d-flex","flex-wrap","gap-2"],["class","btn btn-outline-secondary btn-sm",3,"active","disabled","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-2"],["class","text-muted",4,"ngIf"],["class","text-primary",4,"ngIf"],[1,"col-sm-4","d-flex","justify-content-end","gap-2"],[1,"form-check","mt-2"],["type","checkbox","id","toggleModo",1,"form-check-input",3,"change"],["for","toggleModo",1,"form-check-label"],["class","row mb-2",4,"ngIf"],[4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"card","mb-3"],[1,"card-header","d-flex","align-items-center","justify-content-between","flex-wrap","gap-2","text-danger"],["type","text","placeholder","Buscar docente pendiente",1,"form-control",3,"input","value"],[1,"table-responsive"],[1,"table","table-sm","table-striped","align-middle","mb-0"],[2,"width","140px"],[2,"width","120px"],[4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"btn","btn-sm","btn-outline-success",3,"click","disabled"],["colspan","3",1,"text-center","py-3"],[1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"],[1,"text-muted"],[1,"text-primary"],[1,"row","mb-2"],["id","filtroAnioTabla",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroAnioTabla"],[1,"col-sm-3","mt-2","mt-sm-0"],["id","filtroResolucionTabla",1,"form-select",3,"ngModelChange","change","ngModel"],["for","filtroResolucionTabla"],[1,"col-sm-6"],[1,"bi","bi-filter"],["type","text","placeholder","Buscar materia",1,"form-control",3,"input","value"],[1,"col-sm-6","d-flex","justify-content-end","flex-wrap","gap-2","mt-2","mt-sm-0"],[1,"form-check","mt-1"],["type","checkbox","id","toggleCategorias",1,"form-check-input",3,"change","checked"],["for","toggleCategorias",1,"form-check-label"],[1,"d-flex","align-items-center","flex-wrap","gap-1"],[1,"text-muted","me-1"],["type","button","class","btn btn-outline-primary btn-sm",3,"active","click",4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-secondary btn-sm",3,"active","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[4,"ngFor","ngForOf"],[1,"text-center","mt-3"],[1,"d-flex","flex-wrap"],["class","list-group-item col-sm-3 custom-border position-relative",3,"ngClass",4,"ngFor","ngForOf"],[1,"list-group-item","col-sm-3","custom-border","position-relative",3,"ngClass"],["type","button",1,"btn","btn-sm","w-100","text-start",3,"click","disabled"],[1,"me-2","badge",3,"ngClass"],["class","small text-muted mt-1",4,"ngIf"],["class","spinner-border spinner-border-sm text-primary position-absolute top-50 start-50 translate-middle","role","status",4,"ngIf"],[1,"small","text-muted","mt-1"],["role","status",1,"spinner-border","spinner-border-sm","text-primary","position-absolute","top-50","start-50","translate-middle"],[1,"visually-hidden"],[1,"table","align-middle","table-hover","table-sm"],[1,"table-group-divider"],["colspan","6",1,"text-center","text-muted"],[1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],["colspan","6",1,"text-center"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),c(4,"Asignador de MATERIAS - DOCENTES"),o()()()(),n(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"span",8),x(10,"i",9),o(),n(11,"div",10)(12,"select",11),w("ngModelChange",function(d){return M(t.filtroAnioId,d)||(t.filtroAnioId=d),d}),f("change",function(){return t.onCambioFiltrosAsignacion()}),n(13,"option",12),c(14,"-- Seleccione --"),o(),g(15,so,2,2,"option",13),o(),n(16,"label",14),c(17,"A\xF1o (Gesti\xF3n)"),o()()()(),n(18,"div",6)(19,"div",7)(20,"span",8),x(21,"i",15),o(),n(22,"div",10)(23,"select",16),w("ngModelChange",function(d){return M(t.filtroResolucionKey,d)||(t.filtroResolucionKey=d),d}),f("change",function(){return t.onCambioFiltrosAsignacion()}),n(24,"option",12),c(25,"-- Seleccione --"),o(),g(26,lo,2,2,"option",13),o(),n(27,"label",17),c(28,"Resoluci\xF3n"),o()()()(),n(29,"div",18)(30,"button",19),f("click",function(){return t.togglePendientesDocentes()}),n(31,"span",20),x(32,"ng-lottie",21),o(),n(33,"span"),c(34),o(),x(35,"span",22),o()()(),n(36,"div",23),g(37,po,25,4,"div",24),n(38,"div",25)(39,"div",26)(40,"div",7)(41,"span",8),x(42,"i",27),o(),n(43,"div",10)(44,"input",28),f("input",function(d){return t.filterDocente=d.target.value}),o(),n(45,"label"),c(46,"Buscar docente (nombre o ID)"),o()()(),n(47,"div",29),g(48,uo,4,6,"button",30),o(),n(49,"div",31),g(50,_o,2,0,"small",32)(51,go,4,1,"h3",33),o()(),n(52,"div",34)(53,"div",35)(54,"input",36),f("change",function(d){return t.onToggleChange(d)}),o(),n(55,"label",37),c(56,"Modo tabla"),o()()()(),x(57,"hr"),g(58,vo,23,6,"div",38)(59,No,25,6,"div",39)(60,Fo,20,3,"div",40),o()()),e&2&&(s(12),y("ngModel",t.filtroAnioId),s(),l("ngValue",null),s(2),l("ngForOf",t.aniosOptions),s(8),y("ngModel",t.filtroResolucionKey),s(),l("ngValue",""),s(2),l("ngForOf",t.resolucionOptions),s(6),l("options",t._tools.optionseye),s(2),S("",t.verPendientesDocentes?"Ocultar pendientes":"Ver docentes pendientes de asignaci\xF3n"," "),s(3),l("ngIf",t.verPendientesDocentes),s(7),l("value",t.filterDocente),s(4),l("ngForOf",t.docentesFiltradosDemo())("ngForTrackBy",t.trackById),s(2),l("ngIf",!t.docenteSeleccionadoDemo),s(),l("ngIf",t.docenteSeleccionadoDemo),s(7),l("ngIf",t.ModoBoolean),s(),l("ngIf",!t.ModoBoolean),s(),l("ngIf",t.ModoBoolean))},dependencies:[U,q,K,X,Z,J,Q,Y,te],styles:[".wrap[_ngcontent-%COMP%]{padding:16px}.head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.card[_ngcontent-%COMP%]{border:1px solid #e6e6e6;border-radius:10px;padding:12px;background:#fff}.card.full[_ngcontent-%COMP%]{grid-column:1/-1}.row3[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr}.row4[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr auto}.lbl[_ngcontent-%COMP%]{font-size:12px;color:#444;margin-bottom:6px}.inp[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #dadada;border-radius:8px}.inp.mini[_ngcontent-%COMP%]{padding:6px 8px}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-end}button[_ngcontent-%COMP%]{padding:8px 10px;border:1px solid #dadada;border-radius:8px;background:#fafafa;cursor:pointer}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.danger[_ngcontent-%COMP%]{border-color:#ffb4b4;background:#fff5f5}.muted[_ngcontent-%COMP%]{opacity:.8}.hint[_ngcontent-%COMP%]{margin-top:8px;font-size:12px;color:#666}.msg[_ngcontent-%COMP%]{margin:10px 0;padding:10px 12px;border-radius:10px}.msg.err[_ngcontent-%COMP%]{background:#fff5f5;border:1px solid #ffb4b4;color:#7a0012}.msg.ok[_ngcontent-%COMP%]{background:#f3fff5;border:1px solid #a7f3b6;color:#0b4b1f}.chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}.chip[_ngcontent-%COMP%]{border-radius:999px}.chip.on[_ngcontent-%COMP%]{border-color:#2563eb;background:#eaf1ff}.table[_ngcontent-%COMP%]{margin-top:8px;overflow:auto}.tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 220px 1fr 110px 160px 1fr 210px;gap:8px;align-items:center;padding:8px;border-top:1px solid #f0f0f0}.th[_ngcontent-%COMP%]{font-weight:700;background:#fafafa;border-top:none;position:sticky;top:0}.mono[_ngcontent-%COMP%]{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.custom-border[_ngcontent-%COMP%]{border:1px solid #e6e6e6;border-radius:10px;padding:8px;background:#fff}.custom-border[_ngcontent-%COMP%]:hover{border-color:#2563eb;background:#eaf1ff}.checked[_ngcontent-%COMP%]{border-color:#22c55e!important;background:#f3fff5}.list-group-item[_ngcontent-%COMP%]{cursor:pointer}.btn.active[_ngcontent-%COMP%]{border-color:#2563eb;background:#eaf1ff;color:#0300a3;font-weight:700}@media (max-width: 1100px){.grid[_ngcontent-%COMP%], .row[_ngcontent-%COMP%], .row3[_ngcontent-%COMP%], .row4[_ngcontent-%COMP%]{grid-template-columns:1fr}.tr[_ngcontent-%COMP%]{grid-template-columns:70px 1fr}.th[_ngcontent-%COMP%]{display:none}}"]});var ot=Ge;var ko=[{path:"carreras",component:Ve},{path:"materias",component:Fe},{path:"plandeestudios",component:it},{path:"asignadormaterias",component:ot}],fe=class fe{};fe.\u0275fac=function(e){return new(e||fe)},fe.\u0275mod=Ue({type:fe}),fe.\u0275inj=He({imports:[dt.forChild(ko),dt]});var rt=fe;var xe=class xe{};xe.\u0275fac=function(e){return new(e||xe)},xe.\u0275mod=Ue({type:xe}),xe.\u0275inj=He({imports:[ht,Mt,yt,rt]});var Dt=xe;export{Pe as a,ot as b,Dt as c};
