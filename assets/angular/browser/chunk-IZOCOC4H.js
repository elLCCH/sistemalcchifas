import{a as Ze}from"./chunk-CXRBEYBU.js";import"./chunk-ZVVL3HDK.js";import{a as et}from"./chunk-CLL7BRQX.js";import"./chunk-XLXCS43A.js";import{a as Je}from"./chunk-UTFZNMGL.js";import{a as me}from"./chunk-NFLRO45J.js";import{a as q,e as We,f as Ye}from"./chunk-CCU65BHS.js";import{a as le}from"./chunk-CZWDWMMQ.js";import{a as qe}from"./chunk-KDPIXYM3.js";import{b as ce}from"./chunk-4WRFG2J2.js";import{a as Ke,b as Xe}from"./chunk-IOZ5TDSV.js";import{b as $e}from"./chunk-N4MEOVMH.js";import{a as pe}from"./chunk-5KBF566K.js";import{b as Qe}from"./chunk-UD6YX65Z.js";import"./chunk-NCIXDP2C.js";import{e as Ne,g as Fe,k as W}from"./chunk-LEW5N4EV.js";import{b as de}from"./chunk-YB5XT4DU.js";import{d as ze,f as Be,i as Ge}from"./chunk-OXGEW5OA.js";import{b as He,c as ie,f as ne,g as ke,h as Ce,j as L,k as oe,o as Ve,p as Re,q as Le,r as re,s as ae,t as se,x as je,y as Ue}from"./chunk-TKGN7DBU.js";import{a as te}from"./chunk-5RMZ5E5A.js";import{Aa as S,Bb as Me,Ca as fe,Cb as De,Cc as Oe,Da as he,Db as Pe,Ea as s,Ec as J,Fc as ee,Gb as N,Hb as y,Ib as $,Lb as l,Ma as E,Mb as x,Nb as v,Nc as we,Ob as M,Pb as Te,Ra as Y,Sa as K,Sb as A,Tb as O,Ub as w,Vc as ve,Wa as p,Wb as R,Yb as Ae,_ as Q,_b as F,ab as xe,bb as X,db as Z,ga as u,gc as k,ha as g,ib as m,jb as a,kb as r,lb as C,pb as P,qb as T,sb as h,vb as f,xb as d}from"./chunk-SGF3PIFW.js";import{a as Ie,b as Se,m as ye}from"./chunk-GG76335P.js";var pt=()=>({standalone:!0});function _t(i,t){if(i&1){let e=h();a(0,"button",61),f("click",function(){u(e);let o=d();return g(o.nuevoHorario())}),l(1," Publicar "),r()}}function ut(i,t){i&1&&(a(0,"div",62)(1,"div",63),l(2,"Cargando horarios..."),r()())}function gt(i,t){i&1&&(a(0,"div",66),l(1," No hay horarios publicados. "),r())}function ft(i,t){if(i&1&&C(0,"img",74),i&2){let e=d().$implicit,n=d(2);m("src",n.ruta+e.institucion_logo,S)("alt",e==null?null:e.institucion_nombre)}}function ht(i,t){if(i&1&&(a(0,"span",75),l(1),r()),i&2){let e=d().$implicit;s(),x(e.horarios.length)}}function xt(i,t){if(i&1&&(a(0,"div",13),l(1),r()),i&2){let e=d().$implicit;s(),v("Gesti\xF3n: ",e==null?null:e.subtitulo)}}function vt(i,t){if(i&1&&(a(0,"div",13),l(1),r()),i&2){let e=d().$implicit;s(),x(e==null?null:e.descripcion)}}function Ct(i,t){if(i&1&&(a(0,"a",82),l(1,"Ver"),r()),i&2){let e=d().$implicit,n=d(3);m("href",n.ruta+e.archivo,S)}}function bt(i,t){if(i&1){let e=h();a(0,"button",83),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.editarHorario(o))}),l(1," Editar "),r()}}function Et(i,t){if(i&1){let e=h();a(0,"button",84),f("click",function(){u(e);let o=d().$implicit,c=d(3);return g(c.eliminarHorario(o))}),l(1," Eliminar "),r()}}function It(i,t){if(i&1&&(a(0,"div",76)(1,"div",77)(2,"div")(3,"div",32),l(4),r(),p(5,xt,2,1,"div",78)(6,vt,2,1,"div",78),r(),a(7,"div",14),p(8,Ct,2,1,"a",79)(9,bt,2,0,"button",80)(10,Et,2,0,"button",81),r()()()),i&2){let e=t.$implicit,n=d(3);s(4),x(e==null?null:e.titulo),s(),m("ngIf",e==null?null:e.subtitulo),s(),m("ngIf",e==null?null:e.descripcion),s(2),m("ngIf",e==null?null:e.archivo),s(),m("ngIf",n.puedeEditarHorario(e)),s(),m("ngIf",n.puedeEditarHorario(e))}}function St(i,t){if(i&1&&(a(0,"div",62)(1,"div",67)(2,"div",68)(3,"div",11)(4,"div",14),p(5,ft,1,2,"img",69),a(6,"div",70),l(7),r()(),p(8,ht,2,1,"span",71),r()(),a(9,"div",72),p(10,It,11,6,"div",73),r()()()),i&2){let e=t.$implicit;s(),y("border-left-color",(e==null?null:e.institucion_color_fuerte)||(e==null?null:e.institucion_color_institucional)||"#0d6efd"),s(),y("background",(e==null?null:e.institucion_color_bajo)||"#f8f9fa"),s(3),m("ngIf",e==null?null:e.institucion_logo),s(2),x(e==null?null:e.institucion_nombre),s(),m("ngIf",e==null||e.horarios==null?null:e.horarios.length),s(2),m("ngForOf",e.horarios)}}function yt(i,t){if(i&1&&(P(0),p(1,gt,2,0,"div",64)(2,St,11,8,"div",65),T()),i&2){let e=d();s(),m("ngIf",((e.horariosInstituciones==null?null:e.horariosInstituciones.length)??0)===0),s(),m("ngForOf",e.horariosInstituciones)}}function Mt(i,t){i&1&&(a(0,"div",85),l(1," No tiene permisos para publicar horarios. "),r())}function Dt(i,t){if(i&1&&(a(0,"div",96),l(1),r()),i&2){let e=d(2);s(),v("Archivo: ",e.horarioFile==null?null:e.horarioFile.name)}}function Pt(i,t){if(i&1&&(a(0,"div",62)(1,"div",97)(2,"div",13),l(3,"Subida"),r(),a(4,"div",98),l(5),r()(),a(6,"div",99),C(7,"div",100),r()()),i&2){let e=d(2);s(5),v("",e.horarioUploadProgress??0,"%"),s(2),y("width",e.horarioUploadProgress??0,"%")}}function Tt(i,t){if(i&1){let e=h();P(0),a(1,"div",86),f("dragover",function(o){u(e);let c=d();return g(c.onHorarioDragOver(o))})("dragleave",function(o){u(e);let c=d();return g(c.onHorarioDragLeave(o))})("drop",function(o){u(e);let c=d();return g(c.onHorarioDrop(o))}),a(2,"input",87,0),f("change",function(o){u(e);let c=d();return g(c.onHorarioFileInputChange(o))}),r(),a(4,"div",11)(5,"div")(6,"div",32),l(7,"Arrastra aqu\xED tu archivo"),r(),a(8,"div",13),l(9,"PDF o imagen"),r()(),a(10,"button",88),f("click",function(){u(e);let o=N(3);return g(o.click())}),l(11,"Seleccionar"),r()(),p(12,Dt,2,1,"div",89),r(),p(13,Pt,8,3,"div",17),a(14,"div",90)(15,"div",91)(16,"label",92),l(17,"Gesti\xF3n"),r(),C(18,"input",93),r(),a(19,"div",91)(20,"label",92),l(21,"T\xEDtulo"),r(),C(22,"input",94),r(),a(23,"div",91)(24,"label",92),l(25,"Descripci\xF3n"),r(),C(26,"textarea",95),r()(),T()}if(i&2){let e=d();s(),$("dragging",e.horarioUploadDragging),s(11),m("ngIf",e.horarioFile),s(),m("ngIf",e.horarioUploading||e.horarioUploadProgress!==null),s(),m("formGroup",e.horarioForm)}}function At(i,t){if(i&1){let e=h();a(0,"button",106),f("click",function(){let o=u(e).$implicit,c=d(2);return g(c.seleccionarInstitucion(o))}),C(1,"img",107),r()}if(i&2){let e=t.$implicit,n=d(2);$("active",(n.institucionSeleccionada==null?null:n.institucionSeleccionada.id)===(e==null?null:e.id)),m("title",e==null?null:e.Nombre),s(),m("src",n.ruta+e.Logo,S)("alt",e==null?null:e.Nombre)}}function Ot(i,t){if(i&1){let e=h();a(0,"div",101)(1,"div",102)(2,"div",32),l(3,"Filtrar por instituci\xF3n (click en el logo)"),r(),a(4,"button",103),f("click",function(){u(e);let o=d();return g(o.seleccionarInstitucion(null))}),l(5," Quitar filtro "),r()(),a(6,"div",104),p(7,At,2,5,"button",105),r()()}if(i&2){let e=d();s(4),m("disabled",!e.institucionSeleccionada),s(3),m("ngForOf",e.institucionesLogos)}}function wt(i,t){if(i&1&&(a(0,"option",108),l(1),r()),i&2){let e=t.$implicit;m("value",e.id),s(),x(e.Anio)}}function Nt(i,t){i&1&&(a(0,"div",109)(1,"div",110)(2,"div",111)(3,"div",112),l(4,"NO SE ENCONTR\xD3 HORARIOS PUBLICADOS"),r(),a(5,"div",33),l(6,"No se realiz\xF3 la publicaci\xF3n de horarios para esta gesti\xF3n."),r()()()())}function Ft(i,t){if(i&1&&C(0,"img",74),i&2){let e=d(2).$implicit,n=d();m("src",n.ruta+e.institucion_logo,S)("alt",e==null?null:e.institucion_nombre)}}function Ht(i,t){if(i&1&&(a(0,"div",125)(1,"div",126),p(2,Ft,1,2,"img",69),a(3,"div",33),l(4),r()()()),i&2){let e=d().$implicit,n=d();s(),y("border-color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),s(),m("ngIf",e==null?null:e.institucion_logo),s(2),x(e==null?null:e.institucion_nombre)}}function kt(i,t){if(i&1&&(a(0,"option",108),l(1),r()),i&2){let e=t.$implicit;m("value",e.materia_id),s(),M(" ",e.SiglaMateria," - ",e.NombreMateria," ")}}function Vt(i,t){if(i&1&&(a(0,"div",96),l(1," Seleccionado: "),a(2,"span",32),l(3),r()()),i&2){let e=d().$implicit;s(3),x(e.selectedMateriaNombre)}}function Rt(i,t){if(i&1){let e=h();a(0,"div",113)(1,"div",114)(2,"div",10)(3,"div",115)(4,"div",116)(5,"button",117),f("click",function(){let o=u(e).$implicit,c=d();return g(c.filterHorarioForm.patchValue({txt:o.NivelCurso}))}),l(6),r(),p(7,Ht,5,4,"div",118),r(),a(8,"span",119),l(9),r()(),a(10,"div",62)(11,"label",120),l(12,"Materias"),r(),a(13,"select",121),w("ngModelChange",function(o){let c=u(e).$implicit;return O(c.selectedMateriaId,o)||(c.selectedMateriaId=o),g(o)}),f("ngModelChange",function(o){let c=u(e).$implicit,_=d();return g(_.onMateriaIdChange(c,o))}),a(14,"option",122),l(15,"LISTAR TODO EL CURSO (MEZCLADO)"),r(),p(16,kt,2,3,"option",39),r()(),a(17,"div",123)(18,"button",124),f("click",function(o){let c=u(e).$implicit,_=d();return g(_.AbrirParalelosPorCurso(c,o))}),l(19," LISTAR "),r()(),p(20,Vt,4,1,"div",89),r()()()}if(i&2){let e=t.$implicit,n=d();s(),y("border-left-color",n.institucionColorFuerte(e==null?null:e.instituciones_id))("background","linear-gradient(180deg,"+n.institucionColorBajo(e==null?null:e.instituciones_id)+" 0%, #ffffff 55%)"),s(4),y("color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),s(),v(" ",e.NivelCurso," "),s(),m("ngIf",(e==null?null:e.institucion_logo)||(e==null?null:e.institucion_nombre)),s(),y("background",n.institucionColorFuerte(e==null?null:e.instituciones_id)),s(),v(" ",e.Turno," "),s(4),A("ngModel",e.selectedMateriaId),m("ngModelOptions",Ae(19,pt)),s(3),m("ngForOf",e.materias),s(2),y("background",n.institucionColorFuerte(e==null?null:e.instituciones_id))("border-color",n.institucionColorFuerte(e==null?null:e.instituciones_id)),s(2),m("ngIf",e.selectedMateriaNombre)}}function Lt(i,t){if(i&1&&(a(0,"option",108),l(1),r()),i&2){let e=t.$implicit;m("value",e.id),s(),x(e.Anio)}}function jt(i,t){if(i&1&&C(0,"img",131),i&2){let e=d().$implicit,n=d();m("src",n.ruta+e.logo,S)}}function Ut(i,t){if(i&1&&(a(0,"span"),l(1),r()),i&2){let e=d(2).$implicit;s(),v("(",e.docentes.especialidad.celular_trabajo,")")}}function $t(i,t){if(i&1&&(a(0,"span"),l(1),p(2,Ut,2,1,"span",18),r()),i&2){let e=d().$implicit;s(),M(" ",e.docentes.especialidad.nombres," ",e.docentes.especialidad.apellidos," "),s(),m("ngIf",e.docentes.especialidad.celular_trabajo)}}function zt(i,t){if(i&1&&(a(0,"span"),l(1),r()),i&2){let e=d(2).$implicit;s(),v("(",e.docentes.practica_conjuntos.celular_trabajo,")")}}function Bt(i,t){if(i&1&&(a(0,"span"),l(1),p(2,zt,2,1,"span",18),r()),i&2){let e=d().$implicit;s(),M(" ",e.docentes.practica_conjuntos.nombres," ",e.docentes.practica_conjuntos.apellidos," "),s(),m("ngIf",e.docentes.practica_conjuntos.celular_trabajo)}}function Gt(i,t){if(i&1&&(a(0,"span"),l(1),r()),i&2){let e=d(2).$implicit;s(),v("(",e.docentes.instrumento_complementario.celular_trabajo,")")}}function Wt(i,t){if(i&1&&(a(0,"span"),l(1),p(2,Gt,2,1,"span",18),r()),i&2){let e=d().$implicit;s(),M(" ",e.docentes.instrumento_complementario.nombres," ",e.docentes.instrumento_complementario.apellidos," "),s(),m("ngIf",e.docentes.instrumento_complementario.celular_trabajo)}}function qt(i,t){if(i&1&&(a(0,"tr")(1,"td"),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),p(10,$t,3,3,"span",18),r(),a(11,"td"),p(12,Bt,3,3,"span",18),r(),a(13,"td"),p(14,Wt,3,3,"span",18),r()()),i&2){let e=t.$implicit;s(2),M("",e.lvl_curso," ",e.paralelo),s(2),x(e.nombre_materia),s(2),x(e.turno),s(2),x(e.modo_asistencia),s(2),m("ngIf",e.docentes==null||e.docentes.especialidad==null?null:e.docentes.especialidad.nombres),s(2),m("ngIf",e.docentes==null||e.docentes.practica_conjuntos==null?null:e.docentes.practica_conjuntos.nombres),s(2),m("ngIf",e.docentes==null||e.docentes.instrumento_complementario==null?null:e.docentes.instrumento_complementario.nombres)}}function Qt(i,t){if(i&1&&(a(0,"div",101)(1,"div",132),l(2),r(),a(3,"table",133)(4,"thead",134)(5,"tr")(6,"th"),l(7,"Paralelo"),r(),a(8,"th"),l(9,"Materia"),r(),a(10,"th"),l(11,"Turno"),r(),a(12,"th"),l(13,"Modo Asistencia"),r(),a(14,"th"),l(15,"Docente Especialidad"),r(),a(16,"th"),l(17,"Docente Pr\xE1ctica"),r(),a(18,"th"),l(19,"Docente Complementario"),r()()(),a(20,"tbody"),p(21,qt,15,8,"tr",135),r()()()),i&2){let e=t.$implicit;s(2),x(e.nombre),s(19),m("ngForOf",e.materias)}}function Yt(i,t){if(i&1&&(a(0,"div",127)(1,"h4",128),l(2),p(3,jt,1,1,"img",129),r(),p(4,Qt,22,2,"div",130),r()),i&2){let e=t.$implicit;s(2),v(" ",e.nombre," "),s(),m("ngIf",e.logo),s(),m("ngForOf",e.carreras)}}var z=class z{constructor(t,e,n,o,c,_,b,I){this.router=t;this.route=e;this._tools=n;this._anios=o;this._inst=c;this._public=_;this._inicios=b;this._auth=I;this.ruta=te.ruta;this.perfilTipo=null;this.puedePublicarHorarios=!1;this.institucionesIdSesion=null;this.esSuperlcchs=!1;this.horariosInstituciones=[];this.horariosLoading=!1;this.horarioForm=new Ce({titulo:new L(""),subtitulo:new L(""),descripcion:new L("")});this.horarioUploadDragging=!1;this.horarioFile=null;this.horarioTempFilePath=null;this.horarioUploading=!1;this.horarioUploadProgress=null;this.horarioEditId=null;this.horarioEditOriginalArchivo=null;this.horarioSaving=!1;this.cursos=[];this.cursosFiltrados=[];this.instituciones=[];this.institucionesLogos=[];this.institucionSeleccionada=null;this.institucionesById=new Map;this.modalHorarioEl=null;this.modalHorarioHiddenListener=null;this.filtroHorario=!1;this.filterHorarioForm=new Ce({txt:new L("")});this.anio=[];this.gestion_id_seleccionado="";this.CIVerificar="";this.CursosMateriasEstudiante=[]}ngAfterViewInit(){this.modalHorarioEl=document.getElementById("ModalPublicarHorario"),this.modalHorarioEl&&(this.modalHorarioHiddenListener=()=>{this.forceCleanupModalArtifacts()},this.modalHorarioEl.addEventListener("hidden.bs.modal",this.modalHorarioHiddenListener))}ngOnDestroy(){this.modalHorarioEl&&this.modalHorarioHiddenListener&&this.modalHorarioEl.removeEventListener("hidden.bs.modal",this.modalHorarioHiddenListener),this.modalHorarioEl=null,this.modalHorarioHiddenListener=null}ngOnInit(){this.CargarInstituciones(),this.CargarAnio(),this.iniciarFormfilterHorario(),this.iniciarFormHorario(),this._auth.pedirPerfil().subscribe({next:t=>{this.perfilTipo=t?.tipo??null,this.esSuperlcchs=this.perfilTipo==="superlcchs";let e=Number(t?.usuario?.instituciones_id??0);this.institucionesIdSesion=Number.isFinite(e)&&e>0?e:null,this.puedePublicarHorarios=this.perfilTipo==="planteladministrativos"||this.perfilTipo==="superlcchs"},error:()=>{this.perfilTipo=null,this.puedePublicarHorarios=!1,this.esSuperlcchs=!1,this.institucionesIdSesion=null}})}forceCleanupModalArtifacts(){try{document.querySelectorAll(".modal-backdrop").forEach(t=>t.remove()),document.body.classList.remove("modal-open"),document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right")}catch{}}getGestionAnioSeleccionado(){let t=(this.gestion_id_seleccionado??"").toString();return t?((this.anio??[]).find(n=>(n?.id??"").toString()===t)?.Anio??"").toString():""}iniciarFormHorario(){let t=this.getGestionAnioSeleccionado();this.horarioForm.patchValue({titulo:"HORARIO "+(t||new Date().getFullYear()),subtitulo:t||"",descripcion:""},{emitEvent:!1})}get esEdicionHorario(){return this.horarioEditId!=null}nuevoHorario(){this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!0)}editarHorario(t){if(!this.puedeEditarHorario(t)){this._tools.MostrarMensaje("warning","No autorizado");return}this.resetHorarioDraft(!0),this.horarioEditId=Number(t?.id??0)||null,this.horarioEditOriginalArchivo=t?.archivo??null;let e=this.getGestionAnioSeleccionado()||(t?.subtitulo??"");this.horarioForm.patchValue({titulo:(t?.titulo??"").toString(),subtitulo:e.toString(),descripcion:(t?.descripcion??"").toString()},{emitEvent:!1})}cerrarModalHorario(){let t=document.getElementById("ModalPublicarHorario");if(t){try{(q.getOrCreateInstance?q.getOrCreateInstance(t):q.getInstance(t)||new q(t)).hide()}catch{}setTimeout(()=>this.forceCleanupModalArtifacts(),350)}}CargarHorariosPublicados(){this.horariosLoading=!0;let t=this.getGestionAnioSeleccionado(),e=this.institucionSeleccionada?.id!=null?this.institucionSeleccionada.id:void 0;this._public.obtenerHorariosPublicadosFiltrado({anio:t,institucion_id:e}).subscribe({next:n=>{this.horariosInstituciones=Array.isArray(n?.data)?n.data:[],this.horariosLoading=!1},error:n=>{console.error("Error al cargar horarios publicados",n),this.horariosInstituciones=[],this.horariosLoading=!1}})}subirArchivoHorario(t){t&&(this.horarioTempFilePath&&(this._tools.EliminarArchivo(this.horarioTempFilePath),this.horarioTempFilePath=null),this.horarioFile=t,this.horarioUploading=!0,this.horarioUploadProgress=0,this._tools.SubirArchivo(t,"inicioshorarios").subscribe({next:e=>{if(e.type===ve.UploadProgress){let n=e.total??0;n>0&&(this.horarioUploadProgress=Math.round(e.loaded/n*100))}if(e.type===ve.Response){let n=e.body?.filePath;n&&(this.horarioTempFilePath=n),this.horarioUploading=!1,this.horarioUploadProgress=100}},error:e=>{console.log("ERROR SUBIENDO HORARIO",e),this.horarioUploading=!1,this.horarioUploadProgress=null,this._tools.MostrarMensaje("error","Error al subir archivo")}}))}onHorarioFileInputChange(t){let e=t.target;if(!e?.files||e.files.length===0)return;let n=e.files[0];this.subirArchivoHorario(n)}onHorarioDragOver(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!0}onHorarioDragLeave(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!1}onHorarioDrop(t){t.preventDefault(),t.stopPropagation(),this.horarioUploadDragging=!1;let e=t.dataTransfer?.files?.[0];e&&this.subirArchivoHorario(e)}resetHorarioDraft(t){t&&this.horarioTempFilePath&&this._tools.EliminarArchivo(this.horarioTempFilePath),this.horarioTempFilePath=null,this.horarioFile=null,this.horarioUploading=!1,this.horarioUploadProgress=null,this.iniciarFormHorario()}limpiarHorarioDraft(){this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!0)}puedeEditarHorario(t){if(!this.puedePublicarHorarios)return!1;if(this.esSuperlcchs)return!0;let e=this.institucionesIdSesion;if(!e)return!1;let n=Number(t?.id_institucion??t?.institucion_id??0);return Number.isFinite(n)&&n>0&&n===e}eliminarHorario(t){return ye(this,null,function*(){if(!this.puedeEditarHorario(t)){this._tools.MostrarMensaje("warning","No autorizado");return}if(!(yield this._tools.mostrarMensajeConfirm("Eliminar horario","\xBFDesea eliminar este horario? Esta acci\xF3n no se puede deshacer.","warning","Eliminar","Cancelar")))return;let n=Number(t?.id??0);!Number.isFinite(n)||n<=0||this._inicios.Eliminarinicios(n).subscribe({next:()=>{t?.archivo&&this._tools.EliminarArchivo(t.archivo),this._tools.MostrarMensaje("success","Eliminado"),this.horarioEditId===n&&this.limpiarHorarioDraft(),this.CargarHorariosPublicados()},error:o=>{console.error("Error al eliminar horario",o),this._tools.MostrarMensaje("error","No se pudo eliminar")}})})}guardarHorario(){if(!this.puedePublicarHorarios){this._tools.MostrarMensaje("warning","No tiene permisos para publicar horarios");return}if(this.horarioSaving)return;if(this.horarioUploading){this._tools.MostrarMensaje("warning","Espere a que termine la subida");return}let t=this.getGestionAnioSeleccionado();if(!t){this._tools.MostrarMensaje("warning","Seleccione una gesti\xF3n");return}let e=(this.horarioForm.get("titulo")?.value??"").toString().trim(),n=(this.horarioForm.get("descripcion")?.value??"").toString().trim();if(!e){this._tools.MostrarMensaje("warning","Ingrese un t\xEDtulo");return}let o=this.horarioTempFilePath||this.horarioEditOriginalArchivo;if(!o){this._tools.MostrarMensaje("warning","Suba un PDF o imagen");return}let c={categoria:"HORARIO",titulo:e,subtitulo:t,descripcion:n,archivo:o,estado:"ACTIVO",visibilidad:"VISIBLE"};this.horarioSaving=!0;let _=this.horarioEditId!=null,b=()=>{this.horarioSaving=!1,this._tools.MostrarMensaje("success",_?"Horario actualizado":"Horario publicado"),_&&this.horarioTempFilePath&&this.horarioEditOriginalArchivo&&this.horarioEditOriginalArchivo!==this.horarioTempFilePath&&this._tools.EliminarArchivo(this.horarioEditOriginalArchivo),this.horarioEditId=null,this.horarioEditOriginalArchivo=null,this.resetHorarioDraft(!1),this.CargarHorariosPublicados(),this.cerrarModalHorario()},I=D=>{console.error(_?"Error al actualizar horario":"Error al publicar horario",D),this.horarioSaving=!1,this._tools.MostrarMensaje("error",_?"No se pudo actualizar el horario":"No se pudo publicar el horario")};_?this._inicios.Modificarinicios(c,this.horarioEditId).subscribe({next:b,error:I}):this._inicios.Agregarinicios(c).subscribe({next:b,error:I})}iniciarFormfilterHorario(){this.filterHorarioForm.get("txt").valueChanges.subscribe(t=>{console.log("entered data is ",t),this.filtroHorario=!0,this.aplicarFiltros()})}filterHorario(t){this.filterHorarioForm.patchValue({txt:t},{emitEvent:!1}),this.aplicarFiltros()}aplicarFiltros(){let t=(this.filterHorarioForm.get("txt")?.value??"").toString().toUpperCase().trim(),e=this.institucionSeleccionada?.id!=null?String(this.institucionSeleccionada.id):"",n=Array.isArray(this.cursos)?[...this.cursos]:[];e&&(n=n.filter(o=>String(o?.instituciones_id??"")===e)),t&&(n=n.filter(o=>String(o?.NivelCurso??"").toUpperCase().includes(t))),this.cursosFiltrados=n}CargarInstituciones(){this._inst.Obtenerinstituciones().subscribe({next:t=>{console.log("instituciones",t);let n=(Array.isArray(t?.data?.data)?t.data.data:Array.isArray(t?.data)?t.data:[]).filter(o=>String(o?.Visibilidad??"VISIBLE").toUpperCase()==="VISIBLE").filter(o=>String(o?.Estado??"ACTIVO").toUpperCase()==="ACTIVO").sort((o,c)=>String(o?.Nombre??"").localeCompare(String(c?.Nombre??"")));this.instituciones=n,this.institucionesLogos=n.filter(o=>!!o?.Logo),this.institucionesById=new Map((n||[]).map(o=>[String(o?.id??""),o]))},error:t=>{console.error("Error al cargar carreras",t),this.instituciones=[],this.institucionesLogos=[],this.institucionesById=new Map}})}institucionColorFuerte(t){let e=this.institucionesById.get(String(t??""));return e?.ColorFuerte||e?.ColorInstitucional||"#0d6efd"}institucionColorBajo(t){return this.institucionesById.get(String(t??""))?.ColorBajo||"#f8f9fa"}seleccionarInstitucion(t){t?this.institucionSeleccionada?.id===t.id?this.institucionSeleccionada=null:this.institucionSeleccionada=t:this.institucionSeleccionada=null,this.CargarCursosDesdeMaterias(),this.CargarHorariosPublicados()}CargarAnio(){this._anios.Obteneranios().subscribe({next:t=>{console.log("anios",t),this.anio=t.data??[];let e=this.anio.find(n=>(n?.Predeterminado??"")==="SI")??this.anio[0];e?.id&&(this.gestion_id_seleccionado=e.id,this.onGestionChange())},error:t=>{console.error("Error al cargar",t),this.instituciones=[],this.institucionesLogos=[]}})}onGestionChange(){if(this.CargarCursosDesdeMaterias(),this.CargarHorariosPublicados(),!this.esEdicionHorario)this.iniciarFormHorario();else{let t=this.getGestionAnioSeleccionado();this.horarioForm.patchValue({subtitulo:t},{emitEvent:!1})}}CargarCursosDesdeMaterias(){if(!this.gestion_id_seleccionado){this.cursos=[],this.cursosFiltrados=[];return}let t={Anio_id:this.gestion_id_seleccionado};this.institucionSeleccionada?.id!=null&&(t.instituciones_id=this.institucionSeleccionada.id),this._public.obtenerHorariosCursos(t).subscribe({next:e=>{console.log("CURSOS FILTRADOS",e),this.cursos=(e??[]).map(n=>Se(Ie({},n),{selectedMateriaId:"",selectedMateriaNombre:""})),this.aplicarFiltros()},error:e=>{console.error("Error al cargar anios",e),this.cursos=[],this.cursosFiltrados=[]}})}onSelectMateria(t,e){t.selectedMateriaId=e?.materia_id??"",t.selectedMateriaNombre=`${e?.SiglaMateria??""} ${e?.NombreMateria??""}`.trim()}onMateriaIdChange(t,e){let n=(e??"").toString(),o=(t?.materias??[]).find(c=>(c?.materia_id??"").toString()===n);o?this.onSelectMateria(t,o):(t.selectedMateriaId="",t.selectedMateriaNombre="")}abrirParalelos(t){console.log("intentanto abrir"),t.ctrlKey?window.open("/publicos/paralelos","_blank"):this.router.navigate(["/publicos/paralelos"])}AbrirParalelosPorCurso(t,e){t.selectedMateriaId?sessionStorage.setItem("HORARIOS_MODO","xMATERIA"):sessionStorage.setItem("HORARIOS_MODO","MEZCLADO"),sessionStorage.setItem("HORARIOS_ANIO_ID",(this.gestion_id_seleccionado??"").toString()),sessionStorage.setItem("HORARIOS_LVL_CURSO",(t.LvlCurso??"").toString()),sessionStorage.setItem("HORARIOS_PARALELO",(t.Paralelo??"").toString()),sessionStorage.setItem("HORARIOS_TURNO",(t.Turno??"").toString()),sessionStorage.setItem("HORARIOS_MATERIA_ID",(t.selectedMateriaId??"").toString()),sessionStorage.setItem("HORARIOS_MATERIA_TITULO",(t.selectedMateriaNombre??"TODAS LAS MATERIAS").toString()),t?.instituciones_id!=null?(sessionStorage.setItem("HORARIOS_INSTITUCION_ID",String(t.instituciones_id)),t?.institucion_nombre&&sessionStorage.setItem("HORARIOS_INSTITUCION_NOMBRE",String(t.institucion_nombre)),t?.institucion_logo&&sessionStorage.setItem("HORARIOS_INSTITUCION_LOGO",String(t.institucion_logo))):(sessionStorage.removeItem("HORARIOS_INSTITUCION_ID"),sessionStorage.removeItem("HORARIOS_INSTITUCION_NOMBRE"),sessionStorage.removeItem("HORARIOS_INSTITUCION_LOGO")),this.abrirParalelos(e)}VerificarCursoParalelo(){console.log(this.CIVerificar,this.gestion_id_seleccionado);let t={CI:this.CIVerificar,Anio_id:this.gestion_id_seleccionado};this._public.CargarMateriasEstudiantesMultiInstitucionPublico(t).subscribe({next:e=>{console.log("CURSOS FILTRADOS",e.data),this.CursosMateriasEstudiante=e.data??[],this.CursosMateriasEstudiante.length==0&&this._tools.MensajeInformacion("ESTUDIANTE A\xDAN SIN MATERIAS ASIGNADAS","SI SU CARNET UTILIZA COMPLEMENTO ENTONCES ESCRIBIR, ejemplo: 12345-H1","error")},error:e=>{console.error("Error al cargar anios",e),this.CursosMateriasEstudiante=[],this._tools.MensajeInformacion("ESTUDIANTE A\xDAN SIN MATERIAS ASIGNADAS","SI SU CARNET UTILIZA COMPLEMENTO ENTONCES ESCRIBIR, ejemplo: 12345-H1","error")}})}};z.\u0275fac=function(e){return new(e||z)(E(Fe),E(Ne),E(de),E(me),E(le),E(pe),E(We),E(ce))},z.\u0275cmp=Y({type:z,selectors:[["app-horarios"]],standalone:!1,decls:105,vars:18,consts:[["horarioFileInput",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"container-fluid","py-3"],[1,"row","g-3"],[1,"col-12","col-lg-4"],[1,"card","shadow-sm","border-0","sticky-lg-top","horarios-panel"],[1,"card-body"],[1,"d-flex","align-items-center","justify-content-between","gap-2"],[1,"h5","fw-bold","mb-0"],[1,"small","text-muted"],[1,"d-flex","align-items-center","gap-2"],["type","button","class","btn btn-sm btn-primary","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click"],["class","mt-3",4,"ngIf"],[4,"ngIf"],["id","ModalPublicarHorario","tabindex","-1","aria-hidden","true","data-bs-backdrop","static","data-bs-keyboard","false",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","alert alert-warning",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"col-12","col-lg-8"],[1,"col-sm-6","alert","alert-info","py-2"],[1,"fw-semibold"],[1,"small"],["class","mb-3",4,"ngIf"],[1,"col-sm-6","row"],[1,"form-floating","mb-3","col-4"],[1,"form-select",3,"ngModelChange","change","ngModel"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"form-floating","mb-3","col-8"],["type","button","data-bs-toggle","modal","data-bs-target","#AveriguarParalelo",1,"btn","btn-primary"],[1,"col-sm-12","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"form-floating",3,"formGroup"],["type","text","formControlName","txt","placeholder","EJ: PRIMERO SUPERIOR",1,"form-control"],["class","container text-center mt-5",4,"ngIf"],["class","col-12 col-md-6 col-lg-4",4,"ngFor","ngForOf"],["id","AveriguarParalelo","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-xl"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"mb-4"],[1,"font-weight-bold","text-center","color-fuente"],[1,"form-group","row"],[1,"form-floating","mb-3","col-6"],[1,"form-label","col-6"],[1,"form-floating","mb-3","col-sm-12"],["type","text","placeholder","",1,"form-control",3,"ngModelChange","ngModel"],[1,"invalid-feedback"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"click"],["class","mb-5",4,"ngFor","ngForOf"],["type","button","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",1,"btn","btn-sm","btn-primary",3,"click"],[1,"mt-3"],[1,"text-muted","small"],["class","text-muted small mt-3",4,"ngIf"],["class","mt-3",4,"ngFor","ngForOf"],[1,"text-muted","small","mt-3"],[1,"horario-inst-card"],[1,"horario-inst-header"],["class","institucion-mini-logo",3,"src","alt",4,"ngIf"],[1,"fw-semibold","small"],["class","badge bg-secondary",4,"ngIf"],[1,"horario-inst-body"],["class","horario-item",4,"ngFor","ngForOf"],[1,"institucion-mini-logo",3,"src","alt"],[1,"badge","bg-secondary"],[1,"horario-item"],[1,"d-flex","align-items-start","justify-content-between","gap-2"],["class","small text-muted",4,"ngIf"],["class","btn btn-sm btn-outline-secondary","target","_blank","rel","noopener",3,"href",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-primary","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],["target","_blank","rel","noopener",1,"btn","btn-sm","btn-outline-secondary",3,"href"],["type","button","data-bs-toggle","modal","data-bs-target","#ModalPublicarHorario",1,"btn","btn-sm","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"alert","alert-warning"],[1,"horario-dropzone",3,"dragover","dragleave","drop"],["type","file","accept","application/pdf,image/*","hidden","",3,"change"],["type","button",1,"btn","btn-primary",3,"click"],["class","small text-muted mt-2",4,"ngIf"],[1,"row","g-2","mt-3",3,"formGroup"],[1,"col-12"],[1,"form-label"],["formControlName","subtitulo","readonly","",1,"form-control"],["formControlName","titulo","placeholder","Ej: HORARIO 2026",1,"form-control"],["formControlName","descripcion","rows","3","placeholder","Detalle (opcional)",1,"form-control"],[1,"small","text-muted","mt-2"],[1,"d-flex","align-items-center","justify-content-between"],[1,"small","fw-semibold"],[1,"progress",2,"height","10px"],["role","progressbar",1,"progress-bar"],[1,"mb-3"],[1,"d-flex","align-items-center","justify-content-between","flex-wrap","gap-2"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click","disabled"],[1,"mt-2","d-flex","flex-wrap","gap-2"],["type","button","class","btn btn-light border institucion-logo-btn",3,"active","title","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-light","border","institucion-logo-btn",3,"click","title"],[1,"institucion-logo",3,"src","alt"],[3,"value"],[1,"container","text-center","mt-5"],[1,"row",2,"display","flex","flex-direction","column","align-items","center","position","relative"],[1,"alert","alert-warning","d-inline-block"],[1,"fw-bold"],[1,"col-12","col-md-6","col-lg-4"],[1,"card","h-100","shadow-sm","border-0","curso-card"],[1,"d-flex","justify-content-between","align-items-start","gap-3"],[1,"min-w-0"],["type","button",1,"btn","btn-link","p-0","fw-bold","text-decoration-none","curso-title",3,"click"],["class","mt-2 d-flex align-items-center gap-2",4,"ngIf"],[1,"badge","curso-badge"],[1,"form-label","fw-semibold","mb-1"],[1,"form-select","form-select-sm",3,"ngModelChange","ngModel","ngModelOptions"],["value",""],[1,"d-grid","gap-2","mt-3"],["type","button",1,"btn","btn-inst","fw-semibold",3,"click"],[1,"mt-2","d-flex","align-items-center","gap-2"],[1,"institucion-pill"],[1,"mb-5"],[1,"fw-bold","mb-2"],["alt","Logo","style","height:32px;vertical-align:middle;",3,"src",4,"ngIf"],["class","mb-3",4,"ngFor","ngForOf"],["alt","Logo",2,"height","32px","vertical-align","middle",3,"src"],[1,"fw-semibold","text-primary","mb-1"],[1,"table","table-bordered","table-sm"],[1,"table-light"],[4,"ngFor","ngForOf"]],template:function(e,n){e&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),l(4,"HORARIOS Y LISTAS DE ESTUDIANTES"),r(),a(5,"p",5),l(6,"Verifique su horario/curso/materia/paralelo"),r()()()(),a(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div")(14,"div",12),l(15,"HORARIOS"),r(),a(16,"div",13),l(17,"Publicados por instituci\xF3n"),r()(),a(18,"div",14),p(19,_t,2,0,"button",15),a(20,"button",16),f("click",function(){return n.CargarHorariosPublicados()}),l(21,"Actualizar"),r()()(),p(22,ut,3,0,"div",17)(23,yt,3,2,"ng-container",18),r()()(),a(24,"div",19)(25,"div",20)(26,"div",21)(27,"div",22)(28,"h5",23),l(29),r(),a(30,"button",24),f("click",function(){return n.limpiarHorarioDraft()}),r()(),a(31,"div",25),p(32,Mt,2,0,"div",26)(33,Tt,27,5,"ng-container",18),r(),a(34,"div",27)(35,"button",28),f("click",function(){return n.limpiarHorarioDraft()}),l(36,"Cancelar"),r(),a(37,"button",29),f("click",function(){return n.guardarHorario()}),l(38),r()()()()(),a(39,"div",30)(40,"div",2)(41,"div",31)(42,"div",32),l(43,"C\xF3mo usar"),r(),a(44,"div",33),l(45,"1) Seleccione gesti\xF3n \u2192 se listar\xE1n los cursos"),r(),a(46,"div",33),l(47,"2) En cada curso, elija una materia (opcional) y pulse \u201CLISTAR\u201D"),r(),C(48,"hr"),a(49,"div",33),l(50,'i) Busque el estado de sus materias usando el boton "AVERIGUAR CURSO PARALELO" '),r(),p(51,Ot,8,2,"div",34),r(),a(52,"div",35)(53,"div",36)(54,"select",37),w("ngModelChange",function(c){return O(n.gestion_id_seleccionado,c)||(n.gestion_id_seleccionado=c),c}),f("change",function(){return n.onGestionChange()}),a(55,"option",38),l(56,"Seleccione una opci\xF3n"),r(),p(57,wt,2,2,"option",39),r(),a(58,"label"),l(59,"Gesti\xF3n"),r()(),a(60,"div",40)(61,"button",41),l(62,"AVERIGUAR CURSO PARALELO (POR CI)"),r()(),a(63,"div",2)(64,"div",42)(65,"div",43)(66,"div",44),C(67,"input",45),a(68,"label"),l(69,"Buscar"),r()()()()()()(),p(70,Nt,7,0,"div",46),a(71,"div",7),p(72,Rt,21,20,"div",47),r()()()(),a(73,"div",48)(74,"div",49)(75,"div",21)(76,"div",22)(77,"h5",23),l(78," CONSULTAR CURSO Y PARALELO"),r(),C(79,"button",50),r(),a(80,"div",25)(81,"div",51)(82,"h3",52),l(83,"DEBE INTRODUCIR SU CARNET CORRECTAMENTE. EJEMPLO: 4567814 - 12345-H1 (si tiene complemento)"),r(),a(84,"div",53)(85,"div",54)(86,"select",37),w("ngModelChange",function(c){return O(n.gestion_id_seleccionado,c)||(n.gestion_id_seleccionado=c),c}),f("change",function(){return n.CargarCursosDesdeMaterias()}),a(87,"option",38),l(88,"Seleccione una opci\xF3n"),r(),p(89,Lt,2,2,"option",39),r(),a(90,"label"),l(91,"SE BUSCAR\xC1 LA INFORMACION PARA LA GESTI\xD3N"),r()(),a(92,"label",55),l(93,"SI DESEA VERIFICAR EN OTRA GESTION SELECCIONE OTRA. "),r()(),a(94,"div",53)(95,"div",56)(96,"input",57),w("ngModelChange",function(c){return O(n.CIVerificar,c)||(n.CIVerificar=c),c}),r(),a(97,"label"),l(98,"CARNET (SOLO N\xDAMEROS, SI TIENE COMPLEMENTO SU CI COLOCAR SEGUIDO)"),r(),a(99,"div",58),l(100,"Este campo es obligatorio*"),r()(),a(101,"button",59),f("click",function(){return n.VerificarCursoParalelo()}),l(102,"BUSCAR"),r()()(),p(103,Yt,5,3,"div",60),r(),C(104,"div",27),r()()()),e&2&&(s(19),m("ngIf",n.puedePublicarHorarios),s(3),m("ngIf",n.horariosLoading),s(),m("ngIf",!n.horariosLoading),s(6),x(n.esEdicionHorario?"Editar horario":"Publicar horario"),s(3),m("ngIf",!n.puedePublicarHorarios),s(),m("ngIf",n.puedePublicarHorarios),s(4),m("disabled",!n.puedePublicarHorarios||n.horarioUploading||n.horarioSaving),s(),v(" ",n.esEdicionHorario?"Guardar cambios":"Publicar"," "),s(13),m("ngIf",n.institucionesLogos==null?null:n.institucionesLogos.length),s(3),A("ngModel",n.gestion_id_seleccionado),s(3),m("ngForOf",n.anio),s(9),m("formGroup",n.filterHorarioForm),s(4),m("ngIf",n.cursosFiltrados.length===0),s(2),m("ngForOf",n.cursosFiltrados),s(14),A("ngModel",n.gestion_id_seleccionado),s(3),m("ngForOf",n.anio),s(7),A("ngModel",n.CIVerificar),s(7),m("ngForOf",n.CursosMateriasEstudiante))},dependencies:[J,ee,ae,se,ie,re,ne,ke,oe,Re,Le],styles:['@charset "UTF-8";.no-horario-svg[_ngcontent-%COMP%]{width:200px;height:200px;margin:50px auto auto;display:block}.institucion-logo-btn[_ngcontent-%COMP%]{padding:6px;border-radius:12px;line-height:0}.institucion-logo-btn.active[_ngcontent-%COMP%]{outline:2px solid rgba(25,135,84,.5);box-shadow:0 0 0 .25rem #19875426}.institucion-logo[_ngcontent-%COMP%]{width:44px;height:44px;object-fit:contain;display:block}.institucion-mini-logo[_ngcontent-%COMP%]{width:22px;height:22px;object-fit:contain;display:block}.horarios-panel[_ngcontent-%COMP%]{top:12px}.horario-dropzone[_ngcontent-%COMP%]{border:2px dashed rgba(13,110,253,.35);border-radius:12px;padding:12px;background:#fff;transition:background .12s ease,border-color .12s ease}.horario-dropzone.dragging[_ngcontent-%COMP%]{background:#0d6efd0d;border-color:#0d6efda6}.horario-inst-card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.08);border-left:6px solid #0d6efd;border-radius:12px;overflow:hidden;background:#fff}.horario-inst-header[_ngcontent-%COMP%]{padding:10px 12px;border-bottom:1px solid rgba(0,0,0,.06)}.horario-inst-body[_ngcontent-%COMP%]{padding:10px 12px}.horario-item[_ngcontent-%COMP%]{padding:10px 0;border-bottom:1px dashed rgba(0,0,0,.08)}.horario-item[_ngcontent-%COMP%]:last-child{border-bottom:0}.curso-card[_ngcontent-%COMP%]{border-left:6px solid #0d6efd;border-radius:14px;overflow:hidden;transition:transform .12s ease,box-shadow .12s ease}.curso-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 .5rem 1.25rem #00000014!important}.curso-title[_ngcontent-%COMP%]{text-align:left;line-height:1.15}.curso-badge[_ngcontent-%COMP%]{color:#fff;font-weight:700;letter-spacing:.2px}.institucion-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;border:1px solid rgba(0,0,0,.12);background:#ffffffbf;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.btn-inst[_ngcontent-%COMP%]{color:#fff}.btn-inst[_ngcontent-%COMP%]:hover{filter:brightness(.95);color:#fff}.btn-inst[_ngcontent-%COMP%]:disabled{opacity:.65}']});var _e=z;var Kt=["modalDetalleDocente"],V=(i,t)=>({"bi-caret-up":i,"bi-caret-down":t});function Xt(i,t){if(i&1){let e=h();a(0,"div",42)(1,"input",43),w("ngModelChange",function(o){u(e);let c=d(2);return O(c.edicionDocentesActiva,o)||(c.edicionDocentesActiva=o),g(o)}),f("change",function(){u(e);let o=d(2);return g(o.onToggleEdicionDocentes())}),r(),a(2,"label",44),l(3,"Edici\xF3n de docentes"),r()()}if(i&2){let e=d(2);s(),A("ngModel",e.edicionDocentesActiva)}}function Zt(i,t){if(i&1){let e=h();a(0,"button",45),f("click",function(){u(e);let o=d(2);return g(o.GenerarReporteListaEstudiantes())}),l(1,"GENERAR LISTA DE ESTUDIANTES"),r()}}function Jt(i,t){if(i&1){let e=h();a(0,"button",46),f("click",function(){u(e);let o=d(2);return g(o.copiarListaExcel())}),l(1,"COPIAR (EXCEL)"),r()}}function ei(i,t){if(i&1){let e=h();a(0,"div",47)(1,"input",48),w("ngModelChange",function(o){u(e);let c=d(2);return O(c.reportarconInstrumentos,o)||(c.reportarconInstrumentos=o),g(o)}),r(),a(2,"label",49),l(3," con Especialidad "),r()()}if(i&2){let e=d(2);s(),A("ngModel",e.reportarconInstrumentos)}}function ti(i,t){if(i&1){let e=h();a(0,"div",47)(1,"input",50),w("ngModelChange",function(o){u(e);let c=d(2);return O(c.reportarcondocentesEspecialidad,o)||(c.reportarcondocentesEspecialidad=o),g(o)}),r(),a(2,"label",51),l(3," con Docentes Especialidad "),r()()}if(i&2){let e=d(2);s(),A("ngModel",e.reportarcondocentesEspecialidad)}}function ii(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(2);m("ngClass",F(1,V,e.getSortDirest("Ap_Paterno")==="asc",e.getSortDirest("Ap_Paterno")==="desc"))}}function ni(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(2);m("ngClass",F(1,V,e.getSortDirest("Ap_Materno")==="asc",e.getSortDirest("Ap_Materno")==="desc"))}}function oi(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(2);m("ngClass",F(1,V,e.getSortDirest("Nombre")==="asc",e.getSortDirest("Nombre")==="desc"))}}function ri(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(3);m("ngClass",F(1,V,e.getSortDirest("Docente_Especialidad_Apellidos")==="asc",e.getSortDirest("Docente_Especialidad_Apellidos")==="desc"))}}function ai(i,t){if(i&1){let e=h();a(0,"th",53),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Especialidad_Apellidos",o))}),l(1," Doc. Especialidad "),p(2,ri,1,4,"i",32),r()}if(i&2){let e=d(2);s(2),m("ngIf",e.isSortedest("Docente_Especialidad_Apellidos"))}}function si(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(3);m("ngClass",F(1,V,e.getSortDirest("Docente_Practica_Conjuntos_Apellidos")==="asc",e.getSortDirest("Docente_Practica_Conjuntos_Apellidos")==="desc"))}}function li(i,t){if(i&1){let e=h();a(0,"th",54),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Practica_Conjuntos_Apellidos",o))}),l(1," Doc. Prac. Conj. "),p(2,si,1,4,"i",32),r()}if(i&2){let e=d(2);s(2),m("ngIf",e.isSortedest("Docente_Practica_Conjuntos_Apellidos"))}}function ci(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(3);m("ngClass",F(1,V,e.getSortDirest("Docente_Instrumento_Complementario_Apellidos")==="asc",e.getSortDirest("Docente_Instrumento_Complementario_Apellidos")==="desc"))}}function di(i,t){if(i&1){let e=h();a(0,"th",55),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("Docente_Instrumento_Complementario_Apellidos",o))}),l(1," Doc. Inst. Comp. "),p(2,ci,1,4,"i",32),r()}if(i&2){let e=d(2);s(2),m("ngIf",e.isSortedest("Docente_Instrumento_Complementario_Apellidos"))}}function mi(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(3);m("ngClass",F(1,V,e.getSortDirest("InstrumentoMusical")==="asc",e.getSortDirest("InstrumentoMusical")==="desc"))}}function pi(i,t){if(i&1){let e=h();a(0,"th",31),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("InstrumentoMusical",o))}),l(1," Especialidad "),p(2,mi,1,4,"i",32),r()}if(i&2){let e=d(2);s(2),m("ngIf",e.isSortedest("InstrumentoMusical"))}}function _i(i,t){if(i&1&&C(0,"i",52),i&2){let e=d(3);m("ngClass",F(1,V,e.getSortDirest("InstrumentoMusicalSecundario")==="asc",e.getSortDirest("InstrumentoMusicalSecundario")==="desc"))}}function ui(i,t){if(i&1){let e=h();a(0,"th",56),f("click",function(o){u(e);let c=d(2);return g(c.sortByest("InstrumentoMusicalSecundario",o))}),l(1," Instr. Secundario "),p(2,_i,1,4,"i",32),r()}if(i&2){let e=d(2);s(2),m("ngIf",e.isSortedest("InstrumentoMusicalSecundario"))}}function gi(i,t){i&1&&(a(0,"th",30),l(1,"CELULAR_EST"),r())}function fi(i,t){i&1&&(a(0,"th",30),l(1,"PADRE"),r())}function hi(i,t){i&1&&(a(0,"th",30),l(1,"MADRE"),r())}function xi(i,t){i&1&&(a(0,"tr")(1,"td",30)(2,"div",57)(3,"span",58),l(4,"Cargando..."),r()()()()),i&2&&(s(),xe("colspan",5))}function vi(i,t){i&1&&(a(0,"tr")(1,"td",30),l(2,"No hay datos disponibles"),r()()),i&2&&(s(),xe("colspan",5))}function Ci(i,t){if(i&1&&(a(0,"div",64),l(1),r()),i&2){let e=d().$implicit;s(),v("CI: ",e.CI)}}function bi(i,t){if(i&1&&(a(0,"div",64),l(1),r()),i&2){let e=d().$implicit;s(),v(" ",e.Sexo)}}function Ei(i,t){if(i&1&&(a(0,"span"),l(1),r()),i&2){let e=d(2).$implicit;s(),v("Edad: ",e.Edad)}}function Ii(i,t){if(i&1&&(a(0,"div",64),p(1,Ei,2,1,"span",39),r()),i&2){let e=d(3);s(),m("ngIf",e.verdetallado)}}function Si(i,t){if(i&1&&(a(0,"div",65),l(1),r()),i&2){let e=d().$implicit;s(),v(" Asig. ",e.CantidadMateriasAsignadas)}}function yi(i,t){if(i&1&&(a(0,"span"),l(1),r()),i&2){let e=d(2).$implicit;s(),v("Est. ",e.Categoria)}}function Mi(i,t){if(i&1&&(a(0,"div",64),p(1,yi,2,1,"span",39),r()),i&2){let e=d(3);s(),m("ngIf",e.verdetallado)}}function Di(i,t){i&1&&(a(0,"span"),l(1,"A\xDAN SIN DESIGNAR"),r())}function Pi(i,t){if(i&1){let e=h();a(0,"a",68),f("click",function(o){return u(e),g(o.stopPropagation())}),l(1),C(2,"i",69),r()}if(i&2){let e=d(3).$implicit;m("href",R("https://api.whatsapp.com/send?phone=591",e.Docente_Especialidad_CelularTrabajo),S),s(),v("",e.Docente_Especialidad_CelularTrabajo," ")}}function Ti(i,t){if(i&1&&(P(0),X(1,Di,2,0,"span")(2,Pi,3,3,"a",67),a(3,"div",64),l(4),r(),T()),i&2){let e=d(2).$implicit;s(),Z(e.Docente_Especialidad_Apellidos==null&&e.Docente_Especialidad_Nombres==null?1:2),s(3),M("",e.Docente_Especialidad_Apellidos," ",e.Docente_Especialidad_Nombres)}}function Ai(i,t){i&1&&(a(0,"div",73),l(1,"Guardando..."),r())}function Oi(i,t){if(i&1){let e=h();a(0,"div",70)(1,"input",71),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),r()(),p(2,Ai,2,0,"div",72)}if(i&2){let e=d(2).$implicit,n=d(2);s(),m("formControl",n.docEdicionInput),s(),m("ngIf",n.isGuardandoDocente(e.id,"planteldocadmins_id"))}}function wi(i,t){if(i&1){let e=h();a(0,"td",66),f("click",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.edicionDocentesActiva?_.activarEdicionDocente(c,"planteldocadmins_id",o):null)}),p(1,Ti,5,3,"ng-container",7)(2,Oi,3,2,"ng-template",null,2,k),r()}if(i&2){let e=N(3),n=d().$implicit,o=d(2);s(),m("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(n.id,"planteldocadmins_id"))("ngIfElse",e)}}function Ni(i,t){i&1&&(a(0,"span"),l(1,"NINGUNO(A)"),r())}function Fi(i,t){if(i&1){let e=h();a(0,"a",68),f("click",function(o){return u(e),g(o.stopPropagation())}),l(1),C(2,"i",69),r()}if(i&2){let e=d(3).$implicit;m("href",R("https://api.whatsapp.com/send?phone=591",e.Docente_Practica_Conjuntos_CelularTrabajo),S),s(),v("",e.Docente_Practica_Conjuntos_CelularTrabajo," ")}}function Hi(i,t){if(i&1&&(P(0),X(1,Ni,2,0,"span")(2,Fi,3,3,"a",67),a(3,"div",64),l(4),r(),T()),i&2){let e=d(2).$implicit;s(),Z(e.Docente_Practica_Conjuntos_Apellidos==null&&e.Docente_Practica_Conjuntos_Nombres==null?1:2),s(3),M("",e.Docente_Practica_Conjuntos_Apellidos," ",e.Docente_Practica_Conjuntos_Nombres)}}function ki(i,t){i&1&&(a(0,"div",73),l(1,"Guardando..."),r())}function Vi(i,t){if(i&1){let e=h();a(0,"div",70)(1,"input",71),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),r()(),p(2,ki,2,0,"div",72)}if(i&2){let e=d(2).$implicit,n=d(2);s(),m("formControl",n.docEdicionInput),s(),m("ngIf",n.isGuardandoDocente(e.id,"planteldocadmins_idPC"))}}function Ri(i,t){if(i&1){let e=h();a(0,"td",66),f("click",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.edicionDocentesActiva?_.activarEdicionDocente(c,"planteldocadmins_idPC",o):null)}),p(1,Hi,5,3,"ng-container",7)(2,Vi,3,2,"ng-template",null,3,k),r()}if(i&2){let e=N(3),n=d().$implicit,o=d(2);s(),m("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(n.id,"planteldocadmins_idPC"))("ngIfElse",e)}}function Li(i,t){i&1&&(a(0,"span"),l(1,"NINGUNO(A)"),r())}function ji(i,t){if(i&1){let e=h();a(0,"a",68),f("click",function(o){return u(e),g(o.stopPropagation())}),l(1),C(2,"i",69),r()}if(i&2){let e=d(3).$implicit;m("href",R("https://api.whatsapp.com/send?phone=591",e.Docente_Instrumento_Complementario_CelularTrabajo),S),s(),v("",e.Docente_Instrumento_Complementario_CelularTrabajo," ")}}function Ui(i,t){if(i&1&&(P(0),X(1,Li,2,0,"span")(2,ji,3,3,"a",67),a(3,"div",64),l(4),r(),T()),i&2){let e=d(2).$implicit;s(),Z(e.Docente_Instrumento_Complementario_Apellidos==null&&e.Docente_Instrumento_Complementario_Nombres==null?1:2),s(3),M("",e.Docente_Instrumento_Complementario_Apellidos," ",e.Docente_Instrumento_Complementario_Nombres)}}function $i(i,t){i&1&&(a(0,"div",73),l(1,"Guardando..."),r())}function zi(i,t){if(i&1){let e=h();a(0,"div",70)(1,"input",71),f("focus",function(o){u(e);let c=d(4);return g(c.abrirOverlayDocentes(o))})("click",function(o){u(e);let c=d(4);return o.stopPropagation(),g(c.abrirOverlayDocentes(o))})("keydown.escape",function(o){u(e);let c=d(4);return o.preventDefault(),g(c.salirModoEdicionDocente())}),r()(),p(2,$i,2,0,"div",72)}if(i&2){let e=d(2).$implicit,n=d(2);s(),m("formControl",n.docEdicionInput),s(),m("ngIf",n.isGuardandoDocente(e.id,"planteldocadmins_idOtros"))}}function Bi(i,t){if(i&1){let e=h();a(0,"td",66),f("click",function(o){u(e);let c=d().$implicit,_=d(2);return g(_.edicionDocentesActiva?_.activarEdicionDocente(c,"planteldocadmins_idOtros",o):null)}),p(1,Ui,5,3,"ng-container",7)(2,zi,3,2,"ng-template",null,4,k),r()}if(i&2){let e=N(3),n=d().$implicit,o=d(2);s(),m("ngIf",!o.edicionDocentesActiva||!o.isCeldaDocenteActiva(n.id,"planteldocadmins_idOtros"))("ngIfElse",e)}}function Gi(i,t){if(i&1&&(a(0,"div",64),l(1),r()),i&2){let e=d(3).$implicit;s(),v(" (Est. ",e.Categoria,")")}}function Wi(i,t){if(i&1&&(P(0),l(1),p(2,Gi,2,1,"div",60),T()),i&2){let e=d(2).$implicit,n=d(2);s(),v(" ",e.InstrumentoMusical||"SIN ESPECIALIDAD"," "),s(),m("ngIf",n.verdetallado)}}function qi(i,t){if(i&1&&(a(0,"option",78),l(1),r()),i&2){let e=t.$implicit;m("ngValue",e.value)("disabled",e.disabled),s(),x(e.label)}}function Qi(i,t){i&1&&(a(0,"div",73),l(1,"Guardando..."),r())}function Yi(i,t){if(i&1){let e=h();a(0,"select",75),f("click",function(o){return u(e),g(o.stopPropagation())})("ngModelChange",function(o){u(e);let c=d(2).$implicit,_=d(2);return g(_.onInstrumentoChange(c,"InstrumentoMusical",o))}),a(1,"option",76),l(2,"-- Sin especialidad --"),r(),p(3,qi,2,3,"option",77),r(),p(4,Qi,2,0,"div",72)}if(i&2){let e=d(2).$implicit,n=d(2);m("ngModel",e.InstrumentoMusical),s(),m("ngValue",""),s(2),m("ngForOf",n.InstrumentoMusicalOptions),s(),m("ngIf",n.isGuardandoInstrumento(e.id,"InstrumentoMusical"))}}function Ki(i,t){if(i&1&&(a(0,"td",74),p(1,Wi,3,2,"ng-container",7)(2,Yi,5,4,"ng-template",null,5,k),r()),i&2){let e=N(3),n=d(3);s(),m("ngIf",!n.edicionDocentesActiva)("ngIfElse",e)}}function Xi(i,t){if(i&1&&(a(0,"div",64),l(1),r()),i&2){let e=d(3).$implicit;s(),v(" Edad: ",e.Edad)}}function Zi(i,t){if(i&1&&(P(0),l(1),p(2,Xi,2,1,"div",60),T()),i&2){let e=d(2).$implicit,n=d(2);s(),v(" ",e.InstrumentoMusicalSecundario||"SIN INSTR. SEC."," "),s(),m("ngIf",n.verdetallado)}}function Ji(i,t){if(i&1&&(a(0,"option",78),l(1),r()),i&2){let e=t.$implicit;m("ngValue",e.value)("disabled",e.disabled),s(),x(e.label)}}function en(i,t){i&1&&(a(0,"div",73),l(1,"Guardando..."),r())}function tn(i,t){if(i&1){let e=h();a(0,"select",75),f("click",function(o){return u(e),g(o.stopPropagation())})("ngModelChange",function(o){u(e);let c=d(2).$implicit,_=d(2);return g(_.onInstrumentoChange(c,"InstrumentoMusicalSecundario",o))}),a(1,"option",76),l(2,"-- Sin instr. secundario --"),r(),p(3,Ji,2,3,"option",77),r(),p(4,en,2,0,"div",72)}if(i&2){let e=d(2).$implicit,n=d(2);m("ngModel",e.InstrumentoMusicalSecundario),s(),m("ngValue",""),s(2),m("ngForOf",n.InstrumentoMusicalSecundarioOptions),s(),m("ngIf",n.isGuardandoInstrumento(e.id,"InstrumentoMusicalSecundario"))}}function nn(i,t){if(i&1&&(a(0,"td",74),p(1,Zi,3,2,"ng-container",7)(2,tn,5,4,"ng-template",null,6,k),r()),i&2){let e=N(3),n=d(3);s(),m("ngIf",!n.edicionDocentesActiva)("ngIfElse",e)}}function on(i,t){if(i&1&&(a(0,"td")(1,"a",67),l(2),C(3,"i",69),r(),a(4,"div",64),l(5),r()()),i&2){let e=d().$implicit;s(),m("href",R("https://api.whatsapp.com/send?phone=591",e.Celular),S),s(),x(e.Celular),s(3),x(e.Nombre_Padre)}}function rn(i,t){if(i&1&&(a(0,"td")(1,"a",67),l(2),C(3,"i",69),r(),a(4,"div",64),l(5),r()()),i&2){let e=d().$implicit;s(),m("href",R("https://api.whatsapp.com/send?phone=591",e.NumCelP),S),s(),x(e.NumCelP),s(3),x(e.Nombre_Padre)}}function an(i,t){if(i&1&&(a(0,"td")(1,"a",67),l(2),C(3,"i",69),r(),a(4,"div",64),l(5),r()()),i&2){let e=d().$implicit;s(),m("href",R("https://api.whatsapp.com/send?phone=591",e.NumCelM),S),s(),x(e.NumCelM),s(3),x(e.Nombre_Madre)}}function sn(i,t){if(i&1){let e=h();a(0,"tr",59),f("contextmenu",function(){let o=u(e).$implicit,c=d(2);return g(c.abrirMenuest(c.event,o))}),a(1,"td",30),l(2),r(),a(3,"td"),l(4),p(5,Ci,2,1,"div",60),r(),a(6,"td"),l(7),p(8,bi,2,1,"div",60)(9,Ii,2,1,"div",60),r(),a(10,"td"),l(11),p(12,Si,2,1,"div",61)(13,Mi,2,1,"div",60),r(),p(14,wi,4,2,"td",62)(15,Ri,4,2,"td",62)(16,Bi,4,2,"td",62)(17,Ki,4,2,"td",63)(18,nn,4,2,"td",63)(19,on,6,4,"td",39)(20,rn,6,4,"td",39)(21,an,6,4,"td",39),r()}if(i&2){let e=t.$implicit,n=t.index,o=d(2);s(2),x((o.paginaest-1)*o.pageSizeest+(n+1)),s(2),v("",e.Ap_Paterno," "),s(),m("ngIf",o.verdetallado),s(2),v("",e.Ap_Materno," "),s(),m("ngIf",o.verdetallado),s(),m("ngIf",!o.mostrarCamposMusicales),s(2),v("",e.Nombre," "),s(),m("ngIf",o.verdetallado),s(),m("ngIf",!o.mostrarCamposMusicales),s(),m("ngIf",o.mostrarCamposMusicales),s(),m("ngIf",o.mostrarCamposMusicales),s(),m("ngIf",o.mostrarCamposMusicales),s(),m("ngIf",o.mostrarCamposMusicales),s(),m("ngIf",o.mostrarCamposMusicales),s(),m("ngIf",o.verdetallado),s(),m("ngIf",o.verdetallado),s(),m("ngIf",o.verdetallado)}}function ln(i,t){if(i&1){let e=h();a(0,"div",83)(1,"div",84),l(2,"Dejar vac\xEDo (quitar docente)"),r(),a(3,"button",85),f("click",function(o){u(e);let c=d(3);return o.stopPropagation(),g(c.quitarDocenteEdicion())}),l(4," Quitar "),r()()}if(i&2){let e=d(3);s(3),m("disabled",e.isGuardandoDocente(e.edicionDocenteActivo.infoId,e.edicionDocenteActivo.field))}}function cn(i,t){i&1&&(a(0,"div",86),l(1,"Sin resultados"),r())}function dn(i,t){if(i&1&&(a(0,"span",93),l(1),r()),i&2){let e=d().$implicit,n=d(3);s(),v(" | No tomado en Cuenta: ",n.getConteoDocenteSinModo(e.id))}}function mn(i,t){if(i&1){let e=h();a(0,"div",87),f("click",function(o){let c=u(e).$implicit,_=d(3);return o.stopPropagation(),g(_.seleccionarDocenteEdicion(c))}),a(1,"div",88)(2,"div",89),l(3),r(),a(4,"small",90),l(5),p(6,dn,2,1,"span",91),r()(),a(7,"button",92),f("click",function(o){let c=u(e).$implicit,_=d(3);return g(_.abrirDetalleDocente(c,o))}),l(8,"Detalle"),r()()}if(i&2){let e=t.$implicit,n=d(3);$("disabled",n.docenteInactivo(e)),s(2),$("text-muted",n.docenteInactivo(e)),s(),x(n.getNombreCompletoDocente(e)),s(2),v(" Estudiantes: ",n.getConteoDocenteOk(e.id)," "),s(),m("ngIf",n.getConteoDocenteSinModo(e.id)>0)}}function pn(i,t){if(i&1&&(a(0,"div",79),p(1,ln,5,1,"div",80)(2,cn,2,0,"div",81)(3,mn,9,7,"div",82),r()),i&2){let e=d(2);y("top",e.docenteOverlayTop,"px")("left",e.docenteOverlayLeft,"px")("width",e.docenteOverlayWidth,"px"),s(),m("ngIf",e.edicionDocentesActiva&&e.edicionDocenteActivo),s(),m("ngIf",e.docentesFiltradosEdicion.length===0),s(),m("ngForOf",e.docentesFiltradosEdicion)}}function _n(i,t){if(i&1){let e=h();P(0),a(1,"div",8)(2,"div",9)(3,"div",10)(4,"h1",11),l(5,"Lista de Estudiantes "),r(),a(6,"p",12)(7,"span",13),l(8),r(),l(9),a(10,"span",14),l(11),r()()()()(),a(12,"div",9)(13,"div",15)(14,"div",16)(15,"div",17)(16,"span",18),C(17,"ng-lottie",19),r(),a(18,"div",20)(19,"input",21),w("ngModelChange",function(o){u(e);let c=d();return O(c.filtertxtest,o)||(c.filtertxtest=o),g(o)}),f("ngModelChange",function(){u(e);let o=d();return g(o.onFilterTxtEstChange())}),r(),a(20,"label"),l(21,"Buscar"),r()()(),p(22,Xt,4,1,"div",22),r()()(),p(23,Zt,2,0,"button",23)(24,Jt,2,0,"button",24)(25,ei,4,1,"div",25)(26,ti,4,1,"div",25),a(27,"div",26)(28,"div",27)(29,"table",28)(30,"thead",29)(31,"tr")(32,"th",30),l(33,"#"),r(),a(34,"th",31),f("click",function(o){u(e);let c=d();return g(c.sortByest("Ap_Paterno",o))}),l(35," Ap_Paterno "),p(36,ii,1,4,"i",32),r(),a(37,"th",31),f("click",function(o){u(e);let c=d();return g(c.sortByest("Ap_Materno",o))}),l(38," Ap_Materno "),p(39,ni,1,4,"i",32),r(),a(40,"th",31),f("click",function(o){u(e);let c=d();return g(c.sortByest("Nombre",o))}),l(41," Nombre "),p(42,oi,1,4,"i",32),r(),p(43,ai,3,1,"th",33)(44,li,3,1,"th",34)(45,di,3,1,"th",35)(46,pi,3,1,"th",36)(47,ui,3,1,"th",37)(48,gi,2,0,"th",38)(49,fi,2,0,"th",38)(50,hi,2,0,"th",38),r()(),a(51,"tbody"),p(52,xi,5,1,"tr",39)(53,vi,3,1,"tr",39)(54,sn,22,17,"tr",40),r()()()(),p(55,pn,4,9,"div",41),T()}if(i&2){let e=d();s(8),M("",e.lvlCurso," ",e.paralelo),s(),v(" Turno ",e.turno," "),s(2),x(e.siglaYMateria),s(6),m("options",e._tools.optionslupa),s(2),A("ngModel",e.filtertxtest),s(3),m("ngIf",e.puedeEditarDocentes&&e.mostrarCamposMusicales),s(),m("ngIf",e.visionOpciones),s(),m("ngIf",e.habilitarCopiaExcel),s(),m("ngIf",e.visionOpciones&&e.mostrarCamposMusicales),s(),m("ngIf",e.visionOpciones&&e.mostrarCamposMusicales),s(10),m("ngIf",e.isSortedest("Ap_Paterno")),s(3),m("ngIf",e.isSortedest("Ap_Materno")),s(3),m("ngIf",e.isSortedest("Nombre")),s(),m("ngIf",e.mostrarCamposMusicales),s(),m("ngIf",e.mostrarCamposMusicales),s(),m("ngIf",e.mostrarCamposMusicales),s(),m("ngIf",e.mostrarCamposMusicales),s(),m("ngIf",e.mostrarCamposMusicales),s(),m("ngIf",e.verdetallado),s(),m("ngIf",e.verdetallado),s(),m("ngIf",e.verdetallado),s(2),m("ngIf",e.isLoadingest),s(),m("ngIf",!e.isLoadingest&&(!e.estFiltrados||e.estFiltrados.length===0)),s(),m("ngForOf",e.estFiltrados),s(),m("ngIf",e.mostrarListaDocEdicion&&e.puedeEditarDocentes)}}function un(i,t){i&1&&(a(0,"div",8)(1,"div",94),l(2," Debe iniciar sesi\xF3n para acceder a este sitio. "),r()())}function gn(i,t){i&1&&(a(0,"span",113),l(1,"OK Oficial"),r())}function fn(i,t){i&1&&(a(0,"span",114),l(1,"No tomado en Cuenta"),r())}function hn(i,t){if(i&1&&(a(0,"tr")(1,"td",30),l(2),r(),a(3,"td"),l(4),r(),a(5,"td"),l(6),r(),a(7,"td"),l(8),r(),a(9,"td"),l(10),r(),a(11,"td",30),p(12,gn,2,0,"span",111)(13,fn,2,0,"span",112),r(),a(14,"td",30),l(15),r(),a(16,"td",30),l(17),r(),a(18,"td",30),l(19),r(),a(20,"td",30),l(21),r()()),i&2){let e=t.$implicit,n=t.index,o=d(2);s(2),x(n+1),s(2),x(o.anioId),s(2),x(o.lvlCurso),s(2),x(o.paralelo),s(2),Te("",e==null?null:e.Ap_Paterno," ",e==null?null:e.Ap_Materno," ",e==null?null:e.Nombre),s(2),m("ngIf",o.tieneModoMateria(e,o.detalleDocenteMeta==null?null:o.detalleDocenteMeta.field)),s(),m("ngIf",!o.tieneModoMateria(e,o.detalleDocenteMeta==null?null:o.detalleDocenteMeta.field)),s(2),x(e==null?null:e.CI),s(2),x(e==null?null:e.Edad),s(2),x(e==null?null:e.Sexo),s(2),x(o.turno)}}function xn(i,t){if(i&1&&(a(0,"div",64),l(1),r()),i&2){let e=d(2);s(),v(" Nota: \u201CNo tomado en Cuenta\u201D significa que el estudiante no tiene la materia asignada por lo tanto no se cuenta en estadistica con ",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.modo_label,". ")}}function vn(i,t){if(i&1){let e=h();a(0,"div",95)(1,"div")(2,"h5",96),l(3,"Detalle por docente"),r(),a(4,"div",97),l(5),r()(),a(6,"button",98),f("click",function(){let o=u(e).$implicit;return g(o.dismiss("close"))}),r()(),a(7,"div",99)(8,"div",100)(9,"table",101)(10,"thead")(11,"tr")(12,"th",102),l(13,"#"),r(),a(14,"th"),l(15,"A\xF1o"),r(),a(16,"th"),l(17,"Curso"),r(),a(18,"th"),l(19,"Paralelo"),r(),a(20,"th"),l(21,"Nombre"),r(),a(22,"th",103),l(23,"Modo"),r(),a(24,"th",104),l(25,"CI"),r(),a(26,"th",105),l(27,"Edad"),r(),a(28,"th",106),l(29,"Sexo"),r(),a(30,"th",107),l(31,"Turno"),r()()(),a(32,"tbody"),p(33,hn,22,13,"tr",108),r()()(),p(34,xn,2,1,"div",60),r(),a(35,"div",109)(36,"button",110),f("click",function(){let o=u(e).$implicit;return g(o.close("ok"))}),l(37,"Cerrar"),r()()}if(i&2){let e=d();s(5),v(" ",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.docente_nombre," "),s(28),m("ngForOf",e.detalleDocenteRows),s(),m("ngIf",e.detalleDocenteMeta==null?null:e.detalleDocenteMeta.modo_label)}}var B=class B{constructor(t,e,n,o,c,_,b,I,D){this._reportes=t;this._anios=e;this._tools=n;this._planteldoc=o;this._public=c;this._auth=_;this._inst=b;this._infoest=I;this._controles=D;this.ruta=te.ruta;this.est=[];this.estRespaldo=[];this.admin=[];this.filterpost="";this.ModoSimple=!1;this.materiaId=null;this.anioId=null;this.lvlCurso=null;this.paralelo=null;this.institucionId=null;this.modo="";this.verdetallado=!1;this.esxMateria=!0;this.nameInst="";this.siglaYMateria="";this.turno="";this.visionOpciones=!1;this.requiereLogin=!1;this.tipoPerfil=null;this.puedeEditarDocentes=!1;this.mostrarCamposMusicales=!1;this.habilitarCopiaExcel=!1;this.edicionDocentesActiva=!1;this.edicionDocenteActivo=null;this.docEdicionInput=new L("");this.mostrarListaDocEdicion=!1;this.docentesFiltradosEdicion=[];this.docenteOverlayTop=0;this.docenteOverlayLeft=0;this.docenteOverlayWidth=320;this.docenteOverlayAnchorEl=null;this.overlayDocentePrevState=null;this.guardandoDocenteMap={};this.conteoDocentesOkMap={};this.conteoDocentesSinModoMap={};this.InstrumentoMusicalOptions=[];this.InstrumentoMusicalSecundarioOptions=[];this.guardandoInstrumentoMap={};this.instrumentosOptionsCargando=!1;this.instrumentosOptionsCargadas=!1;this.detalleDocenteMeta=null;this.detalleDocenteRows=[];this.habilitarCamposMusicales=!1;this.paginaest=1;this.isLoadingest=!0;this.AnimacionCargabtnModalest=!1;this.filtertxtest="";this.estFiltrados=[];this.collectionSizeest=0;this.pageSizeest=10;this.pageSizeOptionsest=[5,10,20,50];this.sortColumnsest=[];this.planteldocente=[];this.reportarconInstrumentos=!1;this.reportarcondocentesEspecialidad=!1;this.copiadoNombres=!1;this.copiadoEspecialidades=!1;this.copiadoSexos=!1;this.copiadoTodos=!1;this.copiadoCarnets=!1}ngOnInit(){this.materiaId=sessionStorage.getItem("HORARIOS_MATERIA_ID"),this.anioId=sessionStorage.getItem("HORARIOS_ANIO_ID"),this.lvlCurso=sessionStorage.getItem("HORARIOS_LVL_CURSO"),this.paralelo=sessionStorage.getItem("HORARIOS_PARALELO"),this.institucionId=sessionStorage.getItem("HORARIOS_INSTITUCION_ID"),this.modo=sessionStorage.getItem("HORARIOS_MODO"),this.nameInst=sessionStorage.getItem("HORARIOS_INSTITUCION_NOMBRE"),this.siglaYMateria=sessionStorage.getItem("HORARIOS_MATERIA_TITULO"),this.turno=sessionStorage.getItem("HORARIOS_TURNO"),(this.materiaId==null||this.materiaId==""||this.materiaId==null)&&(this.esxMateria=!1),this._auth.pedirPerfil().subscribe({next:t=>{if(console.log("perfil obtenido",t),!t){this.requiereLogin=!0,this.tipoPerfil=null,this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this._tools.MostrarMensaje("info","Debe iniciar sesi\xF3n para acceder a este sitio."),this.actualizarMostrarCamposMusicales();return}this.requiereLogin=!1,this.tipoPerfil=t?.tipo??null;let e=(t?.tipo??"").toString(),n=e==="usuarioslcchs"||e==="planteladministrativos",o=e==="planteldocentes",c=e==="estudiantesifas";this.habilitarCopiaExcel=!c,this.visionOpciones=n||o,this.puedeEditarDocentes=n,this.verdetallado=n||o,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.puedeEditarDocentes&&(this.CargarPlantelDocente(),this.setupBuscadorDocenteEdicion()),c?this.esxMateria?this.CargarEstudiantesMateriaPublico():this.CargarEstudiantesMezcladosMateriasPublico():n||o?this.esxMateria?this.CargarEstudiantesMateriaPrivado():this.CargarEstudiantesMezcladosMateriasPrivado():(this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.esxMateria?this.CargarEstudiantesMateriaPublico():this.CargarEstudiantesMezcladosMateriasPublico()),this.cargarCaractisticasInstitucionActual(this.institucionId)},error:t=>{console.error("Error al cargar",t),this.requiereLogin=!0,this.tipoPerfil=null,this.visionOpciones=!1,this.puedeEditarDocentes=!1,this.verdetallado=!1,this.edicionDocentesActiva=!1,this.salirModoEdicionDocente(),this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this._tools.MostrarMensaje("info","Debe iniciar sesi\xF3n para acceder a este sitio."),this.actualizarMostrarCamposMusicales()}})}setupBuscadorDocenteEdicion(){this.docEdicionInput.valueChanges.subscribe(t=>{let e=(t??"").toString();if(e===""){this.docentesFiltradosEdicion=[];return}if(e.trim()===""){this.docentesFiltradosEdicion=this.filtrarPlantelDocentes("",!0);return}this.docentesFiltradosEdicion=this.filtrarPlantelDocentes(e.toLowerCase().trim()),this.reposicionarOverlayDocentes()})}abrirOverlayDocentes(t){if(!this.puedeEditarDocentes)return;let e=t?.target??null;e&&(this.docenteOverlayAnchorEl=e,this.mostrarListaDocEdicion=!0,this.reposicionarOverlayDocentes())}reposicionarOverlayDocentes(){if(!this.mostrarListaDocEdicion||!this.docenteOverlayAnchorEl)return;let t=this.docenteOverlayAnchorEl.getBoundingClientRect(),e=window?.innerWidth??1200,n=560,o=Math.max(320,Math.min(720,e-24)),c=Math.max(n,t.width);this.docenteOverlayWidth=Math.min(o,c),this.docenteOverlayTop=t.bottom+2;let _=Math.max(0,e-this.docenteOverlayWidth-12);this.docenteOverlayLeft=Math.min(t.left,_)}salirModoEdicionDocente(){this.overlayDocentePrevState=null,this.edicionDocenteActivo=null,this.mostrarListaDocEdicion=!1,this.docentesFiltradosEdicion=[],this.docEdicionInput.setValue("",{emitEvent:!1}),this.docenteOverlayAnchorEl=null}onToggleEdicionDocentes(){if(!this.edicionDocentesActiva){this.edicionDocenteActivo=null,this.docEdicionInput.setValue("",{emitEvent:!1}),this.docentesFiltradosEdicion=[],this.mostrarListaDocEdicion=!1;return}if(!this.puedeEditarDocentes){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}if(!this.visionOpciones){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","La edici\xF3n solo est\xE1 disponible en modo privado");return}if(!this.habilitarCamposMusicales){this.edicionDocentesActiva=!1,this._tools.MostrarMensaje("info","Edici\xF3n disponible solo para instituciones musicales");return}}activarEdicionDocente(t,e,n){if(n&&(n.preventDefault?.(),n.stopPropagation?.()),!this.edicionDocentesActiva||!this.visionOpciones||!this.puedeEditarDocentes)return;let o=Number(t?.id??t?.info_id??0);if(!Number.isFinite(o)||o<=0){this._tools.MostrarMensaje("warning","No se pudo identificar la inscripci\xF3n (infoestudiantesifas.id)");return}this.edicionDocenteActivo={infoId:o,field:e},this.docEdicionInput.setValue("",{emitEvent:!1}),this.docentesFiltradosEdicion=[],this.mostrarListaDocEdicion=!0,this.recalcularConteoDocentes(e)}isCeldaDocenteActiva(t,e){let n=Number(t??0);return!!this.edicionDocenteActivo&&this.edicionDocenteActivo.infoId===n&&this.edicionDocenteActivo.field===e}docenteInactivo(t){return this.normalizarTexto(t?.Estado)==="INACTIVO"}getNombreCompletoDocente(t){let e=(t?.Nombres??"").toString().trim(),n=(t?.Apellidos??"").toString().trim();return`${e} ${n}`.trim()}filtrarPlantelDocentes(t,e=!1){let n=String(this.institucionId??"").trim(),o=(this.planteldocente||[]).filter(c=>!(this.normalizarTexto(c?.Visibilidad)==="OCULTO"||n&&String(c?.instituciones_id)!==n)).sort((c,_)=>this.getNombreCompletoDocente(c).localeCompare(this.getNombreCompletoDocente(_)));return e?o.slice(0,50):t?o.filter(c=>this.getNombreCompletoDocente(c).toLowerCase().includes(t)).slice(0,25):[]}recalcularConteoDocentes(t){let e={},n={};(this.est||[]).forEach(o=>{let c=Number(o?.[t]??0);if(!c)return;let _=String(c);this.tieneModoParaField(o,t)?e[_]=(e[_]??0)+1:n[_]=(n[_]??0)+1}),this.conteoDocentesOkMap=e,this.conteoDocentesSinModoMap=n}getModoFlagField(t){return t==="planteldocadmins_id"?"TieneModoEspecialidad":t==="planteldocadmins_idPC"?"TieneModoPracticaConjuntos":"TieneModoInstrumentoComplementario"}getModoLabel(t){return t==="planteldocadmins_id"?"MODO INSTRUMENTOS DE ESPECIALIDAD":t==="planteldocadmins_idPC"?"MODO PR\xC1CTICA DE CONJUNTOS":"MODO INSTRUMENTO COMPLEMENTARIO"}tieneModoParaField(t,e){let n=this.getModoFlagField(e),o=t?.[n];return o===!0||o===1||o==="1"||o==="true"}tieneModoMateria(t,e){return e?this.tieneModoParaField(t,e):!0}getConteoDocenteOk(t){let e=String(t??"");return Number(this.conteoDocentesOkMap?.[e]??0)||0}getConteoDocenteSinModo(t){let e=String(t??"");return Number(this.conteoDocentesSinModoMap?.[e]??0)||0}getConteoDocente(t){let e=String(t??"");return(Number(this.conteoDocentesOkMap?.[e]??0)||0)+(Number(this.conteoDocentesSinModoMap?.[e]??0)||0)}seleccionarDocenteEdicion(t){if(!t||this.docenteInactivo(t))return;if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes"),this.salirModoEdicionDocente(),this.edicionDocentesActiva=!1;return}if(!this.edicionDocentesActiva||!this.edicionDocenteActivo){this._tools.MostrarMensaje("warning","Seleccione una celda de docente");return}let e=Number(t?.id??0);if(!Number.isFinite(e)||e<=0)return;let n=this.edicionDocenteActivo.infoId,o=this.edicionDocenteActivo.field;this.guardarDocenteEnFila(n,o,e,t),this.salirModoEdicionDocente()}aplicarDocenteEnRowVisual(t,e,n){if(!t)return;if(!n){if(t[e]=null,e==="planteldocadmins_id"){t.Docente_Especialidad_Apellidos=null,t.Docente_Especialidad_Nombres=null,t.Docente_Especialidad_CelularTrabajo=null;return}if(e==="planteldocadmins_idPC"){t.Docente_Practica_Conjuntos_Apellidos=null,t.Docente_Practica_Conjuntos_Nombres=null,t.Docente_Practica_Conjuntos_CelularTrabajo=null;return}t.Docente_Instrumento_Complementario_Apellidos=null,t.Docente_Instrumento_Complementario_Nombres=null,t.Docente_Instrumento_Complementario_CelularTrabajo=null;return}t[e]=Number(n?.id??0)||null;let o=(n?.Apellidos??"").toString().trim(),c=(n?.Nombres??"").toString().trim(),_=(n?.CelularTrabajo??"").toString().trim();if(e==="planteldocadmins_id"){t.Docente_Especialidad_Apellidos=o||null,t.Docente_Especialidad_Nombres=c||null,t.Docente_Especialidad_CelularTrabajo=_||null;return}if(e==="planteldocadmins_idPC"){t.Docente_Practica_Conjuntos_Apellidos=o||null,t.Docente_Practica_Conjuntos_Nombres=c||null,t.Docente_Practica_Conjuntos_CelularTrabajo=_||null;return}t.Docente_Instrumento_Complementario_Apellidos=o||null,t.Docente_Instrumento_Complementario_Nombres=c||null,t.Docente_Instrumento_Complementario_CelularTrabajo=_||null}quitarDocenteEdicion(){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}if(!this.edicionDocentesActiva||!this.edicionDocenteActivo){this._tools.MostrarMensaje("warning","Seleccione una celda de docente");return}let t=this.edicionDocenteActivo.infoId,e=this.edicionDocenteActivo.field;this.guardarDocenteEnFila(t,e,null,null),this.salirModoEdicionDocente()}guardarDocenteEnFila(t,e,n,o,c=!1){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar docentes");return}let _=`${t}:${e}`;this.guardandoDocenteMap[_]=!0;let b={id:t};b[e]=n,this._infoest.Modificarinfoestudiantesifas(b,t,{force:c}).subscribe({next:()=>{let I=(this.est||[]).find(D=>Number(D?.id??0)===Number(t));I&&this.aplicarDocenteEnRowVisual(I,e,o),this.guardandoDocenteMap[_]=!1,this._tools.MostrarMensaje("success",n?"Docente actualizado":"Docente quitado"),this.recalcularConteoDocentes(e)},error:I=>{let D=I?.status,H=!!I?.error?.requires_confirmation,G=I?.error?.anio;if(D===409&&H){this._tools.mostrarMensajeConfirm("Inscripci\xF3n duplicada",`Ya existe una inscripci\xF3n del estudiante en esta instituci\xF3n para la gesti\xF3n ${G??"actual"}. \xBFDesea guardar igualmente?`,"warning","S\xED, guardar","No, cancelar").then(Ee=>{Ee?this.guardarDocenteEnFila(t,e,n,o,!0):this.guardandoDocenteMap[_]=!1});return}console.error("Error al actualizar docente",I),this.guardandoDocenteMap[_]=!1,this._tools.MostrarMensaje("error","No se pudo actualizar el docente")}})}onInstrumentoChange(t,e,n,o){if(o&&(o.preventDefault?.(),o.stopPropagation?.()),!this.edicionDocentesActiva||!this.visionOpciones||!this.puedeEditarDocentes)return;let c=Number(t?.id??t?.info_id??0);if(!Number.isFinite(c)||c<=0){this._tools.MostrarMensaje("warning","No se pudo identificar la inscripci\xF3n (infoestudiantesifas.id)");return}let _=(n??"").toString(),b=(t?.[e]??"").toString();_!==b&&this.guardarInstrumentoEnFila(c,e,_)}guardarInstrumentoEnFila(t,e,n,o=!1){if(!this.puedeEditarDocentes){this._tools.MostrarMensaje("info","No tiene permisos para editar instrumentos");return}let c=`${t}:${e}`;this.guardandoInstrumentoMap[c]=!0;let _={id:t};_[e]=n,this._infoest.Modificarinfoestudiantesifas(_,t,{force:o}).subscribe({next:()=>{let b=(this.est||[]).find(I=>Number(I?.id??0)===Number(t));b&&(b[e]=n),this.guardandoInstrumentoMap[c]=!1,this._tools.MostrarMensaje("success","Instrumento actualizado")},error:b=>{let I=b?.status,D=!!b?.error?.requires_confirmation,H=b?.error?.anio;if(I===409&&D){this._tools.mostrarMensajeConfirm("Inscripci\xF3n duplicada",`Ya existe una inscripci\xF3n del estudiante en esta instituci\xF3n para la gesti\xF3n ${H??"actual"}. \xBFDesea guardar igualmente?`,"warning","S\xED, guardar","No, cancelar").then(G=>{G?this.guardarInstrumentoEnFila(t,e,n,!0):this.guardandoInstrumentoMap[c]=!1});return}console.error("Error al actualizar instrumento",b),this.guardandoInstrumentoMap[c]=!1,this._tools.MostrarMensaje("error","No se pudo actualizar el instrumento")}})}isGuardandoInstrumento(t,e){let n=`${Number(t??0)}:${e}`;return!!this.guardandoInstrumentoMap?.[n]}isGuardandoDocente(t,e){let n=`${Number(t??0)}:${e}`;return!!this.guardandoDocenteMap?.[n]}abrirDetalleDocente(t,e){if(e&&(e.preventDefault?.(),e.stopPropagation?.()),!t)return;let n=Number(t?.id??0);if(!n)return;if(!this.modalDetalleDocente){this._tools.MostrarMensaje("error","No se encontr\xF3 el template del modal de detalle");return}let o=this.edicionDocenteActivo?.field??"planteldocadmins_id",c=this.getModoLabel(o);this.overlayDocentePrevState={mostrar:this.mostrarListaDocEdicion,anchor:this.docenteOverlayAnchorEl,top:this.docenteOverlayTop,left:this.docenteOverlayLeft,width:this.docenteOverlayWidth,inputValue:this.docEdicionInput.value,filtrados:[...this.docentesFiltradosEdicion||[]],edicionActiva:this.edicionDocentesActiva},this.mostrarListaDocEdicion=!1,this.detalleDocenteMeta={docente_id:n,docente_nombre:this.getNombreCompletoDocente(t),field:o,modo_label:c},this.detalleDocenteRows=(this.est||[]).filter(b=>Number(b?.[o]??0)===n),this.modalDetalleDocenteRef=this._tools.openModal(this.modalDetalleDocente,"xl",{scrollable:!0,windowClass:"modal-paralelos-detalle"});let _=this.overlayDocentePrevState;this.modalDetalleDocenteRef.result.finally(()=>{_&&(this.overlayDocentePrevState=null,this.puedeEditarDocentes&&(!_.edicionActiva||!this.edicionDocentesActiva||_.mostrar&&(this.docenteOverlayAnchorEl=_.anchor,this.docenteOverlayTop=_.top,this.docenteOverlayLeft=_.left,this.docenteOverlayWidth=_.width,this.docentesFiltradosEdicion=_.filtrados,this.docEdicionInput.setValue(_.inputValue??"",{emitEvent:!1}),this.mostrarListaDocEdicion=!0,this.reposicionarOverlayDocentes())))}).catch(()=>{})}closeMenu(t){if(this.overlayDocentePrevState)return;let e=t?.target;e?.closest?.("ngb-modal-window")||e?.closest?.(".modal")||e?.closest?.(".modal-backdrop")||e?.closest?.(".docente-edicion-buscador")||e?.closest?.(".docente-edicion-overlay")||this.salirModoEdicionDocente()}onResize(){this.reposicionarOverlayDocentes()}onScroll(){this.reposicionarOverlayDocentes()}onKeydown(t){t?.key==="Escape"&&this.mostrarListaDocEdicion&&(t.preventDefault(),this.salirModoEdicionDocente())}actualizarMostrarCamposMusicales(){this.mostrarCamposMusicales=!!this.habilitarCamposMusicales&&!this.requiereLogin&&this.tipoPerfil!=="estudiantesifas",this.habilitarCopiaExcel=!this.requiereLogin&&!!this.tipoPerfil&&this.tipoPerfil!=="estudiantesifas",this.puedeEditarDocentes||(this.edicionDocentesActiva=!1,this.salirModoEdicionDocente())}cargarCaractisticasInstitucionActual(t){if(!t){this.habilitarCamposMusicales=!1,this.actualizarMostrarCamposMusicales();return}this._inst.Seleccionarinstituciones(t).subscribe({next:e=>{console.log("ins",e);var o=(e?.data?.Caractisticas??"").toString();this.habilitarCamposMusicales=this.normalizarTexto(o).includes("INSTITUTO MUSICAL"),this.actualizarMostrarCamposMusicales(),this.habilitarCamposMusicales&&this.puedeEditarDocentes&&this.cargarOptionsInstrumentosDesdeControles()},error:()=>{this.habilitarCamposMusicales=!1,this.actualizarMostrarCamposMusicales()}})}cargarOptionsInstrumentosDesdeControles(){if(this.instrumentosOptionsCargando||this.instrumentosOptionsCargadas)return;this.instrumentosOptionsCargando=!0;let t=["ESPECIALIDAD","ESPECIALIDAD SECUNDARIA"];this._controles.ObtenerOptionsSelectPorCategorias(t).subscribe({next:e=>{this.InstrumentoMusicalOptions=e?.ESPECIALIDAD||[],this.InstrumentoMusicalSecundarioOptions=e?.["ESPECIALIDAD SECUNDARIA"]||[],this.instrumentosOptionsCargando=!1,this.instrumentosOptionsCargadas=!0},error:()=>{this.InstrumentoMusicalOptions=[],this.InstrumentoMusicalSecundarioOptions=[],this.instrumentosOptionsCargando=!1,this.instrumentosOptionsCargadas=!1}})}normalizarTexto(t){return(t??"").toString().trim().toUpperCase()}onFilterTxtEstChange(){this.paginaest=1,this.aplicarFiltroEstudiantes()}normalizarBusqueda(t){let e=(t??"").toString();try{return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().toUpperCase()}catch{return e.trim().toUpperCase()}}textoIndexadoEstudiante(t){let e=`${t?.Ap_Paterno??""} ${t?.Ap_Materno??""}`.trim(),n=`${t?.Nombre??""}`.trim(),o=`${t?.CI??""}`.trim(),c=`${t?.Sexo??""}`.trim(),_=`${t?.InstrumentoMusical??""}`.trim();return`${e} ${n} ${o} ${c} ${_}`.trim()}aplicarFiltroEstudiantes(){let t=Array.isArray(this.est)?this.est:[],e=this.normalizarBusqueda(this.filtertxtest);e?this.estFiltrados=t.filter(n=>this.normalizarBusqueda(this.textoIndexadoEstudiante(n)).includes(e)):this.estFiltrados=t,this.collectionSizeest=this.estFiltrados.length}AnimarCargaTablaest(){this.est=[],this.aplicarFiltroEstudiantes(),this.isLoadingest=!0}onPageSizeChangeest(){this.paginaest=1}obtenerOrdenDefaultEstudiantes(){return[{column:"Ap_Paterno",direction:"asc"},{column:"Ap_Materno",direction:"asc"},{column:"Nombre",direction:"asc"}]}aplicarOrdenEstudiantes(){let t=this.sortColumnsest&&this.sortColumnsest.length>0?this.sortColumnsest:this.obtenerOrdenDefaultEstudiantes();this.est=this._tools.applyMultiSort(this.est,t)}sortByest(t,e){this.sortColumnsest=this._tools.handleSort(t,e,this.sortColumnsest),this.est=this._tools.applyMultiSort(this.est,this.sortColumnsest),this.aplicarFiltroEstudiantes()}isSortedest(t){return this._tools.isSorted(this.sortColumnsest,t)}getSortDirest(t){return this._tools.getSortDirection(this.sortColumnsest,t)}CargarEstudiantesMateriaPublico(){this.isLoadingest=!0;let t={materiaId:this.materiaId,anioId:this.anioId};this._public.CargarEstudiantesMateriaPublico(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes publicos",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMezcladosMateriasPublico(){this.isLoadingest=!0;let t={anioId:this.anioId,LvlCurso:this.lvlCurso,Paralelo:this.paralelo,institucionId:this.institucionId};this._public.CargarEstudiantesMezcladosMateriasPublico(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes publicos",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMateriaPrivado(){this.isLoadingest=!0;let t={materiaId:this.materiaId,anioId:this.anioId};this._public.CargarEstudiantesMateriaPrivado(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes Privados",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}CargarEstudiantesMezcladosMateriasPrivado(){this.isLoadingest=!0;let t={anioId:this.anioId,LvlCurso:this.lvlCurso,Paralelo:this.paralelo,institucionId:this.institucionId};this._public.CargarEstudiantesMezcladosMateriasPrivado(t).subscribe({next:e=>{this.est=e.data||[],this.aplicarOrdenEstudiantes(),this.aplicarFiltroEstudiantes(),this.isLoadingest=!1,this.recalcularConteoDocentes(this.edicionDocenteActivo?.field??"planteldocadmins_id"),console.log("estudiantes Privados",this.est)},error:e=>{console.error("Error al cargar",e),this.isLoadingest=!1}})}copiarListaExcel(){if(!this.habilitarCopiaExcel){this._tools.MostrarMensaje("info","No tiene permisos para copiar esta lista");return}let t=Array.isArray(this.estFiltrados)?this.estFiltrados:[];if(t.length===0){this._tools.MostrarMensaje("info","No hay datos para copiar");return}let e=[];t.forEach(o=>{let c=`${o?.Ap_Paterno??""} ${o?.Ap_Materno??""}`.trim(),_=`${o?.Nombre??""}`.trim(),b=`${c} ${_}`.trim(),I=`${o?.CI??""}`.toString().trim(),D=`${o?.InstrumentoMusical??""}`.trim(),H=this.normalizarBusqueda(o?.Sexo??""),G=H.startsWith("F")||H.includes("FEM"),it=H.startsWith("M")||H.includes("MASC")?"X":"",nt=G?"X":"";e.push([b,I,D,it,nt].join("	"))});let n=e.join(`
`);this.copiarTextoPortapapeles(n).then(()=>this._tools.MostrarMensaje("success",`Copiado para Excel (${t.length} filas)`)).catch(()=>this._tools.MostrarMensaje("error","No se pudo copiar al portapapeles"))}copiarTextoPortapapeles(t){let e=window?.navigator;return e?.clipboard?.writeText?e.clipboard.writeText(t):new Promise((n,o)=>{try{let c=document.createElement("textarea");c.value=t,c.style.position="fixed",c.style.left="-10000px",c.style.top="0",document.body.appendChild(c),c.focus(),c.select();let _=document.execCommand("copy");document.body.removeChild(c),_?n():o()}catch{o()}})}CargarPlantelDocente(){this._planteldoc.Obtenerplanteldocentes().subscribe({next:t=>{console.log("plateldoc",t),this.planteldocente=t.data??[]},error:t=>{console.error("Error al cargar",t)}})}GenerarQRDocente(t,e){console.log(t+" "+e),this._reportes.GeneradorQRDinamico("QR DEL NUMERO DE CELULAR DE "+t,"Numero de Celular de Trabajo: "+e,e)}GenerarReporteListaEstudiantes(){this._reportes.GenerarListaAlumnos2026(this.est,this.anioId,this.lvlCurso,this.paralelo,this.institucionId,this.modo,this.materiaId,this.reportarconInstrumentos,this.reportarcondocentesEspecialidad)}AccionCopiarNombres(){var t="";this.est.forEach(e=>{var n=e.Ap_Paterno+" "+e.Ap_Materno+" "+e.Nombre;t=t+n+`
`}),this.copyText(t),this.copiadoNombres=!0,setTimeout(()=>{this.copiadoNombres=!1},1500)}AccionCopiarEspecialidades(){var t="";this.est.forEach(e=>{var n=e.Especialidad;t=t+n+`
`}),this.copyText(t),this.copiadoEspecialidades=!0,setTimeout(()=>{this.copiadoEspecialidades=!1},1500)}AccionCopiarSexos(){var t="";this.est.forEach(e=>{var n=e.Sexo;t=t+n+`
`}),this.copyText(t),this.copiadoSexos=!0,setTimeout(()=>{this.copiadoSexos=!1},1500)}AccionCopiarTodos(){var t="";this.est.forEach(e=>{var n=e.CI,o=e.Especialidad,c=e.Sexo,_=e.Ap_Paterno+" "+e.Ap_Materno+" "+e.Nombre;c=="FEMENINO"?t=t+_+"	"+n+"	"+o+`		X
`:t=t+_+"	"+n+"	"+o+`	X	
`}),this.copyText(t),this.copiadoTodos=!0,setTimeout(()=>{this.copiadoTodos=!1},1500)}AccionCopiarCarnets(){var t="";this.est.forEach(e=>{var n=e.CI;t=t+n+`
`}),this.copyText(t),this.copiadoCarnets=!0,setTimeout(()=>{this.copiadoCarnets=!1},1500)}copyText(t){let e=document.createElement("textarea");e.style.position="fixed",e.style.left="0",e.style.top="0",e.style.opacity="0",e.value=t,document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.copy=!0,setTimeout(()=>{this.copy=!1},2e3)}};B.\u0275fac=function(e){return new(e||B)(E(Ze),E(me),E(de),E(Je),E(pe),E(ce),E(le),E(et),E(qe))},B.\u0275cmp=Y({type:B,selectors:[["app-paralelos"]],viewQuery:function(e,n){if(e&1&&Me(Kt,7),e&2){let o;De(o=Pe())&&(n.modalDetalleDocente=o.first)}},hostBindings:function(e,n){e&1&&f("click",function(c){return n.closeMenu(c)},he)("resize",function(){return n.onResize()},fe)("scroll",function(){return n.onScroll()},fe)("keydown",function(c){return n.onKeydown(c)},he)},standalone:!1,decls:5,vars:2,consts:[["loginRequerido",""],["modalDetalleDocente",""],["editDocAdmin",""],["editDocPC",""],["editDocOtros",""],["editInstrumentoMusical",""],["editInstrumentoMusicalSec",""],[4,"ngIf","ngIfElse"],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"fw-bold",2,"color","blue"],[2,"color","brown"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"w-100"],[1,"input-group"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"ngModelChange","ngModel"],["class","form-check mt-2",4,"ngIf"],["class","btn btn-secondary",3,"click",4,"ngIf"],["class","btn btn-outline-primary ms-2",3,"click",4,"ngIf"],["class","form-check form-check-inline text-dark fw-bold",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],[2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["class","bi",3,"ngClass",4,"ngIf"],["title","Docente de Especialidad","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Docente de Pr\xE1ctica de Conjuntos","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Docente de Instrumento Complementario","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["title","Instrumento Complementario","style","user-select: none; -webkit-user-select: none; -moz-user-select: none;",3,"click",4,"ngIf"],["class","text-center",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],["class","docente-edicion-overlay list-group",3,"top","left","width",4,"ngIf"],[1,"form-check","mt-2"],["type","checkbox","id","chkEdicionDocentes",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","chkEdicionDocentes",1,"form-check-label","fw-semibold","text-dark"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-outline-primary","ms-2",3,"click"],[1,"form-check","form-check-inline","text-dark","fw-bold"],["type","checkbox","id","reportarconInstrumentosxd",1,"form-check-input",3,"ngModelChange","ngModel"],["for","reportarconInstrumentosxd",1,"form-check-label"],["type","checkbox","id","reportarcondocentesEspecialidadxd",1,"form-check-input",3,"ngModelChange","ngModel"],["for","reportarcondocentesEspecialidadxd",1,"form-check-label"],[1,"bi",3,"ngClass"],["title","Docente de Especialidad",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Docente de Pr\xE1ctica de Conjuntos",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Docente de Instrumento Complementario",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["title","Instrumento Complementario",2,"user-select","none","-webkit-user-select","none","-moz-user-select","none",3,"click"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],["class","small text-muted",4,"ngIf"],["class","small text-muted","title","Cantidad de asignaciones",4,"ngIf"],["class","docente-cell","style","min-width: 240px;",3,"click",4,"ngIf"],["style","min-width: 210px;",4,"ngIf"],[1,"small","text-muted"],["title","Cantidad de asignaciones",1,"small","text-muted"],[1,"docente-cell",2,"min-width","240px",3,"click"],["target","_blank","title","CONTACTARSE",1,"btn","btn-success","text-light",3,"href"],["target","_blank","title","CONTACTARSE",1,"btn","btn-success","text-light",3,"click","href"],[1,"bi","bi-whatsapp"],[1,"docente-edicion-buscador","position-relative"],["type","text","placeholder","Buscar docente...",1,"form-control","form-control-sm",3,"focus","click","keydown.escape","formControl"],["class","small text-muted mt-1",4,"ngIf"],[1,"small","text-muted","mt-1"],[2,"min-width","210px"],[1,"form-select","form-select-sm",3,"click","ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue","disabled",4,"ngFor","ngForOf"],[3,"ngValue","disabled"],[1,"docente-edicion-overlay","list-group"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngIf"],["class","list-group-item text-muted",4,"ngIf"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"disabled","click",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"fw-semibold","text-truncate"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click","disabled"],[1,"list-group-item","text-muted"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"click"],[1,"me-2"],[1,"fw-semibold"],[1,"text-muted"],["class","text-danger fw-semibold",4,"ngIf"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"text-danger","fw-semibold"],["role","alert",1,"alert","alert-warning","text-center"],[1,"modal-header"],[1,"modal-title"],[1,"text-muted","small"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"table-responsive",2,"max-height","65vh"],[1,"table","table-sm","table-striped","align-middle"],[1,"text-center",2,"width","40px"],[1,"text-center",2,"width","140px"],[1,"text-center",2,"width","120px"],[1,"text-center",2,"width","70px"],[1,"text-center",2,"width","90px"],[1,"text-center",2,"width","110px"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["class","badge bg-success",4,"ngIf"],["class","badge bg-danger",4,"ngIf"],[1,"badge","bg-success"],[1,"badge","bg-danger"]],template:function(e,n){if(e&1&&p(0,_n,56,26,"ng-container",7)(1,un,3,0,"ng-template",null,0,k)(3,vn,38,3,"ng-template",null,1,k),e&2){let o=N(2);m("ngIf",!n.requiereLogin)("ngIfElse",o)}},dependencies:[Oe,J,ee,ae,se,ie,He,re,ne,oe,Ve,$e],styles:['@charset "UTF-8";[_nghost-%COMP%]     .docente-edicion-overlay{position:fixed;z-index:1040;max-height:520px;overflow:auto;box-shadow:0 6px 18px #0000001f;border-radius:.5rem;background:#fff}[_nghost-%COMP%]     .docente-edicion-overlay .list-group-item{padding-top:.6rem;padding-bottom:.6rem}[_nghost-%COMP%]     .docente-edicion-overlay .list-group-item>.me-2{flex:1;min-width:0}[_nghost-%COMP%]     .docente-edicion-overlay .fw-semibold{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}[_nghost-%COMP%]     .modal.modal-paralelos-detalle{z-index:1060}[_nghost-%COMP%]     .modal.modal-paralelos-detalle .modal-content{min-height:220px}[_nghost-%COMP%]     .modal.modal-paralelos-detalle .modal-body{overflow:auto}[_nghost-%COMP%]     .docente-edicion-buscador .list-group-item.disabled{pointer-events:none;opacity:.6}[_nghost-%COMP%]     td.docente-cell{position:relative;overflow:visible}']});var ue=B;var Cn=[{path:"inicio",component:Ye},{path:"horarios",component:_e},{path:"paralelos",component:ue},{path:"planteldocentes",loadComponent:()=>import("./chunk-HBXKXXVN.js").then(i=>i.Planteldocentes)},{path:"planteladministrativos",loadComponent:()=>import("./chunk-6RGYVYJ7.js").then(i=>i.Planteladministrativos)},{path:"eventos",loadComponent:()=>import("./chunk-UBMK6SWY.js").then(i=>i.EventosPublicosComponent)},{path:"eventos/:id",loadComponent:()=>import("./chunk-AMTNTTXP.js").then(i=>i.EventoInscripcionComponent)}],j=class j{};j.\u0275fac=function(e){return new(e||j)},j.\u0275mod=K({type:j}),j.\u0275inj=Q({imports:[W.forChild(Cn),W]});var ge=j;var U=class U{};U.\u0275fac=function(e){return new(e||U)},U.\u0275mod=K({type:U}),U.\u0275inj=Q({imports:[we,je,Ue,ge,Qe,ze,Ge,Be,W,Ke,Xe]});var tt=U;export{tt as PublicosModule};
