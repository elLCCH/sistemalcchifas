import{a as $}from"./chunk-COLKSTJ6.js";import{b as V}from"./chunk-KCTZUZJH.js";import{g as k,h as T,k as F}from"./chunk-PWQJWZZZ.js";import{c as z,f as N,k as B,x as U}from"./chunk-ROSYCBC4.js";import{a as A}from"./chunk-JISGPZ2J.js";import{Aa as C,Dc as O,Ea as r,Fc as L,Gc as D,Lb as s,Ma as b,Mb as v,Nb as p,Ob as P,Oc as E,Ra as y,Tb as w,Ub as M,Vb as S,Wa as m,ga as h,ha as x,ib as c,jb as o,kb as a,lb as l,sb as I,vb as _,xb as d}from"./chunk-SPNCLBHB.js";import"./chunk-GG76335P.js";function Q(n,t){n&1&&(o(0,"div",16),l(1,"div",17),o(2,"div",18),s(3,"Cargando documentos\u2026"),a()())}function W(n,t){n&1&&(o(0,"div",16),l(1,"i",19),o(2,"div",20),s(3,"Inicia sesi\xF3n para ver los documentos p\xFAblicos."),a(),o(4,"a",21),s(5,"Iniciar sesi\xF3n"),a()())}function R(n,t){n&1&&(o(0,"div",16),l(1,"i",22),o(2,"div",20),s(3,"No hay documentos p\xFAblicos disponibles."),a()())}function G(n,t){if(n&1&&l(0,"img",41),n&2){let e=d().$implicit,i=d(2);c("src",i.getLogoUrl(e),C)("alt",e.institucion_nombre||"Instituci\xF3n")}}function q(n,t){n&1&&l(0,"i",42)}function H(n,t){if(n&1&&(o(0,"span",43),l(1,"i",44),s(2),a()),n&2){let e=d().$implicit;r(2),p("",e.institucion_nombre," ")}}function J(n,t){if(n&1&&(o(0,"span",45),l(1,"i",46),s(2),a()),n&2){let e=d().$implicit;r(2),p("",e.publicado_por," ")}}function K(n,t){if(n&1&&(o(0,"span",45),l(1,"i",47),s(2),a()),n&2){let e=d().$implicit;r(2),p("",e.fecha," ")}}function X(n,t){if(n&1&&(o(0,"span",45),l(1,"i",48),s(2),a()),n&2){let e=d().$implicit;r(2),p("",e.dirigido," ")}}function Y(n,t){if(n&1&&(o(0,"div",49),s(1),a()),n&2){let e=d().$implicit;r(),p(" ",e.descripcion," ")}}function Z(n,t){if(n&1){let e=I();o(0,"div",25),_("click",function(){let f=h(e).$implicit,g=d(2);return x(g.abrirPdf(f))}),o(1,"div",26)(2,"div",27),m(3,G,1,2,"img",28)(4,q,1,0,"i",29),a(),o(5,"div",30),l(6,"i",31),a(),o(7,"div",32)(8,"div",33),s(9),a(),o(10,"div",34),m(11,H,3,1,"span",35)(12,J,3,1,"span",36)(13,K,3,1,"span",36)(14,X,3,1,"span",36),a(),m(15,Y,2,1,"div",37),a(),o(16,"div",38),l(17,"i",39),o(18,"div",40),s(19),a()()()()}if(n&2){let e=t.$implicit,i=d(2);r(3),c("ngIf",i.getLogoUrl(e)),r(),c("ngIf",!i.getLogoUrl(e)),r(5),v(e.nombre_documento),r(2),c("ngIf",e.institucion_nombre),r(),c("ngIf",e.publicado_por),r(),c("ngIf",e.fecha),r(),c("ngIf",e.dirigido),r(),c("ngIf",e.descripcion),r(2),c("ngClass",i.isMobile?"bi-download":"bi-eye-fill"),r(2),v(i.isMobile?"Descargar":"Ver PDF")}}function ee(n,t){if(n&1&&(o(0,"div",23),m(1,Z,20,10,"div",24),a()),n&2){let e=d();r(),c("ngForOf",e.items)}}var u=class u{constructor(t,e,i){this.api=t;this.auth=e;this.router=i;this.ruta=A.ruta;this.allItems=[];this.items=[];this.isLoading=!1;this.isLoggedIn=!1;this.searchQuery=""}ngOnInit(){this.auth.loggedIn$.subscribe(t=>{this.isLoggedIn=t,t&&this.cargar()}),this.cargar()}cargar(){this.isLoading=!0,this.api.listar({categoria:"DOCUMENTOS_PUBLICOS",visibilidad:"VISIBLE"}).subscribe({next:t=>{this.allItems=(t?.data??[]).filter(e=>(e.estado??"").toUpperCase()==="ACTIVO"),this.filtrar(),this.isLoading=!1},error:t=>{console.error(t),this.isLoading=!1}})}filtrar(){let t=this.allItems;if(this.searchQuery.trim()){let e=this.searchQuery.toLowerCase();t=t.filter(i=>(i.nombre_documento??"").toLowerCase().includes(e)||(i.publicado_por??"").toLowerCase().includes(e)||(i.descripcion??"").toLowerCase().includes(e)||(i.institucion_nombre??"").toLowerCase().includes(e))}this.items=t}onSearch(){this.filtrar()}getLogoUrl(t){let e=(t?.institucion_logo??"").toString().trim();return e?e.startsWith("http")?e:this.ruta+e:""}get isMobile(){return typeof window<"u"&&window.innerWidth<992}abrirPdf(t){t.archivo&&(this.isMobile?this.descargarPdf(t):this.router.navigate(["/gestioninstitucion/visor-biblioteca",t.id]))}descargarPdf(t){if(!t.archivo)return;let e=t.archivo.startsWith("http")?t.archivo:this.ruta+t.archivo,i=document.createElement("a");i.href=e,i.download=(t.nombre_documento??"documento")+".pdf",i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}};u.\u0275fac=function(e){return new(e||u)(b($),b(V),b(k))},u.\u0275cmp=y({type:u,selectors:[["app-documentos-publicos"]],decls:21,vars:7,consts:[[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"fw-bold","titulosGlobales"],[1,"bi","bi-globe","me-2","text-primary"],[1,"text-secondary","subtitulosGlobales"],[1,"container","py-3"],[1,"search-bar","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"input-group",2,"max-width","400px"],[1,"input-group-text","bg-white"],[1,"bi","bi-search","text-muted"],["type","search","placeholder","Buscar documento o instituci\xF3n...",1,"form-control","border-start-0",3,"ngModelChange","ngModel"],[1,"badge","bg-primary","ms-2",2,"font-size","0.9rem"],["class","text-center py-5",4,"ngIf"],["class","docs-list",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"mt-2","text-muted"],[1,"bi","bi-lock","display-1","text-muted"],[1,"text-muted","mt-2"],["routerLink","/login",1,"btn","btn-primary","btn-sm","mt-3"],[1,"bi","bi-folder2-open","display-1","text-muted"],[1,"docs-list"],["class","doc-pub-item","role","button",3,"click",4,"ngFor","ngForOf"],["role","button",1,"doc-pub-item",3,"click"],[1,"d-flex","align-items-center","gap-3","p-3"],[1,"doc-pub-logo"],[3,"src","alt",4,"ngIf"],["class","bi bi-building",4,"ngIf"],[1,"doc-pub-icon"],[1,"bi","bi-file-earmark-pdf-fill"],[1,"flex-fill","min-w-0"],[1,"fw-semibold","text-black","doc-pub-title"],[1,"d-flex","flex-wrap","gap-2","mt-1"],["class","badge bg-light text-dark border",4,"ngIf"],["class","small text-muted",4,"ngIf"],["class","small text-muted mt-1 text-truncate","style","max-width: 600px;",4,"ngIf"],[1,"doc-pub-action"],[1,"bi",3,"ngClass"],[1,"small"],[3,"src","alt"],[1,"bi","bi-building"],[1,"badge","bg-light","text-dark","border"],[1,"bi","bi-building","me-1"],[1,"small","text-muted"],[1,"bi","bi-person-fill","me-1"],[1,"bi","bi-calendar3","me-1"],[1,"bi","bi-people-fill","me-1"],[1,"small","text-muted","mt-1","text-truncate",2,"max-width","600px"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),l(4,"i",4),s(5,"Documentos P\xFAblicos "),a(),o(6,"p",5),s(7,"Documentos p\xFAblicos de todas las instituciones"),a()()()(),o(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"span",10),l(13,"i",11),a(),o(14,"input",12),S("ngModelChange",function(g){return M(i.searchQuery,g)||(i.searchQuery=g),g}),_("ngModelChange",function(){return i.onSearch()}),a()(),o(15,"span",13),s(16),a()()(),m(17,Q,4,0,"div",14)(18,W,6,0,"div",14)(19,R,4,0,"div",14)(20,ee,2,1,"div",15),a()),e&2&&(r(14),w("ngModel",i.searchQuery),r(2),P(" ",i.items.length," documento",i.items.length!==1?"s":""," "),r(),c("ngIf",i.isLoading),r(),c("ngIf",!i.isLoading&&!i.isLoggedIn),r(),c("ngIf",!i.isLoading&&i.isLoggedIn&&i.items.length===0),r(),c("ngIf",!i.isLoading&&i.isLoggedIn&&i.items.length>0))},dependencies:[E,O,L,D,U,z,N,B,F,T],styles:[".search-bar[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:12px 16px;box-shadow:0 2px 8px #0000000f}.docs-list[_ngcontent-%COMP%]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 12px #0000000f}.doc-pub-item[_ngcontent-%COMP%]{border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .15s ease}.doc-pub-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.doc-pub-item[_ngcontent-%COMP%]:hover{background:#f8f9fa}.doc-pub-item[_ngcontent-%COMP%]:hover   .doc-pub-action[_ngcontent-%COMP%]{color:#0d6efd}.doc-pub-item[_ngcontent-%COMP%]:hover   .doc-pub-icon[_ngcontent-%COMP%]{transform:scale(1.08)}.doc-pub-logo[_ngcontent-%COMP%]{width:44px;height:44px;min-width:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;overflow:hidden;background:#f0f0f0;border:2px solid #dee2e6}.doc-pub-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain}.doc-pub-logo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem;color:#6c757d}.doc-pub-icon[_ngcontent-%COMP%]{width:40px;height:40px;min-width:40px;border-radius:10px;background:linear-gradient(135deg,#dbeafe,#bfdbfe);color:#0d6efd;display:flex;align-items:center;justify-content:center;font-size:1.2rem;transition:transform .2s ease}.doc-pub-title[_ngcontent-%COMP%]{font-size:.95rem;line-height:1.3}.doc-pub-action[_ngcontent-%COMP%]{text-align:center;color:#adb5bd;font-size:1.3rem;transition:color .2s ease;min-width:60px}.doc-pub-action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{font-size:.7rem;margin-top:2px}.min-w-0[_ngcontent-%COMP%]{min-width:0}@media (max-width: 575.98px){.doc-pub-logo[_ngcontent-%COMP%]{width:32px;height:32px;min-width:32px}.doc-pub-icon[_ngcontent-%COMP%]{width:32px;height:32px;min-width:32px;font-size:1rem}.doc-pub-action[_ngcontent-%COMP%]{min-width:40px;font-size:1.1rem}.doc-pub-action[_ngcontent-%COMP%]   .small[_ngcontent-%COMP%]{display:none}}"]});var j=u;export{j as DocumentosPublicosComponent};
