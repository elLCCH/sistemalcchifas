import{a as rt}from"./chunk-RCZ5M5KG.js";import{a as at}from"./chunk-IOCNCHHO.js";import"./chunk-NSZTAK5R.js";import{a as Ie}from"./chunk-MXKJEPFP.js";import"./chunk-XLXCS43A.js";import{a as J}from"./chunk-MKDQ3MI5.js";import{a as et}from"./chunk-73MWYJ7T.js";import{a as nt}from"./chunk-X7ZST2NJ.js";import{b as Se}from"./chunk-ZSRVLRBH.js";import{b as ot}from"./chunk-IOZ5TDSV.js";import{b as tt}from"./chunk-N4MEOVMH.js";import"./chunk-ZYW7YONX.js";import"./chunk-NCIXDP2C.js";import{k as Fe}from"./chunk-LEW5N4EV.js";import{b as ye}from"./chunk-WL6DQNEU.js";import{g as it}from"./chunk-OXGEW5OA.js";import{b as he,c as D,f as G,g as xe,i as qe,k as B,l as Ce,m as Ee,p as Xe,q as Ye,r as j,s as $,t as U,u as Ze,v as Je}from"./chunk-TKGN7DBU.js";import{a as ve}from"./chunk-JISGPZ2J.js";import{Aa as re,Bb as _e,Cb as ge,Cc as be,Da as ue,Db as fe,Ea as s,Ec as L,Fc as F,Gb as se,Hb as Ue,Ib as P,Lb as l,Ma as M,Mb as f,Mc as We,Nb as C,Nc as He,Ob as Y,Ra as k,Sa as pe,Sb as E,Tb as S,Tc as Z,Ub as y,Wa as b,Xc as Qe,Yb as O,Z as Ge,_ as me,ab as R,ba as Be,cc as ze,fc as Ke,ga as u,gc as K,ha as p,ia as je,ib as d,jb as o,kb as a,lb as x,pb as Re,qb as Le,sb as h,ua as $e,vb as _,xb as m}from"./chunk-SGF3PIFW.js";import{a as ce,b as De,m as de}from"./chunk-GG76335P.js";function ut(r,t){if(r&1){let e=h();o(0,"div",35)(1,"button",36),_("click",function(){u(e);let n=m();return p(n.infoPrev())}),l(2,"Prev"),a(),o(3,"button",36),_("click",function(){u(e);let n=m();return p(n.infoNext())}),l(4,"Next"),a()()}if(r&2){let e=m();s(),d("disabled",!e.infoTienePrev()||e.isLoadingInfo),s(2),d("disabled",!e.infoTieneNext()||e.isLoadingInfo)}}function pt(r,t){if(r&1){let e=h();o(0,"label",37)(1,"input",20),_("ngModelChange",function(n){u(e);let c=m();return p(c.onEvalEnabledChange(0,n))}),a(),o(2,"span",21),l(3,"1"),a()()}if(r&2){let e=m();s(),d("ngModel",e.evalEnabled[0])}}function _t(r,t){if(r&1){let e=h();o(0,"label",37)(1,"input",20),_("ngModelChange",function(n){u(e);let c=m();return p(c.onEvalEnabledChange(1,n))}),a(),o(2,"span",21),l(3,"2"),a()()}if(r&2){let e=m();s(),d("ngModel",e.evalEnabled[1])}}function gt(r,t){if(r&1){let e=h();o(0,"label",37)(1,"input",20),_("ngModelChange",function(n){u(e);let c=m();return p(c.onEvalEnabledChange(2,n))}),a(),o(2,"span",21),l(3,"3"),a()()}if(r&2){let e=m();s(),d("ngModel",e.evalEnabled[2])}}function ft(r,t){if(r&1){let e=h();o(0,"label",37)(1,"input",20),_("ngModelChange",function(n){u(e);let c=m();return p(c.onEvalEnabledChange(3,n))}),a(),o(2,"span",21),l(3,"4"),a()()}if(r&2){let e=m();s(),d("ngModel",e.evalEnabled[3])}}function bt(r,t){if(r&1&&(o(0,"span"),l(1),a()),r&2){let e=m(2);s(),Y("\xB7 P\xE1gina ",e.infoMeta.current_page," / ",e.infoMeta.last_page)}}function vt(r,t){if(r&1&&(o(0,"span"),l(1),a()),r&2){let e=m().$implicit;s(),C("\xB7 ",e.NombreInstitucion)}}function ht(r,t){if(r&1){let e=h();o(0,"button",46),_("click",function(){let n=u(e).$implicit,c=m(2);return p(c.seleccionarInfo(n))}),o(1,"div",47),l(2),a(),o(3,"div",48),l(4),b(5,vt,2,1,"span",43),a()()}if(r&2){let e=t.$implicit,i=m(2);P("active",(i.selectedInfo==null?null:i.selectedInfo.id)===e.id),s(2),f(i.infoLabel(e)),s(2),C(" ID Inscripci\xF3n: ",e.id," "),s(),d("ngIf",i.esSuperAdmin&&e.NombreInstitucion)}}function xt(r,t){if(r&1&&(o(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",42),l(5),b(6,bt,2,2,"span",43),a(),o(7,"div",44),b(8,ht,6,5,"button",45),a()()()()()),r&2){let e=m();s(5),C(" Resultados: ",(e.infoMeta==null?null:e.infoMeta.total)??e.infoItems.length," "),s(),d("ngIf",e.infoMeta),s(2),d("ngForOf",e.infoItems)("ngForTrackBy",e.trackByRowIndex)}}function Ct(r,t){r&1&&(o(0,"div",49)(1,"div",50),l(2," Primero busca una "),o(3,"strong"),l(4,"inscripci\xF3n"),a(),l(5," y selecci\xF3nala para cargar sus materias. "),a(),o(6,"div",51),l(7," Columnas calculadas: "),o(8,"strong"),l(9,"Prom Teo"),a(),l(10,", "),o(11,"strong"),l(12,"Prom Prac"),a(),l(13," y "),o(14,"strong"),l(15,"Prom"),a(),l(16," (solo lectura). "),a()())}function Et(r,t){r&1&&(o(0,"span"),l(1,"Cargando calificaciones\u2026"),a())}function St(r,t){r&1&&(o(0,"span"),l(1,"Guardando cambios\u2026"),a())}function yt(r,t){if(r&1&&(o(0,"div",52)(1,"div",51),b(2,Et,2,0,"span",43)(3,St,2,0,"span",43),a()()),r&2){let e=m();s(2),d("ngIf",e.isLoadingCalificaciones),s(),d("ngIf",e.isSaving)}}function It(r,t){if(r&1&&(o(0,"div",53)(1,"div",51),l(2),a()()),r&2){let e=m();s(2),f(e.saveError)}}function Tt(r,t){if(r&1&&(o(0,"span"),l(1),a()),r&2){let e=m(2);s(),C("/ ",e.califMeta.last_page)}}function Mt(r,t){if(r&1){let e=h();o(0,"div",56)(1,"button",36),_("click",function(){u(e);let n=m(2);return p(n.califPrev())}),l(2,"Prev"),a(),o(3,"button",36),_("click",function(){u(e);let n=m(2);return p(n.califNext())}),l(4,"Next"),a()()}if(r&2){let e=m(2);s(),d("disabled",!e.califTienePrev()||e.isLoadingCalificaciones),s(2),d("disabled",!e.califTieneNext()||e.isLoadingCalificaciones)}}function wt(r,t){if(r&1){let e=h();o(0,"div",2)(1,"div",54),l(2," Inscripci\xF3n seleccionada: "),o(3,"strong"),l(4),a(),l(5," \xB7 P\xE1gina materias: "),o(6,"strong"),l(7),a(),b(8,Tt,2,1,"span",43),a(),o(9,"div",5)(10,"div",51),l(11,"Cambios pendientes: "),o(12,"strong"),l(13),a()(),b(14,Mt,5,2,"div",55),o(15,"button",12),_("click",function(){u(e);let n=m();return p(n.cargarCalificaciones(n.califPage))}),l(16," Recargar "),a()()()}if(r&2){let e=m();s(4),f(e.selectedInfo.id),s(3),f((e.califMeta==null?null:e.califMeta.current_page)??e.califPage),s(),d("ngIf",e.califMeta),s(5),f(e.dirtyIds.size),s(),d("ngIf",e.califMeta),s(),d("disabled",e.isLoadingCalificaciones)}}function Pt(r,t){if(r&1&&(o(0,"span",4),l(1),a()),r&2){let e=t.ngIf;s(),C("(",e,")")}}function Ot(r,t){if(r&1&&(o(0,"th",62),l(1),b(2,Pt,2,1,"span",63),a()),r&2){let e=t.$implicit,i=m(2);Ue("width",e.widthPx,"px"),d("ngClass",i.headerThClass(e.key)),s(),C(" ",e.label," "),s(),d("ngIf",i.maxForColumn(e))}}function At(r,t){if(r&1&&(o(0,"tr",68)(1,"td",59)(2,"div",47),l(3),a()()()),r&2){let e=m().$implicit,i=m(2);s(),R("colspan",i.tableColspan()),s(2),f(i.groupKey(e))}}function Nt(r,t){if(r&1){let e=h();Re(0),o(1,"input",71),_("ngModelChange",function(n){u(e);let c=m().$implicit,g=m().index,v=m(2);return p(v.onCellValueInput(g,c.key,n))})("focus",function(){u(e);let n=m().index,c=m().index,g=m(2);return p(g.onCellFocus(c,n))})("keydown",function(n){u(e);let c=m().index,g=m().index,v=m(2);return p(v.onKeyDown(n,g,c))})("paste",function(n){u(e);let c=m().index,g=m().index,v=m(2);return p(v.onPaste(n,g,c))}),a(),Le()}if(r&2){let e=m(),i=e.$implicit,n=e.index,c=m(),g=c.$implicit,v=c.index,I=m(2);s(),P("readonly-cell",i.readonly),d("readOnly",!!i.readonly||!I.isColumnEditable(i.key))("ngModel",g[i.key]),R("data-cell",v+"-"+n)("min",0)("max",I.maxForColumn(i))}}function Vt(r,t){if(r&1){let e=h();o(0,"input",72),_("focus",function(){u(e);let n=m().index,c=m().index,g=m(2);return p(g.onCellFocus(c,n))})("keydown",function(n){u(e);let c=m().index,g=m().index,v=m(2);return p(v.onKeyDown(n,g,c))})("paste",function(n){u(e);let c=m().index,g=m().index,v=m(2);return p(v.onPaste(n,g,c))}),a()}if(r&2){let e=m(),i=e.$implicit,n=e.index,c=m(),g=c.$implicit,v=c.index,I=m(2);d("readOnly",!0)("value",I.sumForColumn(g,i.key)??""),R("data-cell",v+"-"+n)}}function kt(r,t){if(r&1&&(o(0,"td",69),b(1,Nt,2,7,"ng-container",70)(2,Vt,1,3,"ng-template",null,0,K),a()),r&2){let e=t.$implicit,i=t.index,n=se(3),c=m().$implicit,g=m(2);d("ngClass",g.cellTdClass(c,i,e.key)),s(),d("ngIf",e.kind!=="sum")("ngIfElse",n)}}function Rt(r,t){if(r&1){let e=h();Re(0),b(1,At,4,2,"tr",64),o(2,"tr")(3,"td",59)(4,"div",65)(5,"div")(6,"div",47),l(7),a(),o(8,"div",66),l(9),a()(),o(10,"button",24),_("click",function(){let n=u(e).$implicit,c=m(2);return p(c.openPhoto(n))}),l(11,"Foto"),a()()(),b(12,kt,4,3,"td",67),a(),Le()}if(r&2){let e=t.$implicit,i=t.index,n=m(2);s(),d("ngIf",n.isGroupStart(i)),s(),P("table-active",i===n.activeRowIndex),s(5),f(e.estudiante),s(2),f(e.materia),s(3),d("ngForOf",n.columns)("ngForTrackBy",n.trackByColIndex)}}function Lt(r,t){if(r&1&&(o(0,"div",57)(1,"table",58)(2,"thead")(3,"tr")(4,"th",59),l(5,"Estudiante"),a(),b(6,Ot,3,5,"th",60),a()(),o(7,"tbody"),b(8,Rt,13,7,"ng-container",61),a()()()),r&2){let e=m();s(6),d("ngForOf",e.columns)("ngForTrackBy",e.trackByColIndex),s(2),d("ngForOf",e.rows)("ngForTrackBy",e.trackByRowIndex)}}function Ft(r,t){if(r&1){let e=h();o(0,"div",73)(1,"div",74)(2,"div",75)(3,"div",76)(4,"h5",77),l(5),a(),o(6,"button",78),_("click",function(){u(e);let n=m();return p(n.closePhoto())}),a()(),o(7,"div",79),x(8,"img",80),o(9,"div",81),l(10),a()()()()()}if(r&2){let e=m();s(5),C("Foto - ",e.photoRow==null?null:e.photoRow.estudiante),s(3),d("src",e.photoUrlFor(e.photoRow),re),s(2),f(e.photoRow==null?null:e.photoRow.materia)}}function Dt(r,t){if(r&1){let e=h();o(0,"div",82),_("click",function(){u(e);let n=m();return p(n.closePhoto())}),a()}}var ee=class ee{constructor(t,e,i,n){this.hostEl=t;this._calif=e;this._info=i;this._auth=n;this.esSuperAdmin=!1;this.PASSING_SCORE=61;this.maxTeorico=30;this.maxPractico=70;this.avgEvalCount=4;this.evalEnabled=[!0,!0,!0,!0];this.showSumColumns=!1;this.filterInfo="";this.infoItems=[];this.infoMeta=null;this.infoPage=1;this.infoPerPage=10;this.isLoadingInfo=!1;this.selectedInfo=null;this.isLoadingCalificaciones=!1;this.califMeta=null;this.califPage=1;this.califPerPage=200;this.isSaving=!1;this.saveError=null;this.originalById=new Map;this.dirtyIds=new Set;this.HISTORY_LIMIT=80;this.undoStack=[];this.redoStack=[];this.isRestoring=!1;this.viewMode="intercalado";this.rows=[];this.activeRowIndex=0;this.activeColIndex=0;this.photoModalOpen=!1;this.photoRow=null;this.trackByRowIndex=(t,e)=>e.id;this.trackByColIndex=(t,e)=>e.key}get visibleEvalCount(){return this.avgEvalCount}get columns(){return this.buildColumns(this.viewMode,this.visibleEvalCount)}tableColspan(){return 1+this.columns.length}groupKey(t){let e=(t.Anio??"SIN A\xD1O").toString().trim()||"SIN A\xD1O",i=(t.LvlCurso??"SIN CURSO").toString().trim()||"SIN CURSO";return`${e} | ${i}`}isGroupStart(t){if(t<=0)return!0;let e=this.rows[t-1],i=this.rows[t];return!e||!i?!0:this.groupKey(e)!==this.groupKey(i)}buildColumns(t,e){let i=[],c=e;if(t==="intercalado")for(let g=1;g<=c;g++)i.push({key:`Teorico${g}`,label:`Teo${g}`,type:"number",kind:"input",widthPx:95}),i.push({key:`Practico${g}`,label:`Prac${g}`,type:"number",kind:"input",widthPx:95}),this.showSumColumns&&i.push({key:`Sum${g}`,label:`Sum${g}`,type:"number",kind:"sum",readonly:!0,widthPx:90});else{for(let g=1;g<=c;g++)i.push({key:`Teorico${g}`,label:`Teo${g}`,type:"number",kind:"input",widthPx:95});for(let g=1;g<=c;g++)i.push({key:`Practico${g}`,label:`Prac${g}`,type:"number",kind:"input",widthPx:95}),this.showSumColumns&&i.push({key:`Sum${g}`,label:`Sum${g}`,type:"number",kind:"sum",readonly:!0,widthPx:90})}return[...i,{key:"PromTeorico",label:"Prom Teo",type:"number",kind:"input",readonly:!0,widthPx:110},{key:"PromPractico",label:"Prom Prac",type:"number",kind:"input",readonly:!0,widthPx:110},{key:"Promedio",label:"Prom",type:"number",kind:"input",readonly:!0,widthPx:90},{key:"PruebaRecuperacion",label:"Recup",type:"number",kind:"input",widthPx:95}]}ngOnInit(){this._auth.revisarSiEsSuperAdmin().subscribe(t=>{this.esSuperAdmin=t})}buscarInfo(t=1){if(this.isLoadingInfo)return;let e=(this.filterInfo??"").trim();if(!e||e.length<2){this.infoItems=[],this.infoMeta=null,this.infoPage=1;return}this.isLoadingInfo=!0,this._info.Obtenerinfoestudiantesifas({page:t,per_page:this.infoPerPage,search:e,sort_by:"FechInsc",sort_dir:"desc"}).subscribe({next:i=>{let n=Array.isArray(i?.data)?i.data:[];this.infoItems=n.map(c=>({id:Number(c?.id),FechInsc:c?.FechInsc??null,Curso_Solicitado:c?.Curso_Solicitado??null,Paralelo_Solicitado:c?.Paralelo_Solicitado??null,Categoria:c?.Categoria??null,Turno:c?.Turno??null,Anio:c?.Anio??null,Ap_Paterno:c?.Ap_Paterno??null,Ap_Materno:c?.Ap_Materno??null,Nombre:c?.Nombre??null,NombreInstitucion:c?.NombreInstitucion??null})).filter(c=>Number.isFinite(c.id)),this.infoMeta=i?.meta??null,this.infoPage=this.infoMeta?.current_page??t},error:i=>{console.error("Error al buscar inscripciones:",i),this.infoItems=[],this.infoMeta=null},complete:()=>{this.isLoadingInfo=!1}})}infoTienePrev(){return(this.infoMeta?.current_page??1)>1}infoTieneNext(){let t=this.infoMeta?.current_page??1,e=this.infoMeta?.last_page??1;return t<e}infoPrev(){this.infoTienePrev()&&this.buscarInfo((this.infoMeta?.current_page??1)-1)}infoNext(){this.infoTieneNext()&&this.buscarInfo((this.infoMeta?.current_page??1)+1)}infoLabel(t){let e=(t.Ap_Paterno??"").toString().trim(),i=(t.Ap_Materno??"").toString().trim(),n=(t.Nombre??"").toString().trim(),c=`${e} ${i} ${n}`.replace(/\s+/g," ").trim()||`Inscripci\xF3n #${t.id}`,g=(t.Anio??"").toString().trim(),v=(t.Curso_Solicitado??"").toString().trim(),I=(t.Paralelo_Solicitado??"").toString().trim(),w=[c];return g&&w.push(`A\xF1o: ${g}`),v&&w.push(`Curso: ${v}${I?" - "+I:""}`),w.join(" \xB7 ")}seleccionarInfo(t){this.selectedInfo=t,this.resetGridForNewInfo(),this.cargarCalificaciones(1)}limpiarInfo(){this.selectedInfo=null,this.resetGridForNewInfo()}resetGridForNewInfo(){this.rows=[],this.originalById.clear(),this.dirtyIds.clear(),this.undoStack=[],this.redoStack=[],this.saveError=null,this.califMeta=null,this.califPage=1}califTienePrev(){return(this.califMeta?.current_page??1)>1}califTieneNext(){let t=this.califMeta?.current_page??1,e=this.califMeta?.last_page??1;return t<e}califPrev(){this.califTienePrev()&&this.cargarCalificaciones((this.califMeta?.current_page??1)-1)}califNext(){this.califTieneNext()&&this.cargarCalificaciones((this.califMeta?.current_page??1)+1)}cargarCalificaciones(t=1){if(!this.selectedInfo||this.isLoadingCalificaciones)return;this.isLoadingCalificaciones=!0,this.saveError=null;let e=this.selectedInfo.id;this._calif.ObtenerCalificacionesPorInfoPaginado(e,{page:t,per_page:this.califPerPage}).subscribe({next:i=>{let n=Array.isArray(i?.data)?i.data:[];this.califMeta=i?.meta??null,this.califPage=this.califMeta?.current_page??t;let c=Number(n?.[0]?.CantidadEvaluaciones);Number.isFinite(c)&&(this.avgEvalCount=this.clampInt(c,1,4));let g=this.infoLabel(this.selectedInfo);this.rows=n.map(v=>{let I=(v?.NombreMateria??"").toString().trim(),w=(v?.SiglaMateria??"").toString().trim(),T=(v?.MateriaParalelo??"").toString().trim(),V=[w,I].filter(Boolean).join(" ")+(T?` (${T})`:"");return{id:Number(v?.id),infoestudiantesifas_id:Number(v?.infoestudiantesifas_id??e),materias_id:Number(v?.materias_id),estudiante:g,materia:V||`Materia #${v?.materias_id}`,fotoUrl:null,Anio:v?.Anio??null,LvlCurso:v?.LvlCurso??null,Teorico1:v?.Teorico1??null,Teorico2:v?.Teorico2??null,Teorico3:v?.Teorico3??null,Teorico4:v?.Teorico4??null,Practico1:v?.Practico1??null,Practico2:v?.Practico2??null,Practico3:v?.Practico3??null,Practico4:v?.Practico4??null,PromTeorico:v?.PromTeorico??null,PromPractico:v?.PromPractico??null,Promedio:v?.Promedio??null,PruebaRecuperacion:v?.PruebaRecuperacion??null}}).filter(v=>Number.isFinite(v.id)&&Number.isFinite(v.materias_id));for(let v of this.rows){for(let I of["Teorico1","Teorico2","Teorico3","Teorico4","Practico1","Practico2","Practico3","Practico4","PruebaRecuperacion"])this.sanitizeCellValue(v,I);this.recalcInPlace(v)}this.captureBaseline()},error:i=>{console.error("Error al cargar calificaciones:",i),this.rows=[],this.califMeta=null,this.saveError="No se pudieron cargar las calificaciones."},complete:()=>{this.isLoadingCalificaciones=!1}})}captureBaseline(){this.originalById.clear(),this.dirtyIds.clear();for(let t of this.rows)this.originalById.set(t.id,{Teorico1:t.Teorico1,Teorico2:t.Teorico2,Teorico3:t.Teorico3,Teorico4:t.Teorico4,Practico1:t.Practico1,Practico2:t.Practico2,Practico3:t.Practico3,Practico4:t.Practico4,PruebaRecuperacion:t.PruebaRecuperacion})}recomputeDirtyForRow(t){let e=this.originalById.get(t.id);if(!e)return;["Teorico1","Teorico2","Teorico3","Teorico4","Practico1","Practico2","Practico3","Practico4","PruebaRecuperacion"].some(c=>t[c]!==e[c])?this.dirtyIds.add(t.id):this.dirtyIds.delete(t.id)}guardarCambios(){if(!this.selectedInfo||this.isSaving||(this.saveError=null,Array.from(this.dirtyIds.values()).length===0))return;let e=this.rows.filter(i=>this.dirtyIds.has(i.id)).map(i=>({id:i.id,Teorico1:i.Teorico1,Teorico2:i.Teorico2,Teorico3:i.Teorico3,Teorico4:i.Teorico4,Practico1:i.Practico1,Practico2:i.Practico2,Practico3:i.Practico3,Practico4:i.Practico4,PruebaRecuperacion:i.PruebaRecuperacion}));this.isSaving=!0,this._calif.GuardarCalificacionesBulk({infoestudiantesifas_id:this.selectedInfo.id,avg_eval_count:this.avgEvalCount,items:e}).subscribe({next:()=>{for(let i of this.rows)this.dirtyIds.has(i.id)&&this.originalById.set(i.id,{Teorico1:i.Teorico1,Teorico2:i.Teorico2,Teorico3:i.Teorico3,Teorico4:i.Teorico4,Practico1:i.Practico1,Practico2:i.Practico2,Practico3:i.Practico3,Practico4:i.Practico4,PruebaRecuperacion:i.PruebaRecuperacion});this.dirtyIds.clear()},error:i=>{console.error("Error al guardar cambios:",i),this.saveError="No se pudieron guardar los cambios."},complete:()=>{this.isSaving=!1}})}onGlobalKeyDown(t){let e=t.target;if(!e||!this.hostEl.nativeElement.contains(e)||!(t.ctrlKey||t.metaKey))return;let n=t.key.toLowerCase();if(n==="z"&&!t.shiftKey){this.canUndo()&&(t.preventDefault(),this.undo());return}(n==="y"||n==="z"&&t.shiftKey)&&this.canRedo()&&(t.preventDefault(),this.redo())}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){let t=this.undoStack.pop();t&&(this.redoStack.push(this.snapshotState()),this.restoreState(t))}redo(){let t=this.redoStack.pop();t&&(this.undoStack.push(this.snapshotState()),this.restoreState(t))}beginUserChange(){this.isRestoring||(this.undoStack.push(this.snapshotState()),this.undoStack.length>this.HISTORY_LIMIT&&this.undoStack.shift(),this.redoStack=[])}copyAllToClipboard(){return de(this,null,function*(){let t=this.buildTsvExport();if(navigator.clipboard?.writeText){yield navigator.clipboard.writeText(t);return}let e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-9999px",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),document.body.removeChild(e)})}onShowSumColumnsChange(t){this.beginUserChange(),this.showSumColumns=!!t}onMaxTeoricoInput(t){this.beginUserChange(),this.maxTeorico=t,this.onLimitsChange()}onMaxPracticoInput(t){this.beginUserChange(),this.maxPractico=t,this.onLimitsChange()}onLimitsChange(){this.maxTeorico=this.clampInt(this.maxTeorico,1,100),this.maxPractico=this.clampInt(this.maxPractico,1,100);for(let t of this.rows){for(let e of["Teorico1","Teorico2","Teorico3","Teorico4","Practico1","Practico2","Practico3","Practico4","PruebaRecuperacion"])this.sanitizeCellValue(t,e);this.recalcInPlace(t)}}onAvgEvalCountInput(t){this.beginUserChange(),this.avgEvalCount=t,this.onAvgEvalCountChange()}onAvgEvalCountChange(){this.avgEvalCount=this.clampInt(this.avgEvalCount,1,4);for(let t of this.rows)this.recalcInPlace(t)}setAllEvaluations(t){this.beginUserChange(),this.evalEnabled=[t,t,t,t]}onEvalEnabledChange(t,e){t<0||t>3||(this.beginUserChange(),this.evalEnabled[t]=!!e)}setViewMode(t){this.viewMode!==t&&(this.beginUserChange(),this.viewMode=t)}onCellFocus(t,e){this.activeRowIndex=t,this.activeColIndex=e}maxForKey(t){return this.isTeoricoKey(t)?this.maxTeorico:this.isPracticoKey(t)?this.maxPractico:t==="PruebaRecuperacion"?100:null}maxForColumn(t){if(t.kind!=="input")return null;let e=t.key;return this.isReadonlyKey(e)?null:this.maxForKey(e)}isColumnEditable(t){return this.isSumKey(t)?!1:this.isCellEditable(t)}isSumColumn(t){return this.isSumKey(t)}sumForColumn(t,e){let i=this.evalIndexFromColumnKey(e);return i===null?null:this.evalSum(t,i)}openPhoto(t){this.photoRow=t,this.photoModalOpen=!0}closePhoto(){this.photoModalOpen=!1,this.photoRow=null}photoUrlFor(t){return t?.fotoUrl??"assets/images/client6.png"}isCellEditable(t){if(this.isReadonlyKey(t))return!1;let e=this.evalIndexFromKey(t);return e!==null?!!this.evalEnabled[e-1]:!0}evalSum(t,e){let i=t[`Teorico${e}`],n=t[`Practico${e}`];return typeof i=="number"&&typeof n=="number"?i+n:null}isSumKey(t){return typeof t=="string"&&t.startsWith("Sum")}evalIndexFromColumnKey(t){if(this.isSumKey(t)){let e=Number(t.replace("Sum",""));return e>=1&&e<=4?e:null}return this.evalIndexFromKey(t)}cellTdClass(t,e,i){return{"eval-end":this.isEvaluationSeparator(i),"section-start":this.isSectionStart(i),"cell-danger":this.isDangerCell(t,i)}}headerThClass(t){return{"eval-end":this.isEvaluationSeparator(t),"section-start":this.isSectionStart(t)}}onCellValueInput(t,e,i){if(!this.isCellEditable(e)||this.isReadonlyKey(e))return;this.beginUserChange();let n=this.rows[t];n[e]=this.parseNullableInt(String(i??"").trim()),this.sanitizeCellValue(n,e),this.recalcInPlace(n),this.recomputeDirtyForRow(this.rows[t])}onPaste(t,e,i){let n=t.clipboardData?.getData("text/plain");n&&(t.preventDefault(),this.beginUserChange(),this.applyPaste(n,e,i))}onKeyDown(t,e,i){if(t.key!=="ArrowUp"&&t.key!=="ArrowDown"&&t.key!=="ArrowLeft"&&t.key!=="ArrowRight")return;t.preventDefault();let n=this.keyToDelta(t.key),c=this.clamp(e+n.dr,0,this.rows.length-1),g=this.clamp(i+n.dc,0,this.columns.length-1);this.focusCell(c,g)}focusCell(t,e){this.activeRowIndex=t,this.activeColIndex=e,queueMicrotask(()=>{let i=document.querySelector(`[data-cell="${t}-${e}"]`);i?.focus(),i?.select()})}pasteHere(t){this.applyPaste(t,this.activeRowIndex,this.activeColIndex)}applyPaste(t,e,i){let n=t.replace(/\r\n/g,`
`).replace(/\r/g,`
`).split(`
`),c=this.trimEmptyTrailingLines(n);for(let g=0;g<c.length;g++){let v=e+g;if(v>=this.rows.length)break;let I=c[g].split("	");for(let w=0;w<I.length;w++){let T=i+w;if(T>=this.columns.length)break;let V=this.columns[T];if(V.readonly||V.kind==="sum"||this.isSumKey(V.key))continue;let A=I[w].trim(),z=V.key;if(!this.isCellEditable(z))continue;let X=this.parseNullableInt(A);this.rows[v][z]=X,this.sanitizeCellValue(this.rows[v],z)}this.recalcInPlace(this.rows[v]),this.recomputeDirtyForRow(this.rows[v])}}recalcInPlace(t){let e=this.findZeroCascadeIndex(t),i=t,n=!!i.__cascadeActive,c=i.__cascadeLockFrom??null;if(e!==null){n||(i.__cascadeBackup={1:{teo:t.Teorico1,prac:t.Practico1},2:{teo:t.Teorico2,prac:t.Practico2},3:{teo:t.Teorico3,prac:t.Practico3},4:{teo:t.Teorico4,prac:t.Practico4}}),i.__cascadeActive=!0,i.__cascadeLockFrom=e;for(let T=e;T<=4;T++)t[`Teorico${T}`]=0,t[`Practico${T}`]=0}else if(n){let T=i.__cascadeBackup,V=c??1;if(T)for(let A=V+1;A<=4;A++){let z=T[A];if(!z)continue;let X=t[`Teorico${A}`],le=t[`Practico${A}`];typeof X=="number"&&typeof le=="number"&&X===0&&le===0&&(t[`Teorico${A}`]=z.teo,t[`Practico${A}`]=z.prac)}i.__cascadeActive=!1,i.__cascadeLockFrom=null,i.__cascadeBackup=null}let g=e!==null,v=this.getAvgEvalIndices(),I=v.map(T=>t[`Teorico${T}`]),w=v.map(T=>t[`Practico${T}`]);if(t.PromTeorico=g?0:this.avg(I),t.PromPractico=g?0:this.avg(w),t.PromTeorico===null&&t.PromPractico===null)t.Promedio=null;else{let T=(t.PromTeorico??0)+(t.PromPractico??0);t.Promedio=Math.max(0,Math.min(100,Math.round(T)))}}avg(t){let e=t.filter(n=>typeof n=="number"&&Number.isFinite(n));if(e.length===0)return null;let i=e.reduce((n,c)=>n+c,0);return Math.round(i/e.length)}parseNullableInt(t){if(!t)return null;let e=t.replace(",","."),i=Number(e);return Number.isFinite(i)?Math.trunc(i):null}sanitizeCellValue(t,e){if(this.isReadonlyKey(e))return;let i=t[e];if(i==null||!Number.isFinite(i)){t[e]=null;return}let n=Math.trunc(i),c=this.maxForKey(e);c!==null&&(n=Math.min(n,c)),n=Math.max(n,0),t[e]=n}clampInt(t,e,i){let n=Number(t);return Number.isFinite(n)?Math.trunc(this.clamp(n,e,i)):e}getAvgEvalIndices(){let t=[];for(let e=1;e<=this.avgEvalCount;e++)t.push(e);return t}findZeroCascadeIndex(t){for(let e=1;e<=4;e=e+1){let i=t[`Teorico${e}`],n=t[`Practico${e}`];if(typeof i=="number"&&typeof n=="number"&&i===0&&n===0)return e}return null}buildTsvExport(){let t=[{key:"Teorico1",label:"Teo1"},{key:"Practico1",label:"Prac1"},{key:"Teorico2",label:"Teo2"},{key:"Practico2",label:"Prac2"},{key:"Teorico3",label:"Teo3"},{key:"Practico3",label:"Prac3"},{key:"Teorico4",label:"Teo4"},{key:"Practico4",label:"Prac4"},{key:"PromTeorico",label:"Prom Teo"},{key:"PromPractico",label:"Prom Prac"},{key:"Promedio",label:"Prom"},{key:"PruebaRecuperacion",label:"Recup"}],e=["Estudiante","Materia",...t.map(n=>n.label)].join("	"),i=this.rows.map(n=>{let c=t.map(g=>{let v=n[g.key];return v==null?"":String(v)});return[n.estudiante,n.materia,...c].join("	")});return[e,...i].join(`
`)}snapshotState(){return{maxTeorico:this.maxTeorico,maxPractico:this.maxPractico,avgEvalCount:this.avgEvalCount,viewMode:this.viewMode,evalEnabled:[...this.evalEnabled],showSumColumns:this.showSumColumns,rows:this.rows.map(t=>({id:t.id,Teorico1:t.Teorico1,Teorico2:t.Teorico2,Teorico3:t.Teorico3,Teorico4:t.Teorico4,Practico1:t.Practico1,Practico2:t.Practico2,Practico3:t.Practico3,Practico4:t.Practico4,PruebaRecuperacion:t.PruebaRecuperacion}))}}restoreState(t){this.isRestoring=!0;try{this.maxTeorico=t.maxTeorico,this.maxPractico=t.maxPractico,this.avgEvalCount=t.avgEvalCount,this.viewMode=t.viewMode,this.evalEnabled=[...t.evalEnabled],this.showSumColumns=!!t.showSumColumns;let e=new Map(t.rows.map(i=>[i.id,i]));for(let i of this.rows){let n=e.get(i.id);n&&(i.Teorico1=n.Teorico1,i.Teorico2=n.Teorico2,i.Teorico3=n.Teorico3,i.Teorico4=n.Teorico4,i.Practico1=n.Practico1,i.Practico2=n.Practico2,i.Practico3=n.Practico3,i.Practico4=n.Practico4,i.PruebaRecuperacion=n.PruebaRecuperacion,i.__cascadeActive=!1,i.__cascadeLockFrom=null,i.__cascadeBackup=null,this.recalcInPlace(i),this.recomputeDirtyForRow(i))}}finally{this.isRestoring=!1}}isTeoricoKey(t){return t==="Teorico1"||t==="Teorico2"||t==="Teorico3"||t==="Teorico4"}isPracticoKey(t){return t==="Practico1"||t==="Practico2"||t==="Practico3"||t==="Practico4"}isReadonlyKey(t){return t==="PromTeorico"||t==="PromPractico"||t==="Promedio"}isEvaluationSeparator(t){if(this.viewMode==="intercalado"){let e=i=>this.showSumColumns?`Sum${i}`:`Practico${i}`;return this.visibleEvalCount>=1&&t===e(1)||this.visibleEvalCount>=2&&t===e(2)||this.visibleEvalCount>=3&&t===e(3)||this.visibleEvalCount>=4&&t===e(4)}return t===`Teorico${this.visibleEvalCount}`||t===`Practico${this.visibleEvalCount}`||this.showSumColumns&&t===`Sum${this.visibleEvalCount}`}isSectionStart(t){return t==="PromTeorico"}isDangerCell(t,e){let i=this.evalIndexFromColumnKey(e);if(i!==null){let n=t[`Teorico${i}`],c=t[`Practico${i}`];return typeof n=="number"&&typeof c=="number"?n+c<this.PASSING_SCORE:!1}return e==="PromTeorico"?t.PromTeorico===null?!1:t.PromTeorico*100<this.PASSING_SCORE*this.maxTeorico:e==="PromPractico"?t.PromPractico===null?!1:t.PromPractico*100<this.PASSING_SCORE*this.maxPractico:e==="Promedio"?t.Promedio!==null&&t.Promedio<this.PASSING_SCORE:e==="PruebaRecuperacion"?t.PruebaRecuperacion!==null&&t.PruebaRecuperacion<this.PASSING_SCORE:!1}evalIndexFromKey(t){switch(t){case"Teorico1":case"Practico1":return 1;case"Teorico2":case"Practico2":return 2;case"Teorico3":case"Practico3":return 3;case"Teorico4":case"Practico4":return 4;default:return null}}trimEmptyTrailingLines(t){let e=[...t];for(;e.length>0&&e[e.length-1].trim()==="";)e.pop();return e}keyToDelta(t){switch(t){case"ArrowUp":return{dr:-1,dc:0};case"ArrowDown":return{dr:1,dc:0};case"ArrowLeft":return{dr:0,dc:-1};case"ArrowRight":return{dr:0,dc:1};default:return{dr:0,dc:0}}}clamp(t,e,i){return Math.max(e,Math.min(i,t))}makeRow(t,e,i,n,c,g,v,I,w,T,V,A,z,X,le){return{id:t,infoestudiantesifas_id:e,materias_id:i,estudiante:n,materia:c,fotoUrl:g,Teorico1:v,Teorico2:I,Teorico3:w,Teorico4:T,Practico1:V,Practico2:A,Practico3:z,Practico4:X,PromTeorico:null,PromPractico:null,Promedio:null,PruebaRecuperacion:le}}};ee.\u0275fac=function(e){return new(e||ee)(M($e),M(rt),M(Ie),M(Se))},ee.\u0275cmp=k({type:ee,selectors:[["app-calificacionessolo"]],hostBindings:function(e,i){e&1&&_("keydown",function(c){return i.onGlobalKeyDown(c)},ue)},standalone:!1,decls:73,vars:34,consts:[["sumCell",""],[1,"container-fluid","py-2"],[1,"d-flex","align-items-center","justify-content-between","flex-wrap","gap-2","mb-2"],[1,"mb-0"],[1,"text-body-secondary"],[1,"d-flex","align-items-center","gap-2"],[1,"d-flex","align-items-center","gap-2","flex-wrap"],[1,"input-group","input-group-sm",2,"width","380px"],[1,"input-group-text"],["placeholder","Apellido o nombre (min 2 letras)",1,"form-control",3,"ngModelChange","keydown.enter","ngModel"],["type","button",1,"btn","btn-outline-primary",3,"click","disabled"],["class","btn-group btn-group-sm","role","group","aria-label","Paginaci\xF3n inscripci\xF3n",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"],["role","group","aria-label","Modo de visualizaci\xF3n",1,"btn-group","btn-group-sm"],["type","button",1,"btn",3,"click"],[1,"d-flex","align-items-center","gap-1","small"],["type","number","min","1","max","100",1,"form-control","form-control-sm",2,"width","78px",3,"ngModelChange","ngModel"],[1,"form-select","form-select-sm",2,"width","110px",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"form-check","small","mb-0"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"form-check-label"],[1,"d-flex","align-items-center","gap-2","small"],["class","form-check form-check-inline mb-0",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click","disabled"],["class","row g-2 mb-2",4,"ngIf"],["class","alert alert-info py-2 mb-2",4,"ngIf"],["class","alert alert-warning py-2 mb-2",4,"ngIf"],["class","alert alert-danger py-2 mb-2",4,"ngIf"],["class","d-flex align-items-center justify-content-between flex-wrap gap-2 mb-2",4,"ngIf"],["class","table-responsive cali-grid-wrap",4,"ngIf"],["class","modal fade show d-block","tabindex","-1","role","dialog","aria-modal","true",4,"ngIf"],["class","modal-backdrop fade show",3,"click",4,"ngIf"],["role","group","aria-label","Paginaci\xF3n inscripci\xF3n",1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"form-check","form-check-inline","mb-0"],[1,"row","g-2","mb-2"],[1,"col-12"],[1,"card"],[1,"card-body","py-2"],[1,"small","text-body-secondary","mb-2"],[4,"ngIf"],[1,"list-group","list-group-flush"],["type","button","class","list-group-item list-group-item-action py-2",3,"active","click",4,"ngFor","ngForOf","ngForTrackBy"],["type","button",1,"list-group-item","list-group-item-action","py-2",3,"click"],[1,"fw-semibold"],[1,"small","opacity-75"],[1,"alert","alert-info","py-2","mb-2"],[1,"small","mb-1"],[1,"small"],[1,"alert","alert-warning","py-2","mb-2"],[1,"alert","alert-danger","py-2","mb-2"],[1,"small","text-body-secondary"],["class","btn-group btn-group-sm","role","group","aria-label","Paginaci\xF3n calificaciones",4,"ngIf"],["role","group","aria-label","Paginaci\xF3n calificaciones",1,"btn-group","btn-group-sm"],[1,"table-responsive","cali-grid-wrap"],[1,"table","table-sm","table-bordered","align-middle","cali-grid"],[1,"sticky-col","col-meta"],["class","text-center",3,"width","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-center",3,"ngClass"],["class","text-body-secondary",4,"ngIf"],["class","table-secondary",4,"ngIf"],[1,"d-flex","align-items-start","justify-content-between","gap-2"],[1,"text-body-secondary","small"],["class","p-1",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"table-secondary"],[1,"p-1",3,"ngClass"],[4,"ngIf","ngIfElse"],["type","number","inputmode","numeric",1,"form-control","form-control-sm","text-center",3,"ngModelChange","focus","keydown","paste","readOnly","ngModel"],["type","number","inputmode","numeric",1,"form-control","form-control-sm","text-center","readonly-cell",3,"focus","keydown","paste","readOnly","value"],["tabindex","-1","role","dialog","aria-modal","true",1,"modal","fade","show","d-block"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"modal-body","text-center"],["alt","Foto del estudiante",1,"img-fluid","rounded",3,"src"],[1,"text-body-secondary","small","mt-2"],[1,"modal-backdrop","fade","show",3,"click"]],template:function(e,i){e&1&&(o(0,"div",1)(1,"div",2)(2,"div")(3,"h5",3),l(4,"Editor de calificaciones (BD) tipo Excel"),a(),o(5,"small",4),l(6," Edita directo en celdas. Puedes copiar desde Excel y pegar (Ctrl+V) dentro de una celda; soporta pegar bloques (tab + saltos de l\xEDnea). "),a()(),o(7,"div",5)(8,"div",6)(9,"div",7)(10,"span",8),l(11,"Buscar inscripci\xF3n"),a(),o(12,"input",9),_("ngModelChange",function(c){return i.filterInfo=c})("keydown.enter",function(){return i.buscarInfo(1)}),a(),o(13,"button",10),_("click",function(){return i.buscarInfo(1)}),l(14," Buscar "),a()(),b(15,ut,5,2,"div",11),o(16,"button",12),_("click",function(){return i.limpiarInfo()}),l(17," Limpiar "),a()(),o(18,"div",13)(19,"button",14),_("click",function(){return i.setViewMode("intercalado")}),l(20," Intercalado (Eval1..4) "),a(),o(21,"button",14),_("click",function(){return i.setViewMode("agrupado")}),l(22," Agrupado (Teo/Prac) "),a()(),o(23,"div",6)(24,"div",15)(25,"span",4),l(26,"L\xEDmite Teo"),a(),o(27,"input",16),_("ngModelChange",function(c){return i.onMaxTeoricoInput(c)}),a()(),o(28,"div",15)(29,"span",4),l(30,"L\xEDmite Prac"),a(),o(31,"input",16),_("ngModelChange",function(c){return i.onMaxPracticoInput(c)}),a()(),o(32,"div",6)(33,"div",15)(34,"span",4),l(35,"Promedio usa"),a(),o(36,"select",17),_("ngModelChange",function(c){return i.onAvgEvalCountInput(c)}),o(37,"option",18),l(38,"1 eval"),a(),o(39,"option",18),l(40,"2 eval"),a(),o(41,"option",18),l(42,"3 eval"),a(),o(43,"option",18),l(44,"4 eval"),a()()()()(),o(45,"div",6)(46,"label",19)(47,"input",20),_("ngModelChange",function(c){return i.onShowSumColumnsChange(c)}),a(),o(48,"span",21),l(49,"Mostrar sumas"),a()(),o(50,"div",22)(51,"span",4),l(52,"Evaluaciones"),a(),b(53,pt,4,1,"label",23)(54,_t,4,1,"label",23)(55,gt,4,1,"label",23)(56,ft,4,1,"label",23),a(),o(57,"button",24),_("click",function(){return i.setAllEvaluations(!0)}),l(58," Todas "),a()(),o(59,"button",12),_("click",function(){return i.focusCell(0,0)}),l(60," Ir a primera celda "),a(),o(61,"button",25),_("click",function(){return i.copyAllToClipboard()}),l(62," Copiar todo "),a(),o(63,"button",26),_("click",function(){return i.guardarCambios()}),l(64," Guardar cambios "),a()()(),b(65,xt,9,4,"div",27)(66,Ct,17,0,"div",28)(67,yt,4,2,"div",29)(68,It,3,1,"div",30)(69,wt,17,6,"div",31)(70,Lt,9,4,"div",32)(71,Ft,11,3,"div",33)(72,Dt,1,0,"div",34),a()),e&2&&(s(12),d("ngModel",i.filterInfo),s(),d("disabled",i.isLoadingInfo),s(2),d("ngIf",i.infoMeta),s(),d("disabled",!i.selectedInfo),s(3),P("btn-primary",i.viewMode==="intercalado")("btn-outline-primary",i.viewMode!=="intercalado"),s(2),P("btn-primary",i.viewMode==="agrupado")("btn-outline-primary",i.viewMode!=="agrupado"),s(6),d("ngModel",i.maxTeorico),s(4),d("ngModel",i.maxPractico),s(5),d("ngModel",i.avgEvalCount),s(),d("ngValue",1),s(2),d("ngValue",2),s(2),d("ngValue",3),s(2),d("ngValue",4),s(4),d("ngModel",i.showSumColumns),s(6),d("ngIf",i.visibleEvalCount>=1),s(),d("ngIf",i.visibleEvalCount>=2),s(),d("ngIf",i.visibleEvalCount>=3),s(),d("ngIf",i.visibleEvalCount>=4),s(3),d("disabled",i.rows.length===0),s(4),d("disabled",!i.selectedInfo||i.dirtyIds.size===0||i.isSaving),s(2),d("ngIf",i.infoItems.length>0),s(),d("ngIf",!i.selectedInfo),s(),d("ngIf",i.selectedInfo&&(i.isLoadingCalificaciones||i.isSaving)),s(),d("ngIf",i.saveError),s(),d("ngIf",i.selectedInfo),s(),d("ngIf",i.selectedInfo),s(),d("ngIf",i.photoModalOpen),s(),d("ngIf",i.photoModalOpen))},dependencies:[be,L,F,$,U,D,Ee,he,j,G,Je,Ze,B],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}.cali-grid-wrap[_ngcontent-%COMP%]{max-height:calc(100vh - 220px)}.cali-grid[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}.cali-grid[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:3;background:var(--bs-body-bg)}.col-meta[_ngcontent-%COMP%]{min-width:240px;background:inherit}.sticky-col[_ngcontent-%COMP%]{position:sticky;left:0;z-index:2;background:var(--bs-body-bg)}.cali-grid[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th.col-meta[_ngcontent-%COMP%]{background:var(--bs-body-bg)}.cali-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-active[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .cali-grid[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-active[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--bs-table-active-bg)}.cali-grid[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .cali-grid[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.readonly-cell[_ngcontent-%COMP%]{background:#0000000a}.cali-grid[_ngcontent-%COMP%]   td.eval-end[_ngcontent-%COMP%], .cali-grid[_ngcontent-%COMP%]   th.eval-end[_ngcontent-%COMP%]{border-right-width:3px;border-right-style:solid;border-right-color:color-mix(in srgb,var(--bs-body-color) 55%,var(--bs-border-color))}.cali-grid[_ngcontent-%COMP%]   td.section-start[_ngcontent-%COMP%], .cali-grid[_ngcontent-%COMP%]   th.section-start[_ngcontent-%COMP%]{border-left-width:3px;border-left-style:solid;border-left-color:color-mix(in srgb,var(--bs-body-color) 55%,var(--bs-border-color))}.cali-grid[_ngcontent-%COMP%]   td.cell-danger[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%]{color:var(--bs-danger);font-weight:600}.cali-grid[_ngcontent-%COMP%]   td.cell-danger[_ngcontent-%COMP%]   input.form-control.readonly-cell[_ngcontent-%COMP%]{color:var(--bs-danger)}.cali-grid[_ngcontent-%COMP%]   input.form-control[_ngcontent-%COMP%], .cali-grid[_ngcontent-%COMP%]   select.form-select[_ngcontent-%COMP%]{border-radius:0}']});var Te=ee;var Bt=["modalgestioncontroles"];function jt(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),f(e)}}function $t(r,t){r&1&&(o(0,"div",29),l(1," Cargando controles... "),a())}function Ut(r,t){if(r&1&&(o(0,"div",49),l(1),a()),r&2){let e=m().$implicit,i=m(3).$implicit,n=m(3);s(),Y(" ",n.labelEdadesCategoria(i),": ",e.Edades||"-"," ")}}function zt(r,t){if(r&1&&(o(0,"span",49),l(1),a()),r&2){let e=m().$implicit,i=m(6);s(),C("Instituci\xF3n: ",i.getNombreInstitucion(e)||(e.instituciones_id??"GLOBAL"))}}function Kt(r,t){r&1&&(o(0,"span",49),l(1,"|"),a())}function Wt(r,t){if(r&1){let e=h();o(0,"div",44)(1,"div",45)(2,"div",46),l(3),a(),b(4,Ut,2,2,"div",47)(5,zt,2,1,"span",47)(6,Kt,2,0,"span",47),o(7,"div",48)(8,"span",49),l(9,"Estado:"),a(),o(10,"button",50),_("click",function(n){let c=u(e).$implicit,g=m(6);return p(g.toggleEstadoFila(c,n))}),l(11),a(),o(12,"span",49),l(13,"|"),a(),o(14,"span",49),l(15,"Visibilidad:"),a(),o(16,"button",51),_("click",function(n){let c=u(e).$implicit,g=m(6);return p(g.toggleVisibilidadFila(c,n))}),l(17),a()()(),o(18,"div",52)(19,"button",53),_("click",function(){let n=u(e).$implicit,c=m(6);return p(c.Seleccionarcontroles(n.id))}),l(20,"Editar"),a(),o(21,"button",54),_("click",function(){let n=u(e).$implicit,c=m(6);return p(c.Eliminarcontroles(n.id))}),l(22,"Eliminar"),a()()()}if(r&2){let e=t.$implicit,i=m(3).$implicit,n=m(3);s(3),f(e.ParaI),s(),d("ngIf",n.showEdadesCategoria(i)),s(),d("ngIf",n.esSuperlcchs),s(),d("ngIf",n.esSuperlcchs),s(4),d("ngClass",e.Estado==="ACTIVO"?"btn-outline-success":"btn-outline-secondary")("disabled",n.isTogglingEstado(e.id)),s(),C(" ",e.Estado," "),s(5),d("ngClass",e.Visibilidad==="VISIBLE"?"btn-outline-primary":"btn-outline-secondary")("disabled",n.isTogglingVisibilidad(e.id)),s(),C(" ",e.Visibilidad," ")}}function Ht(r,t){if(r&1&&(o(0,"div",42),b(1,Wt,23,10,"div",43),a()),r&2){let e=m().ngIf;s(),d("ngForOf",e)}}function Qt(r,t){r&1&&(o(0,"div",55),l(1,"Sin datos"),a())}function qt(r,t){if(r&1){let e=h();o(0,"div",34)(1,"div",35)(2,"div",36)(3,"h4",37),l(4),a()(),o(5,"div",38),l(6),a(),o(7,"button",39),_("click",function(){u(e);let n=m().$implicit,c=m(3);return p(c.abrirNuevoPorCategoria(n))}),l(8," Nuevo "),a()(),o(9,"div",40),b(10,Ht,2,1,"div",41)(11,Qt,2,0,"ng-template",null,1,K),a()()}if(r&2){let e=t.ngIf,i=se(12),n=m().$implicit;s(4),C("",n," "),s(2),C(" ",e.length," item(s) "),s(4),d("ngIf",e.length>0)("ngIfElse",i)}}function Xt(r,t){if(r&1&&(o(0,"div",32),b(1,qt,13,4,"div",33),a()),r&2){let e=t.$implicit,i=m(3);s(),d("ngIf",i.getControlesPorCategoria(e))}}function Yt(r,t){if(r&1&&(o(0,"div",30),b(1,Xt,2,1,"div",31),a()),r&2){let e=m(2);s(),d("ngForOf",e.categoriasParaMostrar)}}function Zt(r,t){if(r&1&&(o(0,"div",26),b(1,$t,2,0,"div",27)(2,Yt,2,1,"div",28),a()),r&2){let e=m();s(),d("ngIf",e.isLoadingcontroles),s(),d("ngIf",!e.isLoadingcontroles)}}function Jt(r,t){r&1&&(o(0,"th",67),l(1,"NombreInstitucion"),a())}function ei(r,t){if(r&1&&(o(0,"tr")(1,"td",59)(2,"div",68)(3,"span",69),l(4,"Cargando..."),a()()()()),r&2){let e=m(2);s(),R("colspan",e.esSuperlcchs?9:8)}}function ti(r,t){if(r&1&&(o(0,"tr")(1,"td",59),l(2,"No hay datos disponibles"),a()()),r&2){let e=m(2);s(),R("colspan",e.esSuperlcchs?9:8)}}function ii(r,t){if(r&1&&(o(0,"td"),l(1),a()),r&2){let e=m().$implicit,i=m(2);s(),f(i.getNombreInstitucion(e))}}function ni(r,t){if(r&1&&x(0,"img",76),r&2){let e=m(3);d("src",e._tools.rutabtniconsanimaciones+"pencil.svg",re)}}function oi(r,t){if(r&1&&x(0,"ng-lottie",77),r&2){let e=m(3);d("options",e._tools.optionsEditar)}}function ai(r,t){if(r&1&&x(0,"img",76),r&2){let e=m(3);d("src",e._tools.rutabtniconsanimaciones+"delete.svg",re)}}function ri(r,t){if(r&1&&x(0,"ng-lottie",77),r&2){let e=m(3);d("options",e._tools.optionsEliminar)}}function si(r,t){if(r&1){let e=h();o(0,"tr",70),_("contextmenu",function(n){let c=u(e).$implicit,g=m(2);return p(g.abrirMenucontroles(n,c))}),o(1,"td",59),l(2),a(),o(3,"td"),l(4),a(),b(5,ii,2,1,"td",62),o(6,"td"),l(7),a(),o(8,"td"),l(9),a(),o(10,"td"),l(11),a(),o(12,"td")(13,"button",50),_("click",function(n){let c=u(e).$implicit,g=m(2);return p(g.toggleEstadoFila(c,n))}),l(14),a()(),o(15,"td")(16,"button",51),_("click",function(n){let c=u(e).$implicit,g=m(2);return p(g.toggleVisibilidadFila(c,n))}),l(17),a()(),o(18,"td",71)(19,"button",72),_("click",function(){let n=u(e).$implicit,c=m(2);return p(c.Seleccionarcontroles(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return p(c._tools.hoverBotonMap["edicioncontroles-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return p(c._tools.hoverBotonMap["edicioncontroles-"+n.id]=!1)}),b(20,ni,1,1,"img",73)(21,oi,1,1,"ng-lottie",74),a(),o(22,"button",75),_("click",function(){let n=u(e).$implicit,c=m(2);return p(c.Eliminarcontroles(n.id))})("mouseenter",function(){let n=u(e).$implicit,c=m(2);return p(c._tools.hoverBotonMap["eliminacioncontroles-"+n.id]=!0)})("mouseleave",function(){let n=u(e).$implicit,c=m(2);return p(c._tools.hoverBotonMap["eliminacioncontroles-"+n.id]=!1)}),b(23,ai,1,1,"img",73)(24,ri,1,1,"ng-lottie",74),a()()()}if(r&2){let e=t.index,i=t.$implicit,n=m(2);s(2),f((n.paginacontroles-1)*n.pageSizecontroles+(e+1)),s(2),f(i.instituciones_id??"GLOBAL"),s(),d("ngIf",n.esSuperlcchs),s(2),f(i.Categoria),s(2),f(i.ParaI),s(2),f(i.Edades),s(2),d("ngClass",i.Estado==="ACTIVO"?"btn-outline-success":"btn-outline-secondary")("disabled",n.isTogglingEstado(i.id)),s(),C(" ",i.Estado," "),s(2),d("ngClass",i.Visibilidad==="VISIBLE"?"btn-outline-primary":"btn-outline-secondary")("disabled",n.isTogglingVisibilidad(i.id)),s(),C(" ",i.Visibilidad," "),s(3),d("ngIf",!n._tools.hoverBotonMap["edicioncontroles-"+i.id]),s(),d("ngIf",n._tools.hoverBotonMap["edicioncontroles-"+i.id]),s(2),d("ngIf",!n._tools.hoverBotonMap["eliminacioncontroles-"+i.id]),s(),d("ngIf",n._tools.hoverBotonMap["eliminacioncontroles-"+i.id])}}function li(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),C("",e," por p\xE1gina")}}function ci(r,t){if(r&1){let e=h();o(0,"div",26)(1,"div",56)(2,"table",57)(3,"thead",58)(4,"tr")(5,"th",59),l(6,"#"),a(),o(7,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("instituciones_id",n))}),l(8,"Instituci\xF3n"),a(),b(9,Jt,2,0,"th",61),o(10,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("Categoria",n))}),l(11,"Categoria"),a(),o(12,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("ParaI",n))}),l(13,"ParaI"),a(),o(14,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("Edades",n))}),l(15,"Edades"),a(),o(16,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("Estado",n))}),l(17,"Estado"),a(),o(18,"th",60),_("click",function(n){u(e);let c=m();return p(c.sortBycontroles("Visibilidad",n))}),l(19,"Visibilidad"),a(),o(20,"th",59),l(21,"ACCIONES"),a()()(),o(22,"tbody"),b(23,ei,5,1,"tr",62)(24,ti,3,1,"tr",62)(25,si,25,16,"tr",63),ze(26,"slice"),a()()(),o(27,"div",64)(28,"ngb-pagination",65),y("pageChange",function(n){u(e);let c=m();return S(c.paginacontroles,n)||(c.paginacontroles=n),p(n)}),a(),o(29,"select",66),y("ngModelChange",function(n){u(e);let c=m();return S(c.pageSizecontroles,n)||(c.pageSizecontroles=n),p(n)}),_("change",function(){u(e);let n=m();return p(n.onPageSizeChangecontroles())}),b(30,li,2,2,"option",23),a()()()}if(r&2){let e=m();s(9),d("ngIf",e.esSuperlcchs),s(14),d("ngIf",e.isLoadingcontroles),s(),d("ngIf",!e.isLoadingcontroles&&(!e.controles||e.controles.length===0)),s(),d("ngForOf",Ke(26,13,e.controlesFiltrados,(e.paginacontroles-1)*e.pageSizecontroles,e.paginacontroles*e.pageSizecontroles)),s(3),E("page",e.paginacontroles),d("collectionSize",e.controlesFiltrados.length)("pageSize",e.pageSizecontroles)("maxSize",5)("rotate",!0)("ellipses",!1)("boundaryLinks",!0),s(),E("ngModel",e.pageSizecontroles),s(),d("ngForOf",e.pageSizeOptionscontroles)}}function di(r,t){if(r&1&&(o(0,"option",97),l(1),a()),r&2){let e=t.$implicit;d("ngValue",e.id),s(),f(e.Nombre)}}function mi(r,t){if(r&1&&(o(0,"div",84)(1,"select",96)(2,"option",97),l(3,"GLOBAL"),a(),b(4,di,2,2,"option",98),a(),o(5,"label"),l(6,"Instituci\xF3n"),a()()),r&2){let e=m(2);s(2),d("ngValue",""),s(2),d("ngForOf",e.institucionesInfo)}}function ui(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),f(e)}}function pi(r,t){if(r&1&&(o(0,"div",84),x(1,"input",99),o(2,"label"),l(3),a()()),r&2){let e=m(2);s(3),f(e.labelNivelCurso)}}function _i(r,t){if(r&1&&(o(0,"div",84),x(1,"input",100),o(2,"label"),l(3),a()()),r&2){let e=m(2);s(3),f(e.labelEdades)}}function gi(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),f(e)}}function fi(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),f(e)}}function bi(r,t){if(r&1){let e=h();o(0,"button",103),_("click",function(){u(e);let n=m(3);return p(n.AutoCompletarLastcontroles())}),o(1,"span",104),x(2,"ng-lottie",105),a(),o(3,"span"),l(4,"AUTO COMPLETAR "),a(),x(5,"span",10),a()}if(r&2){let e=m(3);s(2),d("options",e._tools.optionsautocompletar)}}function vi(r,t){if(r&1&&(o(0,"div",101),b(1,bi,6,1,"button",102),a()),r&2){let e=m(2);s(),d("ngIf",!e.AnimacionCargabtnModalcontroles)}}function hi(r,t){if(r&1){let e=h();o(0,"button",106),_("click",function(){u(e);let n=m().$implicit,c=m();return n.dismiss(),p(c.resetcontroles())}),o(1,"span",104),x(2,"ng-lottie",105),a(),o(3,"span"),l(4,"CANCELAR"),a(),x(5,"span",10),a()}if(r&2){let e=m(2);s(2),d("options",e._tools.optionscancelar)}}function xi(r,t){if(r&1){let e=h();o(0,"button",107),_("click",function(){u(e);let n=m(2);return p(n.AgregarModificarcontroles())}),x(1,"span",108),a()}r&2&&d("disabled",!0)}function Ci(r,t){if(r&1){let e=h();o(0,"button",109),_("click",function(){u(e);let n=m(2);return p(n.AgregarModificarcontroles())}),o(1,"span",104),x(2,"ng-lottie",105),a(),o(3,"span"),l(4),a(),x(5,"span",10),a()}if(r&2){let e,i,n=m(2);s(2),d("options",(e=n.newcontroles.get("id"))!=null&&e.value?n._tools.optionsEditar:n._tools.optionsAdicionar),s(2),f((i=n.newcontroles.get("id"))!=null&&i.value?"MODIFICAR":"REGISTRAR")}}function Ei(r,t){if(r&1){let e=h();o(0,"div",78)(1,"h4",79),l(2),a(),o(3,"button",80),_("click",function(){let n=u(e).$implicit,c=m();return n.dismiss(),p(c.resetcontroles())}),a()(),o(4,"div",81)(5,"form",82),b(6,mi,7,2,"div",83),o(7,"div",84)(8,"select",85)(9,"option",22),l(10,"SELECCIONE"),a(),b(11,ui,2,2,"option",23),a(),o(12,"label"),l(13,"Categoria"),a()(),o(14,"div",84),x(15,"input",86),o(16,"label"),l(17),a()(),b(18,pi,4,1,"div",83)(19,_i,4,1,"div",83),o(20,"div",84)(21,"select",87),b(22,gi,2,2,"option",23),a(),o(23,"label"),l(24,"Estado"),a()(),o(25,"div",84)(26,"select",88),b(27,fi,2,2,"option",23),a(),o(28,"label"),l(29,"Visibilidad"),a()()()(),o(30,"div",89),b(31,vi,2,1,"div",90),o(32,"div",91),b(33,hi,6,1,"button",92),a(),o(34,"div",93),b(35,xi,2,1,"button",94)(36,Ci,6,2,"button",95),a()()}if(r&2){let e,i=m();s(2),C("",(e=i.newcontroles.get("id"))!=null&&e.value?"Modificar":"Registrar"," control"),s(3),d("formGroup",i.newcontroles),s(),d("ngIf",i.esSuperlcchs),s(5),d("ngForOf",i.categoriasOptionsForm),s(6),f(i.labelParaI),s(),d("ngIf",i.showNivelCurso),s(),d("ngIf",i.showEdades),s(3),d("ngForOf",i.estadoOptions),s(5),d("ngForOf",i.visibilidadOptions),s(4),d("ngIf",!i.newcontroles.get("id").value),s(2),d("ngIf",!i.AnimacionCargabtnModalcontroles),s(2),d("ngIf",i.AnimacionCargabtnModalcontroles),s(),d("ngIf",!i.AnimacionCargabtnModalcontroles)}}var te=class te{constructor(t,e,i,n){this._cont=t;this._tools=e;this._auth=i;this._inst=n;this.esSuperlcchs=!1;this.esAdministrativo=!1;this.institucionesIdSesion=null;this.institucionesInfo=[];this.institucionesById=new Map;this.estadoOptions=["ACTIVO","INACTIVO"];this.visibilidadOptions=["VISIBLE","OCULTO"];this.categoriasGlobales=["CARGOS SUPERADMINISTRATIVOS","PERMISO","ESTADO","VISIBILIDAD","SEXO","CARACTER\xCDSTICAS DE INSTITUCI\xD3N","EDICI\xD3N DE INSCRIPCIONES","EDICI\xD3N DE CALIFICACIONES","PREDETERMINADO","TIPOS SUPERADMINISTRATIVOS","TIPOS PLANTEL ADMINISTRATIVOS","TIPOS DOCENTES","ESTADO DE HABILITACI\xD3N","TIPOS MATERIAS","MODOS MATERIAS","RELACI\xD3N DOCENTE ESTUDIANTES","PROGRAMA","MODALIDAD","TIPO DE ESTUDIANTE"];this.categoriasPorInstitucion=["CARGOS ADMINISTRATIVOS","CARGOS DOCENTES","NIVEL DE CARRERA","ESPECIALIDAD","ESPECIALIDAD SECUNDARIA","LVLCURSO","NIVEL EN COLEGIO","GRADO DE COLEGIO","TIPO COLEGIO","TIPO REGISTRO DE MATERIA","ESTADO PAGO","EXPEDIDO","TURNO","VERIFICACI\xD3N INSCRIPCIONES"];this.togglingEstadoIds=new Set;this.togglingVisibilidadIds=new Set;this.viewMode="interactive";this.categoriaFiltro="";this.menuStatecontroles$=this._tools.state$;this.controles=[];this.paginacontroles=1;this.isLoadingcontroles=!0;this.AnimacionCargabtnModalcontroles=!1;this.filtertxtcontroles="";this.collectionSizecontroles=0;this.pageSizecontroles=10;this.pageSizeOptionscontroles=[5,10,20,50];this.sortColumnscontroles=[]}get categoriasOptions(){return this.esSuperlcchs?[...this.categoriasGlobales,...this.categoriasPorInstitucion]:[...this.categoriasPorInstitucion]}get categoriasOptionsForm(){return this.categoriasOptions}ngOnInit(){this.newcontroles=this._cont.createFormGroupcontroles(),this.newcontrolesAnteriorAccion=this._cont.createFormGroupcontroles(),this.setupCategoriaWatcher(),this.cargarSesionYPermisos()}cargarSesionYPermisos(){this._auth.pedirPerfil().subscribe({next:t=>{let e=(t?.tipo??"").toString().toLowerCase();this.esSuperlcchs=e==="superlcchs",this.esAdministrativo=e==="planteladministrativos";let i=Number(t?.usuario?.instituciones_id??0);this.institucionesIdSesion=Number.isFinite(i)&&i>0?i:null,this.applyCategoriaRules(),this.esSuperlcchs&&this._inst.Obtenerinstituciones().subscribe({next:n=>{this.institucionesInfo=n?.data||[],this.institucionesById=new Map((this.institucionesInfo||[]).map(c=>[String(c?.id??""),c]))},error:()=>{this.institucionesInfo=[],this.institucionesById=new Map}}),this.Cargarcontroles()},error:()=>{this.esSuperlcchs=!1,this.esAdministrativo=!1,this.institucionesIdSesion=null,this.applyCategoriaRules(),this.Cargarcontroles()}})}upperTrim(t){return(t??"").toString().trim().toUpperCase()}isCategoriaGlobal(t){return this.categoriasGlobales.includes(t)}puedeEditarFila(t){if(this.esSuperlcchs)return!0;let e=Number(this.institucionesIdSesion??0),i=Number(t?.instituciones_id??0);return e>0&&i===e}getNombreInstitucion(t){let e=(t?.NombreInstitucion??t?.nombre_institucion??t?.institucion_nombre??"").toString().trim();if(e)return e;let i=String(t?.instituciones_id??""),n=this.institucionesById.get(i);return(n?.Nombre??n?.nombre??"").toString().trim()}get categoriaActual(){return this.upperTrim(this.newcontroles?.get("Categoria")?.value)}get categoriaFiltroActual(){return this.upperTrim(this.categoriaFiltro)}get categoriasParaMostrar(){let t=this.categoriaFiltroActual;return t?this.categoriasOptions.filter(e=>this.upperTrim(e)===t):this.categoriasOptions}get showEdades(){return this.categoriaActual==="LVLCURSO"||this.categoriaActual==="TURNO"}categoriaUsaNivelCurso(t){let e=this.upperTrim(t);return e==="TIPOS DOCENTES"||e==="MODOS MATERIAS"||e==="RELACI\xD3N DOCENTE ESTUDIANTES"}get showNivelCurso(){let t=this.categoriaActual,e=(this.newcontroles?.get("NivelCurso")?.value??"").toString().trim();return this.categoriaUsaNivelCurso(t)||e.length>0}get labelNivelCurso(){switch(this.categoriaActual){case"TIPOS DOCENTES":case"MODOS MATERIAS":case"RELACI\xD3N DOCENTE ESTUDIANTES":return"Detalle";default:return"NivelCurso"}}get labelEdades(){return this.categoriaActual==="TURNO"?"Horas":"Edades"}get labelParaI(){switch(this.categoriaActual){case"LVLCURSO":return"Nivel/Curso";case"TURNO":return"Turno";case"EXPEDIDO":return"Sigla";default:return"Valor"}}applyCategoriaRules(){let t=this.categoriaActual;t&&this.newcontroles.get("Categoria")?.value!==t&&this.newcontroles.get("Categoria")?.setValue(t,{emitEvent:!1});let e=this.upperTrim(this.newcontroles.get("Estado")?.value);this.estadoOptions.includes(e)||this.newcontroles.get("Estado")?.setValue("ACTIVO",{emitEvent:!1});let i=this.upperTrim(this.newcontroles.get("Visibilidad")?.value);this.visibilidadOptions.includes(i)||this.newcontroles.get("Visibilidad")?.setValue("VISIBLE",{emitEvent:!1});let n=this.newcontroles.get("instituciones_id");n&&(this.esSuperlcchs?t&&this.isCategoriaGlobal(t)?(n.setValue("",{emitEvent:!1}),n.disable({emitEvent:!1})):n.enable({emitEvent:!1}):(this.institucionesIdSesion&&n.setValue(this.institucionesIdSesion,{emitEvent:!1}),n.disable({emitEvent:!1}))),this.showEdades||this.newcontroles.get("Edades")?.setValue("",{emitEvent:!1}),this.showNivelCurso||this.newcontroles.get("NivelCurso")?.setValue("",{emitEvent:!1})}buildPayloadFromForm(){let t=this.newcontroles.getRawValue(),e=ce({},t);return delete e.created_at,delete e.updated_at,this.showEdades||(e.Edades=""),this.showNivelCurso||(e.NivelCurso=""),e}setViewMode(t){this.viewMode=t,this.paginacontroles=1}onCategoriaFiltroChange(){this.paginacontroles=1}get controlesFiltrados(){let t=this.categoriaFiltroActual,e=this.upperTrim(this.filtertxtcontroles);return(this.controles||[]).filter(i=>{if(t&&this.upperTrim(i?.Categoria)!==t)return!1;if(!e)return!0;let n=[i?.instituciones_id,i?.Categoria,i?.ParaI,i?.Edades,i?.Estado,i?.Visibilidad].map(c=>(c??"").toString()).join(" ");return this.upperTrim(n).includes(e)})}getControlesPorCategoria(t){let e=this.upperTrim(t);return this.controlesFiltrados.filter(i=>this.upperTrim(i?.Categoria)===e)}labelEdadesCategoria(t){return this.upperTrim(t)==="TURNO"?"Horas":"Edades"}showEdadesCategoria(t){let e=this.upperTrim(t);return e==="LVLCURSO"||e==="TURNO"}abrirNuevoPorCategoria(t){this.resetcontroles();let e=this.upperTrim(t);e&&(this.newcontroles.get("Categoria")?.setValue(e),this.applyCategoriaRules()),this.modalGestioncontrolesRef=this._tools.openModal(this.modalgestioncontroles,"xl")}isTogglingEstado(t){return this.togglingEstadoIds.has(Number(t))}isTogglingVisibilidad(t){return this.togglingVisibilidadIds.has(Number(t))}toggleEstadoFila(t,e){if(e?.stopPropagation(),!this.puedeEditarFila(t)){this._tools.MostrarMensaje("warning","No autorizado");return}let i=Number(t?.id);if(!Number.isFinite(i)||i<=0||this.togglingEstadoIds.has(i))return;let n=this.upperTrim(t?.Estado),c=n==="ACTIVO"?"INACTIVO":"ACTIVO";this.togglingEstadoIds.add(i),t.Estado=c,this._cont.Modificarcontroles({id:i,Estado:c},i).subscribe({next:g=>{t.Estado=this.upperTrim(g?.data?.Estado??c)},error:g=>{console.error("Error toggling Estado",g),t.Estado=n},complete:()=>{this.togglingEstadoIds.delete(i)}})}toggleVisibilidadFila(t,e){if(e?.stopPropagation(),!this.puedeEditarFila(t)){this._tools.MostrarMensaje("warning","No autorizado");return}let i=Number(t?.id);if(!Number.isFinite(i)||i<=0||this.togglingVisibilidadIds.has(i))return;let n=this.upperTrim(t?.Visibilidad),c=n==="VISIBLE"?"OCULTO":"VISIBLE";this.togglingVisibilidadIds.add(i),t.Visibilidad=c,this._cont.Modificarcontroles({id:i,Visibilidad:c},i).subscribe({next:g=>{t.Visibilidad=this.upperTrim(g?.data?.Visibilidad??c)},error:g=>{console.error("Error toggling Visibilidad",g),t.Visibilidad=n},complete:()=>{this.togglingVisibilidadIds.delete(i)}})}setupCategoriaWatcher(){this.categoriaSub&&(this.categoriaSub.unsubscribe(),this.categoriaSub=void 0),this.categoriaSub=this.newcontroles.get("Categoria")?.valueChanges.subscribe(()=>{this.applyCategoriaRules()}),this.applyCategoriaRules()}closeMenu(){this._tools.close()}abrirMenucontroles(t,e){t.preventDefault(),t.stopPropagation();let i=[{label:"\u270F Editar",action:()=>this.Seleccionarcontroles(e.id)},{label:"\u{1F5D1}\uFE0F Eliminar",action:()=>this.Eliminarcontroles(e.id)}];this._tools.open(t.clientX,t.clientY,i)}Cargarcontroles(){this.isLoadingcontroles=!0,this._cont.Obtenercontroles().subscribe({next:t=>{let e=t.data||[];if(!this.esSuperlcchs&&this.institucionesIdSesion){let i=Number(this.institucionesIdSesion);this.controles=e.filter(n=>Number(n?.instituciones_id??0)===i)}else this.esSuperlcchs?this.controles=e:this.controles=[];this.collectionSizecontroles=this.controles.length,this.isLoadingcontroles=!1},error:t=>{console.error("Error al cargar controles",t),this.controles=[],this.collectionSizecontroles=0,this.isLoadingcontroles=!1}})}AgregarModificarcontroles(){if(this.newcontroles.invalid){this.ValidacionTodoElementocontroles(),this._tools.MostrarMensajeFrmIncompleto(),this.AnimacionCargabtnModalcontroles=!1;return}this.AnimarCargaTablacontroles(),this.AnimacionCargabtnModalcontroles=!0,this._tools.MostrarMensajeLoading(),this.newcontrolesAnteriorAccion.patchValue(this.newcontroles.getRawValue());let t=this.newcontroles.controls.id.value,e=this.buildPayloadFromForm();t?this._cont.Modificarcontroles(e,e.id).subscribe(i=>{this.Cargarcontroles(),this.resetcontroles(),this.AnimacionCargabtnModalcontroles=!1,this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL MODIFICAR controles",i),this.AnimacionCargabtnModalcontroles=!1,this._tools.MostrarMensajeError()}):this._cont.Agregarcontroles(e).subscribe(i=>{this.Cargarcontroles(),this.resetcontroles(),this.AnimacionCargabtnModalcontroles=!1,this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL A\xD1ADIR controles",i),this.AnimacionCargabtnModalcontroles=!1,this._tools.MostrarMensajeError()})}Seleccionarcontroles(t){if(this._tools.MostrarMensajeLoading(),!t)return;let e=this.controles.find(i=>i.id===t);if(e){if(!this.puedeEditarFila(e)){this._tools.MostrarMensaje("warning","No autorizado");return}this._cont.Seleccionarcontroles(t).subscribe(i=>{Object.keys(this.newcontroles.controls).forEach(n=>{this.newcontroles.controls[n].setValue(i.data[n])}),this.newcontrolesAnteriorAccion.patchValue(this.newcontroles.getRawValue()),this.applyCategoriaRules(),this.modalGestioncontrolesRef=this._tools.openModal(this.modalgestioncontroles,"xl"),this._tools.MostrarMensajeSuccess()},i=>{console.log("ERROR AL SELECCIONAR controles",i),this._tools.MostrarMensajeError()})}}Eliminarcontroles(t){let e=this.controles.find(i=>i.id===t);if(e&&!this.puedeEditarFila(e)){this._tools.MostrarMensaje("warning","No autorizado");return}this._tools.mostrarMensajeConfirm("\xBFSEGURO QUE DESEA ELIMINAR?","SE ELIMINARA EL DATO Y NO SE PODR\xC1 RECUPERAR EL DATO","warning","SI, ESTOY SEGURO","NO").then(i=>{i&&(this._tools.MostrarMensajeLoading(),this._cont.Eliminarcontroles(t).subscribe(n=>{this.Cargarcontroles(),this._tools.MostrarMensajeSuccess()},n=>{console.log("ERROR AL ELIMINAR controles",n),this._tools.MostrarMensajeError()}))})}resetcontroles(){this.newcontroles=this._cont.createFormGroupcontroles(),this.setupCategoriaWatcher(),this._tools.closeModal(this.modalGestioncontrolesRef)}AutoCompletarLastcontroles(){this.newcontroles.patchValue(this.newcontrolesAnteriorAccion.getRawValue()),this.newcontroles.patchValue({id:0})}AnimarCargaTablacontroles(){this.controles=[],this.isLoadingcontroles=!0}ValidacioncontrolesxElemento(t){return this._tools.obtenerValidationClass(this.newcontroles,t)}ValidacionTodoElementocontroles(){Object.values(this.newcontroles.controls).forEach(t=>{t.markAsTouched(),t.markAsDirty()})}onPageSizeChangecontroles(){this.paginacontroles=1}sortBycontroles(t,e){this.sortColumnscontroles=this._tools.handleSort(t,e,this.sortColumnscontroles),this.controles=this._tools.applyMultiSort(this.controles,this.sortColumnscontroles)}isSortedcontroles(t){return this._tools.isSorted(this.sortColumnscontroles,t)}getSortDircontroles(t){return this._tools.getSortDirection(this.sortColumnscontroles,t)}};te.\u0275fac=function(e){return new(e||te)(M(nt),M(ye),M(Se),M(et))},te.\u0275cmp=k({type:te,selectors:[["app-controles"]],viewQuery:function(e,i){if(e&1&&_e(Bt,7),e&2){let n;ge(n=fe())&&(i.modalgestioncontroles=n.first)}},hostBindings:function(e,i){e&1&&_("click",function(){return i.closeMenu()},ue)},standalone:!1,decls:41,vars:11,consts:[["modalgestioncontroles",""],["emptyCat",""],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"button","col-sm-3","d-flex","justify-content-start"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],["width","30px","height","30px",3,"options"],[1,"dir-part"],[1,"col-sm-3","ms-auto","d-flex","justify-content-end"],[1,"input-group"],[1,"input-group-text"],[1,"form-floating"],["type","text","placeholder","Buscar","title","Filtrar/Buscar",1,"form-control",3,"input","ngModelChange","ngModel"],[1,"row","mt-3","align-items-end",2,"row-gap","10px"],[1,"col-sm-4"],["role","group","aria-label","Modo",1,"btn-group"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"col-sm-5"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[3,"value"],[1,"mt-4"],["class","alert alert-secondary","style","margin-bottom: 0;",4,"ngIf"],["class","row","style","row-gap: 14px;",4,"ngIf"],[1,"alert","alert-secondary",2,"margin-bottom","0"],[1,"row",2,"row-gap","14px"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],["class","card",4,"ngIf"],[1,"card"],[1,"card-header","d-flex","align-items-center","justify-content-between","col-sm-12",2,"gap","10px"],[1,"col-sm-8"],[1,"fw-bold","text-center","text-danger"],[1,"small","text-secondary","col-sm-2"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"card-body",2,"padding","0"],["class","list-group list-group-flush",4,"ngIf","ngIfElse"],[1,"list-group","list-group-flush"],["class","list-group-item d-flex align-items-center justify-content-between flex-row","style","gap: 12px;",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","align-items-center","justify-content-between","flex-row",2,"gap","12px"],[1,"d-flex","align-items-center","flex-wrap","justify-content-between",2,"gap","12px","min-width","0","width","100%"],[1,"fw-semibold","text-truncate",2,"max-width","180px"],["class","small text-secondary",4,"ngIf"],[1,"d-flex","align-items-center","ms-auto",2,"gap","8px"],[1,"small","text-secondary"],["type","button","title","Cambiar Estado",1,"btn","btn-sm",3,"click","ngClass","disabled"],["type","button","title","Cambiar Visibilidad",1,"btn","btn-sm",3,"click","ngClass","disabled"],[1,"d-flex",2,"gap","8px","flex-shrink","0"],["title","Editar",1,"btn","btn-outline-warning","btn-sm",3,"click"],["title","Eliminar",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"p-3","text-center","text-secondary"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,""],[1,"text-center"],[2,"user-select","none",3,"click"],["style","user-select:none;",4,"ngIf"],[4,"ngIf"],["style","cursor: pointer;",3,"contextmenu",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-3"],["previousLabel","Anterior","nextLabel","Siguiente",3,"pageChange","page","collectionSize","pageSize","maxSize","rotate","ellipses","boundaryLinks"],[1,"form-select",2,"width","auto",3,"ngModelChange","change","ngModel"],[2,"user-select","none"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[2,"cursor","pointer",3,"contextmenu"],[1,"text-center","d-flex","justify-content-center","align-items-center",2,"gap","5px"],["title","Modificar informaci\xF3n",1,"btn","btn-outline-warning","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src",4,"ngIf"],["width","30px","height","35px",3,"options",4,"ngIf"],["title","Eliminar informaci\xF3n",1,"btn","btn-outline-danger","btn-sm","d-flex","justify-content-center","align-items-center","p-0",2,"width","40px","height","40px","overflow","hidden",3,"click","mouseenter","mouseleave"],["width","20",3,"src"],["width","30px","height","35px",3,"options"],[1,"modal-header"],[1,"modal-title"],["type","button","title","cerrar",1,"btn-close",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup"],["class","form-floating mb-3 col-sm-12",4,"ngIf"],[1,"form-floating","mb-3","col-sm-12"],["formControlName","Categoria",1,"form-select"],["type","text","placeholder","","formControlName","ParaI",1,"form-control",2,"text-transform","uppercase"],["formControlName","Estado",1,"form-select"],["formControlName","Visibilidad",1,"form-select"],[1,"modal-footer"],["class","button d-flex justify-content-start",4,"ngIf"],[1,"button","me-2"],["title","Cancelar y cerrar","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],[1,"button"],["class","btn mouse-dir success","title","Procesando informaci\xF3n",3,"disabled","click",4,"ngIf"],["class","btn mouse-dir primary d-flex align-items-center","style"," gap: 8px;","title","Accionar",3,"click",4,"ngIf"],["formControlName","instituciones_id",1,"form-select"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["type","text","placeholder","","formControlName","NivelCurso",1,"form-control",2,"text-transform","uppercase"],["type","text","placeholder","","formControlName","Edades",1,"form-control",2,"text-transform","uppercase"],[1,"button","d-flex","justify-content-start"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n","class","btn mouse-dir secondary d-flex align-items-center","style"," gap: 8px;",3,"click",4,"ngIf"],["title","Se Autocompletar\xE1 la ultima informaci\xF3n",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],["title","Cancelar y cerrar",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["title","Procesando informaci\xF3n",1,"btn","mouse-dir","success",3,"click","disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["title","Accionar",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"]],template:function(e,i){if(e&1){let n=h();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1",5),l(4,"Gesti\xF3n de controles"),a(),o(5,"p",6),l(6,"Administra los controles (selects/autocompletados) del sistema"),a()()()(),o(7,"div",3)(8,"div",7)(9,"button",8),_("click",function(){u(n);let g=se(40);return p(i.modalGestioncontrolesRef=i._tools.openModal(g,"xl"))}),x(10,"ng-lottie",9),o(11,"span"),l(12,"A\xF1adir control"),a(),x(13,"span",10),a()(),o(14,"div",11)(15,"div",12)(16,"span",13),x(17,"ng-lottie",9),a(),o(18,"div",14)(19,"input",15),_("input",function(){return u(n),p(i.paginacontroles=1)}),y("ngModelChange",function(g){return u(n),S(i.filtertxtcontroles,g)||(i.filtertxtcontroles=g),p(g)}),a(),o(20,"label"),l(21,"Buscar"),a()()()()(),o(22,"div",16)(23,"div",17)(24,"div",18)(25,"button",19),_("click",function(){return u(n),p(i.setViewMode("interactive"))}),l(26,"Modo interactivo"),a(),o(27,"button",19),_("click",function(){return u(n),p(i.setViewMode("table"))}),l(28,"Modo tabla"),a()()(),o(29,"div",20)(30,"div",14)(31,"select",21),y("ngModelChange",function(g){return u(n),S(i.categoriaFiltro,g)||(i.categoriaFiltro=g),p(g)}),_("change",function(){return u(n),p(i.onCategoriaFiltroChange())}),o(32,"option",22),l(33,"TODAS"),a(),b(34,jt,2,2,"option",23),a(),o(35,"label"),l(36,"Filtrar por categor\xEDa"),a()()()(),b(37,Zt,3,2,"div",24)(38,ci,31,17,"div",24)(39,Ei,37,13,"ng-template",null,0,K)}e&2&&(s(10),d("options",i._tools.optionsAdicionar),s(7),d("options",i._tools.optionslupa),s(2),E("ngModel",i.filtertxtcontroles),s(6),P("active",i.viewMode==="interactive"),s(2),P("active",i.viewMode==="table"),s(4),E("ngModel",i.categoriaFiltro),s(3),d("ngForOf",i.categoriasOptions),s(3),d("ngIf",i.viewMode==="interactive"),s(),d("ngIf",i.viewMode==="table"))},dependencies:[be,L,F,Ce,$,U,D,j,G,xe,B,Xe,Ye,it,tt,We],encapsulation:2});var Oe=te;var Si=["modalListasPreliminaresCursos"],N=()=>({standalone:!0});function yi(r,t){if(r&1&&(o(0,"option",50),l(1),a()),r&2){let e=t.$implicit;d("value",e.id),s(),f(e.Anio)}}function Ii(r,t){if(r&1){let e=h();o(0,"div",51)(1,"div",19)(2,"label",23),l(3,"\xC1rea:"),a(),o(4,"input",52),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.AreaManual,n)||(c.AreaManual=n),p(n)}),a()(),o(5,"div",19)(6,"label",23),l(7,"Carrera:"),a(),o(8,"input",52),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.CarreraManual,n)||(c.CarreraManual=n),p(n)}),a()(),o(9,"div",19)(10,"label",23),l(11,"Resoluci\xF3n:"),a(),o(12,"input",52),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.ResolucionManual,n)||(c.ResolucionManual=n),p(n)}),a()(),o(13,"div",19)(14,"label",23),l(15,"Texto Nivel:"),a(),o(16,"input",52),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.NivelManual,n)||(c.NivelManual=n),p(n)}),a()(),o(17,"div",19)(18,"label",23),l(19,"Bicentenario:"),a(),o(20,"input",52),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.BicentenarioManual,n)||(c.BicentenarioManual=n),p(n)}),a()(),o(21,"div",53)(22,"div",34)(23,"input",54),y("ngModelChange",function(n){u(e);let c=m(2);return S(c.ContadorManual,n)||(c.ContadorManual=n),p(n)}),a(),o(24,"label",55),l(25," \xBFCon contador de P\xE1gina? "),a()()()()}if(r&2){let e=m(2);s(4),d("ngModelOptions",O(12,N)),E("ngModel",e.AreaManual),s(4),d("ngModelOptions",O(13,N)),E("ngModel",e.CarreraManual),s(4),d("ngModelOptions",O(14,N)),E("ngModel",e.ResolucionManual),s(4),d("ngModelOptions",O(15,N)),E("ngModel",e.NivelManual),s(4),d("ngModelOptions",O(16,N)),E("ngModel",e.BicentenarioManual),s(3),d("ngModelOptions",O(17,N)),E("ngModel",e.ContadorManual)}}function Ti(r,t){r&1&&(o(0,"span"),l(1,"Generar"),a())}function Mi(r,t){r&1&&(o(0,"span"),l(1,"Generando..."),a())}function wi(r,t){if(r&1){let e=h();o(0,"div",12)(1,"div",13)(2,"span",14),x(3,"i",15),a(),o(4,"h2",16),l(5,"CUADRO DE INSCRIPCIONES DE ALUMNOS - GENERAL"),a()(),o(6,"div",17)(7,"p",9),l(8,"Ac\xE1 obtendremos la lista del Cuadro de Inscripciones de Alumnos Nuevos y Antiguos de la Instituci\xF3n."),a(),o(9,"form",18)(10,"div",19)(11,"label",20),l(12,"Por Favor introducir Numero de Paginaci\xF3n Inicial:"),a(),o(13,"input",21),y("ngModelChange",function(n){u(e);let c=m();return S(c.numeroPaginaCuadro,n)||(c.numeroPaginaCuadro=n),p(n)}),a()(),o(14,"div",22)(15,"label",23),l(16,"Seleccione Gesti\xF3n"),a(),o(17,"select",24),y("ngModelChange",function(n){u(e);let c=m();return S(c.gestion_id_seleccionado,n)||(c.gestion_id_seleccionado=n),p(n)}),o(18,"optgroup",25),b(19,yi,2,2,"option",26),a()()(),o(20,"div",27)(21,"label",23),l(22,"Seleccione Nivel"),a(),o(23,"select",28),y("ngModelChange",function(n){u(e);let c=m();return S(c.NivelCuadro,n)||(c.NivelCuadro=n),p(n)}),o(24,"optgroup",29)(25,"option",30),l(26,"MIXTO (TODOS)"),a(),o(27,"option",31),l(28,"TECNICO SUPERIOR"),a(),o(29,"option",32),l(30,"CAPACITACI\xD3N"),a()()()(),o(31,"div",33)(32,"div",34)(33,"input",35),y("ngModelChange",function(n){u(e);let c=m();return S(c.showContenidoManual,n)||(c.showContenidoManual=n),p(n)}),a(),o(34,"label",36),l(35," Mostrar/Ocultar Contenido Manual "),a()()(),o(36,"div",37)(37,"div",34)(38,"input",38),y("ngModelChange",function(n){u(e);let c=m();return S(c.incluirSinAsignar,n)||(c.incluirSinAsignar=n),p(n)}),a(),o(39,"label",39),l(40," INCLUIR LOS SIN ASIGNACIONES "),a()()()(),b(41,Ii,26,18,"div",40),o(42,"div",41)(43,"div",42)(44,"button",43),_("click",function(){u(e);let n=m();return p(n.abrirModalListasPreliminaresCursos())}),x(45,"i",44),o(46,"span"),l(47,"LISTAS POR CURSO"),a()(),o(48,"button",45),_("click",function(){u(e);let n=m();return p(n.GenerarCuadroInscripciones2026())}),je(),o(49,"svg",46),x(50,"path",47)(51,"path",48),a(),b(52,Ti,2,0,"span",49)(53,Mi,2,0,"span",49),a()()()()()}if(r&2){let e=m();s(13),d("ngModelOptions",O(16,N)),E("ngModel",e.numeroPaginaCuadro),s(4),d("ngModelOptions",O(17,N)),E("ngModel",e.gestion_id_seleccionado),s(2),d("ngForOf",e.anio),s(4),d("ngModelOptions",O(18,N)),E("ngModel",e.NivelCuadro),s(10),d("ngModelOptions",O(19,N)),E("ngModel",e.showContenidoManual),s(5),d("ngModelOptions",O(20,N)),E("ngModel",e.incluirSinAsignar),s(3),d("ngIf",e.showContenidoManual),s(3),d("disabled",e.isLoadingCursosParaListas||e.isGenerandoListasPreliminares),s(4),d("disabled",e.isGenerandoCuadro),s(4),d("ngIf",!e.isGenerandoCuadro),s(),d("ngIf",e.isGenerandoCuadro)}}function Pi(r,t){r&1&&(o(0,"div",67),l(1,"Incluye SIN ASIGNAR"),a())}function Oi(r,t){r&1&&(o(0,"div",68),l(1,"Solo asignados"),a())}function Ai(r,t){r&1&&(o(0,"div",69)(1,"div",70),l(2,"Cargando cursos..."),a()())}function Ni(r,t){r&1&&(o(0,"div",71),l(1," No se encontraron cursos para el filtro actual. "),a())}function Vi(r,t){if(r&1){let e=h();o(0,"tr")(1,"td")(2,"input",79),y("ngModelChange",function(n){let c=u(e).$implicit;return S(c.selected,n)||(c.selected=n),p(n)}),a()(),o(3,"td",80),l(4),a(),o(5,"td"),l(6),a(),o(7,"td",77),l(8),a()()}if(r&2){let e=t.$implicit;s(2),E("ngModel",e.selected),d("ngModelOptions",O(5,N)),s(2),f(e.curso),s(2),f(e.paraleloLabel),s(2),f(e.total)}}function ki(r,t){if(r&1){let e=h();o(0,"div",72)(1,"table",73)(2,"thead",74)(3,"tr")(4,"th",75)(5,"input",76),_("change",function(n){u(e);let c=m(2);return p(c.toggleSeleccionarTodosCursosParaListas(n.target.checked))}),a()(),o(6,"th"),l(7,"Curso"),a(),o(8,"th"),l(9,"Paralelo"),a(),o(10,"th",77),l(11,"Total"),a()()(),o(12,"tbody"),b(13,Vi,9,6,"tr",78),a()()()}if(r&2){let e=m(2);s(13),d("ngForOf",e.cursosParaListas)}}function Ri(r,t){r&1&&(o(0,"span"),l(1,"Generar PDF"),a())}function Li(r,t){r&1&&(o(0,"span"),l(1,"Generando..."),a())}function Fi(r,t){if(r&1){let e=h();o(0,"div",5)(1,"h5",6),l(2,"LISTAS PRELIMINARES POR CURSO"),a(),o(3,"button",56),_("click",function(){let n=u(e).$implicit;return p(n.dismiss("close"))}),a()(),o(4,"div",8)(5,"div",57)(6,"div",58),l(7),a(),b(8,Pi,2,0,"div",59)(9,Oi,2,0,"div",60),a(),b(10,Ai,3,0,"div",61)(11,Ni,2,0,"div",62)(12,ki,14,1,"div",63),a(),o(13,"div",10)(14,"div",64),l(15),a(),o(16,"button",65),_("click",function(){let n=u(e).$implicit;return p(n.dismiss("cancel"))}),l(17,"Cancelar"),a(),o(18,"button",66),_("click",function(){u(e);let n=m();return p(n.generarListasPreliminaresSeleccionadas())}),b(19,Ri,2,0,"span",49)(20,Li,2,0,"span",49),a()()}if(r&2){let e=m();s(7),C("Gesti\xF3n: ",e.getGestionLabel()),s(),d("ngIf",e.incluirSinAsignar),s(),d("ngIf",!e.incluirSinAsignar),s(),d("ngIf",e.isLoadingCursosParaListas),s(),d("ngIf",!e.isLoadingCursosParaListas&&e.cursosParaListas.length===0),s(),d("ngIf",!e.isLoadingCursosParaListas&&e.cursosParaListas.length>0),s(3),C("Seleccionados: ",e.getCursosParaListasSeleccionadosCount()),s(3),d("disabled",e.isGenerandoListasPreliminares||e.getCursosParaListasSeleccionadosCount()===0),s(),d("ngIf",!e.isGenerandoListasPreliminares),s(),d("ngIf",e.isGenerandoListasPreliminares)}}var ie=class ie{constructor(t,e,i,n){this._repo=t;this._anios=e;this._infoest=i;this._tools=n;this.numeroPaginaCuadro=1;this.anio=[];this.gestion_id_seleccionado="";this.NivelCuadro="MIXTO";this.incluirSinAsignar=!0;this.isGenerandoCuadro=!1;this.showContenidoManual=!1;this.AreaManual="";this.CarreraManual="";this.ResolucionManual="";this.NivelManual="";this.BicentenarioManual="";this.ContadorManual=!1;this.cursosParaListas=[];this.isLoadingCursosParaListas=!1;this.isGenerandoListasPreliminares=!1}ngOnInit(){this.cargarAnios()}cargarAnios(){this._anios.ObtenerAniosConPredeterminado().subscribe({next:t=>{this.anio=t?.anios||[];let e=t?.predeterminado??null,i=Number(this.gestion_id_seleccionado);(Number.isFinite(i)&&i>0?(this.anio||[]).some(c=>Number(c?.id)===i):!1)||(e?.id?this.gestion_id_seleccionado=e.id:this.anio?.length?this.gestion_id_seleccionado=this.anio[0]?.id??"":this.gestion_id_seleccionado="")},error:t=>{console.error("Error al cargar anios",t),this.anio=[]}})}getGestionLabel(){let t=Number(this.gestion_id_seleccionado),e=(this.anio||[]).find(n=>Number(n?.id)===t);return(e?.Anio??e?.anio??"").toString().trim()||(Number.isFinite(t)&&t>0?String(t):"")}GenerarCuadroInscripciones2026(){if(this.gestion_id_seleccionado===""||this.gestion_id_seleccionado===null||this.gestion_id_seleccionado===void 0){this._tools.MostrarMensaje("warning","Seleccione una gesti\xF3n/a\xF1o");return}if(this.isGenerandoCuadro)return;this.isGenerandoCuadro=!0;let t=Number(this.numeroPaginaCuadro||1),e=Number(this.gestion_id_seleccionado),i=this.NivelCuadro||"MIXTO";try{this._repo.GenerarCuadroInscripciones2026(t,e,i,this.incluirSinAsignar)}catch(n){console.error(n),this._tools.MostrarMensaje("error","No se pudo generar el cuadro de inscripciones")}finally{setTimeout(()=>this.isGenerandoCuadro=!1,1200)}}abrirModalListasPreliminaresCursos(){if(this.gestion_id_seleccionado===""||this.gestion_id_seleccionado===null||this.gestion_id_seleccionado===void 0){this._tools.MostrarMensaje("warning","Seleccione una gesti\xF3n/a\xF1o");return}let t=Number(this.gestion_id_seleccionado);if(!Number.isFinite(t)||t<=0){this._tools.MostrarMensaje("warning","Seleccione un a\xF1o v\xE1lido");return}this.cursosParaListas=[],this.isLoadingCursosParaListas=!0,this.modalListasPreliminaresCursosRef=this._tools.openModal(this.modalListasPreliminaresCursos,"lg"),this._infoest.ObtenerEstadisticasInscripciones({anio_id:t,include_sin_asignar:this.incluirSinAsignar?1:0}).subscribe({next:e=>{let i=Array.isArray(e?.por_curso_paralelo)?e.por_curso_paralelo:[];this.cursosParaListas=i.map(n=>{let c=(n?.curso??"").toString().trim(),g=(n?.paralelo??"").toString().trim(),v=(n?.paralelo_label??(g||"SIN DETERMINAR")).toString().trim(),I=Number(n?.total??0);return{curso:c,paralelo:g,paraleloLabel:v||"SIN DETERMINAR",total:Number.isFinite(I)?I:0,selected:!1}}).filter(n=>n.curso!=="").sort((n,c)=>{let g=n.curso.localeCompare(c.curso);return g!==0?g:(n.paraleloLabel||"").localeCompare(c.paraleloLabel||"")}),this.isLoadingCursosParaListas=!1},error:e=>{console.error(e),this.cursosParaListas=[],this.isLoadingCursosParaListas=!1,this._tools.MostrarMensaje("error","No se pudieron cargar los cursos")}})}toggleSeleccionarTodosCursosParaListas(t){(this.cursosParaListas||[]).forEach(e=>e.selected=t)}getCursosParaListasSeleccionadosCount(){return(this.cursosParaListas||[]).filter(t=>!!t.selected).length}generarListasPreliminaresSeleccionadas(){return de(this,null,function*(){if(this.gestion_id_seleccionado===""||this.gestion_id_seleccionado===null||this.gestion_id_seleccionado===void 0){this._tools.MostrarMensaje("warning","Seleccione una gesti\xF3n/a\xF1o");return}let t=Number(this.gestion_id_seleccionado);if(!Number.isFinite(t)||t<=0){this._tools.MostrarMensaje("warning","Seleccione un a\xF1o v\xE1lido");return}let e=(this.cursosParaListas||[]).filter(i=>!!i.selected).map(i=>({curso:i.curso,paralelo:i.paralelo}));if(e.length===0){this._tools.MostrarMensaje("warning","Seleccione al menos un curso");return}if(!this.isGenerandoListasPreliminares){this.isGenerandoListasPreliminares=!0;try{yield this._repo.GenerarListaPreliminarAlumnos2026(t,e,null,this.incluirSinAsignar);try{this.modalListasPreliminaresCursosRef?.close?.()}catch{}}catch(i){console.error(i),this._tools.MostrarMensaje("error","No se pudieron generar las listas")}finally{this.isGenerandoListasPreliminares=!1}}})}};ie.\u0275fac=function(e){return new(e||ie)(M(at),M(J),M(Ie),M(ye))},ie.\u0275cmp=k({type:ie,selectors:[["app-documentosimportantes"]],viewQuery:function(e,i){if(e&1&&_e(Si,7),e&2){let n;ge(n=fe())&&(i.modalListasPreliminaresCursos=n.first)}},standalone:!1,decls:15,vars:1,consts:[["modalListasPreliminaresCursos",""],["class","card shadow mb-4",4,"ngIf"],["id","modalGeneracionCuadroEstudiantes","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","btn-close-white"],[1,"modal-body"],[1,"mb-4"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],[1,"card","shadow","mb-4"],[1,"card-header","bg-primary","text-white","d-flex","align-items-center"],[1,"me-2"],[1,"bi","bi-file-earmark-text"],[1,"mb-0","fw-bold","fs-4"],[1,"card-body"],[1,"row","g-3","align-items-center","mb-3"],[1,"col-md-4"],[1,"form-label","fw-bold","fst-italic","text-warning"],["type","number","placeholder","NUMERO PAGINA",1,"form-control",3,"ngModelChange","ngModelOptions","ngModel"],[1,"col-md-2"],[1,"form-label"],["name","Curso_id","id","Curso_idModal",1,"form-select","bg-danger","bg-opacity-25",3,"ngModelChange","ngModelOptions","ngModel"],["label","Seleccione Gestion"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"form-select","bg-danger","bg-opacity-25",3,"ngModelChange","ngModelOptions","ngModel"],["label","Seleccione Nivel"],["value","MIXTO"],["value","TECNICO SUPERIOR"],["value","CAPACITACI\xD3N"],[1,"col-md-3","d-flex","align-items-end"],[1,"form-check"],["type","checkbox","id","toggleContent",1,"form-check-input",3,"ngModelChange","ngModelOptions","ngModel"],["for","toggleContent",1,"form-check-label"],[1,"col-md-12"],["type","checkbox","id","chkSinAsignarCuadro",1,"form-check-input",3,"ngModelChange","ngModelOptions","ngModel"],["for","chkSinAsignarCuadro",1,"form-check-label","text-danger","fw-bold"],["class","row g-3",4,"ngIf"],[1,"d-flex","justify-content-end","mt-4"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-outline-primary","btn-lg","d-flex","align-items-center","gap-2",3,"click","disabled"],[1,"bi","bi-list-check"],["type","button",1,"btn","btn-success","btn-lg","d-flex","align-items-center","gap-2",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","width","28","height","28","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-download"],["d","M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"],["d","M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"],[4,"ngIf"],[3,"value"],[1,"row","g-3"],["type","text",1,"form-control",3,"ngModelChange","ngModelOptions","ngModel"],[1,"col-md-4","d-flex","align-items-center"],["type","checkbox","id","contadormanual",1,"form-check-input",3,"ngModelChange","ngModelOptions","ngModel"],["for","contadormanual",1,"form-check-label"],["type","button","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"d-flex","flex-wrap","gap-2","align-items-center"],[1,"badge","bg-secondary"],["class","badge bg-danger",4,"ngIf"],["class","badge bg-light text-dark",4,"ngIf"],["class","mt-3",4,"ngIf"],["class","alert alert-warning mt-3",4,"ngIf"],["class","table-responsive mt-3","style","max-height: 55vh;",4,"ngIf"],[1,"me-auto","text-muted"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"badge","bg-danger"],[1,"badge","bg-light","text-dark"],[1,"mt-3"],[1,"text-center","py-4"],[1,"alert","alert-warning","mt-3"],[1,"table-responsive","mt-3",2,"max-height","55vh"],[1,"table","table-sm","table-hover","align-middle"],[1,"table-light",2,"position","sticky","top","0","z-index","1"],[2,"width","46px"],["type","checkbox",1,"form-check-input",3,"change"],[1,"text-end"],[4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel","ngModelOptions"],[1,"fw-semibold"]],template:function(e,i){e&1&&(b(0,wi,54,21,"div",1)(1,Fi,21,10,"ng-template",null,0,K),o(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),l(8,"FORMULARIO - CUADRO ESTUDIANTES"),a(),x(9,"button",7),a(),o(10,"div",8),x(11,"div",9),a(),o(12,"div",10)(13,"button",11),l(14,"Cancelar"),a()()()()()),e&2&&d("ngIf",!0)},dependencies:[L,F,Ce,$,U,D,Ee,he,j,G,xe,B,qe],encapsulation:2});var Ae=ie;var H=class H{constructor(t){this.http=t;this.ruta=ve.ruta}ObtenerAsignacionesPorMaterias(t){let e=new Z;return Object.entries(t??{}).forEach(([i,n])=>{if(n==null)return;let c=String(n).trim();c&&(e=e.set(i,c))}),this.http.get(this.ruta+"api/estadisticas/asignaciones/materias",{params:e})}ObtenerEstudiantesAsignados(t){let e=new Z;return Object.entries(t??{}).forEach(([i,n])=>{if(n==null)return;let c=String(n).trim();c&&(e=e.set(i,c))}),this.http.get(this.ruta+"api/estadisticas/asignaciones/materias/estudiantes",{params:e})}ObtenerOpcionesResolucionNivel(t){let e=new Z;return Object.entries(t??{}).forEach(([i,n])=>{if(n==null)return;let c=String(n).trim();c&&(e=e.set(i,c))}),this.http.get(this.ruta+"api/estadisticas/docentes/opciones-resolucion",{params:e})}ObtenerConteoDocentesAsignados(t){let e=new Z;return Object.entries(t??{}).forEach(([i,n])=>{if(n==null)return;let c=String(n).trim();c&&(e=e.set(i,c))}),this.http.get(this.ruta+"api/estadisticas/docentes/asignados",{params:e})}ObtenerEstudiantesDocenteAsignados(t){let e=new Z;return Object.entries(t??{}).forEach(([i,n])=>{if(n==null)return;let c=String(n).trim();c&&(e=e.set(i,c))}),this.http.get(this.ruta+"api/estadisticas/docentes/asignados/estudiantes",{params:e})}};H.\u0275fac=function(e){return new(e||H)(Be(Qe))},H.\u0275prov=Ge({token:H,factory:H.\u0275fac,providedIn:"root"});var ne=H;function Di(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e.id),s(),f(e.Anio)}}function Gi(r,t){if(r&1&&(o(0,"option",25),l(1),a()),r&2){let e=t.$implicit;d("value",e),s(),f(e)}}function Bi(r,t){r&1&&x(0,"span",32)}function ji(r,t){if(r&1){let e=h();o(0,"div",26)(1,"div",27)(2,"button",28),_("click",function(){u(e);let n=m();return p(n.cargarEstadisticas())}),b(3,Bi,1,0,"span",29),l(4," Recargar estad\xEDsticas "),a()(),o(5,"div",30)(6,"div",31),l(7,"Registros: "),o(8,"strong"),l(9),a()()()()}if(r&2){let e=m();s(2),d("disabled",e.isLoading),s(),d("ngIf",e.isLoading),s(6),f(e.totalFiltrado)}}function $i(r,t){r&1&&(o(0,"th"),l(1,"Materia"),a())}function Ui(r,t){r&1&&(o(0,"th"),l(1,"Materias (diferenciado)"),a())}function zi(r,t){if(r&1&&(o(0,"tr")(1,"td",33)(2,"div",34)(3,"span",35),l(4,"Cargando..."),a()()()()),r&2){let e=m();s(),R("colspan",e.modo==="NORMAL"?18:e.modo==="SIMPLE_DIFERENCIADO"?17:16)}}function Ki(r,t){if(r&1&&(o(0,"tr")(1,"td",36),l(2," No hay estad\xEDsticas para la gesti\xF3n seleccionada. "),a()()),r&2){let e=m();s(),R("colspan",e.modo==="NORMAL"?18:e.modo==="SIMPLE_DIFERENCIADO"?17:16)}}function Wi(r,t){if(r&1&&(o(0,"td"),l(1),a()),r&2){let e=m().$implicit;s(),f(e.NombreMateria)}}function Hi(r,t){if(r&1&&(o(0,"td"),l(1),a()),r&2){let e=m().$implicit;s(),f(e.Materias)}}function Qi(r,t){if(r&1){let e=h();o(0,"tr")(1,"td",19),l(2),a(),o(3,"td",37),l(4),o(5,"div",38),l(6),a()(),o(7,"td"),l(8),a(),o(9,"td",19),l(10),o(11,"div",38),l(12),a()(),b(13,Wi,2,1,"td",20)(14,Hi,2,1,"td",20),o(15,"td",21)(16,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"NUEVO","MASCULINO","Nuevos M"))}),l(17),a()(),o(18,"td",21)(19,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"NUEVO","FEMENINO","Nuevos F"))}),l(20),a()(),o(21,"td",21)(22,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"NUEVO","","Total nuevos"))}),l(23),a()(),o(24,"td",21)(25,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"ANTIGUO","MASCULINO","Antiguos M"))}),l(26),a()(),o(27,"td",21)(28,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"ANTIGUO","FEMENINO","Antiguos F"))}),l(29),a()(),o(30,"td",21)(31,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"ANTIGUO","","Total antiguos"))}),l(32),a()(),o(33,"td",21)(34,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"","MASCULINO","Total M"))}),l(35),a()(),o(36,"td",21)(37,"button",39),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"","FEMENINO","Total F"))}),l(38),a()(),o(39,"td",40)(40,"button",41),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalCantidad(n,"","","Total general"))}),l(41),a()()()}if(r&2){let e=t.$implicit,i=t.index,n=m();s(2),f(i+1),s(2),C("",e.Anio," "),s(2),f(e.Resolucion),s(2),f(e.LvlCurso),s(2),C("",e.Paralelo," "),s(2),f(e.Turno),s(),d("ngIf",n.modo==="NORMAL"),s(),d("ngIf",n.modo==="SIMPLE_DIFERENCIADO"),s(2),d("title","Ver estudiantes ("+e.Nuevos_M+")"),s(),f(e.Nuevos_M),s(2),d("title","Ver estudiantes ("+e.Nuevos_F+")"),s(),f(e.Nuevos_F),s(2),d("title","Ver estudiantes ("+e.Total_Nuevos+")"),s(),f(e.Total_Nuevos),s(2),d("title","Ver estudiantes ("+e.Antiguos_M+")"),s(),f(e.Antiguos_M),s(2),d("title","Ver estudiantes ("+e.Antiguos_F+")"),s(),f(e.Antiguos_F),s(2),d("title","Ver estudiantes ("+e.Total_Antiguos+")"),s(),f(e.Total_Antiguos),s(2),d("title","Ver estudiantes ("+e.Total_M+")"),s(),f(e.Total_M),s(2),d("title","Ver estudiantes ("+e.Total_F+")"),s(),f(e.Total_F),s(2),d("title","Ver estudiantes ("+e.Total_Gral+")"),s(),f(e.Total_Gral)}}function qi(r,t){r&1&&(o(0,"div",33)(1,"div",34)(2,"span",35),l(3,"Cargando..."),a()()())}function Xi(r,t){r&1&&(o(0,"div",54),l(1," No hay estudiantes para este criterio. "),a())}function Yi(r,t){if(r&1&&(o(0,"tr")(1,"td",19),l(2),a(),o(3,"td"),l(4),a(),o(5,"td",37),l(6),a(),o(7,"td",19),l(8),a(),o(9,"td",19),l(10),a()()),r&2){let e=t.$implicit,i=t.index;s(2),f(i+1),s(2),f(e.Nombre),s(2),f(e.CI),s(2),f(e.Edad??"-"),s(2),f(e.Sexo)}}function Zi(r,t){if(r&1&&(o(0,"div",17)(1,"table",55)(2,"thead")(3,"tr")(4,"th",19),l(5,"#"),a(),o(6,"th"),l(7,"Nombre"),a(),o(8,"th"),l(9,"CI"),a(),o(10,"th",19),l(11,"Edad"),a(),o(12,"th",19),l(13,"Sexo"),a()()(),o(14,"tbody"),b(15,Yi,11,5,"tr",22),a()()()),r&2){let e=m(2);s(15),d("ngForOf",e.modalEstudiantes)}}function Ji(r,t){if(r&1){let e=h();o(0,"div",42),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),o(1,"div",43),_("click",function(n){return u(e),p(n.stopPropagation())}),o(2,"div",44)(3,"div",45)(4,"h5",46),l(5),a(),o(6,"button",47),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),a()(),o(7,"div",48),b(8,qi,4,0,"div",49)(9,Xi,2,0,"div",50)(10,Zi,16,1,"div",51),a(),o(11,"div",52)(12,"button",53),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),l(13,"Cerrar"),a()()()()()}if(r&2){let e=m();s(5),f(e.modalTitulo),s(3),d("ngIf",e.modalLoading),s(),d("ngIf",!e.modalLoading&&(!e.modalEstudiantes||e.modalEstudiantes.length===0)),s(),d("ngIf",!e.modalLoading&&e.modalEstudiantes&&e.modalEstudiantes.length>0)}}function en(r,t){r&1&&x(0,"div",56)}var oe=class oe{constructor(t,e){this.aniosService=t;this.estadisticasService=e;this.ruta=ve.ruta;this.anios=[];this.anioIdSeleccionado="";this.modo="NORMAL";this.isLoading=!1;this.filtroNivel="";this.filtroTexto="";this.dataRaw=[];this.dataTabla=[];this.modalAbierto=!1;this.modalTitulo="";this.modalLoading=!1;this.modalEstudiantes=[]}cerrarModal(){this.modalAbierto=!1,this.modalTitulo="",this.modalEstudiantes=[],this.modalLoading=!1}abrirModalCantidad(t,e,i,n){let c=String(this.anioIdSeleccionado??"").trim();c&&(this.modalAbierto=!0,this.modalTitulo=`${n} \u2014 ${t.Resolucion} / ${t.LvlCurso} ${t.Paralelo} (${t.Turno})`,this.modalLoading=!0,this.modalEstudiantes=[],this.estadisticasService.ObtenerEstudiantesAsignados({anio_id:c,modo:this.modo==="SIMPLE_DIFERENCIADO"?"SIMPLE_DIFERENCIADO":this.modo==="SIMPLIFICADO"?"SIMPLIFICADO":"NORMAL",resolucion:String(t.Resolucion??""),lvl_curso:String(t.LvlCurso??""),paralelo:String(t.Paralelo??""),turno:String(t.Turno??""),nombre_materia:this.modo==="NORMAL"?String(t.NombreMateria??""):void 0,rango:this.modo==="NORMAL"&&t.Rango!==void 0?Number(t.Rango):void 0,materias:this.modo==="SIMPLE_DIFERENCIADO"?String(t.Materias??""):void 0,categoria:e,sexo:i,limit:2e3}).subscribe({next:g=>{this.modalEstudiantes=g?.data??[],this.modalLoading=!1},error:()=>{this.modalEstudiantes=[],this.modalLoading=!1}}))}ngOnInit(){this.cargarAnios()}cargarAnios(){this.aniosService.ObtenerAniosConPredeterminado().subscribe({next:t=>{this.anios=t?.anios??[];let e=t?.predeterminado;e?.id&&(this.anioIdSeleccionado=String(e.id),this.cargarEstadisticas())},error:()=>{this.anios=[]}})}onChangeGestion(){this.cargarEstadisticas()}setModo(t){this.modo=t,this.cargarEstadisticas()}cargarEstadisticas(){let t=String(this.anioIdSeleccionado??"").trim();if(!t){this.dataRaw=[],this.dataTabla=[];return}this.isLoading=!0,this.estadisticasService.ObtenerAsignacionesPorMaterias({anio_id:t,modo:this.modo}).subscribe({next:e=>{this.dataRaw=(e?.data??[]).map(i=>De(ce({},i),{RangoLvlCurso:Number(i?.RangoLvlCurso??0),Rango:i?.Rango===null||i?.Rango===void 0?void 0:Number(i?.Rango??0),Nuevos_M:Number(i?.Nuevos_M??0),Nuevos_F:Number(i?.Nuevos_F??0),Total_Nuevos:Number(i?.Total_Nuevos??0),Antiguos_M:Number(i?.Antiguos_M??0),Antiguos_F:Number(i?.Antiguos_F??0),Total_Antiguos:Number(i?.Total_Antiguos??0),Total_M:Number(i?.Total_M??0),Total_F:Number(i?.Total_F??0),Total_Gral:Number(i?.Total_Gral??0)})),this.dataTabla=[...this.dataRaw],this.isLoading=!1},error:()=>{this.dataRaw=[],this.dataTabla=[],this.isLoading=!1}})}get nivelesCursos(){let t=new Set;for(let e of this.dataTabla??[]){let i=String(e?.LvlCurso??"").trim();i&&t.add(i)}return Array.from(t).sort((e,i)=>e.localeCompare(i))}get dataFiltrada(){let t=String(this.filtroNivel??"").trim(),e=String(this.filtroTexto??"").trim().toUpperCase();return(this.dataTabla??[]).filter(i=>t&&String(i.LvlCurso??"").trim()!==t?!1:e?[i.Anio,i.Resolucion,i.LvlCurso,i.Paralelo,i.Turno,i.NombreMateria,i.Materias].map(c=>String(c??"").toUpperCase()).join(" ").includes(e):!0)}get totalFiltrado(){return this.dataFiltrada.length}};oe.\u0275fac=function(e){return new(e||oe)(M(J),M(ne))},oe.\u0275cmp=k({type:oe,selectors:[["app-estadisticas"]],standalone:!1,decls:76,vars:22,consts:[[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"row","g-2","align-items-end"],[1,"col-12","col-md-3"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["role","group",1,"btn-group","w-100"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"form-select",3,"ngModelChange","ngModel"],["placeholder","Materia / resoluci\xF3n / nivel / paralelo",1,"form-control",3,"ngModelChange","ngModel"],["class","row mt-3",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,"text-center"],[4,"ngIf"],[1,"text-end"],[4,"ngFor","ngForOf"],["class","modal fade show d-block","tabindex","-1","role","dialog",3,"click",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[3,"value"],[1,"row","mt-3"],[1,"col-12","col-md-4"],[1,"btn","btn-outline-primary","w-100",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[1,"col-12","col-md-8","text-md-end","mt-2","mt-md-0"],[1,"text-secondary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-center","text-secondary","py-4"],[2,"white-space","nowrap"],[1,"small","text-muted"],["type","button",1,"btn","btn-link","text-black","p-0","text-end","w-100",3,"click","title"],[1,"text-end","fw-bold"],["type","button",1,"btn","btn-link","text-black","p-0","text-end","w-100","fw-bold",3,"click","title"],["tabindex","-1","role","dialog",1,"modal","fade","show","d-block",3,"click"],["role","document",1,"modal-dialog","modal-lg","modal-dialog-scrollable",3,"click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","text-center py-4",4,"ngIf"],["class","text-secondary text-center py-3",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"text-secondary","text-center","py-3"],[1,"table","table-sm","table-striped","align-middle"],[1,"modal-backdrop","fade","show"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),l(4,"Estad\xEDsticas de asignaciones estudiantiles"),a(),o(5,"p",4),l(6,"Conteo oficial desde asignaciones (tabla calificaciones)"),a()()()(),o(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Gesti\xF3n"),a(),o(11,"select",8),y("ngModelChange",function(c){return S(i.anioIdSeleccionado,c)||(i.anioIdSeleccionado=c),c}),_("change",function(){return i.onChangeGestion()}),o(12,"option",9),l(13,"Seleccione"),a(),b(14,Di,2,2,"option",10),a()(),o(15,"div",6)(16,"label",7),l(17,"Modo"),a(),o(18,"div",11)(19,"button",12),_("click",function(){return i.setModo("NORMAL")}),l(20," Normal "),a(),o(21,"button",12),_("click",function(){return i.setModo("SIMPLIFICADO")}),l(22," Simplificado "),a(),o(23,"button",12),_("click",function(){return i.setModo("SIMPLE_DIFERENCIADO")}),l(24," Simple diferenciado "),a()()(),o(25,"div",6)(26,"label",7),l(27,"Filtrar por nivel"),a(),o(28,"select",13),y("ngModelChange",function(c){return S(i.filtroNivel,c)||(i.filtroNivel=c),c}),o(29,"option",9),l(30,"Todos"),a(),b(31,Gi,2,2,"option",10),a()(),o(32,"div",6)(33,"label",7),l(34,"Buscar"),a(),o(35,"input",14),y("ngModelChange",function(c){return S(i.filtroTexto,c)||(i.filtroTexto=c),c}),a()()(),b(36,ji,10,3,"div",15),o(37,"div",16)(38,"div",17)(39,"table",18)(40,"thead")(41,"tr")(42,"th",19),l(43,"#"),a(),o(44,"th"),l(45,"Gesti\xF3n"),a(),o(46,"th"),l(47,"Nivel"),a(),o(48,"th",19),l(49,"Paralelo"),a(),b(50,$i,2,0,"th",20)(51,Ui,2,0,"th",20),o(52,"th",21),l(53,"Nuevos M"),a(),o(54,"th",21),l(55,"Nuevos F"),a(),o(56,"th",21),l(57,"Total nuevos"),a(),o(58,"th",21),l(59,"Antiguos M"),a(),o(60,"th",21),l(61,"Antiguos F"),a(),o(62,"th",21),l(63,"Total antiguos"),a(),o(64,"th",21),l(65,"Total M"),a(),o(66,"th",21),l(67,"Total F"),a(),o(68,"th",21),l(69,"Total gral"),a()()(),o(70,"tbody"),b(71,zi,5,1,"tr",20)(72,Ki,3,1,"tr",20)(73,Qi,42,26,"tr",22),a()()()(),b(74,Ji,14,4,"div",23)(75,en,1,0,"div",24)),e&2&&(s(11),E("ngModel",i.anioIdSeleccionado),s(3),d("ngForOf",i.anios),s(5),P("active",i.modo==="NORMAL"),d("disabled",i.isLoading),s(2),P("active",i.modo==="SIMPLIFICADO"),d("disabled",i.isLoading),s(2),P("active",i.modo==="SIMPLE_DIFERENCIADO"),d("disabled",i.isLoading),s(5),E("ngModel",i.filtroNivel),s(3),d("ngForOf",i.nivelesCursos),s(4),E("ngModel",i.filtroTexto),s(),d("ngIf",i.anioIdSeleccionado),s(14),d("ngIf",i.modo==="NORMAL"),s(),d("ngIf",i.modo==="SIMPLE_DIFERENCIADO"),s(20),d("ngIf",i.isLoading),s(),d("ngIf",!i.isLoading&&(!i.dataFiltrada||i.dataFiltrada.length===0)),s(),d("ngForOf",i.dataFiltrada),s(),d("ngIf",i.modalAbierto),s(),d("ngIf",i.modalAbierto))},dependencies:[L,F,$,U,D,j,G,B],encapsulation:2});var Ne=oe;function tn(r,t){if(r&1&&(o(0,"option",31),l(1),a()),r&2){let e=t.$implicit;d("value",e.id),s(),f(e.Anio)}}function nn(r,t){if(r&1&&(o(0,"option",31),l(1),a()),r&2){let e=t.$implicit;d("value",e.Resolucion),s(),Y("",e.Resolucion," \u2014 ",e.Nivel)}}function on(r,t){r&1&&x(0,"span",37)}function an(r,t){if(r&1){let e=h();o(0,"div",32)(1,"div",11)(2,"button",33),_("click",function(){u(e);let n=m();return p(n.cargarDocentes())}),b(3,on,1,0,"span",34),l(4," Recargar "),a()(),o(5,"div",35)(6,"div",36),l(7,"Docentes: "),o(8,"strong"),l(9),a()()()()}if(r&2){let e=m();s(2),d("disabled",e.isLoading),s(),d("ngIf",e.isLoading),s(6),f(e.totalDocentes)}}function rn(r,t){r&1&&(o(0,"div",38),l(1,` Los \u201CNo tomados en cuenta\u201D = son aquellos estudiantes que tienen su docente puesto en su inscripci\xF3n; PERO NO SON TOMADOS EN CUENTA POR QUE NO TIENEN REGISTRADO ESA MATERIA.
`),a())}function sn(r,t){r&1&&(o(0,"tr")(1,"td",39)(2,"div",40)(3,"span",41),l(4,"Cargando..."),a()()()())}function ln(r,t){r&1&&(o(0,"tr")(1,"td",42),l(2,"No hay datos para el filtro."),a()())}function cn(r,t){if(r&1&&(o(0,"div",48),l(1),a()),r&2){let e=m().$implicit;s(),f(e.CelularTrabajo)}}function dn(r,t){if(r&1){let e=h();o(0,"tr")(1,"td",20),l(2),a(),o(3,"td")(4,"div",43),l(5),a(),b(6,cn,2,1,"div",44),a(),o(7,"td",45)(8,"button",46),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_id","OK","Especialidad"))}),l(9),a()(),o(10,"td",45)(11,"button",47),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_id","SIN_MODO","Especialidad"))}),l(12),a()(),o(13,"td",45)(14,"button",46),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_idPC","OK","Pr\xE1ctica de conjuntos"))}),l(15),a()(),o(16,"td",45)(17,"button",47),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_idPC","SIN_MODO","Pr\xE1ctica de conjuntos"))}),l(18),a()(),o(19,"td",45)(20,"button",46),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_idOtros","OK","Instrumento complementario"))}),l(21),a()(),o(22,"td",45)(23,"button",47),_("click",function(){let n=u(e).$implicit,c=m();return p(c.abrirModalDetalle(n,"planteldocadmins_idOtros","SIN_MODO","Instrumento complementario"))}),l(24),a()()()}if(r&2){let e=t.$implicit,i=t.index,n=m();s(2),f(i+1),s(3),f(n.getNombreCompletoDocente(e)),s(),d("ngIf",e==null?null:e.CelularTrabajo),s(2),d("disabled",((e==null?null:e.Especialidad_OK)??0)<=0),s(),C(" ",e.Especialidad_OK??0," "),s(2),d("disabled",((e==null?null:e.Especialidad_SinModo)??0)<=0),s(),C(" ",e.Especialidad_SinModo??0," "),s(2),d("disabled",((e==null?null:e.PracticaConjuntos_OK)??0)<=0),s(),C(" ",e.PracticaConjuntos_OK??0," "),s(2),d("disabled",((e==null?null:e.PracticaConjuntos_SinModo)??0)<=0),s(),C(" ",e.PracticaConjuntos_SinModo??0," "),s(2),d("disabled",((e==null?null:e.InstrumentoComplementario_OK)??0)<=0),s(),C(" ",e.InstrumentoComplementario_OK??0," "),s(2),d("disabled",((e==null?null:e.InstrumentoComplementario_SinModo)??0)<=0),s(),C(" ",e.InstrumentoComplementario_SinModo??0," ")}}function mn(r,t){r&1&&(o(0,"div",61)(1,"div",40)(2,"span",41),l(3,"Cargando..."),a()()())}function un(r,t){r&1&&(o(0,"div",62),l(1," No hay estudiantes para este criterio. "),a())}function pn(r,t){r&1&&(o(0,"th"),l(1,"Instrumento (Especialidad)"),a())}function _n(r,t){r&1&&(o(0,"th"),l(1,"Instrumento (Complementario)"),a())}function gn(r,t){if(r&1&&(o(0,"td",64),l(1),a()),r&2){let e=m().$implicit;s(),f((e.InstrumentoMusical??"")||"-")}}function fn(r,t){if(r&1&&(o(0,"td",64),l(1),a()),r&2){let e=m().$implicit;s(),f((e.InstrumentoMusicalSecundario??"")||"-")}}function bn(r,t){if(r&1&&(o(0,"tr")(1,"td",20),l(2),a(),o(3,"td"),l(4),a(),o(5,"td",64),l(6),a(),o(7,"td",65),l(8),a(),o(9,"td",64),l(10),a(),o(11,"td",64),l(12),a(),o(13,"td",64),l(14),a(),o(15,"td",64),l(16),a(),b(17,gn,2,1,"td",66)(18,fn,2,1,"td",66),a()),r&2){let e=t.$implicit,i=t.index,n=m(3);s(2),f(i+1),s(2),f(e.Nombre),s(2),f(e.CI),s(2),f(e.Edad??"-"),s(2),f((e.Sexo??"")||"-"),s(2),f((e.Curso??"")||"-"),s(2),f((e.Paralelo??"")||"-"),s(2),f((e.Turno??"")||"-"),s(),d("ngIf",n.modalCampo==="planteldocadmins_id"),s(),d("ngIf",n.modalCampo==="planteldocadmins_idOtros")}}function vn(r,t){if(r&1&&(o(0,"div",18)(1,"table",63)(2,"thead")(3,"tr")(4,"th",20),l(5,"#"),a(),o(6,"th"),l(7,"Nombre"),a(),o(8,"th"),l(9,"CI"),a(),o(10,"th",20),l(11,"Edad"),a(),o(12,"th"),l(13,"Sexo"),a(),o(14,"th"),l(15,"Curso"),a(),o(16,"th"),l(17,"Paralelo"),a(),o(18,"th"),l(19,"Turno"),a(),b(20,pn,2,0,"th",27)(21,_n,2,0,"th",27),a()(),o(22,"tbody"),b(23,bn,19,10,"tr",28),a()()()),r&2){let e=m(2);s(20),d("ngIf",e.modalCampo==="planteldocadmins_id"),s(),d("ngIf",e.modalCampo==="planteldocadmins_idOtros"),s(2),d("ngForOf",e.modalEstudiantes)}}function hn(r,t){if(r&1){let e=h();o(0,"div",49),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),o(1,"div",50),_("click",function(n){return u(e),p(n.stopPropagation())}),o(2,"div",51)(3,"div",52)(4,"h5",53),l(5),a(),o(6,"button",54),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),a()(),o(7,"div",55),b(8,mn,4,0,"div",56)(9,un,2,0,"div",57)(10,vn,24,3,"div",58),a(),o(11,"div",59)(12,"button",60),_("click",function(){u(e);let n=m();return p(n.cerrarModal())}),l(13,"Cerrar"),a()()()()()}if(r&2){let e=m();s(5),f(e.modalTitulo),s(3),d("ngIf",e.modalLoading),s(),d("ngIf",!e.modalLoading&&(!e.modalEstudiantes||e.modalEstudiantes.length===0)),s(),d("ngIf",!e.modalLoading&&e.modalEstudiantes&&e.modalEstudiantes.length>0)}}function xn(r,t){r&1&&x(0,"div",67)}var ae=class ae{constructor(t,e){this.aniosService=t;this.estadisticasService=e;this.anios=[];this.anioIdSeleccionado="";this.opcionesResolucion=[];this.resolucionSeleccionada="";this.isLoading=!1;this.filtroDocente="";this.docentesRaw=[];this.modalAbierto=!1;this.modalTitulo="";this.modalCampo="";this.modalLoading=!1;this.modalEstudiantes=[]}ngOnInit(){this.cargarAnios()}cargarAnios(){this.aniosService.ObtenerAniosConPredeterminado().subscribe({next:t=>{this.anios=t?.anios??[];let e=t?.predeterminado;e?.id&&(this.anioIdSeleccionado=String(e.id),this.cargarOpcionesResolucion())},error:()=>{this.anios=[]}})}onChangeGestion(){this.resolucionSeleccionada="",this.opcionesResolucion=[],this.docentesRaw=[],this.cargarOpcionesResolucion()}onChangeResolucion(){this.cargarDocentes()}cargarOpcionesResolucion(){let t=String(this.anioIdSeleccionado??"").trim();if(!t){this.opcionesResolucion=[];return}this.estadisticasService.ObtenerOpcionesResolucionNivel({anio_id:t}).subscribe({next:e=>{this.opcionesResolucion=e?.data??[],!this.resolucionSeleccionada&&this.opcionesResolucion.length>0&&(this.resolucionSeleccionada=String(this.opcionesResolucion[0]?.Resolucion??"").trim(),this.resolucionSeleccionada&&this.cargarDocentes())},error:()=>{this.opcionesResolucion=[]}})}cargarDocentes(){let t=String(this.anioIdSeleccionado??"").trim(),e=String(this.resolucionSeleccionada??"").trim();if(!t||!e){this.docentesRaw=[];return}this.isLoading=!0,this.estadisticasService.ObtenerConteoDocentesAsignados({anio_id:t,resolucion:e}).subscribe({next:i=>{this.docentesRaw=i?.data??[],this.isLoading=!1},error:()=>{this.docentesRaw=[],this.isLoading=!1}})}get docentesFiltrados(){let t=String(this.filtroDocente??"").trim().toUpperCase();return t?(this.docentesRaw??[]).filter(e=>`${e?.Apellidos??""} ${e?.Nombres??""}`.toUpperCase().includes(t)):this.docentesRaw??[]}get totalDocentes(){return this.docentesFiltrados.length}getNombreCompletoDocente(t){return`${(t?.Apellidos??"").toString().trim()} ${(t?.Nombres??"").toString().trim()}`.trim()}abrirModalDetalle(t,e,i,n){let c=String(this.anioIdSeleccionado??"").trim(),g=String(this.resolucionSeleccionada??"").trim();!c||!g||(this.modalAbierto=!0,this.modalTitulo=`${n} \u2014 ${this.getNombreCompletoDocente(t)} (${i==="OK"?"Parte":"Sin modo"})`,this.modalCampo=e,this.modalLoading=!0,this.modalEstudiantes=[],this.estadisticasService.ObtenerEstudiantesDocenteAsignados({anio_id:c,resolucion:g,docente_id:t.id,campo:e,tipo:i,limit:5e3}).subscribe({next:v=>{this.modalEstudiantes=v?.data??[],this.modalLoading=!1},error:()=>{this.modalEstudiantes=[],this.modalLoading=!1}}))}cerrarModal(){this.modalAbierto=!1,this.modalTitulo="",this.modalCampo="",this.modalLoading=!1,this.modalEstudiantes=[]}};ae.\u0275fac=function(e){return new(e||ae)(M(J),M(ne))},ae.\u0275cmp=k({type:ae,selectors:[["app-estadisticasmezclainstrs"]],standalone:!1,decls:55,vars:13,consts:[[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-4","fw-bold","titulosGlobales"],[1,"lead","text-secondary","subtitulosGlobales"],[1,"row","g-2","align-items-end"],[1,"col-12","col-md-3"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-12","col-md-4"],[1,"form-select",3,"ngModelChange","change","ngModel","disabled"],[1,"col-12","col-md-5"],["placeholder","Apellidos o nombres",1,"form-control",3,"ngModelChange","ngModel"],["class","row mt-3",4,"ngIf"],["class","mt-3 alert alert-secondary",4,"ngIf"],[1,"mt-4"],[1,"table-responsive"],[1,"table","table-striped","table-hover","table-sm","align-middle"],[1,"text-center"],["title","Instrumento de Especialidad Oficial",1,"text-end"],["title","Estudiantes no tomados en cuenta en Especialidad",1,"text-end","text-danger"],["title","Instrumento de Pr\xE1ctica de conjuntos Oficial",1,"text-end"],["title","Estudiantes no tomados en cuenta en Pr\xE1ctica de conjuntos",1,"text-end","text-danger"],["title","Instrumento complementario Oficial",1,"text-end"],["title","Estudiantes no tomados en cuenta en Instrumento complementario",1,"text-end","text-danger"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","modal fade show d-block","tabindex","-1","role","dialog",3,"click",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[3,"value"],[1,"row","mt-3"],[1,"btn","btn-outline-primary","w-100",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2","role","status","aria-hidden","true",4,"ngIf"],[1,"col-12","col-md-8","text-md-end","mt-2","mt-md-0"],[1,"text-secondary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"mt-3","alert","alert-secondary"],["colspan","8",1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],["colspan","8",1,"text-center","text-secondary","py-4"],[1,"fw-semibold"],["class","small text-muted",4,"ngIf"],[1,"text-end"],["type","button",1,"btn","btn-link","text-black","p-0","text-end","w-100",3,"click","disabled"],["type","button",1,"btn","btn-link","text-danger","p-0","text-end","w-100",3,"click","disabled"],[1,"small","text-muted"],["tabindex","-1","role","dialog",1,"modal","fade","show","d-block",3,"click"],["role","document",1,"modal-dialog","modal-xl","modal-dialog-scrollable",3,"click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["class","text-center py-4",4,"ngIf"],["class","text-secondary text-center py-3",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"text-center","py-4"],[1,"text-secondary","text-center","py-3"],[1,"table","table-sm","table-striped","align-middle"],[2,"white-space","nowrap"],[1,"text-center",2,"white-space","nowrap"],["style","white-space: nowrap;",4,"ngIf"],[1,"modal-backdrop","fade","show"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),l(4,"Estudiantes por docente (asignados)"),a(),o(5,"p",4),l(6,"Vea estudisticas por docentes y estudiantes designados en los modos especiales de plan de estudios (MODO INSTRUMENTO DE ESPECIALIDAD, PRACTICA DE CONJUNTOS, INSTRUMENTO COMPLEMENTARIO)"),a()()()(),o(7,"div",5)(8,"div",6)(9,"label",7),l(10,"Gesti\xF3n"),a(),o(11,"select",8),y("ngModelChange",function(c){return S(i.anioIdSeleccionado,c)||(i.anioIdSeleccionado=c),c}),_("change",function(){return i.onChangeGestion()}),o(12,"option",9),l(13,"Seleccione"),a(),b(14,tn,2,2,"option",10),a()(),o(15,"div",11)(16,"label",7),l(17,"Resoluci\xF3n (Nivel)"),a(),o(18,"select",12),y("ngModelChange",function(c){return S(i.resolucionSeleccionada,c)||(i.resolucionSeleccionada=c),c}),_("change",function(){return i.onChangeResolucion()}),o(19,"option",9),l(20,"Seleccione"),a(),b(21,nn,2,3,"option",10),a()(),o(22,"div",13)(23,"label",7),l(24,"Buscar docente"),a(),o(25,"input",14),y("ngModelChange",function(c){return S(i.filtroDocente,c)||(i.filtroDocente=c),c}),a()()(),b(26,an,10,3,"div",15)(27,rn,2,0,"div",16),o(28,"div",17)(29,"div",18)(30,"table",19)(31,"thead")(32,"tr")(33,"th",20),l(34,"#"),a(),o(35,"th"),l(36,"Docente"),a(),o(37,"th",21),l(38,"Esp. OFICIAL"),a(),o(39,"th",22),l(40,"Esp. No tomados en cuenta"),a(),o(41,"th",23),l(42,"Pr\xE1c. OFICIAL"),a(),o(43,"th",24),l(44,"Pr\xE1c. No tomados en cuenta"),a(),o(45,"th",25),l(46,"Comp. OFICIAL"),a(),o(47,"th",26),l(48,"Comp. No tomados en cuenta"),a()()(),o(49,"tbody"),b(50,sn,5,0,"tr",27)(51,ln,3,0,"tr",27)(52,dn,25,15,"tr",28),a()()()(),b(53,hn,14,4,"div",29)(54,xn,1,0,"div",30)),e&2&&(s(11),E("ngModel",i.anioIdSeleccionado),s(3),d("ngForOf",i.anios),s(4),E("ngModel",i.resolucionSeleccionada),d("disabled",!i.anioIdSeleccionado),s(3),d("ngForOf",i.opcionesResolucion),s(4),E("ngModel",i.filtroDocente),s(),d("ngIf",i.anioIdSeleccionado&&i.resolucionSeleccionada),s(),d("ngIf",i.anioIdSeleccionado&&i.resolucionSeleccionada),s(23),d("ngIf",i.isLoading),s(),d("ngIf",!i.isLoading&&(!i.docentesFiltrados||i.docentesFiltrados.length===0)),s(),d("ngForOf",i.docentesFiltrados),s(),d("ngIf",i.modalAbierto),s(),d("ngIf",i.modalAbierto))},dependencies:[L,F,$,U,D,j,G,B],encapsulation:2});var Ve=ae;var Cn=[{path:"calificacionessolo",component:Te},{path:"controles",component:Oe},{path:"documentosifasimportantes",component:Ae},{path:"estadisticasasignaciones",component:Ne},{path:"estadisticasmezclainstrs",component:Ve}],Q=class Q{};Q.\u0275fac=function(e){return new(e||Q)},Q.\u0275mod=pe({type:Q}),Q.\u0275inj=me({imports:[Fe.forChild(Cn),Fe]});var ke=Q;var q=class q{};q.\u0275fac=function(e){return new(e||q)},q.\u0275mod=pe({type:q}),q.\u0275inj=me({imports:[He,ot,ke]});var ct=q;export{ct as AdministrativosModule};
