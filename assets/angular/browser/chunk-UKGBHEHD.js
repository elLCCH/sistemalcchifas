import{b as il}from"./chunk-P3GASOP5.js";import{b as tl}from"./chunk-LRDGIBFV.js";import{a as Fs}from"./chunk-COLKSTJ6.js";import{b as Zo}from"./chunk-KCTZUZJH.js";import{e as zo,g as Ns,k as ur}from"./chunk-PWQJWZZZ.js";import{b as el}from"./chunk-OX7OA6PN.js";import{c as Uo,e as fr,f as $o,h as Go,j as Se,k as Wo,o as qo,r as Xo,s as Yo,t as Ko,x as Qo,y as Jo}from"./chunk-ROSYCBC4.js";import{a as Os}from"./chunk-JISGPZ2J.js";import{$b as hr,Aa as rr,Bb as ar,Cb as or,Db as lr,Dc as Rs,Ea as q,Fc as Bo,Gc as Ds,Hb as cr,Ib as Xi,Kb as Io,Lb as et,Ma as Ne,Mb as $e,Mc as Ho,Nb as pe,Oc as jo,Ra as Is,Sa as Ls,Tb as Lo,Ub as Ro,Vb as Do,Wa as oe,Wc as dr,Xb as No,Yc as Vo,_ as Ms,dc as Oo,fc as Fo,ga as Lt,ha as Rt,ib as nt,jb as z,kb as U,lb as At,p as ko,pb as Po,qb as Mo,sb as xe,vb as kt,xb as ut}from"./chunk-SPNCLBHB.js";import{a as Ue,b as Ti,d as Tc,f as kc,g as De,h as ki,i as ks,j as Ps,k as To,l as oi,m as Q}from"./chunk-GG76335P.js";var nl=Tc((sl,Hs)=>{(function(c,e){"use strict";typeof Hs=="object"&&typeof Hs.exports=="object"?Hs.exports=c.document?e(c,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(c)})(typeof window<"u"?window:sl,function(c,e){"use strict";var t=[],i=Object.getPrototypeOf,s=t.slice,n=t.flat?function(r){return t.flat.call(r)}:function(r){return t.concat.apply([],r)},a=t.push,o=t.indexOf,h={},d=h.toString,f=h.hasOwnProperty,m=f.toString,b=m.call(Object),_={},w=function(l){return typeof l=="function"&&typeof l.nodeType!="number"&&typeof l.item!="function"},x=function(l){return l!=null&&l===l.window},C=c.document,k={type:!0,src:!0,nonce:!0,noModule:!0};function D(r,l,u){u=u||C;var g,v,y=u.createElement("script");if(y.text=r,l)for(g in k)v=l[g]||l.getAttribute&&l.getAttribute(g),v&&y.setAttribute(g,v);u.head.appendChild(y).parentNode.removeChild(y)}function O(r){return r==null?r+"":typeof r=="object"||typeof r=="function"?h[d.call(r)]||"object":typeof r}var H="3.7.1",j=/HTML$/i,p=function(r,l){return new p.fn.init(r,l)};p.fn=p.prototype={jquery:H,constructor:p,length:0,toArray:function(){return s.call(this)},get:function(r){return r==null?s.call(this):r<0?this[r+this.length]:this[r]},pushStack:function(r){var l=p.merge(this.constructor(),r);return l.prevObject=this,l},each:function(r){return p.each(this,r)},map:function(r){return this.pushStack(p.map(this,function(l,u){return r.call(l,u,l)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(p.grep(this,function(r,l){return(l+1)%2}))},odd:function(){return this.pushStack(p.grep(this,function(r,l){return l%2}))},eq:function(r){var l=this.length,u=+r+(r<0?l:0);return this.pushStack(u>=0&&u<l?[this[u]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:t.sort,splice:t.splice},p.extend=p.fn.extend=function(){var r,l,u,g,v,y,A=arguments[0]||{},T=1,E=arguments.length,M=!1;for(typeof A=="boolean"&&(M=A,A=arguments[T]||{},T++),typeof A!="object"&&!w(A)&&(A={}),T===E&&(A=this,T--);T<E;T++)if((r=arguments[T])!=null)for(l in r)g=r[l],!(l==="__proto__"||A===g)&&(M&&g&&(p.isPlainObject(g)||(v=Array.isArray(g)))?(u=A[l],v&&!Array.isArray(u)?y=[]:!v&&!p.isPlainObject(u)?y={}:y=u,v=!1,A[l]=p.extend(M,y,g)):g!==void 0&&(A[l]=g));return A},p.extend({expando:"jQuery"+(H+Math.random()).replace(/\D/g,""),isReady:!0,error:function(r){throw new Error(r)},noop:function(){},isPlainObject:function(r){var l,u;return!r||d.call(r)!=="[object Object]"?!1:(l=i(r),l?(u=f.call(l,"constructor")&&l.constructor,typeof u=="function"&&m.call(u)===b):!0)},isEmptyObject:function(r){var l;for(l in r)return!1;return!0},globalEval:function(r,l,u){D(r,{nonce:l&&l.nonce},u)},each:function(r,l){var u,g=0;if($(r))for(u=r.length;g<u&&l.call(r[g],g,r[g])!==!1;g++);else for(g in r)if(l.call(r[g],g,r[g])===!1)break;return r},text:function(r){var l,u="",g=0,v=r.nodeType;if(!v)for(;l=r[g++];)u+=p.text(l);return v===1||v===11?r.textContent:v===9?r.documentElement.textContent:v===3||v===4?r.nodeValue:u},makeArray:function(r,l){var u=l||[];return r!=null&&($(Object(r))?p.merge(u,typeof r=="string"?[r]:r):a.call(u,r)),u},inArray:function(r,l,u){return l==null?-1:o.call(l,r,u)},isXMLDoc:function(r){var l=r&&r.namespaceURI,u=r&&(r.ownerDocument||r).documentElement;return!j.test(l||u&&u.nodeName||"HTML")},merge:function(r,l){for(var u=+l.length,g=0,v=r.length;g<u;g++)r[v++]=l[g];return r.length=v,r},grep:function(r,l,u){for(var g,v=[],y=0,A=r.length,T=!u;y<A;y++)g=!l(r[y],y),g!==T&&v.push(r[y]);return v},map:function(r,l,u){var g,v,y=0,A=[];if($(r))for(g=r.length;y<g;y++)v=l(r[y],y,u),v!=null&&A.push(v);else for(y in r)v=l(r[y],y,u),v!=null&&A.push(v);return n(A)},guid:1,support:_}),typeof Symbol=="function"&&(p.fn[Symbol.iterator]=t[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(r,l){h["[object "+l+"]"]=l.toLowerCase()});function $(r){var l=!!r&&"length"in r&&r.length,u=O(r);return w(r)||x(r)?!1:u==="array"||l===0||typeof l=="number"&&l>0&&l-1 in r}function W(r,l){return r.nodeName&&r.nodeName.toLowerCase()===l.toLowerCase()}var ot=t.pop,wt=t.sort,mt=t.splice,at="[\\x20\\t\\r\\n\\f]",Dt=new RegExp("^"+at+"+|((?:^|[^\\\\])(?:\\\\.)*)"+at+"+$","g");p.contains=function(r,l){var u=l&&l.parentNode;return r===u||!!(u&&u.nodeType===1&&(r.contains?r.contains(u):r.compareDocumentPosition&&r.compareDocumentPosition(u)&16))};var Ct=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function Yt(r,l){return l?r==="\0"?"\uFFFD":r.slice(0,-1)+"\\"+r.charCodeAt(r.length-1).toString(16)+" ":"\\"+r}p.escapeSelector=function(r){return(r+"").replace(Ct,Yt)};var K=C,Z=a;(function(){var r,l,u,g,v,y=Z,A,T,E,M,N,B=p.expando,L=0,V=0,ct=Ss(),St=Ss(),gt=Ss(),qt=Ss(),Gt=function(S,P){return S===P&&(v=!0),0},Pe="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Me="(?:\\\\[\\da-fA-F]{1,6}"+at+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",_t="\\["+at+"*("+Me+")(?:"+at+"*([*^$|!~]?=)"+at+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Me+"))|)"+at+"*\\]",ri=":("+Me+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+_t+")*)|.*)\\)|)",Et=new RegExp(at+"+","g"),jt=new RegExp("^"+at+"*,"+at+"*"),Gi=new RegExp("^"+at+"*([>+~]|"+at+")"+at+"*"),Jn=new RegExp(at+"|>"),Ie=new RegExp(ri),Wi=new RegExp("^"+Me+"$"),Le={ID:new RegExp("^#("+Me+")"),CLASS:new RegExp("^\\.("+Me+")"),TAG:new RegExp("^("+Me+"|[*])"),ATTR:new RegExp("^"+_t),PSEUDO:new RegExp("^"+ri),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+at+"*(even|odd|(([+-]|)(\\d*)n|)"+at+"*(?:([+-]|)"+at+"*(\\d+)|))"+at+"*\\)|)","i"),bool:new RegExp("^(?:"+Pe+")$","i"),needsContext:new RegExp("^"+at+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+at+"*((?:-\\d)?\\d*)"+at+"*\\)|)(?=[^-]|$)","i")},Xe=/^(?:input|select|textarea|button)$/i,Ye=/^h\d$/i,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Zn=/[+~]/,Ve=new RegExp("\\\\[\\da-fA-F]{1,6}"+at+"?|\\\\([^\\r\\n\\f])","g"),ze=function(S,P){var I="0x"+S.slice(1)-65536;return P||(I<0?String.fromCharCode(I+65536):String.fromCharCode(I>>10|55296,I&1023|56320))},_c=function(){Ke()},Ac=Cs(function(S){return S.disabled===!0&&W(S,"fieldset")},{dir:"parentNode",next:"legend"});function wc(){try{return A.activeElement}catch{}}try{y.apply(t=s.call(K.childNodes),K.childNodes),t[K.childNodes.length].nodeType}catch{y={apply:function(P,I){Z.apply(P,s.call(I))},call:function(P){Z.apply(P,s.call(arguments,1))}}}function Tt(S,P,I,R){var F,G,X,tt,Y,vt,lt,dt=P&&P.ownerDocument,yt=P?P.nodeType:9;if(I=I||[],typeof S!="string"||!S||yt!==1&&yt!==9&&yt!==11)return I;if(!R&&(Ke(P),P=P||A,E)){if(yt!==11&&(Y=ve.exec(S)))if(F=Y[1]){if(yt===9)if(X=P.getElementById(F)){if(X.id===F)return y.call(I,X),I}else return I;else if(dt&&(X=dt.getElementById(F))&&Tt.contains(P,X)&&X.id===F)return y.call(I,X),I}else{if(Y[2])return y.apply(I,P.getElementsByTagName(S)),I;if((F=Y[3])&&P.getElementsByClassName)return y.apply(I,P.getElementsByClassName(F)),I}if(!qt[S+" "]&&(!M||!M.test(S))){if(lt=S,dt=P,yt===1&&(Jn.test(S)||Gi.test(S))){for(dt=Zn.test(S)&&tr(P.parentNode)||P,(dt!=P||!_.scope)&&((tt=P.getAttribute("id"))?tt=p.escapeSelector(tt):P.setAttribute("id",tt=B)),vt=qi(S),G=vt.length;G--;)vt[G]=(tt?"#"+tt:":scope")+" "+Es(vt[G]);lt=vt.join(",")}try{return y.apply(I,dt.querySelectorAll(lt)),I}catch{qt(S,!0)}finally{tt===B&&P.removeAttribute("id")}}}return Co(S.replace(Dt,"$1"),P,I,R)}function Ss(){var S=[];function P(I,R){return S.push(I+" ")>l.cacheLength&&delete P[S.shift()],P[I+" "]=R}return P}function we(S){return S[B]=!0,S}function Ei(S){var P=A.createElement("fieldset");try{return!!S(P)}catch{return!1}finally{P.parentNode&&P.parentNode.removeChild(P),P=null}}function xc(S){return function(P){return W(P,"input")&&P.type===S}}function Sc(S){return function(P){return(W(P,"input")||W(P,"button"))&&P.type===S}}function So(S){return function(P){return"form"in P?P.parentNode&&P.disabled===!1?"label"in P?"label"in P.parentNode?P.parentNode.disabled===S:P.disabled===S:P.isDisabled===S||P.isDisabled!==!S&&Ac(P)===S:P.disabled===S:"label"in P?P.disabled===S:!1}}function ai(S){return we(function(P){return P=+P,we(function(I,R){for(var F,G=S([],I.length,P),X=G.length;X--;)I[F=G[X]]&&(I[F]=!(R[F]=I[F]))})})}function tr(S){return S&&typeof S.getElementsByTagName<"u"&&S}function Ke(S){var P,I=S?S.ownerDocument||S:K;return I==A||I.nodeType!==9||!I.documentElement||(A=I,T=A.documentElement,E=!p.isXMLDoc(A),N=T.matches||T.webkitMatchesSelector||T.msMatchesSelector,T.msMatchesSelector&&K!=A&&(P=A.defaultView)&&P.top!==P&&P.addEventListener("unload",_c),_.getById=Ei(function(R){return T.appendChild(R).id=p.expando,!A.getElementsByName||!A.getElementsByName(p.expando).length}),_.disconnectedMatch=Ei(function(R){return N.call(R,"*")}),_.scope=Ei(function(){return A.querySelectorAll(":scope")}),_.cssHas=Ei(function(){try{return A.querySelector(":has(*,:jqfake)"),!1}catch{return!0}}),_.getById?(l.filter.ID=function(R){var F=R.replace(Ve,ze);return function(G){return G.getAttribute("id")===F}},l.find.ID=function(R,F){if(typeof F.getElementById<"u"&&E){var G=F.getElementById(R);return G?[G]:[]}}):(l.filter.ID=function(R){var F=R.replace(Ve,ze);return function(G){var X=typeof G.getAttributeNode<"u"&&G.getAttributeNode("id");return X&&X.value===F}},l.find.ID=function(R,F){if(typeof F.getElementById<"u"&&E){var G,X,tt,Y=F.getElementById(R);if(Y){if(G=Y.getAttributeNode("id"),G&&G.value===R)return[Y];for(tt=F.getElementsByName(R),X=0;Y=tt[X++];)if(G=Y.getAttributeNode("id"),G&&G.value===R)return[Y]}return[]}}),l.find.TAG=function(R,F){return typeof F.getElementsByTagName<"u"?F.getElementsByTagName(R):F.querySelectorAll(R)},l.find.CLASS=function(R,F){if(typeof F.getElementsByClassName<"u"&&E)return F.getElementsByClassName(R)},M=[],Ei(function(R){var F;T.appendChild(R).innerHTML="<a id='"+B+"' href='' disabled='disabled'></a><select id='"+B+"-\r\\' disabled='disabled'><option selected=''></option></select>",R.querySelectorAll("[selected]").length||M.push("\\["+at+"*(?:value|"+Pe+")"),R.querySelectorAll("[id~="+B+"-]").length||M.push("~="),R.querySelectorAll("a#"+B+"+*").length||M.push(".#.+[+~]"),R.querySelectorAll(":checked").length||M.push(":checked"),F=A.createElement("input"),F.setAttribute("type","hidden"),R.appendChild(F).setAttribute("name","D"),T.appendChild(R).disabled=!0,R.querySelectorAll(":disabled").length!==2&&M.push(":enabled",":disabled"),F=A.createElement("input"),F.setAttribute("name",""),R.appendChild(F),R.querySelectorAll("[name='']").length||M.push("\\["+at+"*name"+at+"*="+at+`*(?:''|"")`)}),_.cssHas||M.push(":has"),M=M.length&&new RegExp(M.join("|")),Gt=function(R,F){if(R===F)return v=!0,0;var G=!R.compareDocumentPosition-!F.compareDocumentPosition;return G||(G=(R.ownerDocument||R)==(F.ownerDocument||F)?R.compareDocumentPosition(F):1,G&1||!_.sortDetached&&F.compareDocumentPosition(R)===G?R===A||R.ownerDocument==K&&Tt.contains(K,R)?-1:F===A||F.ownerDocument==K&&Tt.contains(K,F)?1:g?o.call(g,R)-o.call(g,F):0:G&4?-1:1)}),A}Tt.matches=function(S,P){return Tt(S,null,null,P)},Tt.matchesSelector=function(S,P){if(Ke(S),E&&!qt[P+" "]&&(!M||!M.test(P)))try{var I=N.call(S,P);if(I||_.disconnectedMatch||S.document&&S.document.nodeType!==11)return I}catch{qt(P,!0)}return Tt(P,A,null,[S]).length>0},Tt.contains=function(S,P){return(S.ownerDocument||S)!=A&&Ke(S),p.contains(S,P)},Tt.attr=function(S,P){(S.ownerDocument||S)!=A&&Ke(S);var I=l.attrHandle[P.toLowerCase()],R=I&&f.call(l.attrHandle,P.toLowerCase())?I(S,P,!E):void 0;return R!==void 0?R:S.getAttribute(P)},Tt.error=function(S){throw new Error("Syntax error, unrecognized expression: "+S)},p.uniqueSort=function(S){var P,I=[],R=0,F=0;if(v=!_.sortStable,g=!_.sortStable&&s.call(S,0),wt.call(S,Gt),v){for(;P=S[F++];)P===S[F]&&(R=I.push(F));for(;R--;)mt.call(S,I[R],1)}return g=null,S},p.fn.uniqueSort=function(){return this.pushStack(p.uniqueSort(s.apply(this)))},l=p.expr={cacheLength:50,createPseudo:we,match:Le,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(S){return S[1]=S[1].replace(Ve,ze),S[3]=(S[3]||S[4]||S[5]||"").replace(Ve,ze),S[2]==="~="&&(S[3]=" "+S[3]+" "),S.slice(0,4)},CHILD:function(S){return S[1]=S[1].toLowerCase(),S[1].slice(0,3)==="nth"?(S[3]||Tt.error(S[0]),S[4]=+(S[4]?S[5]+(S[6]||1):2*(S[3]==="even"||S[3]==="odd")),S[5]=+(S[7]+S[8]||S[3]==="odd")):S[3]&&Tt.error(S[0]),S},PSEUDO:function(S){var P,I=!S[6]&&S[2];return Le.CHILD.test(S[0])?null:(S[3]?S[2]=S[4]||S[5]||"":I&&Ie.test(I)&&(P=qi(I,!0))&&(P=I.indexOf(")",I.length-P)-I.length)&&(S[0]=S[0].slice(0,P),S[2]=I.slice(0,P)),S.slice(0,3))}},filter:{TAG:function(S){var P=S.replace(Ve,ze).toLowerCase();return S==="*"?function(){return!0}:function(I){return W(I,P)}},CLASS:function(S){var P=ct[S+" "];return P||(P=new RegExp("(^|"+at+")"+S+"("+at+"|$)"))&&ct(S,function(I){return P.test(typeof I.className=="string"&&I.className||typeof I.getAttribute<"u"&&I.getAttribute("class")||"")})},ATTR:function(S,P,I){return function(R){var F=Tt.attr(R,S);return F==null?P==="!=":P?(F+="",P==="="?F===I:P==="!="?F!==I:P==="^="?I&&F.indexOf(I)===0:P==="*="?I&&F.indexOf(I)>-1:P==="$="?I&&F.slice(-I.length)===I:P==="~="?(" "+F.replace(Et," ")+" ").indexOf(I)>-1:P==="|="?F===I||F.slice(0,I.length+1)===I+"-":!1):!0}},CHILD:function(S,P,I,R,F){var G=S.slice(0,3)!=="nth",X=S.slice(-4)!=="last",tt=P==="of-type";return R===1&&F===0?function(Y){return!!Y.parentNode}:function(Y,vt,lt){var dt,yt,rt,It,ae,Kt=G!==X?"nextSibling":"previousSibling",ye=Y.parentNode,Re=tt&&Y.nodeName.toLowerCase(),Ci=!lt&&!tt,ee=!1;if(ye){if(G){for(;Kt;){for(rt=Y;rt=rt[Kt];)if(tt?W(rt,Re):rt.nodeType===1)return!1;ae=Kt=S==="only"&&!ae&&"nextSibling"}return!0}if(ae=[X?ye.firstChild:ye.lastChild],X&&Ci){for(yt=ye[B]||(ye[B]={}),dt=yt[S]||[],It=dt[0]===L&&dt[1],ee=It&&dt[2],rt=It&&ye.childNodes[It];rt=++It&&rt&&rt[Kt]||(ee=It=0)||ae.pop();)if(rt.nodeType===1&&++ee&&rt===Y){yt[S]=[L,It,ee];break}}else if(Ci&&(yt=Y[B]||(Y[B]={}),dt=yt[S]||[],It=dt[0]===L&&dt[1],ee=It),ee===!1)for(;(rt=++It&&rt&&rt[Kt]||(ee=It=0)||ae.pop())&&!((tt?W(rt,Re):rt.nodeType===1)&&++ee&&(Ci&&(yt=rt[B]||(rt[B]={}),yt[S]=[L,ee]),rt===Y)););return ee-=F,ee===R||ee%R===0&&ee/R>=0}}},PSEUDO:function(S,P){var I,R=l.pseudos[S]||l.setFilters[S.toLowerCase()]||Tt.error("unsupported pseudo: "+S);return R[B]?R(P):R.length>1?(I=[S,S,"",P],l.setFilters.hasOwnProperty(S.toLowerCase())?we(function(F,G){for(var X,tt=R(F,P),Y=tt.length;Y--;)X=o.call(F,tt[Y]),F[X]=!(G[X]=tt[Y])}):function(F){return R(F,0,I)}):R}},pseudos:{not:we(function(S){var P=[],I=[],R=nr(S.replace(Dt,"$1"));return R[B]?we(function(F,G,X,tt){for(var Y,vt=R(F,null,tt,[]),lt=F.length;lt--;)(Y=vt[lt])&&(F[lt]=!(G[lt]=Y))}):function(F,G,X){return P[0]=F,R(P,null,X,I),P[0]=null,!I.pop()}}),has:we(function(S){return function(P){return Tt(S,P).length>0}}),contains:we(function(S){return S=S.replace(Ve,ze),function(P){return(P.textContent||p.text(P)).indexOf(S)>-1}}),lang:we(function(S){return Wi.test(S||"")||Tt.error("unsupported lang: "+S),S=S.replace(Ve,ze).toLowerCase(),function(P){var I;do if(I=E?P.lang:P.getAttribute("xml:lang")||P.getAttribute("lang"))return I=I.toLowerCase(),I===S||I.indexOf(S+"-")===0;while((P=P.parentNode)&&P.nodeType===1);return!1}}),target:function(S){var P=c.location&&c.location.hash;return P&&P.slice(1)===S.id},root:function(S){return S===T},focus:function(S){return S===wc()&&A.hasFocus()&&!!(S.type||S.href||~S.tabIndex)},enabled:So(!1),disabled:So(!0),checked:function(S){return W(S,"input")&&!!S.checked||W(S,"option")&&!!S.selected},selected:function(S){return S.parentNode&&S.parentNode.selectedIndex,S.selected===!0},empty:function(S){for(S=S.firstChild;S;S=S.nextSibling)if(S.nodeType<6)return!1;return!0},parent:function(S){return!l.pseudos.empty(S)},header:function(S){return Ye.test(S.nodeName)},input:function(S){return Xe.test(S.nodeName)},button:function(S){return W(S,"input")&&S.type==="button"||W(S,"button")},text:function(S){var P;return W(S,"input")&&S.type==="text"&&((P=S.getAttribute("type"))==null||P.toLowerCase()==="text")},first:ai(function(){return[0]}),last:ai(function(S,P){return[P-1]}),eq:ai(function(S,P,I){return[I<0?I+P:I]}),even:ai(function(S,P){for(var I=0;I<P;I+=2)S.push(I);return S}),odd:ai(function(S,P){for(var I=1;I<P;I+=2)S.push(I);return S}),lt:ai(function(S,P,I){var R;for(I<0?R=I+P:I>P?R=P:R=I;--R>=0;)S.push(R);return S}),gt:ai(function(S,P,I){for(var R=I<0?I+P:I;++R<P;)S.push(R);return S})}},l.pseudos.nth=l.pseudos.eq;for(r in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})l.pseudos[r]=xc(r);for(r in{submit:!0,reset:!0})l.pseudos[r]=Sc(r);function Eo(){}Eo.prototype=l.filters=l.pseudos,l.setFilters=new Eo;function qi(S,P){var I,R,F,G,X,tt,Y,vt=St[S+" "];if(vt)return P?0:vt.slice(0);for(X=S,tt=[],Y=l.preFilter;X;){(!I||(R=jt.exec(X)))&&(R&&(X=X.slice(R[0].length)||X),tt.push(F=[])),I=!1,(R=Gi.exec(X))&&(I=R.shift(),F.push({value:I,type:R[0].replace(Dt," ")}),X=X.slice(I.length));for(G in l.filter)(R=Le[G].exec(X))&&(!Y[G]||(R=Y[G](R)))&&(I=R.shift(),F.push({value:I,type:G,matches:R}),X=X.slice(I.length));if(!I)break}return P?X.length:X?Tt.error(S):St(S,tt).slice(0)}function Es(S){for(var P=0,I=S.length,R="";P<I;P++)R+=S[P].value;return R}function Cs(S,P,I){var R=P.dir,F=P.next,G=F||R,X=I&&G==="parentNode",tt=V++;return P.first?function(Y,vt,lt){for(;Y=Y[R];)if(Y.nodeType===1||X)return S(Y,vt,lt);return!1}:function(Y,vt,lt){var dt,yt,rt=[L,tt];if(lt){for(;Y=Y[R];)if((Y.nodeType===1||X)&&S(Y,vt,lt))return!0}else for(;Y=Y[R];)if(Y.nodeType===1||X)if(yt=Y[B]||(Y[B]={}),F&&W(Y,F))Y=Y[R]||Y;else{if((dt=yt[G])&&dt[0]===L&&dt[1]===tt)return rt[2]=dt[2];if(yt[G]=rt,rt[2]=S(Y,vt,lt))return!0}return!1}}function er(S){return S.length>1?function(P,I,R){for(var F=S.length;F--;)if(!S[F](P,I,R))return!1;return!0}:S[0]}function Ec(S,P,I){for(var R=0,F=P.length;R<F;R++)Tt(S,P[R],I);return I}function Ts(S,P,I,R,F){for(var G,X=[],tt=0,Y=S.length,vt=P!=null;tt<Y;tt++)(G=S[tt])&&(!I||I(G,R,F))&&(X.push(G),vt&&P.push(tt));return X}function ir(S,P,I,R,F,G){return R&&!R[B]&&(R=ir(R)),F&&!F[B]&&(F=ir(F,G)),we(function(X,tt,Y,vt){var lt,dt,yt,rt,It=[],ae=[],Kt=tt.length,ye=X||Ec(P||"*",Y.nodeType?[Y]:Y,[]),Re=S&&(X||!P)?Ts(ye,It,S,Y,vt):ye;if(I?(rt=F||(X?S:Kt||R)?[]:tt,I(Re,rt,Y,vt)):rt=Re,R)for(lt=Ts(rt,ae),R(lt,[],Y,vt),dt=lt.length;dt--;)(yt=lt[dt])&&(rt[ae[dt]]=!(Re[ae[dt]]=yt));if(X){if(F||S){if(F){for(lt=[],dt=rt.length;dt--;)(yt=rt[dt])&&lt.push(Re[dt]=yt);F(null,rt=[],lt,vt)}for(dt=rt.length;dt--;)(yt=rt[dt])&&(lt=F?o.call(X,yt):It[dt])>-1&&(X[lt]=!(tt[lt]=yt))}}else rt=Ts(rt===tt?rt.splice(Kt,rt.length):rt),F?F(null,tt,rt,vt):y.apply(tt,rt)})}function sr(S){for(var P,I,R,F=S.length,G=l.relative[S[0].type],X=G||l.relative[" "],tt=G?1:0,Y=Cs(function(dt){return dt===P},X,!0),vt=Cs(function(dt){return o.call(P,dt)>-1},X,!0),lt=[function(dt,yt,rt){var It=!G&&(rt||yt!=u)||((P=yt).nodeType?Y(dt,yt,rt):vt(dt,yt,rt));return P=null,It}];tt<F;tt++)if(I=l.relative[S[tt].type])lt=[Cs(er(lt),I)];else{if(I=l.filter[S[tt].type].apply(null,S[tt].matches),I[B]){for(R=++tt;R<F&&!l.relative[S[R].type];R++);return ir(tt>1&&er(lt),tt>1&&Es(S.slice(0,tt-1).concat({value:S[tt-2].type===" "?"*":""})).replace(Dt,"$1"),I,tt<R&&sr(S.slice(tt,R)),R<F&&sr(S=S.slice(R)),R<F&&Es(S))}lt.push(I)}return er(lt)}function Cc(S,P){var I=P.length>0,R=S.length>0,F=function(G,X,tt,Y,vt){var lt,dt,yt,rt=0,It="0",ae=G&&[],Kt=[],ye=u,Re=G||R&&l.find.TAG("*",vt),Ci=L+=ye==null?1:Math.random()||.1,ee=Re.length;for(vt&&(u=X==A||X||vt);It!==ee&&(lt=Re[It])!=null;It++){if(R&&lt){for(dt=0,!X&&lt.ownerDocument!=A&&(Ke(lt),tt=!E);yt=S[dt++];)if(yt(lt,X||A,tt)){y.call(Y,lt);break}vt&&(L=Ci)}I&&((lt=!yt&&lt)&&rt--,G&&ae.push(lt))}if(rt+=It,I&&It!==rt){for(dt=0;yt=P[dt++];)yt(ae,Kt,X,tt);if(G){if(rt>0)for(;It--;)ae[It]||Kt[It]||(Kt[It]=ot.call(Y));Kt=Ts(Kt)}y.apply(Y,Kt),vt&&!G&&Kt.length>0&&rt+P.length>1&&p.uniqueSort(Y)}return vt&&(L=Ci,u=ye),ae};return I?we(F):F}function nr(S,P){var I,R=[],F=[],G=gt[S+" "];if(!G){for(P||(P=qi(S)),I=P.length;I--;)G=sr(P[I]),G[B]?R.push(G):F.push(G);G=gt(S,Cc(F,R)),G.selector=S}return G}function Co(S,P,I,R){var F,G,X,tt,Y,vt=typeof S=="function"&&S,lt=!R&&qi(S=vt.selector||S);if(I=I||[],lt.length===1){if(G=lt[0]=lt[0].slice(0),G.length>2&&(X=G[0]).type==="ID"&&P.nodeType===9&&E&&l.relative[G[1].type]){if(P=(l.find.ID(X.matches[0].replace(Ve,ze),P)||[])[0],P)vt&&(P=P.parentNode);else return I;S=S.slice(G.shift().value.length)}for(F=Le.needsContext.test(S)?0:G.length;F--&&(X=G[F],!l.relative[tt=X.type]);)if((Y=l.find[tt])&&(R=Y(X.matches[0].replace(Ve,ze),Zn.test(G[0].type)&&tr(P.parentNode)||P))){if(G.splice(F,1),S=R.length&&Es(G),!S)return y.apply(I,R),I;break}}return(vt||nr(S,lt))(R,P,!E,I,!P||Zn.test(S)&&tr(P.parentNode)||P),I}_.sortStable=B.split("").sort(Gt).join("")===B,Ke(),_.sortDetached=Ei(function(S){return S.compareDocumentPosition(A.createElement("fieldset"))&1}),p.find=Tt,p.expr[":"]=p.expr.pseudos,p.unique=p.uniqueSort,Tt.compile=nr,Tt.select=Co,Tt.setDocument=Ke,Tt.tokenize=qi,Tt.escape=p.escapeSelector,Tt.getText=p.text,Tt.isXML=p.isXMLDoc,Tt.selectors=p.expr,Tt.support=p.support,Tt.uniqueSort=p.uniqueSort})();var $t=function(r,l,u){for(var g=[],v=u!==void 0;(r=r[l])&&r.nodeType!==9;)if(r.nodeType===1){if(v&&p(r).is(u))break;g.push(r)}return g},de=function(r,l){for(var u=[];r;r=r.nextSibling)r.nodeType===1&&r!==l&&u.push(r);return u},Te=p.expr.match.needsContext,te=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ht(r,l,u){return w(l)?p.grep(r,function(g,v){return!!l.call(g,v,g)!==u}):l.nodeType?p.grep(r,function(g){return g===l!==u}):typeof l!="string"?p.grep(r,function(g){return o.call(l,g)>-1!==u}):p.filter(l,r,u)}p.filter=function(r,l,u){var g=l[0];return u&&(r=":not("+r+")"),l.length===1&&g.nodeType===1?p.find.matchesSelector(g,r)?[g]:[]:p.find.matches(r,p.grep(l,function(v){return v.nodeType===1}))},p.fn.extend({find:function(r){var l,u,g=this.length,v=this;if(typeof r!="string")return this.pushStack(p(r).filter(function(){for(l=0;l<g;l++)if(p.contains(v[l],this))return!0}));for(u=this.pushStack([]),l=0;l<g;l++)p.find(r,v[l],u);return g>1?p.uniqueSort(u):u},filter:function(r){return this.pushStack(Ht(this,r||[],!1))},not:function(r){return this.pushStack(Ht(this,r||[],!0))},is:function(r){return!!Ht(this,typeof r=="string"&&Te.test(r)?p(r):r||[],!1).length}});var Ft,qe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ei=p.fn.init=function(r,l,u){var g,v;if(!r)return this;if(u=u||Ft,typeof r=="string")if(r[0]==="<"&&r[r.length-1]===">"&&r.length>=3?g=[null,r,null]:g=qe.exec(r),g&&(g[1]||!l))if(g[1]){if(l=l instanceof p?l[0]:l,p.merge(this,p.parseHTML(g[1],l&&l.nodeType?l.ownerDocument||l:C,!0)),te.test(g[1])&&p.isPlainObject(l))for(g in l)w(this[g])?this[g](l[g]):this.attr(g,l[g]);return this}else return v=C.getElementById(g[2]),v&&(this[0]=v,this.length=1),this;else return!l||l.jquery?(l||u).find(r):this.constructor(l).find(r);else{if(r.nodeType)return this[0]=r,this.length=1,this;if(w(r))return u.ready!==void 0?u.ready(r):r(p)}return p.makeArray(r,this)};ei.prototype=p.fn,Ft=p(C);var ie=/^(?:parents|prev(?:Until|All))/,Mt={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({has:function(r){var l=p(r,this),u=l.length;return this.filter(function(){for(var g=0;g<u;g++)if(p.contains(this,l[g]))return!0})},closest:function(r,l){var u,g=0,v=this.length,y=[],A=typeof r!="string"&&p(r);if(!Te.test(r)){for(;g<v;g++)for(u=this[g];u&&u!==l;u=u.parentNode)if(u.nodeType<11&&(A?A.index(u)>-1:u.nodeType===1&&p.find.matchesSelector(u,r))){y.push(u);break}}return this.pushStack(y.length>1?p.uniqueSort(y):y)},index:function(r){return r?typeof r=="string"?o.call(p(r),this[0]):o.call(this,r.jquery?r[0]:r):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(r,l){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(r,l))))},addBack:function(r){return this.add(r==null?this.prevObject:this.prevObject.filter(r))}});function ue(r,l){for(;(r=r[l])&&r.nodeType!==1;);return r}p.each({parent:function(r){var l=r.parentNode;return l&&l.nodeType!==11?l:null},parents:function(r){return $t(r,"parentNode")},parentsUntil:function(r,l,u){return $t(r,"parentNode",u)},next:function(r){return ue(r,"nextSibling")},prev:function(r){return ue(r,"previousSibling")},nextAll:function(r){return $t(r,"nextSibling")},prevAll:function(r){return $t(r,"previousSibling")},nextUntil:function(r,l,u){return $t(r,"nextSibling",u)},prevUntil:function(r,l,u){return $t(r,"previousSibling",u)},siblings:function(r){return de((r.parentNode||{}).firstChild,r)},children:function(r){return de(r.firstChild)},contents:function(r){return r.contentDocument!=null&&i(r.contentDocument)?r.contentDocument:(W(r,"template")&&(r=r.content||r),p.merge([],r.childNodes))}},function(r,l){p.fn[r]=function(u,g){var v=p.map(this,l,u);return r.slice(-5)!=="Until"&&(g=u),g&&typeof g=="string"&&(v=p.filter(g,v)),this.length>1&&(Mt[r]||p.uniqueSort(v),ie.test(r)&&v.reverse()),this.pushStack(v)}});var fe=/[^\x20\t\r\n\f]+/g;function On(r){var l={};return p.each(r.match(fe)||[],function(u,g){l[g]=!0}),l}p.Callbacks=function(r){r=typeof r=="string"?On(r):p.extend({},r);var l,u,g,v,y=[],A=[],T=-1,E=function(){for(v=v||r.once,g=l=!0;A.length;T=-1)for(u=A.shift();++T<y.length;)y[T].apply(u[0],u[1])===!1&&r.stopOnFalse&&(T=y.length,u=!1);r.memory||(u=!1),l=!1,v&&(u?y=[]:y="")},M={add:function(){return y&&(u&&!l&&(T=y.length-1,A.push(u)),(function N(B){p.each(B,function(L,V){w(V)?(!r.unique||!M.has(V))&&y.push(V):V&&V.length&&O(V)!=="string"&&N(V)})})(arguments),u&&!l&&E()),this},remove:function(){return p.each(arguments,function(N,B){for(var L;(L=p.inArray(B,y,L))>-1;)y.splice(L,1),L<=T&&T--}),this},has:function(N){return N?p.inArray(N,y)>-1:y.length>0},empty:function(){return y&&(y=[]),this},disable:function(){return v=A=[],y=u="",this},disabled:function(){return!y},lock:function(){return v=A=[],!u&&!l&&(y=u=""),this},locked:function(){return!!v},fireWith:function(N,B){return v||(B=B||[],B=[N,B.slice?B.slice():B],A.push(B),l||E()),this},fire:function(){return M.fireWith(this,arguments),this},fired:function(){return!!g}};return M};function vi(r){return r}function bs(r){throw r}function Ga(r,l,u,g){var v;try{r&&w(v=r.promise)?v.call(r).done(l).fail(u):r&&w(v=r.then)?v.call(r,l,u):l.apply(void 0,[r].slice(g))}catch(y){u.apply(void 0,[y])}}p.extend({Deferred:function(r){var l=[["notify","progress",p.Callbacks("memory"),p.Callbacks("memory"),2],["resolve","done",p.Callbacks("once memory"),p.Callbacks("once memory"),0,"resolved"],["reject","fail",p.Callbacks("once memory"),p.Callbacks("once memory"),1,"rejected"]],u="pending",g={state:function(){return u},always:function(){return v.done(arguments).fail(arguments),this},catch:function(y){return g.then(null,y)},pipe:function(){var y=arguments;return p.Deferred(function(A){p.each(l,function(T,E){var M=w(y[E[4]])&&y[E[4]];v[E[1]](function(){var N=M&&M.apply(this,arguments);N&&w(N.promise)?N.promise().progress(A.notify).done(A.resolve).fail(A.reject):A[E[0]+"With"](this,M?[N]:arguments)})}),y=null}).promise()},then:function(y,A,T){var E=0;function M(N,B,L,V){return function(){var ct=this,St=arguments,gt=function(){var Gt,Pe;if(!(N<E)){if(Gt=L.apply(ct,St),Gt===B.promise())throw new TypeError("Thenable self-resolution");Pe=Gt&&(typeof Gt=="object"||typeof Gt=="function")&&Gt.then,w(Pe)?V?Pe.call(Gt,M(E,B,vi,V),M(E,B,bs,V)):(E++,Pe.call(Gt,M(E,B,vi,V),M(E,B,bs,V),M(E,B,vi,B.notifyWith))):(L!==vi&&(ct=void 0,St=[Gt]),(V||B.resolveWith)(ct,St))}},qt=V?gt:function(){try{gt()}catch(Gt){p.Deferred.exceptionHook&&p.Deferred.exceptionHook(Gt,qt.error),N+1>=E&&(L!==bs&&(ct=void 0,St=[Gt]),B.rejectWith(ct,St))}};N?qt():(p.Deferred.getErrorHook?qt.error=p.Deferred.getErrorHook():p.Deferred.getStackHook&&(qt.error=p.Deferred.getStackHook()),c.setTimeout(qt))}}return p.Deferred(function(N){l[0][3].add(M(0,N,w(T)?T:vi,N.notifyWith)),l[1][3].add(M(0,N,w(y)?y:vi)),l[2][3].add(M(0,N,w(A)?A:bs))}).promise()},promise:function(y){return y!=null?p.extend(y,g):g}},v={};return p.each(l,function(y,A){var T=A[2],E=A[5];g[A[1]]=T.add,E&&T.add(function(){u=E},l[3-y][2].disable,l[3-y][3].disable,l[0][2].lock,l[0][3].lock),T.add(A[3].fire),v[A[0]]=function(){return v[A[0]+"With"](this===v?void 0:this,arguments),this},v[A[0]+"With"]=T.fireWith}),g.promise(v),r&&r.call(v,v),v},when:function(r){var l=arguments.length,u=l,g=Array(u),v=s.call(arguments),y=p.Deferred(),A=function(T){return function(E){g[T]=this,v[T]=arguments.length>1?s.call(arguments):E,--l||y.resolveWith(g,v)}};if(l<=1&&(Ga(r,y.done(A(u)).resolve,y.reject,!l),y.state()==="pending"||w(v[u]&&v[u].then)))return y.then();for(;u--;)Ga(v[u],A(u),y.reject);return y.promise()}});var Il=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;p.Deferred.exceptionHook=function(r,l){c.console&&c.console.warn&&r&&Il.test(r.name)&&c.console.warn("jQuery.Deferred exception: "+r.message,r.stack,l)},p.readyException=function(r){c.setTimeout(function(){throw r})};var Fn=p.Deferred();p.fn.ready=function(r){return Fn.then(r).catch(function(l){p.readyException(l)}),this},p.extend({isReady:!1,readyWait:1,ready:function(r){(r===!0?--p.readyWait:p.isReady)||(p.isReady=!0,!(r!==!0&&--p.readyWait>0)&&Fn.resolveWith(C,[p]))}}),p.ready.then=Fn.then;function vs(){C.removeEventListener("DOMContentLoaded",vs),c.removeEventListener("load",vs),p.ready()}C.readyState==="complete"||C.readyState!=="loading"&&!C.documentElement.doScroll?c.setTimeout(p.ready):(C.addEventListener("DOMContentLoaded",vs),c.addEventListener("load",vs));var He=function(r,l,u,g,v,y,A){var T=0,E=r.length,M=u==null;if(O(u)==="object"){v=!0;for(T in u)He(r,l,T,u[T],!0,y,A)}else if(g!==void 0&&(v=!0,w(g)||(A=!0),M&&(A?(l.call(r,g),l=null):(M=l,l=function(N,B,L){return M.call(p(N),L)})),l))for(;T<E;T++)l(r[T],u,A?g:g.call(r[T],T,l(r[T],u)));return v?r:M?l.call(r):E?l(r[0],u):y},Ll=/^-ms-/,Rl=/-([a-z])/g;function Dl(r,l){return l.toUpperCase()}function ke(r){return r.replace(Ll,"ms-").replace(Rl,Dl)}var Fi=function(r){return r.nodeType===1||r.nodeType===9||!+r.nodeType};function Bi(){this.expando=p.expando+Bi.uid++}Bi.uid=1,Bi.prototype={cache:function(r){var l=r[this.expando];return l||(l={},Fi(r)&&(r.nodeType?r[this.expando]=l:Object.defineProperty(r,this.expando,{value:l,configurable:!0}))),l},set:function(r,l,u){var g,v=this.cache(r);if(typeof l=="string")v[ke(l)]=u;else for(g in l)v[ke(g)]=l[g];return v},get:function(r,l){return l===void 0?this.cache(r):r[this.expando]&&r[this.expando][ke(l)]},access:function(r,l,u){return l===void 0||l&&typeof l=="string"&&u===void 0?this.get(r,l):(this.set(r,l,u),u!==void 0?u:l)},remove:function(r,l){var u,g=r[this.expando];if(g!==void 0){if(l!==void 0)for(Array.isArray(l)?l=l.map(ke):(l=ke(l),l=l in g?[l]:l.match(fe)||[]),u=l.length;u--;)delete g[l[u]];(l===void 0||p.isEmptyObject(g))&&(r.nodeType?r[this.expando]=void 0:delete r[this.expando])}},hasData:function(r){var l=r[this.expando];return l!==void 0&&!p.isEmptyObject(l)}};var st=new Bi,se=new Bi,Nl=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ol=/[A-Z]/g;function Fl(r){return r==="true"?!0:r==="false"?!1:r==="null"?null:r===+r+""?+r:Nl.test(r)?JSON.parse(r):r}function Wa(r,l,u){var g;if(u===void 0&&r.nodeType===1)if(g="data-"+l.replace(Ol,"-$&").toLowerCase(),u=r.getAttribute(g),typeof u=="string"){try{u=Fl(u)}catch{}se.set(r,l,u)}else u=void 0;return u}p.extend({hasData:function(r){return se.hasData(r)||st.hasData(r)},data:function(r,l,u){return se.access(r,l,u)},removeData:function(r,l){se.remove(r,l)},_data:function(r,l,u){return st.access(r,l,u)},_removeData:function(r,l){st.remove(r,l)}}),p.fn.extend({data:function(r,l){var u,g,v,y=this[0],A=y&&y.attributes;if(r===void 0){if(this.length&&(v=se.get(y),y.nodeType===1&&!st.get(y,"hasDataAttrs"))){for(u=A.length;u--;)A[u]&&(g=A[u].name,g.indexOf("data-")===0&&(g=ke(g.slice(5)),Wa(y,g,v[g])));st.set(y,"hasDataAttrs",!0)}return v}return typeof r=="object"?this.each(function(){se.set(this,r)}):He(this,function(T){var E;if(y&&T===void 0)return E=se.get(y,r),E!==void 0||(E=Wa(y,r),E!==void 0)?E:void 0;this.each(function(){se.set(this,r,T)})},null,l,arguments.length>1,null,!0)},removeData:function(r){return this.each(function(){se.remove(this,r)})}}),p.extend({queue:function(r,l,u){var g;if(r)return l=(l||"fx")+"queue",g=st.get(r,l),u&&(!g||Array.isArray(u)?g=st.access(r,l,p.makeArray(u)):g.push(u)),g||[]},dequeue:function(r,l){l=l||"fx";var u=p.queue(r,l),g=u.length,v=u.shift(),y=p._queueHooks(r,l),A=function(){p.dequeue(r,l)};v==="inprogress"&&(v=u.shift(),g--),v&&(l==="fx"&&u.unshift("inprogress"),delete y.stop,v.call(r,A,y)),!g&&y&&y.empty.fire()},_queueHooks:function(r,l){var u=l+"queueHooks";return st.get(r,u)||st.access(r,u,{empty:p.Callbacks("once memory").add(function(){st.remove(r,[l+"queue",u])})})}}),p.fn.extend({queue:function(r,l){var u=2;return typeof r!="string"&&(l=r,r="fx",u--),arguments.length<u?p.queue(this[0],r):l===void 0?this:this.each(function(){var g=p.queue(this,r,l);p._queueHooks(this,r),r==="fx"&&g[0]!=="inprogress"&&p.dequeue(this,r)})},dequeue:function(r){return this.each(function(){p.dequeue(this,r)})},clearQueue:function(r){return this.queue(r||"fx",[])},promise:function(r,l){var u,g=1,v=p.Deferred(),y=this,A=this.length,T=function(){--g||v.resolveWith(y,[y])};for(typeof r!="string"&&(l=r,r=void 0),r=r||"fx";A--;)u=st.get(y[A],r+"queueHooks"),u&&u.empty&&(g++,u.empty.add(T));return T(),v.promise(l)}});var qa=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Hi=new RegExp("^(?:([+-])=|)("+qa+")([a-z%]*)$","i"),je=["Top","Right","Bottom","Left"],ii=C.documentElement,yi=function(r){return p.contains(r.ownerDocument,r)},Bl={composed:!0};ii.getRootNode&&(yi=function(r){return p.contains(r.ownerDocument,r)||r.getRootNode(Bl)===r.ownerDocument});var ys=function(r,l){return r=l||r,r.style.display==="none"||r.style.display===""&&yi(r)&&p.css(r,"display")==="none"};function Xa(r,l,u,g){var v,y,A=20,T=g?function(){return g.cur()}:function(){return p.css(r,l,"")},E=T(),M=u&&u[3]||(p.cssNumber[l]?"":"px"),N=r.nodeType&&(p.cssNumber[l]||M!=="px"&&+E)&&Hi.exec(p.css(r,l));if(N&&N[3]!==M){for(E=E/2,M=M||N[3],N=+E||1;A--;)p.style(r,l,N+M),(1-y)*(1-(y=T()/E||.5))<=0&&(A=0),N=N/y;N=N*2,p.style(r,l,N+M),u=u||[]}return u&&(N=+N||+E||0,v=u[1]?N+(u[1]+1)*u[2]:+u[2],g&&(g.unit=M,g.start=N,g.end=v)),v}var Ya={};function Hl(r){var l,u=r.ownerDocument,g=r.nodeName,v=Ya[g];return v||(l=u.body.appendChild(u.createElement(g)),v=p.css(l,"display"),l.parentNode.removeChild(l),v==="none"&&(v="block"),Ya[g]=v,v)}function _i(r,l){for(var u,g,v=[],y=0,A=r.length;y<A;y++)g=r[y],g.style&&(u=g.style.display,l?(u==="none"&&(v[y]=st.get(g,"display")||null,v[y]||(g.style.display="")),g.style.display===""&&ys(g)&&(v[y]=Hl(g))):u!=="none"&&(v[y]="none",st.set(g,"display",u)));for(y=0;y<A;y++)v[y]!=null&&(r[y].style.display=v[y]);return r}p.fn.extend({show:function(){return _i(this,!0)},hide:function(){return _i(this)},toggle:function(r){return typeof r=="boolean"?r?this.show():this.hide():this.each(function(){ys(this)?p(this).show():p(this).hide()})}});var ji=/^(?:checkbox|radio)$/i,Ka=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Qa=/^$|^module$|\/(?:java|ecma)script/i;(function(){var r=C.createDocumentFragment(),l=r.appendChild(C.createElement("div")),u=C.createElement("input");u.setAttribute("type","radio"),u.setAttribute("checked","checked"),u.setAttribute("name","t"),l.appendChild(u),_.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,l.innerHTML="<textarea>x</textarea>",_.noCloneChecked=!!l.cloneNode(!0).lastChild.defaultValue,l.innerHTML="<option></option>",_.option=!!l.lastChild})();var be={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,_.option||(be.optgroup=be.option=[1,"<select multiple='multiple'>","</select>"]);function ne(r,l){var u;return typeof r.getElementsByTagName<"u"?u=r.getElementsByTagName(l||"*"):typeof r.querySelectorAll<"u"?u=r.querySelectorAll(l||"*"):u=[],l===void 0||l&&W(r,l)?p.merge([r],u):u}function Bn(r,l){for(var u=0,g=r.length;u<g;u++)st.set(r[u],"globalEval",!l||st.get(l[u],"globalEval"))}var jl=/<|&#?\w+;/;function Ja(r,l,u,g,v){for(var y,A,T,E,M,N,B=l.createDocumentFragment(),L=[],V=0,ct=r.length;V<ct;V++)if(y=r[V],y||y===0)if(O(y)==="object")p.merge(L,y.nodeType?[y]:y);else if(!jl.test(y))L.push(l.createTextNode(y));else{for(A=A||B.appendChild(l.createElement("div")),T=(Ka.exec(y)||["",""])[1].toLowerCase(),E=be[T]||be._default,A.innerHTML=E[1]+p.htmlPrefilter(y)+E[2],N=E[0];N--;)A=A.lastChild;p.merge(L,A.childNodes),A=B.firstChild,A.textContent=""}for(B.textContent="",V=0;y=L[V++];){if(g&&p.inArray(y,g)>-1){v&&v.push(y);continue}if(M=yi(y),A=ne(B.appendChild(y),"script"),M&&Bn(A),u)for(N=0;y=A[N++];)Qa.test(y.type||"")&&u.push(y)}return B}var Za=/^([^.]*)(?:\.(.+)|)/;function Ai(){return!0}function wi(){return!1}function Hn(r,l,u,g,v,y){var A,T;if(typeof l=="object"){typeof u!="string"&&(g=g||u,u=void 0);for(T in l)Hn(r,T,u,g,l[T],y);return r}if(g==null&&v==null?(v=u,g=u=void 0):v==null&&(typeof u=="string"?(v=g,g=void 0):(v=g,g=u,u=void 0)),v===!1)v=wi;else if(!v)return r;return y===1&&(A=v,v=function(E){return p().off(E),A.apply(this,arguments)},v.guid=A.guid||(A.guid=p.guid++)),r.each(function(){p.event.add(this,l,v,g,u)})}p.event={global:{},add:function(r,l,u,g,v){var y,A,T,E,M,N,B,L,V,ct,St,gt=st.get(r);if(Fi(r))for(u.handler&&(y=u,u=y.handler,v=y.selector),v&&p.find.matchesSelector(ii,v),u.guid||(u.guid=p.guid++),(E=gt.events)||(E=gt.events=Object.create(null)),(A=gt.handle)||(A=gt.handle=function(qt){return typeof p<"u"&&p.event.triggered!==qt.type?p.event.dispatch.apply(r,arguments):void 0}),l=(l||"").match(fe)||[""],M=l.length;M--;)T=Za.exec(l[M])||[],V=St=T[1],ct=(T[2]||"").split(".").sort(),V&&(B=p.event.special[V]||{},V=(v?B.delegateType:B.bindType)||V,B=p.event.special[V]||{},N=p.extend({type:V,origType:St,data:g,handler:u,guid:u.guid,selector:v,needsContext:v&&p.expr.match.needsContext.test(v),namespace:ct.join(".")},y),(L=E[V])||(L=E[V]=[],L.delegateCount=0,(!B.setup||B.setup.call(r,g,ct,A)===!1)&&r.addEventListener&&r.addEventListener(V,A)),B.add&&(B.add.call(r,N),N.handler.guid||(N.handler.guid=u.guid)),v?L.splice(L.delegateCount++,0,N):L.push(N),p.event.global[V]=!0)},remove:function(r,l,u,g,v){var y,A,T,E,M,N,B,L,V,ct,St,gt=st.hasData(r)&&st.get(r);if(!(!gt||!(E=gt.events))){for(l=(l||"").match(fe)||[""],M=l.length;M--;){if(T=Za.exec(l[M])||[],V=St=T[1],ct=(T[2]||"").split(".").sort(),!V){for(V in E)p.event.remove(r,V+l[M],u,g,!0);continue}for(B=p.event.special[V]||{},V=(g?B.delegateType:B.bindType)||V,L=E[V]||[],T=T[2]&&new RegExp("(^|\\.)"+ct.join("\\.(?:.*\\.|)")+"(\\.|$)"),A=y=L.length;y--;)N=L[y],(v||St===N.origType)&&(!u||u.guid===N.guid)&&(!T||T.test(N.namespace))&&(!g||g===N.selector||g==="**"&&N.selector)&&(L.splice(y,1),N.selector&&L.delegateCount--,B.remove&&B.remove.call(r,N));A&&!L.length&&((!B.teardown||B.teardown.call(r,ct,gt.handle)===!1)&&p.removeEvent(r,V,gt.handle),delete E[V])}p.isEmptyObject(E)&&st.remove(r,"handle events")}},dispatch:function(r){var l,u,g,v,y,A,T=new Array(arguments.length),E=p.event.fix(r),M=(st.get(this,"events")||Object.create(null))[E.type]||[],N=p.event.special[E.type]||{};for(T[0]=E,l=1;l<arguments.length;l++)T[l]=arguments[l];if(E.delegateTarget=this,!(N.preDispatch&&N.preDispatch.call(this,E)===!1)){for(A=p.event.handlers.call(this,E,M),l=0;(v=A[l++])&&!E.isPropagationStopped();)for(E.currentTarget=v.elem,u=0;(y=v.handlers[u++])&&!E.isImmediatePropagationStopped();)(!E.rnamespace||y.namespace===!1||E.rnamespace.test(y.namespace))&&(E.handleObj=y,E.data=y.data,g=((p.event.special[y.origType]||{}).handle||y.handler).apply(v.elem,T),g!==void 0&&(E.result=g)===!1&&(E.preventDefault(),E.stopPropagation()));return N.postDispatch&&N.postDispatch.call(this,E),E.result}},handlers:function(r,l){var u,g,v,y,A,T=[],E=l.delegateCount,M=r.target;if(E&&M.nodeType&&!(r.type==="click"&&r.button>=1)){for(;M!==this;M=M.parentNode||this)if(M.nodeType===1&&!(r.type==="click"&&M.disabled===!0)){for(y=[],A={},u=0;u<E;u++)g=l[u],v=g.selector+" ",A[v]===void 0&&(A[v]=g.needsContext?p(v,this).index(M)>-1:p.find(v,this,null,[M]).length),A[v]&&y.push(g);y.length&&T.push({elem:M,handlers:y})}}return M=this,E<l.length&&T.push({elem:M,handlers:l.slice(E)}),T},addProp:function(r,l){Object.defineProperty(p.Event.prototype,r,{enumerable:!0,configurable:!0,get:w(l)?function(){if(this.originalEvent)return l(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[r]},set:function(u){Object.defineProperty(this,r,{enumerable:!0,configurable:!0,writable:!0,value:u})}})},fix:function(r){return r[p.expando]?r:new p.Event(r)},special:{load:{noBubble:!0},click:{setup:function(r){var l=this||r;return ji.test(l.type)&&l.click&&W(l,"input")&&_s(l,"click",!0),!1},trigger:function(r){var l=this||r;return ji.test(l.type)&&l.click&&W(l,"input")&&_s(l,"click"),!0},_default:function(r){var l=r.target;return ji.test(l.type)&&l.click&&W(l,"input")&&st.get(l,"click")||W(l,"a")}},beforeunload:{postDispatch:function(r){r.result!==void 0&&r.originalEvent&&(r.originalEvent.returnValue=r.result)}}}};function _s(r,l,u){if(!u){st.get(r,l)===void 0&&p.event.add(r,l,Ai);return}st.set(r,l,!1),p.event.add(r,l,{namespace:!1,handler:function(g){var v,y=st.get(this,l);if(g.isTrigger&1&&this[l]){if(y)(p.event.special[l]||{}).delegateType&&g.stopPropagation();else if(y=s.call(arguments),st.set(this,l,y),this[l](),v=st.get(this,l),st.set(this,l,!1),y!==v)return g.stopImmediatePropagation(),g.preventDefault(),v}else y&&(st.set(this,l,p.event.trigger(y[0],y.slice(1),this)),g.stopPropagation(),g.isImmediatePropagationStopped=Ai)}})}p.removeEvent=function(r,l,u){r.removeEventListener&&r.removeEventListener(l,u)},p.Event=function(r,l){if(!(this instanceof p.Event))return new p.Event(r,l);r&&r.type?(this.originalEvent=r,this.type=r.type,this.isDefaultPrevented=r.defaultPrevented||r.defaultPrevented===void 0&&r.returnValue===!1?Ai:wi,this.target=r.target&&r.target.nodeType===3?r.target.parentNode:r.target,this.currentTarget=r.currentTarget,this.relatedTarget=r.relatedTarget):this.type=r,l&&p.extend(this,l),this.timeStamp=r&&r.timeStamp||Date.now(),this[p.expando]=!0},p.Event.prototype={constructor:p.Event,isDefaultPrevented:wi,isPropagationStopped:wi,isImmediatePropagationStopped:wi,isSimulated:!1,preventDefault:function(){var r=this.originalEvent;this.isDefaultPrevented=Ai,r&&!this.isSimulated&&r.preventDefault()},stopPropagation:function(){var r=this.originalEvent;this.isPropagationStopped=Ai,r&&!this.isSimulated&&r.stopPropagation()},stopImmediatePropagation:function(){var r=this.originalEvent;this.isImmediatePropagationStopped=Ai,r&&!this.isSimulated&&r.stopImmediatePropagation(),this.stopPropagation()}},p.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},p.event.addProp),p.each({focus:"focusin",blur:"focusout"},function(r,l){function u(g){if(C.documentMode){var v=st.get(this,"handle"),y=p.event.fix(g);y.type=g.type==="focusin"?"focus":"blur",y.isSimulated=!0,v(g),y.target===y.currentTarget&&v(y)}else p.event.simulate(l,g.target,p.event.fix(g))}p.event.special[r]={setup:function(){var g;if(_s(this,r,!0),C.documentMode)g=st.get(this,l),g||this.addEventListener(l,u),st.set(this,l,(g||0)+1);else return!1},trigger:function(){return _s(this,r),!0},teardown:function(){var g;if(C.documentMode)g=st.get(this,l)-1,g?st.set(this,l,g):(this.removeEventListener(l,u),st.remove(this,l));else return!1},_default:function(g){return st.get(g.target,r)},delegateType:l},p.event.special[l]={setup:function(){var g=this.ownerDocument||this.document||this,v=C.documentMode?this:g,y=st.get(v,l);y||(C.documentMode?this.addEventListener(l,u):g.addEventListener(r,u,!0)),st.set(v,l,(y||0)+1)},teardown:function(){var g=this.ownerDocument||this.document||this,v=C.documentMode?this:g,y=st.get(v,l)-1;y?st.set(v,l,y):(C.documentMode?this.removeEventListener(l,u):g.removeEventListener(r,u,!0),st.remove(v,l))}}}),p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(r,l){p.event.special[r]={delegateType:l,bindType:l,handle:function(u){var g,v=this,y=u.relatedTarget,A=u.handleObj;return(!y||y!==v&&!p.contains(v,y))&&(u.type=A.origType,g=A.handler.apply(this,arguments),u.type=l),g}}}),p.fn.extend({on:function(r,l,u,g){return Hn(this,r,l,u,g)},one:function(r,l,u,g){return Hn(this,r,l,u,g,1)},off:function(r,l,u){var g,v;if(r&&r.preventDefault&&r.handleObj)return g=r.handleObj,p(r.delegateTarget).off(g.namespace?g.origType+"."+g.namespace:g.origType,g.selector,g.handler),this;if(typeof r=="object"){for(v in r)this.off(v,l,r[v]);return this}return(l===!1||typeof l=="function")&&(u=l,l=void 0),u===!1&&(u=wi),this.each(function(){p.event.remove(this,r,u,l)})}});var Vl=/<script|<style|<link/i,zl=/checked\s*(?:[^=]|=\s*.checked.)/i,Ul=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function to(r,l){return W(r,"table")&&W(l.nodeType!==11?l:l.firstChild,"tr")&&p(r).children("tbody")[0]||r}function $l(r){return r.type=(r.getAttribute("type")!==null)+"/"+r.type,r}function Gl(r){return(r.type||"").slice(0,5)==="true/"?r.type=r.type.slice(5):r.removeAttribute("type"),r}function eo(r,l){var u,g,v,y,A,T,E;if(l.nodeType===1){if(st.hasData(r)&&(y=st.get(r),E=y.events,E)){st.remove(l,"handle events");for(v in E)for(u=0,g=E[v].length;u<g;u++)p.event.add(l,v,E[v][u])}se.hasData(r)&&(A=se.access(r),T=p.extend({},A),se.set(l,T))}}function Wl(r,l){var u=l.nodeName.toLowerCase();u==="input"&&ji.test(r.type)?l.checked=r.checked:(u==="input"||u==="textarea")&&(l.defaultValue=r.defaultValue)}function xi(r,l,u,g){l=n(l);var v,y,A,T,E,M,N=0,B=r.length,L=B-1,V=l[0],ct=w(V);if(ct||B>1&&typeof V=="string"&&!_.checkClone&&zl.test(V))return r.each(function(St){var gt=r.eq(St);ct&&(l[0]=V.call(this,St,gt.html())),xi(gt,l,u,g)});if(B&&(v=Ja(l,r[0].ownerDocument,!1,r,g),y=v.firstChild,v.childNodes.length===1&&(v=y),y||g)){for(A=p.map(ne(v,"script"),$l),T=A.length;N<B;N++)E=v,N!==L&&(E=p.clone(E,!0,!0),T&&p.merge(A,ne(E,"script"))),u.call(r[N],E,N);if(T)for(M=A[A.length-1].ownerDocument,p.map(A,Gl),N=0;N<T;N++)E=A[N],Qa.test(E.type||"")&&!st.access(E,"globalEval")&&p.contains(M,E)&&(E.src&&(E.type||"").toLowerCase()!=="module"?p._evalUrl&&!E.noModule&&p._evalUrl(E.src,{nonce:E.nonce||E.getAttribute("nonce")},M):D(E.textContent.replace(Ul,""),E,M))}return r}function io(r,l,u){for(var g,v=l?p.filter(l,r):r,y=0;(g=v[y])!=null;y++)!u&&g.nodeType===1&&p.cleanData(ne(g)),g.parentNode&&(u&&yi(g)&&Bn(ne(g,"script")),g.parentNode.removeChild(g));return r}p.extend({htmlPrefilter:function(r){return r},clone:function(r,l,u){var g,v,y,A,T=r.cloneNode(!0),E=yi(r);if(!_.noCloneChecked&&(r.nodeType===1||r.nodeType===11)&&!p.isXMLDoc(r))for(A=ne(T),y=ne(r),g=0,v=y.length;g<v;g++)Wl(y[g],A[g]);if(l)if(u)for(y=y||ne(r),A=A||ne(T),g=0,v=y.length;g<v;g++)eo(y[g],A[g]);else eo(r,T);return A=ne(T,"script"),A.length>0&&Bn(A,!E&&ne(r,"script")),T},cleanData:function(r){for(var l,u,g,v=p.event.special,y=0;(u=r[y])!==void 0;y++)if(Fi(u)){if(l=u[st.expando]){if(l.events)for(g in l.events)v[g]?p.event.remove(u,g):p.removeEvent(u,g,l.handle);u[st.expando]=void 0}u[se.expando]&&(u[se.expando]=void 0)}}}),p.fn.extend({detach:function(r){return io(this,r,!0)},remove:function(r){return io(this,r)},text:function(r){return He(this,function(l){return l===void 0?p.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=l)})},null,r,arguments.length)},append:function(){return xi(this,arguments,function(r){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var l=to(this,r);l.appendChild(r)}})},prepend:function(){return xi(this,arguments,function(r){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var l=to(this,r);l.insertBefore(r,l.firstChild)}})},before:function(){return xi(this,arguments,function(r){this.parentNode&&this.parentNode.insertBefore(r,this)})},after:function(){return xi(this,arguments,function(r){this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling)})},empty:function(){for(var r,l=0;(r=this[l])!=null;l++)r.nodeType===1&&(p.cleanData(ne(r,!1)),r.textContent="");return this},clone:function(r,l){return r=r??!1,l=l??r,this.map(function(){return p.clone(this,r,l)})},html:function(r){return He(this,function(l){var u=this[0]||{},g=0,v=this.length;if(l===void 0&&u.nodeType===1)return u.innerHTML;if(typeof l=="string"&&!Vl.test(l)&&!be[(Ka.exec(l)||["",""])[1].toLowerCase()]){l=p.htmlPrefilter(l);try{for(;g<v;g++)u=this[g]||{},u.nodeType===1&&(p.cleanData(ne(u,!1)),u.innerHTML=l);u=0}catch{}}u&&this.empty().append(l)},null,r,arguments.length)},replaceWith:function(){var r=[];return xi(this,arguments,function(l){var u=this.parentNode;p.inArray(this,r)<0&&(p.cleanData(ne(this)),u&&u.replaceChild(l,this))},r)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(r,l){p.fn[r]=function(u){for(var g,v=[],y=p(u),A=y.length-1,T=0;T<=A;T++)g=T===A?this:this.clone(!0),p(y[T])[l](g),a.apply(v,g.get());return this.pushStack(v)}});var jn=new RegExp("^("+qa+")(?!px)[a-z%]+$","i"),Vn=/^--/,As=function(r){var l=r.ownerDocument.defaultView;return(!l||!l.opener)&&(l=c),l.getComputedStyle(r)},so=function(r,l,u){var g,v,y={};for(v in l)y[v]=r.style[v],r.style[v]=l[v];g=u.call(r);for(v in l)r.style[v]=y[v];return g},ql=new RegExp(je.join("|"),"i");(function(){function r(){if(M){E.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",M.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ii.appendChild(E).appendChild(M);var N=c.getComputedStyle(M);u=N.top!=="1%",T=l(N.marginLeft)===12,M.style.right="60%",y=l(N.right)===36,g=l(N.width)===36,M.style.position="absolute",v=l(M.offsetWidth/3)===12,ii.removeChild(E),M=null}}function l(N){return Math.round(parseFloat(N))}var u,g,v,y,A,T,E=C.createElement("div"),M=C.createElement("div");M.style&&(M.style.backgroundClip="content-box",M.cloneNode(!0).style.backgroundClip="",_.clearCloneStyle=M.style.backgroundClip==="content-box",p.extend(_,{boxSizingReliable:function(){return r(),g},pixelBoxStyles:function(){return r(),y},pixelPosition:function(){return r(),u},reliableMarginLeft:function(){return r(),T},scrollboxSize:function(){return r(),v},reliableTrDimensions:function(){var N,B,L,V;return A==null&&(N=C.createElement("table"),B=C.createElement("tr"),L=C.createElement("div"),N.style.cssText="position:absolute;left:-11111px;border-collapse:separate",B.style.cssText="box-sizing:content-box;border:1px solid",B.style.height="1px",L.style.height="9px",L.style.display="block",ii.appendChild(N).appendChild(B).appendChild(L),V=c.getComputedStyle(B),A=parseInt(V.height,10)+parseInt(V.borderTopWidth,10)+parseInt(V.borderBottomWidth,10)===B.offsetHeight,ii.removeChild(N)),A}}))})();function Vi(r,l,u){var g,v,y,A,T=Vn.test(l),E=r.style;return u=u||As(r),u&&(A=u.getPropertyValue(l)||u[l],T&&A&&(A=A.replace(Dt,"$1")||void 0),A===""&&!yi(r)&&(A=p.style(r,l)),!_.pixelBoxStyles()&&jn.test(A)&&ql.test(l)&&(g=E.width,v=E.minWidth,y=E.maxWidth,E.minWidth=E.maxWidth=E.width=A,A=u.width,E.width=g,E.minWidth=v,E.maxWidth=y)),A!==void 0?A+"":A}function no(r,l){return{get:function(){if(r()){delete this.get;return}return(this.get=l).apply(this,arguments)}}}var ro=["Webkit","Moz","ms"],ao=C.createElement("div").style,oo={};function Xl(r){for(var l=r[0].toUpperCase()+r.slice(1),u=ro.length;u--;)if(r=ro[u]+l,r in ao)return r}function zn(r){var l=p.cssProps[r]||oo[r];return l||(r in ao?r:oo[r]=Xl(r)||r)}var Yl=/^(none|table(?!-c[ea]).+)/,Kl={position:"absolute",visibility:"hidden",display:"block"},lo={letterSpacing:"0",fontWeight:"400"};function co(r,l,u){var g=Hi.exec(l);return g?Math.max(0,g[2]-(u||0))+(g[3]||"px"):l}function Un(r,l,u,g,v,y){var A=l==="width"?1:0,T=0,E=0,M=0;if(u===(g?"border":"content"))return 0;for(;A<4;A+=2)u==="margin"&&(M+=p.css(r,u+je[A],!0,v)),g?(u==="content"&&(E-=p.css(r,"padding"+je[A],!0,v)),u!=="margin"&&(E-=p.css(r,"border"+je[A]+"Width",!0,v))):(E+=p.css(r,"padding"+je[A],!0,v),u!=="padding"?E+=p.css(r,"border"+je[A]+"Width",!0,v):T+=p.css(r,"border"+je[A]+"Width",!0,v));return!g&&y>=0&&(E+=Math.max(0,Math.ceil(r["offset"+l[0].toUpperCase()+l.slice(1)]-y-E-T-.5))||0),E+M}function ho(r,l,u){var g=As(r),v=!_.boxSizingReliable()||u,y=v&&p.css(r,"boxSizing",!1,g)==="border-box",A=y,T=Vi(r,l,g),E="offset"+l[0].toUpperCase()+l.slice(1);if(jn.test(T)){if(!u)return T;T="auto"}return(!_.boxSizingReliable()&&y||!_.reliableTrDimensions()&&W(r,"tr")||T==="auto"||!parseFloat(T)&&p.css(r,"display",!1,g)==="inline")&&r.getClientRects().length&&(y=p.css(r,"boxSizing",!1,g)==="border-box",A=E in r,A&&(T=r[E])),T=parseFloat(T)||0,T+Un(r,l,u||(y?"border":"content"),A,g,T)+"px"}p.extend({cssHooks:{opacity:{get:function(r,l){if(l){var u=Vi(r,"opacity");return u===""?"1":u}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(r,l,u,g){if(!(!r||r.nodeType===3||r.nodeType===8||!r.style)){var v,y,A,T=ke(l),E=Vn.test(l),M=r.style;if(E||(l=zn(T)),A=p.cssHooks[l]||p.cssHooks[T],u!==void 0){if(y=typeof u,y==="string"&&(v=Hi.exec(u))&&v[1]&&(u=Xa(r,l,v),y="number"),u==null||u!==u)return;y==="number"&&!E&&(u+=v&&v[3]||(p.cssNumber[T]?"":"px")),!_.clearCloneStyle&&u===""&&l.indexOf("background")===0&&(M[l]="inherit"),(!A||!("set"in A)||(u=A.set(r,u,g))!==void 0)&&(E?M.setProperty(l,u):M[l]=u)}else return A&&"get"in A&&(v=A.get(r,!1,g))!==void 0?v:M[l]}},css:function(r,l,u,g){var v,y,A,T=ke(l),E=Vn.test(l);return E||(l=zn(T)),A=p.cssHooks[l]||p.cssHooks[T],A&&"get"in A&&(v=A.get(r,!0,u)),v===void 0&&(v=Vi(r,l,g)),v==="normal"&&l in lo&&(v=lo[l]),u===""||u?(y=parseFloat(v),u===!0||isFinite(y)?y||0:v):v}}),p.each(["height","width"],function(r,l){p.cssHooks[l]={get:function(u,g,v){if(g)return Yl.test(p.css(u,"display"))&&(!u.getClientRects().length||!u.getBoundingClientRect().width)?so(u,Kl,function(){return ho(u,l,v)}):ho(u,l,v)},set:function(u,g,v){var y,A=As(u),T=!_.scrollboxSize()&&A.position==="absolute",E=T||v,M=E&&p.css(u,"boxSizing",!1,A)==="border-box",N=v?Un(u,l,v,M,A):0;return M&&T&&(N-=Math.ceil(u["offset"+l[0].toUpperCase()+l.slice(1)]-parseFloat(A[l])-Un(u,l,"border",!1,A)-.5)),N&&(y=Hi.exec(g))&&(y[3]||"px")!=="px"&&(u.style[l]=g,g=p.css(u,l)),co(u,g,N)}}}),p.cssHooks.marginLeft=no(_.reliableMarginLeft,function(r,l){if(l)return(parseFloat(Vi(r,"marginLeft"))||r.getBoundingClientRect().left-so(r,{marginLeft:0},function(){return r.getBoundingClientRect().left}))+"px"}),p.each({margin:"",padding:"",border:"Width"},function(r,l){p.cssHooks[r+l]={expand:function(u){for(var g=0,v={},y=typeof u=="string"?u.split(" "):[u];g<4;g++)v[r+je[g]+l]=y[g]||y[g-2]||y[0];return v}},r!=="margin"&&(p.cssHooks[r+l].set=co)}),p.fn.extend({css:function(r,l){return He(this,function(u,g,v){var y,A,T={},E=0;if(Array.isArray(g)){for(y=As(u),A=g.length;E<A;E++)T[g[E]]=p.css(u,g[E],!1,y);return T}return v!==void 0?p.style(u,g,v):p.css(u,g)},r,l,arguments.length>1)}});function re(r,l,u,g,v){return new re.prototype.init(r,l,u,g,v)}p.Tween=re,re.prototype={constructor:re,init:function(r,l,u,g,v,y){this.elem=r,this.prop=u,this.easing=v||p.easing._default,this.options=l,this.start=this.now=this.cur(),this.end=g,this.unit=y||(p.cssNumber[u]?"":"px")},cur:function(){var r=re.propHooks[this.prop];return r&&r.get?r.get(this):re.propHooks._default.get(this)},run:function(r){var l,u=re.propHooks[this.prop];return this.options.duration?this.pos=l=p.easing[this.easing](r,this.options.duration*r,0,1,this.options.duration):this.pos=l=r,this.now=(this.end-this.start)*l+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),u&&u.set?u.set(this):re.propHooks._default.set(this),this}},re.prototype.init.prototype=re.prototype,re.propHooks={_default:{get:function(r){var l;return r.elem.nodeType!==1||r.elem[r.prop]!=null&&r.elem.style[r.prop]==null?r.elem[r.prop]:(l=p.css(r.elem,r.prop,""),!l||l==="auto"?0:l)},set:function(r){p.fx.step[r.prop]?p.fx.step[r.prop](r):r.elem.nodeType===1&&(p.cssHooks[r.prop]||r.elem.style[zn(r.prop)]!=null)?p.style(r.elem,r.prop,r.now+r.unit):r.elem[r.prop]=r.now}}},re.propHooks.scrollTop=re.propHooks.scrollLeft={set:function(r){r.elem.nodeType&&r.elem.parentNode&&(r.elem[r.prop]=r.now)}},p.easing={linear:function(r){return r},swing:function(r){return .5-Math.cos(r*Math.PI)/2},_default:"swing"},p.fx=re.prototype.init,p.fx.step={};var Si,ws,Ql=/^(?:toggle|show|hide)$/,Jl=/queueHooks$/;function $n(){ws&&(C.hidden===!1&&c.requestAnimationFrame?c.requestAnimationFrame($n):c.setTimeout($n,p.fx.interval),p.fx.tick())}function uo(){return c.setTimeout(function(){Si=void 0}),Si=Date.now()}function xs(r,l){var u,g=0,v={height:r};for(l=l?1:0;g<4;g+=2-l)u=je[g],v["margin"+u]=v["padding"+u]=r;return l&&(v.opacity=v.width=r),v}function fo(r,l,u){for(var g,v=(Ae.tweeners[l]||[]).concat(Ae.tweeners["*"]),y=0,A=v.length;y<A;y++)if(g=v[y].call(u,l,r))return g}function Zl(r,l,u){var g,v,y,A,T,E,M,N,B="width"in l||"height"in l,L=this,V={},ct=r.style,St=r.nodeType&&ys(r),gt=st.get(r,"fxshow");u.queue||(A=p._queueHooks(r,"fx"),A.unqueued==null&&(A.unqueued=0,T=A.empty.fire,A.empty.fire=function(){A.unqueued||T()}),A.unqueued++,L.always(function(){L.always(function(){A.unqueued--,p.queue(r,"fx").length||A.empty.fire()})}));for(g in l)if(v=l[g],Ql.test(v)){if(delete l[g],y=y||v==="toggle",v===(St?"hide":"show"))if(v==="show"&&gt&&gt[g]!==void 0)St=!0;else continue;V[g]=gt&&gt[g]||p.style(r,g)}if(E=!p.isEmptyObject(l),!(!E&&p.isEmptyObject(V))){B&&r.nodeType===1&&(u.overflow=[ct.overflow,ct.overflowX,ct.overflowY],M=gt&&gt.display,M==null&&(M=st.get(r,"display")),N=p.css(r,"display"),N==="none"&&(M?N=M:(_i([r],!0),M=r.style.display||M,N=p.css(r,"display"),_i([r]))),(N==="inline"||N==="inline-block"&&M!=null)&&p.css(r,"float")==="none"&&(E||(L.done(function(){ct.display=M}),M==null&&(N=ct.display,M=N==="none"?"":N)),ct.display="inline-block")),u.overflow&&(ct.overflow="hidden",L.always(function(){ct.overflow=u.overflow[0],ct.overflowX=u.overflow[1],ct.overflowY=u.overflow[2]})),E=!1;for(g in V)E||(gt?"hidden"in gt&&(St=gt.hidden):gt=st.access(r,"fxshow",{display:M}),y&&(gt.hidden=!St),St&&_i([r],!0),L.done(function(){St||_i([r]),st.remove(r,"fxshow");for(g in V)p.style(r,g,V[g])})),E=fo(St?gt[g]:0,g,L),g in gt||(gt[g]=E.start,St&&(E.end=E.start,E.start=0))}}function tc(r,l){var u,g,v,y,A;for(u in r)if(g=ke(u),v=l[g],y=r[u],Array.isArray(y)&&(v=y[1],y=r[u]=y[0]),u!==g&&(r[g]=y,delete r[u]),A=p.cssHooks[g],A&&"expand"in A){y=A.expand(y),delete r[g];for(u in y)u in r||(r[u]=y[u],l[u]=v)}else l[g]=v}function Ae(r,l,u){var g,v,y=0,A=Ae.prefilters.length,T=p.Deferred().always(function(){delete E.elem}),E=function(){if(v)return!1;for(var B=Si||uo(),L=Math.max(0,M.startTime+M.duration-B),V=L/M.duration||0,ct=1-V,St=0,gt=M.tweens.length;St<gt;St++)M.tweens[St].run(ct);return T.notifyWith(r,[M,ct,L]),ct<1&&gt?L:(gt||T.notifyWith(r,[M,1,0]),T.resolveWith(r,[M]),!1)},M=T.promise({elem:r,props:p.extend({},l),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},u),originalProperties:l,originalOptions:u,startTime:Si||uo(),duration:u.duration,tweens:[],createTween:function(B,L){var V=p.Tween(r,M.opts,B,L,M.opts.specialEasing[B]||M.opts.easing);return M.tweens.push(V),V},stop:function(B){var L=0,V=B?M.tweens.length:0;if(v)return this;for(v=!0;L<V;L++)M.tweens[L].run(1);return B?(T.notifyWith(r,[M,1,0]),T.resolveWith(r,[M,B])):T.rejectWith(r,[M,B]),this}}),N=M.props;for(tc(N,M.opts.specialEasing);y<A;y++)if(g=Ae.prefilters[y].call(M,r,N,M.opts),g)return w(g.stop)&&(p._queueHooks(M.elem,M.opts.queue).stop=g.stop.bind(g)),g;return p.map(N,fo,M),w(M.opts.start)&&M.opts.start.call(r,M),M.progress(M.opts.progress).done(M.opts.done,M.opts.complete).fail(M.opts.fail).always(M.opts.always),p.fx.timer(p.extend(E,{elem:r,anim:M,queue:M.opts.queue})),M}p.Animation=p.extend(Ae,{tweeners:{"*":[function(r,l){var u=this.createTween(r,l);return Xa(u.elem,r,Hi.exec(l),u),u}]},tweener:function(r,l){w(r)?(l=r,r=["*"]):r=r.match(fe);for(var u,g=0,v=r.length;g<v;g++)u=r[g],Ae.tweeners[u]=Ae.tweeners[u]||[],Ae.tweeners[u].unshift(l)},prefilters:[Zl],prefilter:function(r,l){l?Ae.prefilters.unshift(r):Ae.prefilters.push(r)}}),p.speed=function(r,l,u){var g=r&&typeof r=="object"?p.extend({},r):{complete:u||!u&&l||w(r)&&r,duration:r,easing:u&&l||l&&!w(l)&&l};return p.fx.off?g.duration=0:typeof g.duration!="number"&&(g.duration in p.fx.speeds?g.duration=p.fx.speeds[g.duration]:g.duration=p.fx.speeds._default),(g.queue==null||g.queue===!0)&&(g.queue="fx"),g.old=g.complete,g.complete=function(){w(g.old)&&g.old.call(this),g.queue&&p.dequeue(this,g.queue)},g},p.fn.extend({fadeTo:function(r,l,u,g){return this.filter(ys).css("opacity",0).show().end().animate({opacity:l},r,u,g)},animate:function(r,l,u,g){var v=p.isEmptyObject(r),y=p.speed(l,u,g),A=function(){var T=Ae(this,p.extend({},r),y);(v||st.get(this,"finish"))&&T.stop(!0)};return A.finish=A,v||y.queue===!1?this.each(A):this.queue(y.queue,A)},stop:function(r,l,u){var g=function(v){var y=v.stop;delete v.stop,y(u)};return typeof r!="string"&&(u=l,l=r,r=void 0),l&&this.queue(r||"fx",[]),this.each(function(){var v=!0,y=r!=null&&r+"queueHooks",A=p.timers,T=st.get(this);if(y)T[y]&&T[y].stop&&g(T[y]);else for(y in T)T[y]&&T[y].stop&&Jl.test(y)&&g(T[y]);for(y=A.length;y--;)A[y].elem===this&&(r==null||A[y].queue===r)&&(A[y].anim.stop(u),v=!1,A.splice(y,1));(v||!u)&&p.dequeue(this,r)})},finish:function(r){return r!==!1&&(r=r||"fx"),this.each(function(){var l,u=st.get(this),g=u[r+"queue"],v=u[r+"queueHooks"],y=p.timers,A=g?g.length:0;for(u.finish=!0,p.queue(this,r,[]),v&&v.stop&&v.stop.call(this,!0),l=y.length;l--;)y[l].elem===this&&y[l].queue===r&&(y[l].anim.stop(!0),y.splice(l,1));for(l=0;l<A;l++)g[l]&&g[l].finish&&g[l].finish.call(this);delete u.finish})}}),p.each(["toggle","show","hide"],function(r,l){var u=p.fn[l];p.fn[l]=function(g,v,y){return g==null||typeof g=="boolean"?u.apply(this,arguments):this.animate(xs(l,!0),g,v,y)}}),p.each({slideDown:xs("show"),slideUp:xs("hide"),slideToggle:xs("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(r,l){p.fn[r]=function(u,g,v){return this.animate(l,u,g,v)}}),p.timers=[],p.fx.tick=function(){var r,l=0,u=p.timers;for(Si=Date.now();l<u.length;l++)r=u[l],!r()&&u[l]===r&&u.splice(l--,1);u.length||p.fx.stop(),Si=void 0},p.fx.timer=function(r){p.timers.push(r),p.fx.start()},p.fx.interval=13,p.fx.start=function(){ws||(ws=!0,$n())},p.fx.stop=function(){ws=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(r,l){return r=p.fx&&p.fx.speeds[r]||r,l=l||"fx",this.queue(l,function(u,g){var v=c.setTimeout(u,r);g.stop=function(){c.clearTimeout(v)}})},(function(){var r=C.createElement("input"),l=C.createElement("select"),u=l.appendChild(C.createElement("option"));r.type="checkbox",_.checkOn=r.value!=="",_.optSelected=u.selected,r=C.createElement("input"),r.value="t",r.type="radio",_.radioValue=r.value==="t"})();var po,zi=p.expr.attrHandle;p.fn.extend({attr:function(r,l){return He(this,p.attr,r,l,arguments.length>1)},removeAttr:function(r){return this.each(function(){p.removeAttr(this,r)})}}),p.extend({attr:function(r,l,u){var g,v,y=r.nodeType;if(!(y===3||y===8||y===2)){if(typeof r.getAttribute>"u")return p.prop(r,l,u);if((y!==1||!p.isXMLDoc(r))&&(v=p.attrHooks[l.toLowerCase()]||(p.expr.match.bool.test(l)?po:void 0)),u!==void 0){if(u===null){p.removeAttr(r,l);return}return v&&"set"in v&&(g=v.set(r,u,l))!==void 0?g:(r.setAttribute(l,u+""),u)}return v&&"get"in v&&(g=v.get(r,l))!==null?g:(g=p.find.attr(r,l),g??void 0)}},attrHooks:{type:{set:function(r,l){if(!_.radioValue&&l==="radio"&&W(r,"input")){var u=r.value;return r.setAttribute("type",l),u&&(r.value=u),l}}}},removeAttr:function(r,l){var u,g=0,v=l&&l.match(fe);if(v&&r.nodeType===1)for(;u=v[g++];)r.removeAttribute(u)}}),po={set:function(r,l,u){return l===!1?p.removeAttr(r,u):r.setAttribute(u,u),u}},p.each(p.expr.match.bool.source.match(/\w+/g),function(r,l){var u=zi[l]||p.find.attr;zi[l]=function(g,v,y){var A,T,E=v.toLowerCase();return y||(T=zi[E],zi[E]=A,A=u(g,v,y)!=null?E:null,zi[E]=T),A}});var ec=/^(?:input|select|textarea|button)$/i,ic=/^(?:a|area)$/i;p.fn.extend({prop:function(r,l){return He(this,p.prop,r,l,arguments.length>1)},removeProp:function(r){return this.each(function(){delete this[p.propFix[r]||r]})}}),p.extend({prop:function(r,l,u){var g,v,y=r.nodeType;if(!(y===3||y===8||y===2))return(y!==1||!p.isXMLDoc(r))&&(l=p.propFix[l]||l,v=p.propHooks[l]),u!==void 0?v&&"set"in v&&(g=v.set(r,u,l))!==void 0?g:r[l]=u:v&&"get"in v&&(g=v.get(r,l))!==null?g:r[l]},propHooks:{tabIndex:{get:function(r){var l=p.find.attr(r,"tabindex");return l?parseInt(l,10):ec.test(r.nodeName)||ic.test(r.nodeName)&&r.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),_.optSelected||(p.propHooks.selected={get:function(r){var l=r.parentNode;return l&&l.parentNode&&l.parentNode.selectedIndex,null},set:function(r){var l=r.parentNode;l&&(l.selectedIndex,l.parentNode&&l.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this});function si(r){var l=r.match(fe)||[];return l.join(" ")}function ni(r){return r.getAttribute&&r.getAttribute("class")||""}function Gn(r){return Array.isArray(r)?r:typeof r=="string"?r.match(fe)||[]:[]}p.fn.extend({addClass:function(r){var l,u,g,v,y,A;return w(r)?this.each(function(T){p(this).addClass(r.call(this,T,ni(this)))}):(l=Gn(r),l.length?this.each(function(){if(g=ni(this),u=this.nodeType===1&&" "+si(g)+" ",u){for(y=0;y<l.length;y++)v=l[y],u.indexOf(" "+v+" ")<0&&(u+=v+" ");A=si(u),g!==A&&this.setAttribute("class",A)}}):this)},removeClass:function(r){var l,u,g,v,y,A;return w(r)?this.each(function(T){p(this).removeClass(r.call(this,T,ni(this)))}):arguments.length?(l=Gn(r),l.length?this.each(function(){if(g=ni(this),u=this.nodeType===1&&" "+si(g)+" ",u){for(y=0;y<l.length;y++)for(v=l[y];u.indexOf(" "+v+" ")>-1;)u=u.replace(" "+v+" "," ");A=si(u),g!==A&&this.setAttribute("class",A)}}):this):this.attr("class","")},toggleClass:function(r,l){var u,g,v,y,A=typeof r,T=A==="string"||Array.isArray(r);return w(r)?this.each(function(E){p(this).toggleClass(r.call(this,E,ni(this),l),l)}):typeof l=="boolean"&&T?l?this.addClass(r):this.removeClass(r):(u=Gn(r),this.each(function(){if(T)for(y=p(this),v=0;v<u.length;v++)g=u[v],y.hasClass(g)?y.removeClass(g):y.addClass(g);else(r===void 0||A==="boolean")&&(g=ni(this),g&&st.set(this,"__className__",g),this.setAttribute&&this.setAttribute("class",g||r===!1?"":st.get(this,"__className__")||""))}))},hasClass:function(r){var l,u,g=0;for(l=" "+r+" ";u=this[g++];)if(u.nodeType===1&&(" "+si(ni(u))+" ").indexOf(l)>-1)return!0;return!1}});var sc=/\r/g;p.fn.extend({val:function(r){var l,u,g,v=this[0];return arguments.length?(g=w(r),this.each(function(y){var A;this.nodeType===1&&(g?A=r.call(this,y,p(this).val()):A=r,A==null?A="":typeof A=="number"?A+="":Array.isArray(A)&&(A=p.map(A,function(T){return T==null?"":T+""})),l=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()],(!l||!("set"in l)||l.set(this,A,"value")===void 0)&&(this.value=A))})):v?(l=p.valHooks[v.type]||p.valHooks[v.nodeName.toLowerCase()],l&&"get"in l&&(u=l.get(v,"value"))!==void 0?u:(u=v.value,typeof u=="string"?u.replace(sc,""):u??"")):void 0}}),p.extend({valHooks:{option:{get:function(r){var l=p.find.attr(r,"value");return l??si(p.text(r))}},select:{get:function(r){var l,u,g,v=r.options,y=r.selectedIndex,A=r.type==="select-one",T=A?null:[],E=A?y+1:v.length;for(y<0?g=E:g=A?y:0;g<E;g++)if(u=v[g],(u.selected||g===y)&&!u.disabled&&(!u.parentNode.disabled||!W(u.parentNode,"optgroup"))){if(l=p(u).val(),A)return l;T.push(l)}return T},set:function(r,l){for(var u,g,v=r.options,y=p.makeArray(l),A=v.length;A--;)g=v[A],(g.selected=p.inArray(p.valHooks.option.get(g),y)>-1)&&(u=!0);return u||(r.selectedIndex=-1),y}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(r,l){if(Array.isArray(l))return r.checked=p.inArray(p(r).val(),l)>-1}},_.checkOn||(p.valHooks[this].get=function(r){return r.getAttribute("value")===null?"on":r.value})});var Ui=c.location,go={guid:Date.now()},Wn=/\?/;p.parseXML=function(r){var l,u;if(!r||typeof r!="string")return null;try{l=new c.DOMParser().parseFromString(r,"text/xml")}catch{}return u=l&&l.getElementsByTagName("parsererror")[0],(!l||u)&&p.error("Invalid XML: "+(u?p.map(u.childNodes,function(g){return g.textContent}).join(`
`):r)),l};var mo=/^(?:focusinfocus|focusoutblur)$/,bo=function(r){r.stopPropagation()};p.extend(p.event,{trigger:function(r,l,u,g){var v,y,A,T,E,M,N,B,L=[u||C],V=f.call(r,"type")?r.type:r,ct=f.call(r,"namespace")?r.namespace.split("."):[];if(y=B=A=u=u||C,!(u.nodeType===3||u.nodeType===8)&&!mo.test(V+p.event.triggered)&&(V.indexOf(".")>-1&&(ct=V.split("."),V=ct.shift(),ct.sort()),E=V.indexOf(":")<0&&"on"+V,r=r[p.expando]?r:new p.Event(V,typeof r=="object"&&r),r.isTrigger=g?2:3,r.namespace=ct.join("."),r.rnamespace=r.namespace?new RegExp("(^|\\.)"+ct.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,r.result=void 0,r.target||(r.target=u),l=l==null?[r]:p.makeArray(l,[r]),N=p.event.special[V]||{},!(!g&&N.trigger&&N.trigger.apply(u,l)===!1))){if(!g&&!N.noBubble&&!x(u)){for(T=N.delegateType||V,mo.test(T+V)||(y=y.parentNode);y;y=y.parentNode)L.push(y),A=y;A===(u.ownerDocument||C)&&L.push(A.defaultView||A.parentWindow||c)}for(v=0;(y=L[v++])&&!r.isPropagationStopped();)B=y,r.type=v>1?T:N.bindType||V,M=(st.get(y,"events")||Object.create(null))[r.type]&&st.get(y,"handle"),M&&M.apply(y,l),M=E&&y[E],M&&M.apply&&Fi(y)&&(r.result=M.apply(y,l),r.result===!1&&r.preventDefault());return r.type=V,!g&&!r.isDefaultPrevented()&&(!N._default||N._default.apply(L.pop(),l)===!1)&&Fi(u)&&E&&w(u[V])&&!x(u)&&(A=u[E],A&&(u[E]=null),p.event.triggered=V,r.isPropagationStopped()&&B.addEventListener(V,bo),u[V](),r.isPropagationStopped()&&B.removeEventListener(V,bo),p.event.triggered=void 0,A&&(u[E]=A)),r.result}},simulate:function(r,l,u){var g=p.extend(new p.Event,u,{type:r,isSimulated:!0});p.event.trigger(g,null,l)}}),p.fn.extend({trigger:function(r,l){return this.each(function(){p.event.trigger(r,l,this)})},triggerHandler:function(r,l){var u=this[0];if(u)return p.event.trigger(r,l,u,!0)}});var nc=/\[\]$/,vo=/\r?\n/g,rc=/^(?:submit|button|image|reset|file)$/i,ac=/^(?:input|select|textarea|keygen)/i;function qn(r,l,u,g){var v;if(Array.isArray(l))p.each(l,function(y,A){u||nc.test(r)?g(r,A):qn(r+"["+(typeof A=="object"&&A!=null?y:"")+"]",A,u,g)});else if(!u&&O(l)==="object")for(v in l)qn(r+"["+v+"]",l[v],u,g);else g(r,l)}p.param=function(r,l){var u,g=[],v=function(y,A){var T=w(A)?A():A;g[g.length]=encodeURIComponent(y)+"="+encodeURIComponent(T??"")};if(r==null)return"";if(Array.isArray(r)||r.jquery&&!p.isPlainObject(r))p.each(r,function(){v(this.name,this.value)});else for(u in r)qn(u,r[u],l,v);return g.join("&")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var r=p.prop(this,"elements");return r?p.makeArray(r):this}).filter(function(){var r=this.type;return this.name&&!p(this).is(":disabled")&&ac.test(this.nodeName)&&!rc.test(r)&&(this.checked||!ji.test(r))}).map(function(r,l){var u=p(this).val();return u==null?null:Array.isArray(u)?p.map(u,function(g){return{name:l.name,value:g.replace(vo,`\r
`)}}):{name:l.name,value:u.replace(vo,`\r
`)}}).get()}});var oc=/%20/g,lc=/#.*$/,cc=/([?&])_=[^&]*/,hc=/^(.*?):[ \t]*([^\r\n]*)$/mg,dc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,uc=/^(?:GET|HEAD)$/,fc=/^\/\//,yo={},Xn={},_o="*/".concat("*"),Yn=C.createElement("a");Yn.href=Ui.href;function Ao(r){return function(l,u){typeof l!="string"&&(u=l,l="*");var g,v=0,y=l.toLowerCase().match(fe)||[];if(w(u))for(;g=y[v++];)g[0]==="+"?(g=g.slice(1)||"*",(r[g]=r[g]||[]).unshift(u)):(r[g]=r[g]||[]).push(u)}}function wo(r,l,u,g){var v={},y=r===Xn;function A(T){var E;return v[T]=!0,p.each(r[T]||[],function(M,N){var B=N(l,u,g);if(typeof B=="string"&&!y&&!v[B])return l.dataTypes.unshift(B),A(B),!1;if(y)return!(E=B)}),E}return A(l.dataTypes[0])||!v["*"]&&A("*")}function Kn(r,l){var u,g,v=p.ajaxSettings.flatOptions||{};for(u in l)l[u]!==void 0&&((v[u]?r:g||(g={}))[u]=l[u]);return g&&p.extend(!0,r,g),r}function pc(r,l,u){for(var g,v,y,A,T=r.contents,E=r.dataTypes;E[0]==="*";)E.shift(),g===void 0&&(g=r.mimeType||l.getResponseHeader("Content-Type"));if(g){for(v in T)if(T[v]&&T[v].test(g)){E.unshift(v);break}}if(E[0]in u)y=E[0];else{for(v in u){if(!E[0]||r.converters[v+" "+E[0]]){y=v;break}A||(A=v)}y=y||A}if(y)return y!==E[0]&&E.unshift(y),u[y]}function gc(r,l,u,g){var v,y,A,T,E,M={},N=r.dataTypes.slice();if(N[1])for(A in r.converters)M[A.toLowerCase()]=r.converters[A];for(y=N.shift();y;)if(r.responseFields[y]&&(u[r.responseFields[y]]=l),!E&&g&&r.dataFilter&&(l=r.dataFilter(l,r.dataType)),E=y,y=N.shift(),y){if(y==="*")y=E;else if(E!=="*"&&E!==y){if(A=M[E+" "+y]||M["* "+y],!A){for(v in M)if(T=v.split(" "),T[1]===y&&(A=M[E+" "+T[0]]||M["* "+T[0]],A)){A===!0?A=M[v]:M[v]!==!0&&(y=T[0],N.unshift(T[1]));break}}if(A!==!0)if(A&&r.throws)l=A(l);else try{l=A(l)}catch(B){return{state:"parsererror",error:A?B:"No conversion from "+E+" to "+y}}}}return{state:"success",data:l}}p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ui.href,type:"GET",isLocal:dc.test(Ui.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_o,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(r,l){return l?Kn(Kn(r,p.ajaxSettings),l):Kn(p.ajaxSettings,r)},ajaxPrefilter:Ao(yo),ajaxTransport:Ao(Xn),ajax:function(r,l){typeof r=="object"&&(l=r,r=void 0),l=l||{};var u,g,v,y,A,T,E,M,N,B,L=p.ajaxSetup({},l),V=L.context||L,ct=L.context&&(V.nodeType||V.jquery)?p(V):p.event,St=p.Deferred(),gt=p.Callbacks("once memory"),qt=L.statusCode||{},Gt={},Pe={},Me="canceled",_t={readyState:0,getResponseHeader:function(Et){var jt;if(E){if(!y)for(y={};jt=hc.exec(v);)y[jt[1].toLowerCase()+" "]=(y[jt[1].toLowerCase()+" "]||[]).concat(jt[2]);jt=y[Et.toLowerCase()+" "]}return jt==null?null:jt.join(", ")},getAllResponseHeaders:function(){return E?v:null},setRequestHeader:function(Et,jt){return E==null&&(Et=Pe[Et.toLowerCase()]=Pe[Et.toLowerCase()]||Et,Gt[Et]=jt),this},overrideMimeType:function(Et){return E==null&&(L.mimeType=Et),this},statusCode:function(Et){var jt;if(Et)if(E)_t.always(Et[_t.status]);else for(jt in Et)qt[jt]=[qt[jt],Et[jt]];return this},abort:function(Et){var jt=Et||Me;return u&&u.abort(jt),ri(0,jt),this}};if(St.promise(_t),L.url=((r||L.url||Ui.href)+"").replace(fc,Ui.protocol+"//"),L.type=l.method||l.type||L.method||L.type,L.dataTypes=(L.dataType||"*").toLowerCase().match(fe)||[""],L.crossDomain==null){T=C.createElement("a");try{T.href=L.url,T.href=T.href,L.crossDomain=Yn.protocol+"//"+Yn.host!=T.protocol+"//"+T.host}catch{L.crossDomain=!0}}if(L.data&&L.processData&&typeof L.data!="string"&&(L.data=p.param(L.data,L.traditional)),wo(yo,L,l,_t),E)return _t;M=p.event&&L.global,M&&p.active++===0&&p.event.trigger("ajaxStart"),L.type=L.type.toUpperCase(),L.hasContent=!uc.test(L.type),g=L.url.replace(lc,""),L.hasContent?L.data&&L.processData&&(L.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(L.data=L.data.replace(oc,"+")):(B=L.url.slice(g.length),L.data&&(L.processData||typeof L.data=="string")&&(g+=(Wn.test(g)?"&":"?")+L.data,delete L.data),L.cache===!1&&(g=g.replace(cc,"$1"),B=(Wn.test(g)?"&":"?")+"_="+go.guid+++B),L.url=g+B),L.ifModified&&(p.lastModified[g]&&_t.setRequestHeader("If-Modified-Since",p.lastModified[g]),p.etag[g]&&_t.setRequestHeader("If-None-Match",p.etag[g])),(L.data&&L.hasContent&&L.contentType!==!1||l.contentType)&&_t.setRequestHeader("Content-Type",L.contentType),_t.setRequestHeader("Accept",L.dataTypes[0]&&L.accepts[L.dataTypes[0]]?L.accepts[L.dataTypes[0]]+(L.dataTypes[0]!=="*"?", "+_o+"; q=0.01":""):L.accepts["*"]);for(N in L.headers)_t.setRequestHeader(N,L.headers[N]);if(L.beforeSend&&(L.beforeSend.call(V,_t,L)===!1||E))return _t.abort();if(Me="abort",gt.add(L.complete),_t.done(L.success),_t.fail(L.error),u=wo(Xn,L,l,_t),!u)ri(-1,"No Transport");else{if(_t.readyState=1,M&&ct.trigger("ajaxSend",[_t,L]),E)return _t;L.async&&L.timeout>0&&(A=c.setTimeout(function(){_t.abort("timeout")},L.timeout));try{E=!1,u.send(Gt,ri)}catch(Et){if(E)throw Et;ri(-1,Et)}}function ri(Et,jt,Gi,Jn){var Ie,Wi,Le,Xe,Ye,ve=jt;E||(E=!0,A&&c.clearTimeout(A),u=void 0,v=Jn||"",_t.readyState=Et>0?4:0,Ie=Et>=200&&Et<300||Et===304,Gi&&(Xe=pc(L,_t,Gi)),!Ie&&p.inArray("script",L.dataTypes)>-1&&p.inArray("json",L.dataTypes)<0&&(L.converters["text script"]=function(){}),Xe=gc(L,Xe,_t,Ie),Ie?(L.ifModified&&(Ye=_t.getResponseHeader("Last-Modified"),Ye&&(p.lastModified[g]=Ye),Ye=_t.getResponseHeader("etag"),Ye&&(p.etag[g]=Ye)),Et===204||L.type==="HEAD"?ve="nocontent":Et===304?ve="notmodified":(ve=Xe.state,Wi=Xe.data,Le=Xe.error,Ie=!Le)):(Le=ve,(Et||!ve)&&(ve="error",Et<0&&(Et=0))),_t.status=Et,_t.statusText=(jt||ve)+"",Ie?St.resolveWith(V,[Wi,ve,_t]):St.rejectWith(V,[_t,ve,Le]),_t.statusCode(qt),qt=void 0,M&&ct.trigger(Ie?"ajaxSuccess":"ajaxError",[_t,L,Ie?Wi:Le]),gt.fireWith(V,[_t,ve]),M&&(ct.trigger("ajaxComplete",[_t,L]),--p.active||p.event.trigger("ajaxStop")))}return _t},getJSON:function(r,l,u){return p.get(r,l,u,"json")},getScript:function(r,l){return p.get(r,void 0,l,"script")}}),p.each(["get","post"],function(r,l){p[l]=function(u,g,v,y){return w(g)&&(y=y||v,v=g,g=void 0),p.ajax(p.extend({url:u,type:l,dataType:y,data:g,success:v},p.isPlainObject(u)&&u))}}),p.ajaxPrefilter(function(r){var l;for(l in r.headers)l.toLowerCase()==="content-type"&&(r.contentType=r.headers[l]||"")}),p._evalUrl=function(r,l,u){return p.ajax({url:r,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(g){p.globalEval(g,l,u)}})},p.fn.extend({wrapAll:function(r){var l;return this[0]&&(w(r)&&(r=r.call(this[0])),l=p(r,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&l.insertBefore(this[0]),l.map(function(){for(var u=this;u.firstElementChild;)u=u.firstElementChild;return u}).append(this)),this},wrapInner:function(r){return w(r)?this.each(function(l){p(this).wrapInner(r.call(this,l))}):this.each(function(){var l=p(this),u=l.contents();u.length?u.wrapAll(r):l.append(r)})},wrap:function(r){var l=w(r);return this.each(function(u){p(this).wrapAll(l?r.call(this,u):r)})},unwrap:function(r){return this.parent(r).not("body").each(function(){p(this).replaceWith(this.childNodes)}),this}}),p.expr.pseudos.hidden=function(r){return!p.expr.pseudos.visible(r)},p.expr.pseudos.visible=function(r){return!!(r.offsetWidth||r.offsetHeight||r.getClientRects().length)},p.ajaxSettings.xhr=function(){try{return new c.XMLHttpRequest}catch{}};var mc={0:200,1223:204},$i=p.ajaxSettings.xhr();_.cors=!!$i&&"withCredentials"in $i,_.ajax=$i=!!$i,p.ajaxTransport(function(r){var l,u;if(_.cors||$i&&!r.crossDomain)return{send:function(g,v){var y,A=r.xhr();if(A.open(r.type,r.url,r.async,r.username,r.password),r.xhrFields)for(y in r.xhrFields)A[y]=r.xhrFields[y];r.mimeType&&A.overrideMimeType&&A.overrideMimeType(r.mimeType),!r.crossDomain&&!g["X-Requested-With"]&&(g["X-Requested-With"]="XMLHttpRequest");for(y in g)A.setRequestHeader(y,g[y]);l=function(T){return function(){l&&(l=u=A.onload=A.onerror=A.onabort=A.ontimeout=A.onreadystatechange=null,T==="abort"?A.abort():T==="error"?typeof A.status!="number"?v(0,"error"):v(A.status,A.statusText):v(mc[A.status]||A.status,A.statusText,(A.responseType||"text")!=="text"||typeof A.responseText!="string"?{binary:A.response}:{text:A.responseText},A.getAllResponseHeaders()))}},A.onload=l(),u=A.onerror=A.ontimeout=l("error"),A.onabort!==void 0?A.onabort=u:A.onreadystatechange=function(){A.readyState===4&&c.setTimeout(function(){l&&u()})},l=l("abort");try{A.send(r.hasContent&&r.data||null)}catch(T){if(l)throw T}},abort:function(){l&&l()}}}),p.ajaxPrefilter(function(r){r.crossDomain&&(r.contents.script=!1)}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(r){return p.globalEval(r),r}}}),p.ajaxPrefilter("script",function(r){r.cache===void 0&&(r.cache=!1),r.crossDomain&&(r.type="GET")}),p.ajaxTransport("script",function(r){if(r.crossDomain||r.scriptAttrs){var l,u;return{send:function(g,v){l=p("<script>").attr(r.scriptAttrs||{}).prop({charset:r.scriptCharset,src:r.url}).on("load error",u=function(y){l.remove(),u=null,y&&v(y.type==="error"?404:200,y.type)}),C.head.appendChild(l[0])},abort:function(){u&&u()}}}});var xo=[],Qn=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var r=xo.pop()||p.expando+"_"+go.guid++;return this[r]=!0,r}}),p.ajaxPrefilter("json jsonp",function(r,l,u){var g,v,y,A=r.jsonp!==!1&&(Qn.test(r.url)?"url":typeof r.data=="string"&&(r.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&Qn.test(r.data)&&"data");if(A||r.dataTypes[0]==="jsonp")return g=r.jsonpCallback=w(r.jsonpCallback)?r.jsonpCallback():r.jsonpCallback,A?r[A]=r[A].replace(Qn,"$1"+g):r.jsonp!==!1&&(r.url+=(Wn.test(r.url)?"&":"?")+r.jsonp+"="+g),r.converters["script json"]=function(){return y||p.error(g+" was not called"),y[0]},r.dataTypes[0]="json",v=c[g],c[g]=function(){y=arguments},u.always(function(){v===void 0?p(c).removeProp(g):c[g]=v,r[g]&&(r.jsonpCallback=l.jsonpCallback,xo.push(g)),y&&w(v)&&v(y[0]),y=v=void 0}),"script"}),_.createHTMLDocument=(function(){var r=C.implementation.createHTMLDocument("").body;return r.innerHTML="<form></form><form></form>",r.childNodes.length===2})(),p.parseHTML=function(r,l,u){if(typeof r!="string")return[];typeof l=="boolean"&&(u=l,l=!1);var g,v,y;return l||(_.createHTMLDocument?(l=C.implementation.createHTMLDocument(""),g=l.createElement("base"),g.href=C.location.href,l.head.appendChild(g)):l=C),v=te.exec(r),y=!u&&[],v?[l.createElement(v[1])]:(v=Ja([r],l,y),y&&y.length&&p(y).remove(),p.merge([],v.childNodes))},p.fn.load=function(r,l,u){var g,v,y,A=this,T=r.indexOf(" ");return T>-1&&(g=si(r.slice(T)),r=r.slice(0,T)),w(l)?(u=l,l=void 0):l&&typeof l=="object"&&(v="POST"),A.length>0&&p.ajax({url:r,type:v||"GET",dataType:"html",data:l}).done(function(E){y=arguments,A.html(g?p("<div>").append(p.parseHTML(E)).find(g):E)}).always(u&&function(E,M){A.each(function(){u.apply(this,y||[E.responseText,M,E])})}),this},p.expr.pseudos.animated=function(r){return p.grep(p.timers,function(l){return r===l.elem}).length},p.offset={setOffset:function(r,l,u){var g,v,y,A,T,E,M,N=p.css(r,"position"),B=p(r),L={};N==="static"&&(r.style.position="relative"),T=B.offset(),y=p.css(r,"top"),E=p.css(r,"left"),M=(N==="absolute"||N==="fixed")&&(y+E).indexOf("auto")>-1,M?(g=B.position(),A=g.top,v=g.left):(A=parseFloat(y)||0,v=parseFloat(E)||0),w(l)&&(l=l.call(r,u,p.extend({},T))),l.top!=null&&(L.top=l.top-T.top+A),l.left!=null&&(L.left=l.left-T.left+v),"using"in l?l.using.call(r,L):B.css(L)}},p.fn.extend({offset:function(r){if(arguments.length)return r===void 0?this:this.each(function(v){p.offset.setOffset(this,r,v)});var l,u,g=this[0];if(g)return g.getClientRects().length?(l=g.getBoundingClientRect(),u=g.ownerDocument.defaultView,{top:l.top+u.pageYOffset,left:l.left+u.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var r,l,u,g=this[0],v={top:0,left:0};if(p.css(g,"position")==="fixed")l=g.getBoundingClientRect();else{for(l=this.offset(),u=g.ownerDocument,r=g.offsetParent||u.documentElement;r&&(r===u.body||r===u.documentElement)&&p.css(r,"position")==="static";)r=r.parentNode;r&&r!==g&&r.nodeType===1&&(v=p(r).offset(),v.top+=p.css(r,"borderTopWidth",!0),v.left+=p.css(r,"borderLeftWidth",!0))}return{top:l.top-v.top-p.css(g,"marginTop",!0),left:l.left-v.left-p.css(g,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var r=this.offsetParent;r&&p.css(r,"position")==="static";)r=r.offsetParent;return r||ii})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(r,l){var u=l==="pageYOffset";p.fn[r]=function(g){return He(this,function(v,y,A){var T;if(x(v)?T=v:v.nodeType===9&&(T=v.defaultView),A===void 0)return T?T[l]:v[y];T?T.scrollTo(u?T.pageXOffset:A,u?A:T.pageYOffset):v[y]=A},r,g,arguments.length)}}),p.each(["top","left"],function(r,l){p.cssHooks[l]=no(_.pixelPosition,function(u,g){if(g)return g=Vi(u,l),jn.test(g)?p(u).position()[l]+"px":g})}),p.each({Height:"height",Width:"width"},function(r,l){p.each({padding:"inner"+r,content:l,"":"outer"+r},function(u,g){p.fn[g]=function(v,y){var A=arguments.length&&(u||typeof v!="boolean"),T=u||(v===!0||y===!0?"margin":"border");return He(this,function(E,M,N){var B;return x(E)?g.indexOf("outer")===0?E["inner"+r]:E.document.documentElement["client"+r]:E.nodeType===9?(B=E.documentElement,Math.max(E.body["scroll"+r],B["scroll"+r],E.body["offset"+r],B["offset"+r],B["client"+r])):N===void 0?p.css(E,M,T):p.style(E,M,N,T)},l,A?v:void 0,A)}})}),p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(r,l){p.fn[l]=function(u){return this.on(l,u)}}),p.fn.extend({bind:function(r,l,u){return this.on(r,null,l,u)},unbind:function(r,l){return this.off(r,null,l)},delegate:function(r,l,u,g){return this.on(l,r,u,g)},undelegate:function(r,l,u){return arguments.length===1?this.off(r,"**"):this.off(l,r||"**",u)},hover:function(r,l){return this.on("mouseenter",r).on("mouseleave",l||r)}}),p.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(r,l){p.fn[l]=function(u,g){return arguments.length>0?this.on(l,null,u,g):this.trigger(l)}});var bc=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;p.proxy=function(r,l){var u,g,v;if(typeof l=="string"&&(u=r[l],l=r,r=u),!!w(r))return g=s.call(arguments,2),v=function(){return r.apply(l||this,g.concat(s.call(arguments)))},v.guid=r.guid=r.guid||p.guid++,v},p.holdReady=function(r){r?p.readyWait++:p.ready(!0)},p.isArray=Array.isArray,p.parseJSON=JSON.parse,p.nodeName=W,p.isFunction=w,p.isWindow=x,p.camelCase=ke,p.type=O,p.now=Date.now,p.isNumeric=function(r){var l=p.type(r);return(l==="number"||l==="string")&&!isNaN(r-parseFloat(r))},p.trim=function(r){return r==null?"":(r+"").replace(bc,"$1")},typeof define=="function"&&define.amd&&define("jquery",[],function(){return p});var vc=c.jQuery,yc=c.$;return p.noConflict=function(r){return c.$===p&&(c.$=yc),r&&c.jQuery===p&&(c.jQuery=vc),p},typeof e>"u"&&(c.jQuery=c.$=p),p})});var Rc=(c,e)=>({"bg-success":c,"bg-secondary":e}),Dc=(c,e)=>({"bg-primary":c,"bg-warning text-dark":e});function Nc(c,e){if(c&1&&(z(0,"div",20)(1,"div",21)(2,"div",22)(3,"h1",23),At(4,"i",24),et(5,"Gesti\xF3n de Documentos "),U(),z(6,"p",25),et(7),U()()()()),c&2){let t=ut();q(7),pe(" ",t.esDocente?"Sube y gestiona tus planes de clase":"Administra planes, documentos administrativos y documentos p\xFAblicos"," ")}}function Oc(c,e){if(c&1){let t=xe();Po(0),z(1,"button",26),kt("click",function(){let s=Lt(t).$implicit,n=ut();return Rt(n.cambiarCategoria(s.key))}),At(2,"i"),et(3),z(4,"span",27),et(5),U()(),Mo()}if(c&2){let t=e.$implicit,i=ut();q(),cr("--tab-color",t.color),Xi("active",i.categoriaActiva===t.key),q(),Io(No("bi ",t.icon," me-1")),q(),pe(" ",t.label," "),q(2),$e(i.contarCategoria(t.key))}}function Fc(c,e){c&1&&(z(0,"div",28),At(1,"div",29),z(2,"div",30),et(3,"Cargando documentos\u2026"),U()())}function Bc(c,e){if(c&1){let t=xe();z(0,"div",28),At(1,"i",31),z(2,"div",32),et(3,"No hay documentos en esta categor\xEDa."),U(),z(4,"button",33),kt("click",function(){Lt(t);let s=ut();return Rt(s.abrirCrear())}),z(5,"span",14),At(6,"ng-lottie",15),U(),z(7,"span"),et(8,"Agregar documento"),U(),At(9,"span",16),U()()}if(c&2){let t=ut();q(6),nt("options",t.tools.optionsAdicionar)}}function Hc(c,e){if(c&1&&(z(0,"div",53),At(1,"i",54),et(2),U()),c&2){let t=ut().$implicit;q(2),pe("",t.publicado_por," ")}}function jc(c,e){if(c&1&&(z(0,"div",53),At(1,"i",55),et(2),U()),c&2){let t=ut().$implicit;q(2),pe("",t.fecha," ")}}function Vc(c,e){if(c&1&&(z(0,"div",56),et(1),U()),c&2){let t=ut().$implicit;q(),pe(" ",t.descripcion," ")}}function zc(c,e){if(c&1&&(z(0,"div",57),At(1,"i",58),et(2),U()),c&2){let t=ut().$implicit;q(2),pe("Dirigido a: ",t.dirigido," ")}}function Uc(c,e){if(c&1){let t=xe();z(0,"button",59),kt("click",function(){Lt(t);let s=ut().$implicit,n=ut(2);return Rt(n.abrirEditar(s))}),At(1,"i",60),U()}}function $c(c,e){if(c&1){let t=xe();z(0,"button",61),kt("click",function(){Lt(t);let s=ut().$implicit,n=ut(2);return Rt(n.eliminar(s))}),At(1,"i",62),U()}}function Gc(c,e){if(c&1){let t=xe();z(0,"div",36)(1,"div",37)(2,"div",38)(3,"div",39)(4,"div",40),At(5,"i",41),U(),z(6,"div",42)(7,"span",43),et(8),U(),z(9,"span",43),et(10),U()()(),z(11,"div",44),et(12),U(),oe(13,Hc,3,1,"div",45)(14,jc,3,1,"div",45)(15,Vc,2,1,"div",46)(16,zc,3,1,"div",47),z(17,"div",48)(18,"button",49),kt("click",function(){let s=Lt(t).$implicit,n=ut(2);return Rt(n.abrirPdf(s))}),At(19,"i",50),et(20),U(),oe(21,Uc,2,0,"button",51)(22,$c,2,0,"button",52),U()()()()}if(c&2){let t=e.$implicit,i=ut(2);q(),nt("ngClass",i.getCategoriaBadgeClass(t.categoria||"")),q(3),nt("ngClass",i.getCategoriaBadgeClass(t.categoria||"")),q(3),nt("ngClass",hr(15,Rc,t.visibilidad==="VISIBLE",t.visibilidad!=="VISIBLE")),q(),$e(t.visibilidad),q(),nt("ngClass",hr(18,Dc,t.estado==="ACTIVO",t.estado!=="ACTIVO")),q(),$e(t.estado),q(2),$e(t.nombre_documento),q(),nt("ngIf",t.publicado_por),q(),nt("ngIf",t.fecha),q(),nt("ngIf",t.descripcion),q(),nt("ngIf",t.dirigido),q(2),nt("disabled",!t.archivo),q(2),pe(" ",i.isMobile?"Descargar":"Ver PDF"," "),q(),nt("ngIf",i.puedeEditar(t)),q(),nt("ngIf",i.puedeEditar(t))}}function Wc(c,e){if(c&1&&(z(0,"div",34),oe(1,Gc,23,21,"div",35),U()),c&2){let t=ut();q(),nt("ngForOf",t.items)}}function qc(c,e){if(c&1&&(z(0,"div",72)(1,"select",79)(2,"option",93),et(3,"PLAN"),U(),z(4,"option",94),et(5,"DOCUMENTOS ADMINISTRATIVOS"),U(),z(6,"option",95),et(7,"DOCUMENTOS P\xDABLICOS"),U()(),z(8,"label"),et(9,"Categor\xEDa *"),U()()),c&2){let t=ut(2);q(),nt("formControl",t.form.controls.categoria)}}function Xc(c,e){c&1&&(z(0,"div",72),At(1,"input",96),z(2,"label"),et(3,"Categor\xEDa"),U()())}function Yc(c,e){if(c&1&&(z(0,"div",97)(1,"div",98)(2,"div",99),et(3),U()()()),c&2){let t=ut(2);q(2),cr("width",t.uploadProgress,"%"),q(),pe(" ",t.uploadProgress,"% ")}}function Kc(c,e){if(c&1&&(z(0,"div",100),At(1,"i",101),et(2),U()),c&2){let t=ut(2);q(2),pe("",t.form.controls.archivo.value," ")}}function Qc(c,e){if(c&1){let t=xe();z(0,"div",63),kt("click",function(){Lt(t);let s=ut();return Rt(s.cerrarModal())}),z(1,"div",64),kt("click",function(s){return Lt(t),Rt(s.stopPropagation())}),z(2,"div",65)(3,"div",66)(4,"h5",67),At(5,"i",68),et(6),U(),z(7,"button",69),kt("click",function(){Lt(t);let s=ut();return Rt(s.cerrarModal())}),U()(),z(8,"div",70)(9,"div",21),oe(10,qc,10,1,"div",71)(11,Xc,4,0,"div",71),z(12,"div",72),At(13,"input",73),z(14,"label"),et(15,"Nombre del documento *"),U()(),z(16,"div",72),At(17,"input",74),z(18,"label"),et(19,"Fecha"),U()(),z(20,"div",72),At(21,"input",75),z(22,"label"),et(23,"Publicado por"),U()(),z(24,"div",72),At(25,"input",75),z(26,"label"),et(27,"Dirigido a"),U()(),z(28,"div",76),At(29,"textarea",77),z(30,"label"),et(31,"Descripci\xF3n"),U()(),z(32,"div",78)(33,"select",79)(34,"option",80),et(35,"ACTIVO"),U(),z(36,"option",81),et(37,"INACTIVO"),U()(),z(38,"label"),et(39,"Estado"),U()(),z(40,"div",78)(41,"select",79)(42,"option",82),et(43,"VISIBLE"),U(),z(44,"option",83),et(45,"OCULTO"),U()(),z(46,"label"),et(47,"Visibilidad"),U()(),z(48,"div",84)(49,"label",85),et(50,"Archivo PDF *"),U(),z(51,"input",86),kt("change",function(s){Lt(t);let n=ut();return Rt(n.onFileSelected(s))}),U(),oe(52,Yc,4,3,"div",87)(53,Kc,3,1,"div",88),U()()(),z(54,"div",89)(55,"div",90)(56,"button",91),kt("click",function(){Lt(t);let s=ut();return Rt(s.cerrarModal())}),z(57,"span",14),At(58,"ng-lottie",15),U(),z(59,"span"),et(60,"CANCELAR"),U(),At(61,"span",16),U(),z(62,"button",92),kt("click",function(){Lt(t);let s=ut();return Rt(s.guardar())}),z(63,"span",14),At(64,"ng-lottie",15),U(),z(65,"span"),et(66),U(),At(67,"span",16),U()()()()()()}if(c&2){let t=ut();q(6),pe(" ",t.editMode?"Editar Documento":"Nuevo Documento"," "),q(4),nt("ngIf",t.esAdmin),q(),nt("ngIf",t.esDocente&&!t.esAdmin),q(2),nt("formControl",t.form.controls.nombre_documento),q(4),nt("formControl",t.form.controls.fecha)("readOnly",t.esDocente),q(4),nt("formControl",t.form.controls.publicado_por)("readOnly",t.esDocente),q(4),nt("formControl",t.form.controls.dirigido)("readOnly",t.esDocente),q(4),nt("formControl",t.form.controls.descripcion),q(4),nt("formControl",t.form.controls.estado),q(8),nt("formControl",t.form.controls.visibilidad),q(11),nt("ngIf",t.uploadProgress!==null),q(),nt("ngIf",t.form.controls.archivo.value),q(5),nt("options",t.tools.optionscancelar),q(6),nt("options",t.editMode?t.tools.optionsEditar:t.tools.optionsAdicionar),q(2),$e(t.editMode?"ACTUALIZAR":"GUARDAR")}}var Pi=class Pi{constructor(e,t,i,s){this.api=e;this.tools=t;this.router=i;this.auth=s;this.ruta=Os.ruta;this.modoEmbed=!1;this.soloPlan=!1;this.allItems=[];this.items=[];this.isLoading=!1;this.searchQuery="";this.uploadProgress=null;this.tipoSesion="";this.esDocente=!1;this.esAdmin=!1;this.docenteNombreCompleto="";this.categoriaActiva="PLAN";this.categorias=[];this.showModal=!1;this.editMode=!1;this.form=new Go({id:new Se(0,{nonNullable:!0}),categoria:new Se("PLAN",{nonNullable:!0}),nombre_documento:new Se("",{nonNullable:!0,validators:[fr.required]}),fecha:new Se(""),archivo:new Se("",{nonNullable:!0,validators:[fr.required]}),estado:new Se("ACTIVO"),visibilidad:new Se("VISIBLE"),publicado_por:new Se(""),dirigido:new Se(""),descripcion:new Se("")})}ngOnInit(){this.auth.pedirPerfil().subscribe({next:e=>{if(this.tipoSesion=(e?.tipo??"").toString(),this.esDocente=this.tipoSesion==="planteldocentes",this.esAdmin=["planteladministrativos","superlcchs"].includes(this.tipoSesion),this.esDocente&&e?.usuario){let t=(e.usuario.Apellidos??e.usuario.apellidos??"").toString().trim(),i=(e.usuario.Nombres??e.usuario.nombres??"").toString().trim();this.docenteNombreCompleto=(t+" "+i).trim()}this.buildCategorias(),this.cargar()},error:()=>{this.buildCategorias(),this.cargar()}})}buildCategorias(){if(this.categorias=[],this.soloPlan||this.modoEmbed){this.categorias=[{key:"PLAN",label:"Mis Planes",icon:"bi-journal-text",color:"#0d6efd"}],this.categoriaActiva="PLAN";return}this.esDocente?(this.categorias=[{key:"PLAN",label:"Mis Planes",icon:"bi-journal-text",color:"#0d6efd"}],this.categoriaActiva="PLAN"):this.categorias=[{key:"PLAN",label:"Planes",icon:"bi-journal-text",color:"#0d6efd"},{key:"DOCUMENTOS_ADMINISTRATIVOS",label:"Docs. Administrativos",icon:"bi-file-earmark-text",color:"#198754"},{key:"DOCUMENTOS_PUBLICOS",label:"Docs. P\xFAblicos",icon:"bi-globe",color:"#dc3545"}]}cargar(){this.isLoading=!0,this.api.listar().subscribe({next:e=>{this.allItems=e?.data??[],this.filtrar(),this.isLoading=!1},error:e=>{console.error(e),this.isLoading=!1,this.tools.MostrarMensaje("error","Error al cargar documentos")}})}filtrar(){let e=this.allItems.filter(t=>(t.categoria??"").toUpperCase()===this.categoriaActiva);if(this.searchQuery.trim()){let t=this.searchQuery.toLowerCase();e=e.filter(i=>(i.nombre_documento??"").toLowerCase().includes(t)||(i.publicado_por??"").toLowerCase().includes(t)||(i.descripcion??"").toLowerCase().includes(t))}this.items=e}cambiarCategoria(e){this.categoriaActiva=e,this.filtrar()}onSearch(){this.filtrar()}abrirCrear(){if(this.editMode=!1,this.limpiarForm(),this.form.patchValue({categoria:this.categoriaActiva}),this.esDocente){let e=new Date().toISOString().split("T")[0];this.form.patchValue({publicado_por:this.docenteNombreCompleto,dirigido:"PLANTEL INSTITUCIONAL",fecha:e})}this.showModal=!0}abrirEditar(e){if(this.editMode=!0,this.form.patchValue({id:e.id,categoria:e.categoria??"PLAN",nombre_documento:e.nombre_documento??"",fecha:e.fecha??"",archivo:e.archivo??"",estado:e.estado??"ACTIVO",visibilidad:e.visibilidad??"VISIBLE",publicado_por:e.publicado_por??"",dirigido:e.dirigido??"",descripcion:e.descripcion??""}),this.esDocente){let t=new Date().toISOString().split("T")[0];this.form.patchValue({publicado_por:this.docenteNombreCompleto,dirigido:"PLANTEL INSTITUCIONAL",fecha:t})}this.showModal=!0}cerrarModal(){this.showModal=!1,this.limpiarForm()}limpiarForm(){this.form.reset({id:0,categoria:this.categoriaActiva,nombre_documento:"",fecha:"",archivo:"",estado:"ACTIVO",visibilidad:"VISIBLE",publicado_por:"",dirigido:"",descripcion:""}),this.uploadProgress=null}eliminar(e){return Q(this,null,function*(){(yield this.tools.mostrarMensajeConfirm("Eliminar","\xBFEliminar este documento?","warning","S\xED, eliminar"))&&this.api.eliminar(e.id).subscribe({next:()=>{e.archivo&&this.tools.EliminarArchivo(e.archivo),this.tools.MostrarMensaje("success","Eliminado"),this.cargar()},error:i=>{console.error(i),this.tools.MostrarMensaje("error","Error al eliminar")}})})}ver(e){this.router.navigate(["/gestioninstitucion/visor-biblioteca",e.id])}onFileSelected(e){let i=e.target.files?.[0];if(i){if(!i.name.toLowerCase().endsWith(".pdf")){this.tools.MostrarMensaje("warning","Solo se permite PDF");return}this.uploadProgress=0,this.tools.SubirArchivo(i,"bibliotecaPdf").subscribe({next:s=>{if(s.type===dr.UploadProgress){let n=s.total??0;n>0&&(this.uploadProgress=Math.round(s.loaded/n*100))}if(s.type===dr.Response){let a=s.body?.filePath;a&&(this.form.patchValue({archivo:String(a)}),this.tools.MostrarMensaje("success","PDF subido")),this.uploadProgress=null}},error:s=>{console.error(s),this.uploadProgress=null,this.tools.MostrarMensaje("error","Error al subir PDF")}})}}guardar(){if(this.form.invalid){this.tools.MostrarMensajeFrmIncompleto();return}let e=Number(this.form.value.id??0),t={categoria:this.form.value.categoria??this.categoriaActiva,nombre_documento:this.form.value.nombre_documento??null,fecha:this.form.value.fecha??null,archivo:this.form.value.archivo??null,estado:this.form.value.estado??null,visibilidad:this.form.value.visibilidad??null,publicado_por:this.form.value.publicado_por??null,dirigido:this.form.value.dirigido??null,descripcion:this.form.value.descripcion??null};if(!e){this.api.crear(t).subscribe({next:()=>{this.tools.MostrarMensaje("success","Guardado"),this.cerrarModal(),this.cargar()},error:i=>{console.error(i),this.tools.MostrarMensaje("error","Error al guardar")}});return}this.api.modificar(e,t).subscribe({next:()=>{this.tools.MostrarMensaje("success","Actualizado"),this.cerrarModal(),this.cargar()},error:i=>{console.error(i),this.tools.MostrarMensaje("error","Error al actualizar")}})}puedeEditar(e){return this.esAdmin?!0:this.esDocente&&(e.categoria??"").toUpperCase()==="PLAN"?(e.publicado_por??"").trim()===this.docenteNombreCompleto:!1}getCategoriaBadgeClass(e){switch((e??"").toUpperCase()){case"PLAN":return"badge-plan";case"DOCUMENTOS_ADMINISTRATIVOS":return"badge-documento";case"DOCUMENTOS_PUBLICOS":return"badge-importante";default:return"badge-secondary"}}getCategoriaLabel(e){switch((e??"").toUpperCase()){case"PLAN":return"Plan";case"DOCUMENTOS_ADMINISTRATIVOS":return"Doc. Administrativo";case"DOCUMENTOS_PUBLICOS":return"Doc. P\xFAblico";default:return e||"Sin categor\xEDa"}}contarCategoria(e){return this.allItems.filter(t=>(t.categoria??"").toUpperCase()===e).length}get isMobile(){return typeof window<"u"&&window.innerWidth<992}descargarPdf(e){if(!e.archivo)return;let t=e.archivo.startsWith("http")?e.archivo:this.ruta+e.archivo,i=document.createElement("a");i.href=t,i.download=(e.nombre_documento??"documento")+".pdf",i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i)}abrirPdf(e){this.isMobile?this.descargarPdf(e):this.ver(e)}};Pi.\u0275fac=function(t){return new(t||Pi)(Ne(Fs),Ne(el),Ne(Ns),Ne(Zo))},Pi.\u0275cmp=Is({type:Pi,selectors:[["app-bibliotecaarchivoslcch"]],inputs:{modoEmbed:"modoEmbed",soloPlan:"soloPlan"},standalone:!1,decls:25,vars:10,consts:[["class","container mt-4",4,"ngIf"],[1,"container","py-3"],[1,"cat-tabs-bar","mb-3"],[1,"d-flex","flex-wrap","gap-2","align-items-center"],[4,"ngFor","ngForOf"],[1,"ms-auto","d-flex","gap-2","align-items-center"],[1,"input-group",2,"max-width","280px"],[1,"input-group-text"],["width","30px","height","30px",3,"options"],[1,"form-floating"],["type","search","placeholder","Buscar",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-sm","btn-outline-secondary",3,"click","disabled"],[1,"bi","bi-arrow-clockwise"],[1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],[2,"display","flex","align-items","center","justify-content","center","width","30px","height","30px"],["width","50px","height","50px",3,"options"],[1,"dir-part"],["class","text-center py-5",4,"ngIf"],["class","row g-3",4,"ngIf"],["class","modal d-block","tabindex","-1","style","background: rgba(0,0,0,.5);",3,"click",4,"ngIf"],[1,"container","mt-4"],[1,"row"],[1,"col","text-center"],[1,"display-5","fw-bold","titulosGlobales"],[1,"bi","bi-archive","me-2"],[1,"text-secondary","subtitulosGlobales"],[1,"btn","cat-tab-btn",3,"click"],[1,"badge","bg-light","text-dark","ms-1"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"mt-2","text-muted"],[1,"bi","bi-folder2-open","display-1","text-muted"],[1,"text-muted","mt-2"],[1,"btn","mouse-dir","primary","d-flex","align-items-center","mt-3",2,"gap","8px",3,"click"],[1,"row","g-3"],["class","col-12 col-sm-6 col-lg-4 col-xl-3",4,"ngFor","ngForOf"],[1,"col-12","col-sm-6","col-lg-4","col-xl-3"],[1,"card","doc-card","h-100","shadow-sm",3,"ngClass"],[1,"card-body","d-flex","flex-column"],[1,"d-flex","align-items-start","justify-content-between","gap-2","mb-2"],[1,"doc-icon-circle",3,"ngClass"],[1,"bi","bi-file-earmark-pdf"],[1,"d-flex","gap-1"],[1,"badge",3,"ngClass"],[1,"fw-semibold","text-black","mb-1","doc-title"],["class","small text-muted mb-1",4,"ngIf"],["class","small text-muted mb-2 text-truncate-2",4,"ngIf"],["class","small text-muted mb-2",4,"ngIf"],[1,"mt-auto","d-flex","flex-wrap","gap-1","pt-2"],[1,"btn","btn-sm","btn-outline-primary","flex-fill",3,"click","disabled"],[1,"bi","bi-eye","me-1"],["class","btn btn-sm btn-outline-secondary",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-danger",3,"click",4,"ngIf"],[1,"small","text-muted","mb-1"],[1,"bi","bi-person","me-1"],[1,"bi","bi-calendar3","me-1"],[1,"small","text-muted","mb-2","text-truncate-2"],[1,"small","text-muted","mb-2"],[1,"bi","bi-people","me-1"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],["tabindex","-1",1,"modal","d-block",2,"background","rgba(0,0,0,.5)",3,"click"],[1,"modal-dialog","modal-dialog-centered","modal-lg",3,"click"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"bi","bi-file-earmark-plus","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["class","form-floating mb-3 col-12 col-md-6",4,"ngIf"],[1,"form-floating","mb-3","col-12","col-md-6"],["type","text","placeholder"," ",1,"form-control",3,"formControl"],["type","date","placeholder"," ",1,"form-control",3,"formControl","readOnly"],["type","text","placeholder"," ",1,"form-control",3,"formControl","readOnly"],[1,"form-floating","mb-3","col-12"],["placeholder"," ",1,"form-control",2,"height","80px",3,"formControl"],[1,"form-floating","mb-3","col-6","col-md-3"],[1,"form-control",3,"formControl"],["value","ACTIVO"],["value","INACTIVO"],["value","VISIBLE"],["value","OCULTO"],[1,"col-12","col-md-6"],[1,"form-label","fw-semibold"],["type","file","accept","application/pdf",1,"form-control",3,"change"],["class","mt-2",4,"ngIf"],["class","small text-muted mt-1",4,"ngIf"],[1,"modal-footer"],[1,"d-flex","justify-content-start","button",2,"gap","10px"],["type","button",1,"btn","mouse-dir","secondary","d-flex","align-items-center",2,"gap","8px",3,"click"],["type","button",1,"btn","mouse-dir","primary","d-flex","align-items-center",2,"gap","8px",3,"click"],["value","PLAN"],["value","DOCUMENTOS_ADMINISTRATIVOS"],["value","DOCUMENTOS_PUBLICOS"],["type","text","placeholder"," ","value","PLAN","disabled","",1,"form-control"],[1,"mt-2"],[1,"progress",2,"height","22px"],["role","progressbar",1,"progress-bar","progress-bar-striped","progress-bar-animated"],[1,"small","text-muted","mt-1"],[1,"bi","bi-check-circle","text-success","me-1"]],template:function(t,i){t&1&&(oe(0,Nc,8,1,"div",0),z(1,"div",1)(2,"div",2)(3,"div",3),oe(4,Oc,6,9,"ng-container",4),z(5,"div",5)(6,"div",6)(7,"span",7),At(8,"ng-lottie",8),U(),z(9,"div",9)(10,"input",10),Do("ngModelChange",function(n){return Ro(i.searchQuery,n)||(i.searchQuery=n),n}),kt("ngModelChange",function(){return i.onSearch()}),U(),z(11,"label"),et(12,"Buscar"),U()()(),z(13,"button",11),kt("click",function(){return i.cargar()}),At(14,"i",12),U(),z(15,"button",13),kt("click",function(){return i.abrirCrear()}),z(16,"span",14),At(17,"ng-lottie",15),U(),z(18,"span"),et(19,"Nuevo"),U(),At(20,"span",16),U()()()(),oe(21,Fc,4,0,"div",17)(22,Bc,10,1,"div",17)(23,Wc,2,1,"div",18),U(),oe(24,Qc,68,18,"div",19)),t&2&&(nt("ngIf",!i.modoEmbed),q(4),nt("ngForOf",i.categorias),q(4),nt("options",i.tools.optionslupa),q(2),Lo("ngModel",i.searchQuery),q(3),nt("disabled",i.isLoading),q(4),nt("options",i.tools.optionsAdicionar),q(4),nt("ngIf",i.isLoading),q(),nt("ngIf",!i.isLoading&&i.items.length===0),q(),nt("ngIf",!i.isLoading&&i.items.length>0),q(),nt("ngIf",i.showModal))},dependencies:[Rs,Bo,Ds,Yo,Ko,Uo,Xo,$o,Wo,qo,tl],styles:['@charset "UTF-8";.cat-tabs-bar[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:12px 16px;box-shadow:0 2px 8px #0000000f}.cat-tab-btn[_ngcontent-%COMP%]{border:2px solid #dee2e6;border-radius:8px;padding:6px 16px;font-weight:500;background:#fff;color:#495057;transition:all .2s ease}.cat-tab-btn[_ngcontent-%COMP%]:hover{border-color:var(--tab-color, #0d6efd);color:var(--tab-color, #0d6efd);background:#0d6efd0a}.cat-tab-btn.active[_ngcontent-%COMP%]{border-color:var(--tab-color, #0d6efd);background:var(--tab-color, #0d6efd);color:#fff}.cat-tab-btn.active[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#ffffffe6!important;color:var(--tab-color, #0d6efd)!important}.doc-card[_ngcontent-%COMP%]{border:none;border-radius:12px;border-left:4px solid #dee2e6;transition:transform .2s ease,box-shadow .2s ease}.doc-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 20px #0000001a!important}.doc-card.badge-plan[_ngcontent-%COMP%]{border-left-color:#0d6efd}.doc-card.badge-documento[_ngcontent-%COMP%]{border-left-color:#198754}.doc-card.badge-importante[_ngcontent-%COMP%]{border-left-color:#dc3545}.doc-icon-circle[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.2rem;color:#fff;flex-shrink:0}.doc-icon-circle.badge-plan[_ngcontent-%COMP%]{background:#0d6efd}.doc-icon-circle.badge-documento[_ngcontent-%COMP%]{background:#198754}.doc-icon-circle.badge-importante[_ngcontent-%COMP%]{background:#dc3545}.doc-icon-circle.badge-secondary[_ngcontent-%COMP%]{background:#6c757d}.doc-title[_ngcontent-%COMP%]{font-size:.95rem;line-height:1.3;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.text-truncate-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{transition:width .2s ease}.modal[_ngcontent-%COMP%]{z-index:1060}@media (max-width: 575.98px){.cat-tabs-bar[_ngcontent-%COMP%]{padding:8px 10px}.cat-tab-btn[_ngcontent-%COMP%]{font-size:.85rem;padding:5px 10px}}']});var Bs=Pi;var $a=kc(nl());var ts={};ts.d=(c,e)=>{for(var t in e)ts.o(e,t)&&!ts.o(c,t)&&Object.defineProperty(c,t,{enumerable:!0,get:e[t]})};ts.o=(c,e)=>Object.prototype.hasOwnProperty.call(c,e);var ht=globalThis.pdfjsLib={};ts.d(ht,{AbortException:()=>Be,AnnotationEditorLayer:()=>Xh,AnnotationEditorParamsType:()=>xt,AnnotationEditorType:()=>ft,AnnotationEditorUIManager:()=>as,AnnotationLayer:()=>Pa,AnnotationMode:()=>Qe,ColorPicker:()=>wn,DOMSVGFactory:()=>ds,DrawLayer:()=>Ba,FeatureTest:()=>Xt,GlobalWorkerOptions:()=>di,ImageKind:()=>Gs,InvalidPDFException:()=>is,MissingPDFException:()=>ui,OPS:()=>Ee,OutputScale:()=>rs,PDFDataRangeTransport:()=>hn,PDFDateString:()=>Ks,PDFWorker:()=>Li,PasswordResponses:()=>ih,PermissionFlag:()=>eh,PixelsPerInch:()=>Ze,RenderingCancelledException:()=>ns,TextLayer:()=>cs,TouchManager:()=>Js,UnexpectedResponseException:()=>Ni,Util:()=>it,VerbosityLevel:()=>Cn,XfaLayer:()=>fn,build:()=>Gh,createValidAbsoluteUrl:()=>ah,fetchData:()=>Mn,getDocument:()=>Vh,getFilenameFromUrl:()=>ph,getPdfFilenameFromUrl:()=>gh,getXfaPageViewport:()=>mh,isDataScheme:()=>In,isPdfFile:()=>Va,noContextMenu:()=>Ce,normalizeUnicode:()=>dh,setLayerDimensions:()=>fi,shadow:()=>bt,stopEvent:()=>me,version:()=>$h});var Zt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),_l=[1,0,0,1,0,0],_r=[.001,0,0,.001,0,0],Jc=1e7,$s=1.35,Zc=.35,fd=Zc/$s,ge={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Qe={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},th="pdfjs_internal_editor_",ft={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},xt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},eh={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Qt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Gs={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Wt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};var Yi={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};var Cn={ERRORS:0,WARNINGS:1,INFOS:5},Ee={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},ih={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},Tn=Cn.WARNINGS;function sh(c){Number.isInteger(c)&&(Tn=c)}function nh(){return Tn}function kn(c){Tn>=Cn.INFOS&&console.log(`Info: ${c}`)}function pt(c){Tn>=Cn.WARNINGS&&console.log(`Warning: ${c}`)}function Pt(c){throw new Error(c)}function Ut(c,e){c||Pt(e)}function rh(c){switch(c?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ah(c,e=null,t=null){if(!c)return null;try{if(t&&typeof c=="string"&&(t.addDefaultProtocol&&c.startsWith("www.")&&c.match(/\./g)?.length>=2&&(c=`http://${c}`),t.tryConvertEncoding))try{c=hh(c)}catch{}let i=e?new URL(c,e):new URL(c);if(rh(i))return i}catch{}return null}function bt(c,e,t,i=!1){return Object.defineProperty(c,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}var ti=(function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e})(),Xs=class extends ti{constructor(e,t){super(e,"PasswordException"),this.code=t}},es=class extends ti{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},is=class extends ti{constructor(e){super(e,"InvalidPDFException")}},ui=class extends ti{constructor(e){super(e,"MissingPDFException")}},Ni=class extends ti{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},Ar=class extends ti{constructor(e){super(e,"FormatError")}},Be=class extends ti{constructor(e){super(e,"AbortException")}};function Al(c){(typeof c!="object"||c?.length===void 0)&&Pt("Invalid argument for bytesToString");let e=c.length,t=8192;if(e<t)return String.fromCharCode.apply(null,c);let i=[];for(let s=0;s<e;s+=t){let n=Math.min(s+t,e),a=c.subarray(s,n);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Pn(c){typeof c!="string"&&Pt("Invalid argument for stringToBytes");let e=c.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=c.charCodeAt(i)&255;return t}function oh(c){return String.fromCharCode(c>>24&255,c>>16&255,c>>8&255,c&255)}function Ha(c){let e=Object.create(null);for(let[t,i]of c)e[t]=i;return e}function lh(){let c=new Uint8Array(4);return c[0]=1,new Uint32Array(c.buffer,0,1)[0]===1}function ch(){try{return new Function(""),!0}catch{return!1}}var Xt=class{static get isLittleEndian(){return bt(this,"isLittleEndian",lh())}static get isEvalSupported(){return bt(this,"isEvalSupported",ch())}static get isOffscreenCanvasSupported(){return bt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return bt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?bt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):bt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return bt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}},gr=Array.from(Array(256).keys(),c=>c.toString(16).padStart(2,"0")),it=class{static makeHexColor(e,t,i){return`#${gr[e]}${gr[t]}${gr[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){let i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){let i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,n=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,n]}static getAxialAlignedBoundingBox(e,t){let i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),n=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],n[0],a[0]),Math.min(i[1],s[1],n[1],a[1]),Math.max(i[0],s[0],n[0],a[0]),Math.max(i[1],s[1],n[1],a[1])]}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){let t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],n=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(i+a)/2,h=Math.sqrt((i+a)**2-4*(i*a-n*s))/2,d=o+h||1,f=o-h||1;return[Math.sqrt(d),Math.sqrt(f)]}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;let n=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return n>a?null:[i,n,s,a]}static#t(e,t,i,s,n,a,o,h,d,f){if(d<=0||d>=1)return;let m=1-d,b=d*d,_=b*d,w=m*(m*(m*e+3*d*t)+3*b*i)+_*s,x=m*(m*(m*n+3*d*a)+3*b*o)+_*h;f[0]=Math.min(f[0],w),f[1]=Math.min(f[1],x),f[2]=Math.max(f[2],w),f[3]=Math.max(f[3],x)}static#e(e,t,i,s,n,a,o,h,d,f,m,b){if(Math.abs(d)<1e-12){Math.abs(f)>=1e-12&&this.#t(e,t,i,s,n,a,o,h,-m/f,b);return}let _=f**2-4*m*d;if(_<0)return;let w=Math.sqrt(_),x=2*d;this.#t(e,t,i,s,n,a,o,h,(-f+w)/x,b),this.#t(e,t,i,s,n,a,o,h,(-f-w)/x,b)}static bezierBoundingBox(e,t,i,s,n,a,o,h,d){return d?(d[0]=Math.min(d[0],e,o),d[1]=Math.min(d[1],t,h),d[2]=Math.max(d[2],e,o),d[3]=Math.max(d[3],t,h)):d=[Math.min(e,o),Math.min(t,h),Math.max(e,o),Math.max(t,h)],this.#e(e,i,n,o,t,s,a,h,3*(-e+3*(i-n)+o),6*(e-2*i+n),3*(i-e),d),this.#e(e,i,n,o,t,s,a,h,3*(-t+3*(s-a)+h),6*(t-2*s+a),3*(s-t),d),d}};function hh(c){return decodeURIComponent(escape(c))}var mr=null,rl=null;function dh(c){return mr||(mr=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,rl=new Map([["\uFB05","\u017Ft"]])),c.replaceAll(mr,(e,t,i)=>t?t.normalize("NFKC"):rl.get(i))}function uh(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();let c=new Uint8Array(32);return crypto.getRandomValues(c),Al(c)}var ja="pdfjs_internal_id_";function fh(c){return Uint8Array.prototype.toBase64?c.toBase64():btoa(Al(c))}typeof Promise.try!="function"&&(Promise.try=function(c,...e){return new Promise(t=>{t(c(...e))})});var Ge="http://www.w3.org/2000/svg",Ze=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};function Mn(c,e="text"){return Q(this,null,function*(){if(Zi(c,document.baseURI)){let t=yield fetch(c);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{let s=new XMLHttpRequest;s.open("GET",c,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})})}var ss=class c{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:n=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=n,this.offsetY=a,i*=t;let h=(e[2]+e[0])/2,d=(e[3]+e[1])/2,f,m,b,_;switch(s%=360,s<0&&(s+=360),s){case 180:f=-1,m=0,b=0,_=1;break;case 90:f=0,m=1,b=1,_=0;break;case 270:f=0,m=-1,b=-1,_=0;break;case 0:f=1,m=0,b=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(b=-b,_=-_);let w,x,C,k;f===0?(w=Math.abs(d-e[1])*i+n,x=Math.abs(h-e[0])*i+a,C=(e[3]-e[1])*i,k=(e[2]-e[0])*i):(w=Math.abs(h-e[0])*i+n,x=Math.abs(d-e[1])*i+a,C=(e[2]-e[0])*i,k=(e[3]-e[1])*i),this.transform=[f*i,m*i,b*i,_*i,w-f*i*h-b*i*d,x-m*i*h-_*i*d],this.width=C,this.height=k}get rawDims(){let{userUnit:e,viewBox:t}=this,i=t.map(s=>s*e);return bt(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:n=!1}={}){return new c({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:n})}convertToViewportPoint(e,t){return it.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){let t=it.applyTransform([e[0],e[1]],this.transform),i=it.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return it.applyInverseTransform([e,t],this.transform)}},ns=class extends ti{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}};function In(c){let e=c.length,t=0;for(;t<e&&c[t].trim()==="";)t++;return c.substring(t,t+5).toLowerCase()==="data:"}function Va(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function ph(c){return[c]=c.split(/[#?]/,1),c.substring(c.lastIndexOf("/")+1)}function gh(c,e="document.pdf"){if(typeof c!="string")return e;if(In(c))return pt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;let t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(c),n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||e}var Ys=class{started=Object.create(null);times=[];time(e){e in this.started&&pt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||pt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:i}of this.times)t=Math.max(i.length,t);for(let{name:i,start:s,end:n}of this.times)e.push(`${i.padEnd(t)} ${n-s}ms
`);return e.join("")}};function Zi(c,e){try{let{protocol:t}=e?new URL(c,e):new URL(c);return t==="http:"||t==="https:"}catch{return!1}}function Ce(c){c.preventDefault()}function me(c){c.preventDefault(),c.stopPropagation()}var Ks=class{static#t;static toDateObject(e){if(!e||typeof e!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");let t=this.#t.exec(e);if(!t)return null;let i=parseInt(t[1],10),s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let n=parseInt(t[3],10);n=n>=1&&n<=31?n:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;let d=t[7]||"Z",f=parseInt(t[8],10);f=f>=0&&f<=23?f:0;let m=parseInt(t[9],10)||0;return m=m>=0&&m<=59?m:0,d==="-"?(a+=f,o+=m):d==="+"&&(a-=f,o-=m),new Date(Date.UTC(i,s,n,a,o,h))}};function mh(c,{scale:e=1,rotation:t=0}){let{width:i,height:s}=c.attributes.style,n=[0,0,parseInt(i),parseInt(s)];return new ss({viewBox:n,userUnit:1,scale:e,rotation:t})}function za(c){if(c.startsWith("#")){let e=parseInt(c.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(e=>parseInt(e)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(pt(`Not a valid color format: "${c}"`),[0,0,0])}function bh(c){let e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(let t of c.keys()){e.style.color=t;let i=window.getComputedStyle(e).color;c.set(t,za(i))}e.remove()}function Ot(c){let{a:e,b:t,c:i,d:s,e:n,f:a}=c.getTransform();return[e,t,i,s,n,a]}function Oe(c){let{a:e,b:t,c:i,d:s,e:n,f:a}=c.getTransform().invertSelf();return[e,t,i,s,n,a]}function fi(c,e,t=!1,i=!0){if(e instanceof ss){let{pageWidth:s,pageHeight:n}=e.rawDims,{style:a}=c,o=Xt.isCSSRoundSupported,h=`var(--scale-factor) * ${s}px`,d=`var(--scale-factor) * ${n}px`,f=o?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,m=o?`round(down, ${d}, var(--scale-round-y, 1px))`:`calc(${d})`;!t||e.rotation%180===0?(a.width=f,a.height=m):(a.width=m,a.height=f)}i&&c.setAttribute("data-main-rotation",e.rotation)}var rs=class{constructor(){let e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}},wr=class c{#t=null;#e=null;#i;#s=null;#r=null;static#n=null;constructor(e){this.#i=e,c.#n||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){let e=this.#t=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");let t=this.#i._uiManager._signal;e.addEventListener("contextmenu",Ce,{signal:t}),e.addEventListener("pointerdown",c.#l,{signal:t});let i=this.#s=document.createElement("div");i.className="buttons",e.append(i);let s=this.#i.toolbarPosition;if(s){let{style:n}=e,a=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];n.insetInlineEnd=`${100*a}%`,n.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return this.#u(),e}get div(){return this.#t}static#l(e){e.stopPropagation()}#o(e){this.#i._focusEventsAllowed=!1,me(e)}#h(e){this.#i._focusEventsAllowed=!0,me(e)}#c(e){let t=this.#i._uiManager._signal;e.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ce,{signal:t})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown()}#u(){let{editorType:e,_uiManager:t}=this.#i,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",c.#n[e]),this.#c(i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#s.append(i)}get#d(){let e=document.createElement("div");return e.className="divider",e}addAltText(e){return Q(this,null,function*(){let t=yield e.render();this.#c(t),this.#s.prepend(t,this.#d),this.#r=e})}addColorPicker(e){this.#e=e;let t=e.renderButton();this.#c(t),this.#s.prepend(t,this.#d)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}},xr=class{#t=null;#e=null;#i;constructor(e){this.#i=e}#s(){let e=this.#e=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ce,{signal:this.#i._signal});let t=this.#t=document.createElement("div");return t.className="buttons",e.append(t),this.#n(),e}#r(e,t){let i=0,s=0;for(let n of e){let a=n.y+n.height;if(a<i)continue;let o=n.x+(t?n.width:0);if(a>i){s=o,i=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,i]}show(e,t,i){let[s,n]=this.#r(t,i),{style:a}=this.#e||=this.#s();e.append(this.#e),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#n(){let e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");let t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");let i=this.#i._signal;e.addEventListener("contextmenu",Ce,{signal:i}),e.addEventListener("click",()=>{this.#i.highlightSelection("floating_button")},{signal:i}),this.#t.append(e)}};function Qs(c,e,t){for(let i of t)e.addEventListener(i,c[i].bind(c))}var Sr=class{#t=0;get id(){return`${th}${this.#t++}`}},Er=class c{#t=uh();#e=0;#i=null;static get _isSVGFittingCanvas(){let e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;let n=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return bt(this,"_isSVGFittingCanvas",n)}#s(e,t){return Q(this,null,function*(){this.#i||=new Map;let i=this.#i.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(i.url=t,s=yield Mn(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){let n=c._isSVGFittingCanvas,a=new FileReader,o=new Image,h=new Promise((d,f)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,d()},a.onload=()=>Q(this,null,function*(){let m=i.svgUrl=a.result;o.src=(yield n)?`${m}#svgView(preserveAspectRatio(none))`:m}),o.onerror=a.onerror=f});a.readAsDataURL(s),yield h}else i.bitmap=yield createImageBitmap(s);i.refCounter=1}catch(s){pt(s),i=null}return this.#i.set(e,i),i&&this.#i.set(i.id,i),i})}getFromFile(e){return Q(this,null,function*(){let{lastModified:t,name:i,size:s,type:n}=e;return this.#s(`${t}_${i}_${s}_${n}`,e)})}getFromUrl(e){return Q(this,null,function*(){return this.#s(e,e)})}getFromBlob(e,t){return Q(this,null,function*(){let i=yield t;return this.#s(e,i)})}getFromId(e){return Q(this,null,function*(){this.#i||=new Map;let t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)})}getFromCanvas(e,t){this.#i||=new Map;let i=this.#i.get(e);if(i?.bitmap)return i.refCounter+=1,i;let s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(e,i),this.#i.set(i.id,i),i}getSvgUrl(e){let t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;let t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;let{bitmap:i}=t;if(!t.url&&!t.file){let s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=s.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#t}_`)}},Cr=class{#t=[];#e=!1;#i;#s=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:i,mustExec:s,type:n=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),this.#e)return;let h={cmd:e,undo:t,post:i,type:n};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(h);return}if(a&&this.#t[this.#s].type===n){o&&(h.undo=this.#t[this.#s].undo),this.#t[this.#s]=h;return}let d=this.#s+1;d===this.#i?this.#t.splice(0,1):(this.#s=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#s===-1)return;this.#e=!0;let{undo:e,post:t}=this.#t[this.#s];e(),t?.(),this.#e=!1,this.#s-=1}redo(){if(this.#s<this.#t.length-1){this.#s+=1,this.#e=!0;let{cmd:e,post:t}=this.#t[this.#s];e(),t?.(),this.#e=!1}}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}cleanType(e){if(this.#s!==-1){for(let t=this.#s;t>=0;t--)if(this.#t[t].type!==e){this.#t.splice(t+1,this.#s-t),this.#s=t;return}this.#t.length=0,this.#s=-1}}destroy(){this.#t=null}},pi=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Xt.platform;for(let[i,s,n={}]of e)for(let a of i){let o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);let t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let i=this.callbacks.get(this.#t(t));if(!i)return;let{callback:s,options:{bubbles:n=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(s.bind(e,...a,t)(),n||me(t))}},Tr=class c{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){let e=new Map([["CanvasText",null],["Canvas",null]]);return bh(e),bt(this,"_colors",e)}convert(e){let t=za(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(let[i,s]of this._colors)if(s.every((n,a)=>n===t[a]))return c._colorsMapping.get(i);return t}getHexCode(e){let t=this._colors.get(e);return t?it.makeHexColor(...t):e}},as=(()=>{class c{#t=new AbortController;#e=null;#i=new Map;#s=new Map;#r=null;#n=null;#l=null;#o=new Cr;#h=null;#c=null;#u=0;#d=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#b=!1;#_=null;#v=null;#A=null;#x=null;#E=!1;#T=null;#P=new Sr;#w=!1;#k=!1;#C=null;#I=null;#D=null;#O=null;#S=ft.NONE;#y=new Set;#R=null;#V=null;#z=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#F=[0,0];#N=null;#B=null;#$=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=c.prototype,i=o=>o.#B.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),s=(o,{target:h})=>{if(h instanceof HTMLInputElement){let{type:d}=h;return d!=="text"&&d!=="number"}return!0},n=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return bt(this,"_keyboardManager",new pi([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:h})=>!(h instanceof HTMLButtonElement)&&o.#B.contains(h)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:h})=>!(h instanceof HTMLButtonElement)&&o.#B.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:i}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:i}]]))}constructor(t,i,s,n,a,o,h,d,f,m,b,_,w){let x=this._signal=this.#t.signal;this.#B=t,this.#$=i,this.#r=s,this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:x}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:x}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:x}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:x}),n._on("setpreference",this.onSetPreference.bind(this),{signal:x}),n._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:x}),this.#et(),this.#rt(),this.#X(),this.#n=a.annotationStorage,this.#_=a.filterFactory,this.#V=o,this.#x=h||null,this.#m=d,this.#g=f,this.#b=m,this.#O=b||null,this.viewParameters={realScale:Ze.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=w!==!1}destroy(){this.#L?.resolve(),this.#L=null,this.#t?.abort(),this.#t=null,this._signal=null;for(let t of this.#s.values())t.destroy();this.#s.clear(),this.#i.clear(),this.#p.clear(),this.#e=null,this.#y.clear(),this.#o.destroy(),this.#r?.destroy(),this.#T?.hide(),this.#T=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#N&&(clearTimeout(this.#N),this.#N=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#O}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return bt(this,"hcmFilter",this.#V?this.#_.addHCMFilter(this.#V.foreground,this.#V.background):"none")}get direction(){return bt(this,"direction",getComputedStyle(this.#B).direction)}get highlightColors(){return bt(this,"highlightColors",this.#x?new Map(this.#x.split(",").map(t=>t.split("=").map(i=>i.trim()))):null)}get highlightColorNames(){return bt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#D=t}editAltText(t,i=!1){this.#r?.editAltText(this,t,i)}switchToMode(t,i){this._eventBus.on("annotationeditormodechanged",i,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,i){this._eventBus.dispatch("setpreference",{source:this,name:t,value:i})}onSetPreference({name:t,value:i}){switch(t){case"enableNewAltTextWhenAddingImage":this.#b=i;break}}onPageChanging({pageNumber:t}){this.#u=t-1}focusMainContainer(){this.#B.focus()}findParent(t,i){for(let s of this.#s.values()){let{x:n,y:a,width:o,height:h}=s.div.getBoundingClientRect();if(t>=n&&t<=n+o&&i>=a&&i<=a+h)return s}return null}disableUserSelect(t=!1){this.#$.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Ze.PDF_TO_CSS_UNITS;for(let i of this.#p)i.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#H({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#q(t){let{currentLayer:i}=this;if(i.hasTextLayer(t))return i;for(let s of this.#s.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t=""){let i=document.getSelection();if(!i||i.isCollapsed)return;let{anchorNode:s,anchorOffset:n,focusNode:a,focusOffset:o}=i,h=i.toString(),f=this.#H(i).closest(".textLayer"),m=this.getSelectionBoxes(f);if(!m)return;i.empty();let b=this.#q(f),_=this.#S===ft.NONE,w=()=>{b?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:s,anchorOffset:n,focusNode:a,focusOffset:o,text:h}),_&&this.showAllEditors("highlight",!0,!0)};if(_){this.switchToMode(ft.HIGHLIGHT,w);return}w()}#Z(){let t=document.getSelection();if(!t||t.isCollapsed)return;let s=this.#H(t).closest(".textLayer"),n=this.getSelectionBoxes(s);n&&(this.#T||=new xr(this),this.#T.show(s,n,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#n&&!this.#n.has(t.id)&&this.#n.setValue(t.id,t)}#tt(){let t=document.getSelection();if(!t||t.isCollapsed){this.#R&&(this.#T?.hide(),this.#R=null,this.#M({hasSelectedText:!1}));return}let{anchorNode:i}=t;if(i===this.#R)return;let n=this.#H(t).closest(".textLayer");if(!n){this.#R&&(this.#T?.hide(),this.#R=null,this.#M({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#R=i,this.#M({hasSelectedText:!0}),!(this.#S!==ft.HIGHLIGHT&&this.#S!==ft.NONE)&&(this.#S===ft.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#E=this.isShiftKeyDown,!this.isShiftKeyDown)){let a=this.#S===ft.HIGHLIGHT?this.#q(n):null;a?.toggleDrawing();let o=new AbortController,h=this.combinedSignal(o),d=f=>{f.type==="pointerup"&&f.button!==0||(o.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}}#W(t=""){this.#S===ft.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#Z()}#et(){document.addEventListener("selectionchange",this.#tt.bind(this),{signal:this._signal})}#it(){if(this.#A)return;this.#A=new AbortController;let t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#st(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#W("main_toolbar")),!this.hasSelection)return;let{activeElement:t}=document;for(let i of this.#y)if(i.div.contains(t)){this.#I=[i,t],i._focusEventsAllowed=!1;break}}focus(){if(!this.#I)return;let[t,i]=this.#I;this.#I=null,i.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),i.focus()}#X(){if(this.#C)return;this.#C=new AbortController;let t=this.combinedSignal(this.#C);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#nt(){this.#C?.abort(),this.#C=null}#Y(){if(this.#h)return;this.#h=new AbortController;let t=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#K(){this.#h?.abort(),this.#h=null}#rt(){let t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#X(),this.#Y()}removeEditListeners(){this.#nt(),this.#K()}dragOver(t){for(let{type:i}of t.dataTransfer.items)for(let s of this.#a)if(s.isHandlingMimeForPasting(i)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(let i of t.dataTransfer.items)for(let s of this.#a)if(s.isHandlingMimeForPasting(i.type)){s.paste(i,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;let i=[];for(let s of this.#y){let n=s.serialize(!0);n&&i.push(n)}i.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(i))}cut(t){this.copy(t),this.delete()}paste(t){return Q(this,null,function*(){t.preventDefault();let{clipboardData:i}=t;for(let a of i.items)for(let o of this.#a)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let s=i.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(a){pt(`paste: "${a.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();let n=this.currentLayer;try{let a=[];for(let d of s){let f=yield n.deserialize(d);if(!f)return;a.push(f)}let o=()=>{for(let d of a)this.#Q(d);this.#J(a)},h=()=>{for(let d of a)d.remove()};this.addCommands({cmd:o,undo:h,mustExec:!0})}catch(a){pt(`paste: "${a.message}".`)}})}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==ft.NONE&&!this.isEditorHandlingKeyboard&&c._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#E&&(this.#E=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#M(t){Object.entries(t).some(([s,n])=>this.#U[s]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,t)}),this.#S===ft.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#j([[xt.HIGHLIGHT_FREE,!0]]))}#j(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#it(),this.#Y(),this.#M({isEditing:this.#S!==ft.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#st(),this.#K(),this.#M({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(let i of this.#a)this.#j(i.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#s.get(this.#u)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#u}addLayer(t){this.#s.set(t.pageIndex,t),this.#w?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}updateMode(t,i=null,s=!1){return Q(this,null,function*(){if(this.#S!==t&&!(this.#L&&(yield this.#L.promise,!this.#L))){if(this.#L=Promise.withResolvers(),this.#S=t,t===ft.NONE){this.setEditingState(!1),this.#ot(),this._editorUndoBar?.hide(),this.#L.resolve();return}this.setEditingState(!0),yield this.#at(),this.unselectAll();for(let n of this.#s.values())n.updateMode(t);if(!i){s&&this.addNewEditorFromKeyboard(),this.#L.resolve();return}for(let n of this.#i.values())n.annotationElementId===i?(this.setSelected(n),n.enterInEditMode()):n.unselect();this.#L.resolve()}})}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,i){if(this.#a){switch(t){case xt.CREATE:this.currentLayer.addNewEditor();return;case xt.HIGHLIGHT_DEFAULT_COLOR:this.#D?.updateColor(i);break;case xt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#z||=new Map).set(t,i),this.showAllEditors("highlight",i);break}for(let s of this.#y)s.updateParams(t,i);for(let s of this.#a)s.updateDefaultParams(t,i)}}showAllEditors(t,i,s=!1){for(let a of this.#i.values())a.editorType===t&&a.show(i);(this.#z?.get(xt.HIGHLIGHT_SHOW_ALL)??!0)!==i&&this.#j([[xt.HIGHLIGHT_SHOW_ALL,i]])}enableWaiting(t=!1){if(this.#k!==t){this.#k=t;for(let i of this.#s.values())t?i.disableClick():i.enableClick(),i.div.classList.toggle("waiting",t)}}#at(){return Q(this,null,function*(){if(!this.#w){this.#w=!0;let t=[];for(let i of this.#s.values())t.push(i.enable());yield Promise.all(t);for(let i of this.#i.values())i.enable()}})}#ot(){if(this.unselectAll(),this.#w){this.#w=!1;for(let t of this.#s.values())t.disable();for(let t of this.#i.values())t.disable()}}getEditors(t){let i=[];for(let s of this.#i.values())s.pageIndex===t&&i.push(s);return i}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#i.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#d.has(t.annotationElementId))&&this.#n?.remove(t.id)}addDeletedAnnotationElement(t){this.#d.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#d.has(t)}removeDeletedAnnotationElement(t){this.#d.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Q(t){let i=this.#s.get(t.pageIndex);i?i.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#j(t.propertiesToUpdate))}get#lt(){let t=null;for(t of this.#y);return t}updateUI(t){this.#lt===t&&this.#j(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#j(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#y.has(t)){this.#y.delete(t),t.unselect(),this.#M({hasSelectedEditor:this.hasSelection});return}this.#y.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}setSelected(t){this.#c?.commitOrRemove();for(let i of this.#y)i!==t&&i.unselect();this.#y.clear(),this.#y.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}isSelected(t){return this.#y.has(t)}get firstSelectedEditor(){return this.#y.values().next().value}unselect(t){t.unselect(),this.#y.delete(t),this.#M({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#y.size!==0}get isEnterHandled(){return this.#y.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#M({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(t){this.#o.add(t),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(t){this.#o.cleanType(t)}#G(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(let t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();let t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;let i=t?[t]:[...this.#y],s=()=>{this._editorUndoBar?.show(n,i.length===1?i[0].editorType:i.length);for(let a of i)a.remove()},n=()=>{for(let a of i)this.#Q(a)};this.addCommands({cmd:s,undo:n,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#J(t){for(let i of this.#y)i.unselect();this.#y.clear();for(let i of t)i.isEmpty()||(this.#y.add(i),i.select());this.#M({hasSelectedEditor:this.hasSelection})}selectAll(){for(let t of this.#y)t.commit();this.#J(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#S!==ft.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(let t of this.#y)t.unselect();this.#y.clear(),this.#M({hasSelectedEditor:!1})}}translateSelectedEditors(t,i,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#F[0]+=t,this.#F[1]+=i;let[n,a]=this.#F,o=[...this.#y],h=1e3;this.#N&&clearTimeout(this.#N),this.#N=setTimeout(()=>{this.#N=null,this.#F[0]=this.#F[1]=0,this.addCommands({cmd:()=>{for(let d of o)this.#i.has(d.id)&&d.translateInPage(n,a)},undo:()=>{for(let d of o)this.#i.has(d.id)&&d.translateInPage(-n,-a)},mustExec:!1})},h);for(let d of o)d.translateInPage(t,i)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(let t of this.#y)this.#f.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);let t=this.#f;this.#f=null;let i=!1;for(let[{x:n,y:a,pageIndex:o},h]of t)h.newX=n,h.newY=a,h.newPageIndex=o,i||=n!==h.savedX||a!==h.savedY||o!==h.savedPageIndex;if(!i)return!1;let s=(n,a,o,h)=>{if(this.#i.has(n.id)){let d=this.#s.get(h);d?n._setParentAndPosition(d,a,o):(n.pageIndex=h,n.x=a,n.y=o)}};return this.addCommands({cmd:()=>{for(let[n,{newX:a,newY:o,newPageIndex:h}]of t)s(n,a,o,h)},undo:()=>{for(let[n,{savedX:a,savedY:o,savedPageIndex:h}]of t)s(n,a,o,h)},mustExec:!0}),!0}dragSelectedEditors(t,i){if(this.#f)for(let s of this.#f.keys())s.drag(t,i)}rebuild(t){if(t.parent===null){let i=this.getLayer(t.pageIndex);i?(i.changeParent(t),i.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#y.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#S}get imageManager(){return bt(this,"imageManager",new Er)}getSelectionBoxes(t){if(!t)return null;let i=document.getSelection();for(let f=0,m=i.rangeCount;f<m;f++)if(!t.contains(i.getRangeAt(f).commonAncestorContainer))return null;let{x:s,y:n,width:a,height:o}=t.getBoundingClientRect(),h;switch(t.getAttribute("data-main-rotation")){case"90":h=(f,m,b,_)=>({x:(m-n)/o,y:1-(f+b-s)/a,width:_/o,height:b/a});break;case"180":h=(f,m,b,_)=>({x:1-(f+b-s)/a,y:1-(m+_-n)/o,width:b/a,height:_/o});break;case"270":h=(f,m,b,_)=>({x:1-(m+_-n)/o,y:(f-s)/a,width:_/o,height:b/a});break;default:h=(f,m,b,_)=>({x:(f-s)/a,y:(m-n)/o,width:b/a,height:_/o});break}let d=[];for(let f=0,m=i.rangeCount;f<m;f++){let b=i.getRangeAt(f);if(!b.collapsed)for(let{x:_,y:w,width:x,height:C}of b.getClientRects())x===0||C===0||d.push(h(_,w,x,C))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:i}){(this.#l||=new Map).set(t,i)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){let i=this.#l?.get(t.data.id);if(!i)return;let s=this.#n.getRawValue(i);s&&(this.#S===ft.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}}return c})(),al=(()=>{class c{#t=null;#e=!1;#i=null;#s=null;#r=null;#n=null;#l=!1;#o=null;#h=null;#c=null;#u=null;#d=!1;static#f=null;static _l10n=null;constructor(t){this.#h=t,this.#d=t._uiManager.useNewAltTextFlow,c.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){c._l10n??=t}render(){return Q(this,null,function*(){let t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";let i=this.#s=document.createElement("span");t.append(i),this.#d?(t.classList.add("new"),t.setAttribute("data-l10n-id",c.#f.missing),i.setAttribute("data-l10n-id",c.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));let s=this.#h._uiManager._signal;t.addEventListener("contextmenu",Ce,{signal:s}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:s});let n=a=>{a.preventDefault(),this.#h._uiManager.editAltText(this.#h),this.#d&&this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",n,{capture:!0,signal:s}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#l=!0,n(a))},{signal:s}),yield this.#p(),t})}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#d?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#d?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}setGuessedText(t){return Q(this,null,function*(){this.#t===null&&(this.#c=t,this.#u=yield c._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())})}toggleAltTextBadge(t=!1){if(!this.#d||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){let i=this.#o=document.createElement("div");i.className="noAltTextBadge",this.#h.div.append(i)}this.#o.classList.toggle("hidden",!t)}serialize(t){let i=this.#t;return!t&&this.#c===i&&(i=this.#u),{altText:i,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#u}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:i,guessedText:s,textWithDisclaimer:n,cancel:a=!1}){s&&(this.#c=s,this.#u=n),!(this.#t===t&&this.#e===i)&&(a||(this.#t=t,this.#e=i),this.#p())}toggle(t=!1){this.#i&&(!t&&this.#n&&(clearTimeout(this.#n),this.#n=null),this.#i.disabled=!t)}shown(){this.#h._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#i?.remove(),this.#i=null,this.#s=null,this.#r=null,this.#o?.remove(),this.#o=null}#p(){return Q(this,null,function*(){let t=this.#i;if(!t)return;if(this.#d){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",c.#f[this.#a]),this.#s?.setAttribute("data-l10n-id",c.#f[`${this.#a}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=this.#r;if(!i){this.#r=i=document.createElement("span"),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${this.#h.id}`;let n=100,a=this.#h._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#n),this.#n=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#n=setTimeout(()=>{this.#n=null,this.#r.classList.add("show"),this.#h._reportTelemetry({action:"alt_text_tooltip"})},n)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#n&&(clearTimeout(this.#n),this.#n=null),this.#r?.classList.remove("show")},{signal:a})}this.#e?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=this.#t),i.parentNode||t.append(i),this.#h.getImageForAltText()?.setAttribute("aria-describedby",i.id)})}}return c})(),Js=class c{#t;#e=!1;#i=null;#s;#r;#n;#l;#o;#h=null;#c;#u=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:n=null,onPinchEnd:a=null,signal:o}){this.#t=e,this.#i=i,this.#s=t,this.#r=s,this.#n=n,this.#l=a,this.#c=new AbortController,this.#o=AbortSignal.any([o,this.#c.signal]),e.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return bt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#d(e){if(this.#s?.()||e.touches.length<2)return;if(!this.#u){this.#u=new AbortController;let s=AbortSignal.any([this.#o,this.#u.signal]),n=this.#t,a={signal:s,passive:!1};n.addEventListener("touchmove",this.#f.bind(this),a),n.addEventListener("touchend",this.#a.bind(this),a),n.addEventListener("touchcancel",this.#a.bind(this),a),this.#r?.()}if(me(e),e.touches.length!==2||this.#i?.()){this.#h=null;return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),this.#h={touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#f(e){if(!this.#h||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);let{screenX:s,screenY:n}=t,{screenX:a,screenY:o}=i,h=this.#h,{touch0X:d,touch0Y:f,touch1X:m,touch1Y:b}=h,_=m-d,w=b-f,x=a-s,C=o-n,k=Math.hypot(x,C)||1,D=Math.hypot(_,w)||1;if(!this.#e&&Math.abs(D-k)<=c.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=n,h.touch1X=a,h.touch1Y=o,e.preventDefault(),!this.#e){this.#e=!0;return}let O=[(s+a)/2,(n+o)/2];this.#n?.(O,D,k)}#a(e){this.#u.abort(),this.#u=null,this.#l?.(),this.#h&&(e.preventDefault(),this.#h=null,this.#e=!1)}destroy(){this.#c?.abort(),this.#c=null}},Bt=class c{#t=null;#e=null;#i=null;#s=!1;#r=null;#n="";#l=!1;#o=null;#h=null;#c=null;#u=null;#d="";#f=!1;#a=null;#p=!1;#m=!1;#g=!1;#b=null;#_=0;#v=0;#A=null;#x=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#E=!1;#T=c._zIndex++;static _borderLineWidth=-1;static _colorManager=new Tr;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let e=c.prototype._resizeWithKeyboard,t=as.TRANSLATE_SMALL,i=as.TRANSLATE_BIG;return bt(this,"_resizerKeyboardManager",new pi([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],c.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;let{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[n,a];let[o,h]=this.parentDimensions;this.x=e.x/o,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return bt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){let t=new kr({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(c._l10n??=e,c._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),c._borderLineWidth!==-1)return;let i=getComputedStyle(document.documentElement);c._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Pt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#E}set _isDraggable(e){this.#E=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#H(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){let[n,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/n,this.y=(t+s)/a,this.fixAndSetPosition()}#P([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#P(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#a||=[this.x,this.y,this.width,this.height];let{div:i,parentDimensions:[s,n]}=this;if(this.x+=e/s,this.y+=t/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:m,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this,[h,d]=this.getBaseTranslation();a+=h,o+=d;let{style:f}=i;f.left=`${(100*a).toFixed(2)}%`,f.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){let[e,t]=this.parentDimensions,{_borderLineWidth:i}=c,s=i/e,n=i/t;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let{div:{style:t},pageDimensions:[i,s]}=this,{x:n,y:a,width:o,height:h}=this;if(o*=i,h*=s,n*=i,a*=s,this._mustFixPosition)switch(e){case 0:n=Math.max(0,Math.min(i-o,n)),a=Math.max(0,Math.min(s-h,a));break;case 90:n=Math.max(0,Math.min(i-h,n)),a=Math.min(s,Math.max(o,a));break;case 180:n=Math.min(i,Math.max(o,n)),a=Math.min(s,Math.max(h,a));break;case 270:n=Math.min(i,Math.max(h,n)),a=Math.max(0,Math.min(s-o,a));break}this.x=n/=i,this.y=a/=s;let[d,f]=this.getBaseTranslation();n+=d,a+=f,t.left=`${(100*n).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#w(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return c.#w(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return c.#w(e,t,360-this.parentRotation)}#k(e){switch(e){case 90:{let[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{let[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){let[i,s]=this.parentDimensions,{style:n}=this.div;n.width=`${(100*e/i).toFixed(2)}%`,this.#l||(n.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){let{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),n=!this.#l&&t.endsWith("%");if(s&&n)return;let[a,o]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!this.#l&&!n&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#C(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");let e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(let i of e){let s=document.createElement("div");this.#o.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#I.bind(this,i),{signal:t}),s.addEventListener("contextmenu",Ce,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#o)}#I(e,t){t.preventDefault();let{isMac:i}=Xt.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#i?.toggle(!1);let s=this._isDraggable;this._isDraggable=!1,this.#h=[t.screenX,t.screenY];let n=new AbortController,a=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#S.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",me,{passive:!1,signal:a}),window.addEventListener("contextmenu",Ce,{signal:a}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let o=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let d=()=>{n.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=h,this.#O()};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})}#D(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;let[n,a]=this.parentDimensions;this.setDims(n*i,a*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#O(){if(!this.#c)return;let{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=this.#c;this.#c=null;let n=this.x,a=this.y,o=this.width,h=this.height;n===e&&a===t&&o===i&&h===s||this.addCommands({cmd:this.#D.bind(this,n,a,o,h),undo:this.#D.bind(this,e,t,i,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#S(e,t){let[i,s]=this.parentDimensions,n=this.x,a=this.y,o=this.width,h=this.height,d=c.MIN_SIZE/i,f=c.MIN_SIZE/s,m=this.#k(this.rotation),b=(K,Z)=>[m[0]*K+m[2]*Z,m[1]*K+m[3]*Z],_=this.#k(360-this.rotation),w=(K,Z)=>[_[0]*K+_[2]*Z,_[1]*K+_[3]*Z],x,C,k=!1,D=!1;switch(e){case"topLeft":k=!0,x=(K,Z)=>[0,0],C=(K,Z)=>[K,Z];break;case"topMiddle":x=(K,Z)=>[K/2,0],C=(K,Z)=>[K/2,Z];break;case"topRight":k=!0,x=(K,Z)=>[K,0],C=(K,Z)=>[0,Z];break;case"middleRight":D=!0,x=(K,Z)=>[K,Z/2],C=(K,Z)=>[0,Z/2];break;case"bottomRight":k=!0,x=(K,Z)=>[K,Z],C=(K,Z)=>[0,0];break;case"bottomMiddle":x=(K,Z)=>[K/2,Z],C=(K,Z)=>[K/2,0];break;case"bottomLeft":k=!0,x=(K,Z)=>[0,Z],C=(K,Z)=>[K,0];break;case"middleLeft":D=!0,x=(K,Z)=>[0,Z/2],C=(K,Z)=>[K,Z/2];break}let O=x(o,h),H=C(o,h),j=b(...H),p=c._round(n+j[0]),$=c._round(a+j[1]),W=1,ot=1,wt,mt;if(t.fromKeyboard)({deltaX:wt,deltaY:mt}=t);else{let{screenX:K,screenY:Z}=t,[$t,de]=this.#h;[wt,mt]=this.screenToPageTranslation(K-$t,Z-de),this.#h[0]=K,this.#h[1]=Z}if([wt,mt]=w(wt/i,mt/s),k){let K=Math.hypot(o,h);W=ot=Math.max(Math.min(Math.hypot(H[0]-O[0]-wt,H[1]-O[1]-mt)/K,1/o,1/h),d/o,f/h)}else D?W=Math.max(d,Math.min(1,Math.abs(H[0]-O[0]-wt)))/o:ot=Math.max(f,Math.min(1,Math.abs(H[1]-O[1]-mt)))/h;let at=c._round(o*W),Dt=c._round(h*ot);j=b(...C(at,Dt));let Ct=p-j[0],Yt=$-j[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=at,this.height=Dt,this.x=Ct,this.y=Yt,this.setDims(i*at,s*Dt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}addEditToolbar(){return Q(this,null,function*(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new wr(this),this.div.append(this._editToolbar.render()),this.#i&&(yield this._editToolbar.addAltText(this.#i)),this._editToolbar)})}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#i?.destroy())}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){return Q(this,null,function*(){this.#i||(al.initialize(c._l10n),this.#i=new al(this),this.#t&&(this.#i.data=this.#t,this.#t=null),yield this.addEditToolbar())})}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}setGuessedAltText(e){return Q(this,null,function*(){yield this.#i?.setGuessedText(e)})}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#s?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#F();let[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);let[i,s]=this.getInitialTranslation();return this.translate(i,s),Qs(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new Js({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#y.bind(this),onPinching:this.#R.bind(this),onPinchEnd:this.#V.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#y(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#R(e,t,i){let n=.7*(i/t)+1-.7;if(n===1)return;let a=this.#k(this.rotation),o=(p,$)=>[a[0]*p+a[2]*$,a[1]*p+a[3]*$],[h,d]=this.parentDimensions,f=this.x,m=this.y,b=this.width,_=this.height,w=c.MIN_SIZE/h,x=c.MIN_SIZE/d;n=Math.max(Math.min(n,1/b,1/_),w/b,x/_);let C=c._round(b*n),k=c._round(_*n);if(C===b&&k===_)return;this.#a||=[f,m,b,_];let D=o(b/2,_/2),O=c._round(f+D[0]),H=c._round(m+D[1]),j=o(C/2,k/2);this.x=O-j[0],this.y=H-j[1],this.width=C,this.height=k,this.setDims(h*C,d*k),this.fixAndSetPosition(),this._onResizing()}#V(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#O()}pointerdown(e){let{isMac:t}=Xt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#U(e);return}this.#z(e)}get isSelected(){return this._uiManager.isSelected(this)}#z(e){let{isMac:t}=Xt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1,s=new AbortController,n=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:n},o=d=>{s.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#z(d),i&&this._onStopDragging()};t&&(this.#_=e.clientX,this.#v=e.clientY,this.#r=e.pointerId,this.#n=e.pointerType,window.addEventListener("pointermove",d=>{i||(i=!0,this._onStartDragging());let{clientX:f,clientY:m,pointerId:b}=d;if(b!==this.#r){me(d);return}let[_,w]=this.screenToPageTranslation(f-this.#_,m-this.#v);this.#_=f,this.#v=m,this._uiManager.dragSelectedEditors(_,w)},a),window.addEventListener("touchmove",me,a),window.addEventListener("pointerdown",d=>{d.pointerType===this.#n&&(this.#x||d.isPrimary)&&o(d),me(d)},a));let h=d=>{if(!this.#r||this.#r===d.pointerId){o(d);return}me(d)};window.addEventListener("pointerup",h,{signal:n}),window.addEventListener("blur",h,{signal:n})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){let s=this.parentScale,[n,a]=this.pageDimensions,[o,h]=this.pageTranslation,d=e/s,f=t/s,m=this.x*n,b=this.y*a,_=this.width*n,w=this.height*a;switch(i){case 0:return[m+d+o,a-b-f-w+h,m+d+_+o,a-b-f+h];case 90:return[m+f+o,a-b+d+h,m+f+w+o,a-b+d+_+h];case 180:return[m-d-_+o,a-b+f+h,m-d+o,a-b+f+w+h];case 270:return[m-f-w+o,a-b-d-_+h,m-f+o,a-b-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){let[i,s,n,a]=e,o=n-i,h=a-s;switch(this.rotation){case 0:return[i,t-a,o,h];case 90:return[i,t-s,h,o];case 180:return[n,t-s,o,h];case 270:return[n,t-a,h,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){let{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:n,innerWidth:a}=window;return t<a&&s>0&&e<n&&i>0}#F(){if(this.#u||!this.div)return;this.#u=new AbortController;let e=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#F()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Pt("An editor must be serializable")}static deserialize(e,t,i){return Q(this,null,function*(){let s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,s.#t=e.accessibilityData;let[n,a]=s.pageDimensions,[o,h,d,f]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/n,s.y=h/a,s.width=d/n,s.height=f/a,s})}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#H(),this.removeEditToolbar(),this.#A){for(let e of this.#A.values())clearTimeout(e);this.#A=null}this.parent=null,this.#x?.destroy(),this.#x=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#C(),this.#o.classList.remove("hidden"),Qs(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let t=this.#o.children;if(!this.#e){this.#e=Array.from(t);let a=this.#N.bind(this),o=this.#B.bind(this),h=this._uiManager._signal;for(let d of this.#e){let f=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",a,{signal:h}),d.addEventListener("blur",o,{signal:h}),d.addEventListener("focus",this.#$.bind(this,f),{signal:h}),d.setAttribute("data-l10n-id",c._l10nResizer[f])}}let i=this.#e[0],s=0;for(let a of t){if(a===i)break;s++}let n=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(n!==s){if(n<s)for(let o=0;o<s-n;o++)this.#o.append(this.#o.firstChild);else if(n>s)for(let o=0;o<n-s;o++)this.#o.firstChild.before(this.#o.lastChild);let a=0;for(let o of t){let d=this.#e[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",c._l10nResizer[d])}}this.#L(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#N(e){c._resizerKeyboardManager.exec(this,e)}#B(e){this.#g&&e.relatedTarget?.parentNode!==this.#o&&this.#H()}#$(e){this.#d=this.#g?e:""}#L(e){if(this.#e)for(let t of this.#e)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#g&&this.#S(this.#d,{deltaX:e,deltaY:t,fromKeyboard:!0})}#H(){this.#g=!1,this.#L(-1),this.#O()}_stopResizingWithKeyboard(){this.#H(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;let i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#A||=new Map;let{action:i}=e,s=this.#A.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#A.delete(i),this.#A.size===0&&(this.#A=null)},c._telemetryTimeout),this.#A.set(i,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){let i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}},kr=class extends Bt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},ol=3285377520,_e=4294901760,Fe=65535,Zs=class{constructor(e){this.h1=e?e&4294967295:ol,this.h2=e?e&4294967295:ol}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let x=0,C=e.length;x<C;x++){let k=e.charCodeAt(x);k<=255?t[i++]=k:(t[i++]=k>>>8,t[i++]=k&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");let s=i>>2,n=i-s*4,a=new Uint32Array(t.buffer,0,s),o=0,h=0,d=this.h1,f=this.h2,m=3432918353,b=461845907,_=m&Fe,w=b&Fe;for(let x=0;x<s;x++)x&1?(o=a[x],o=o*m&_e|o*_&Fe,o=o<<15|o>>>17,o=o*b&_e|o*w&Fe,d^=o,d=d<<13|d>>>19,d=d*5+3864292196):(h=a[x],h=h*m&_e|h*_&Fe,h=h<<15|h>>>17,h=h*b&_e|h*w&Fe,f^=h,f=f<<13|f>>>19,f=f*5+3864292196);switch(o=0,n){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*m&_e|o*_&Fe,o=o<<15|o>>>17,o=o*b&_e|o*w&Fe,s&1?d^=o:f^=o}this.h1=d,this.h2=f}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&_e|e*36045&Fe,t=t*4283543511&_e|((t<<16|e>>>16)*2950163797&_e)>>>16,e^=t>>>1,e=e*444984403&_e|e*60499&Fe,t=t*3301882366&_e|((t<<16|e>>>16)*3120437893&_e)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}},Pr=Object.freeze({map:null,hash:"",transfer:void 0}),os=class{#t=!1;#e=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let i=this.#i.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#i.get(e)}remove(e){if(this.#i.delete(e),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(let t of this.#i.values())if(t instanceof Bt)return;this.onAnnotationEditor(null)}}setValue(e,t){let i=this.#i.get(e),s=!1;if(i!==void 0)for(let[n,a]of Object.entries(t))i[n]!==a&&(s=!0,i[n]=a);else s=!0,this.#i.set(e,t);s&&this.#s(),t instanceof Bt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#i.has(e)}getAll(){return this.#i.size>0?Ha(this.#i):null}setAll(e){for(let[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return this.#i.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new tn(this)}get serializable(){if(this.#i.size===0)return Pr;let e=new Map,t=new Zs,i=[],s=Object.create(null),n=!1;for(let[a,o]of this.#i){let h=o instanceof Bt?o.serialize(!1,s):o;h&&(e.set(a,h),t.update(`${a}:${JSON.stringify(h)}`),n||=!!h.bitmap)}if(n)for(let a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:Pr}get editorStats(){let e=null,t=new Map;for(let i of this.#i.values()){if(!(i instanceof Bt))continue;let s=i.telemetryFinalData;if(!s)continue;let{type:n}=s;t.has(n)||t.set(n,Object.getPrototypeOf(i).constructor),e||=Object.create(null);let a=e[n]||=new Map;for(let[o,h]of Object.entries(s)){if(o==="type")continue;let d=a.get(o);d||(d=new Map,a.set(o,d));let f=d.get(h)??0;d.set(h,f+1)}}for(let[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;let e=[];for(let t of this.#i.values())!(t instanceof Bt)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#e={ids:new Set(e),hash:e.join(",")}}},tn=class extends os{#t;constructor(e){super();let{map:t,hash:i,transfer:s}=e.serializable,n=structuredClone(t,s?{transfer:s}:null);this.#t={map:n,hash:i,transfer:s}}get print(){Pt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return bt(this,"modifiedIds",{ids:new Set,hash:""})}},Mr=class{#t=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont(i){return Q(this,arguments,function*({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#t.has(e.loadedName))){if(Ut(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:s,src:n,style:a}=e,o=new FontFace(s,n,a);this.addNativeFontFace(o);try{yield o.load(),this.#t.add(s),t?.(e)}catch{pt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Pt("Not implemented: loadSystemFont without the Font Loading API.")}})}bind(e){return Q(this,null,function*(){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){yield this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{yield i.loaded}catch(s){throw pt(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;yield new Promise(i=>{let s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}})}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return bt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Zt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),bt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ut(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){let n=i.shift();setTimeout(n.callback,0)}}let{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){let e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return bt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(H,j){return H.charCodeAt(j)<<24|H.charCodeAt(j+1)<<16|H.charCodeAt(j+2)<<8|H.charCodeAt(j+3)&255}function s(H,j,p,$){let W=H.substring(0,j),ot=H.substring(j+p);return W+$+ot}let n,a,o=this._document.createElement("canvas");o.width=1,o.height=1;let h=o.getContext("2d"),d=0;function f(H,j){if(++d>30){pt("Load test font never loaded."),j();return}if(h.font="30px "+H,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){j();return}setTimeout(f.bind(null,H,j))}let m=`lt${Date.now()}${this.loadTestFontId++}`,b=this._loadTestFont;b=s(b,976,m.length,m);let w=16,x=1482184792,C=i(b,w);for(n=0,a=m.length-3;n<a;n+=4)C=C-x+i(m,n)|0;n<m.length&&(C=C-x+i(m+"XXX",n)|0),b=s(b,w,4,oh(C));let k=`url(data:font/opentype;base64,${btoa(b)});`,D=`@font-face {font-family:"${m}";src:${k}}`;this.insertRule(D);let O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(let H of[e.loadedName,m]){let j=this._document.createElement("span");j.textContent="Hi",j.style.fontFamily=H,O.append(j)}this._document.body.append(O),f(m,()=>{O.remove(),t.complete()})}},Ir=class{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(let n in e)this[n]=e[n];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${fh(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let i=this.loadedName+"_path_"+t,s;try{s=e.get(i)}catch(a){pt(`getPathGenerator - ignoring character: "${a}".`)}let n=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=n}},js={DATA:1,ERROR:2},zt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ll(){}function ce(c){if(c instanceof Be||c instanceof is||c instanceof ui||c instanceof Xs||c instanceof Ni||c instanceof es)return c;switch(c instanceof Error||typeof c=="object"&&c!==null||Pt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),c.name){case"AbortException":return new Be(c.message);case"InvalidPDFException":return new is(c.message);case"MissingPDFException":return new ui(c.message);case"PasswordException":return new Xs(c.message,c.code);case"UnexpectedResponseException":return new Ni(c.message,c.status);case"UnknownErrorException":return new es(c.message,c.details)}return new es(c.message,c.toString())}var li=class{#t=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#s(e);return}if(e.callback){let i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===js.DATA)s.resolve(e.data);else if(e.callback===js.ERROR)s.reject(ce(e.reason));else throw new Error("Unexpected callback case");return}let t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let i=this.sourceName,s=e.sourceName,n=this.comObj;Promise.try(t,e.data).then(function(a){n.postMessage({sourceName:i,targetName:s,callback:js.DATA,callbackId:e.callbackId,data:a})},function(a){n.postMessage({sourceName:i,targetName:s,callback:js.ERROR,callbackId:e.callbackId,reason:ce(a)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){let i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){let s=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[s]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(a){n.reject(a)}return n.promise}sendWithStream(e,t,i,s){let n=this.streamId++,a=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{let f=Promise.withResolvers();return this.streamControllers[n]={controller:d,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:a,targetName:o,action:e,streamId:n,data:t,desiredSize:d.desiredSize},s),f.promise},pull:d=>{let f=Promise.withResolvers();return this.streamControllers[n].pullCall=f,h.postMessage({sourceName:a,targetName:o,stream:zt.PULL,streamId:n,desiredSize:d.desiredSize}),f.promise},cancel:d=>{Ut(d instanceof Error,"cancel must have a valid reason");let f=Promise.withResolvers();return this.streamControllers[n].cancelCall=f,this.streamControllers[n].isClosed=!0,h.postMessage({sourceName:a,targetName:o,stream:zt.CANCEL,streamId:n,reason:ce(d)}),f.promise}},i)}#i(e){let t=e.streamId,i=this.sourceName,s=e.sourceName,n=this.comObj,a=this,o=this.actionHandler[e.action],h={enqueue(d,f=1,m){if(this.isCancelled)return;let b=this.desiredSize;this.desiredSize-=f,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:s,stream:zt.ENQUEUE,streamId:t,chunk:d},m)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:zt.CLOSE,streamId:t}),delete a.streamSinks[t])},error(d){Ut(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:zt.ERROR,streamId:t,reason:ce(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(o,e.data,h).then(function(){n.postMessage({sourceName:i,targetName:s,stream:zt.START_COMPLETE,streamId:t,success:!0})},function(d){n.postMessage({sourceName:i,targetName:s,stream:zt.START_COMPLETE,streamId:t,reason:ce(d)})})}#s(e){let t=e.streamId,i=this.sourceName,s=e.sourceName,n=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case zt.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ce(e.reason));break;case zt.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ce(e.reason));break;case zt.PULL:if(!o){n.postMessage({sourceName:i,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||ll).then(function(){n.postMessage({sourceName:i,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,success:!0})},function(d){n.postMessage({sourceName:i,targetName:s,stream:zt.PULL_COMPLETE,streamId:t,reason:ce(d)})});break;case zt.ENQUEUE:if(Ut(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case zt.CLOSE:if(Ut(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#r(a,t);break;case zt.ERROR:Ut(a,"error should have stream controller"),a.controller.error(ce(e.reason)),this.#r(a,t);break;case zt.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ce(e.reason)),this.#r(a,t);break;case zt.CANCEL:if(!o)break;let h=ce(e.reason);Promise.try(o.onCancel||ll,h).then(function(){n.postMessage({sourceName:i,targetName:s,stream:zt.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){n.postMessage({sourceName:i,targetName:s,stream:zt.CANCEL_COMPLETE,streamId:t,reason:ce(d)})}),o.sinkCapability.reject(h),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}#r(e,t){return Q(this,null,function*(){yield Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]})}destroy(){this.#t?.abort(),this.#t=null}},en=class{#t=!1;constructor({enableHWA:e=!1}){this.#t=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");let i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Pt("Abstract method `_createCanvas` called.")}},Lr=class extends en{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let i=this._document.createElement("canvas");return i.width=e,i.height=t,i}},sn=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}fetch(t){return Q(this,arguments,function*({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");let i=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(i).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${i}`)})})}_fetch(e){return Q(this,null,function*(){Pt("Abstract method `_fetch` called.")})}},nn=class extends sn{_fetch(e){return Q(this,null,function*(){let t=yield Mn(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Pn(t)})}},rn=class{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,n){return"none"}destroy(e=!1){}},Rr=class extends rn{#t;#e;#i;#s;#r;#n;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#s=e,this.#r=t}get#o(){return this.#e||=new Map}get#h(){return this.#n||=new Map}get#c(){if(!this.#i){let e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;let i=this.#r.createElementNS(Ge,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#r.createElementNS(Ge,"defs"),e.append(i),i.append(this.#i),this.#r.body.append(e)}return this.#i}#u(e){if(e.length===1){let h=e[0],d=new Array(256);for(let m=0;m<256;m++)d[m]=h[m]/255;let f=d.join(",");return[f,f,f]}let[t,i,s]=e,n=new Array(256),a=new Array(256),o=new Array(256);for(let h=0;h<256;h++)n[h]=t[h]/255,a[h]=i[h]/255,o[h]=s[h]/255;return[n.join(","),a.join(","),o.join(",")]}#d(e){if(this.#t===void 0){this.#t="";let t=this.#r.URL;t!==this.#r.baseURI&&(In(t)?pt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=t.split("#",1)[0])}return`url(${this.#t}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;let[i,s,n]=this.#u(e),a=e.length===1?i:`${i}${s}${n}`;if(t=this.#o.get(a),t)return this.#o.set(e,t),t;let o=`g_${this.#s}_transfer_map_${this.#l++}`,h=this.#d(o);this.#o.set(e,h),this.#o.set(a,h);let d=this.#p(o);return this.#g(i,s,n,d),h}addHCMFilter(e,t){let i=`${e}-${t}`,s="base",n=this.#h.get(s);if(n?.key===i||(n?(n.filter?.remove(),n.key=i,n.url="none",n.filter=null):(n={key:i,url:"none",filter:null},this.#h.set(s,n)),!e||!t))return n.url;let a=this.#_(e);e=it.makeHexColor(...a);let o=this.#_(t);if(t=it.makeHexColor(...o),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return n.url;let h=new Array(256);for(let _=0;_<=255;_++){let w=_/255;h[_]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}let d=h.join(","),f=`g_${this.#s}_hcm_filter`,m=n.filter=this.#p(f);this.#g(d,d,d,m),this.#a(m);let b=(_,w)=>{let x=a[_]/255,C=o[_]/255,k=new Array(w+1);for(let D=0;D<=w;D++)k[D]=x+D/w*(C-x);return k.join(",")};return this.#g(b(0,5),b(1,5),b(2,5),m),n.url=this.#d(f),n.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;let[i]=this.#u([e]),s=`alpha_${i}`;if(t=this.#o.get(s),t)return this.#o.set(e,t),t;let n=`g_${this.#s}_alpha_map_${this.#l++}`,a=this.#d(n);this.#o.set(e,a),this.#o.set(s,a);let o=this.#p(n);return this.#b(i,o),a}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let i,s;if(e?([i]=this.#u([e]),s=`luminosity_${i}`):s="luminosity",t=this.#o.get(s),t)return this.#o.set(e,t),t;let n=`g_${this.#s}_luminosity_map_${this.#l++}`,a=this.#d(n);this.#o.set(e,a),this.#o.set(s,a);let o=this.#p(n);return this.#f(o),e&&this.#b(i,o),a}addHighlightHCMFilter(e,t,i,s,n){let a=`${t}-${i}-${s}-${n}`,o=this.#h.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url="none",o.filter=null):(o={key:a,url:"none",filter:null},this.#h.set(e,o)),!t||!i))return o.url;let[h,d]=[t,i].map(this.#_.bind(this)),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[b,_]=[s,n].map(this.#_.bind(this));m<f&&([f,m,b,_]=[m,f,_,b]),this.#c.style.color="";let w=(k,D,O)=>{let H=new Array(256),j=(m-f)/O,p=k/255,$=(D-k)/(255*O),W=0;for(let ot=0;ot<=O;ot++){let wt=Math.round(f+ot*j),mt=p+ot*$;for(let at=W;at<=wt;at++)H[at]=mt;W=wt+1}for(let ot=W;ot<256;ot++)H[ot]=H[W-1];return H.join(",")},x=`g_${this.#s}_hcm_${e}_filter`,C=o.filter=this.#p(x);return this.#a(C),this.#g(w(b[0],_[0],5),w(b[1],_[1],5),w(b[2],_[2],5),C),o.url=this.#d(x),o.url}destroy(e=!1){e&&this.#n?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#n?.clear(),this.#n=null,this.#l=0)}#f(e){let t=this.#r.createElementNS(Ge,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#a(e){let t=this.#r.createElementNS(Ge,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){let t=this.#r.createElementNS(Ge,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#m(e,t,i){let s=this.#r.createElementNS(Ge,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),e.append(s)}#g(e,t,i,s){let n=this.#r.createElementNS(Ge,"feComponentTransfer");s.append(n),this.#m(n,"feFuncR",e),this.#m(n,"feFuncG",t),this.#m(n,"feFuncB",i)}#b(e,t){let i=this.#r.createElementNS(Ge,"feComponentTransfer");t.append(i),this.#m(i,"feFuncA",e)}#_(e){return this.#c.style.color=e,za(getComputedStyle(this.#c).getPropertyValue("color"))}},an=class{constructor({baseUrl:e=null}){this.baseUrl=e}fetch(t){return Q(this,arguments,function*({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");let i=`${this.baseUrl}${e}`;return this._fetch(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})})}_fetch(e){return Q(this,null,function*(){Pt("Abstract method `_fetch` called.")})}},on=class extends an{_fetch(e){return Q(this,null,function*(){let t=yield Mn(e,"arraybuffer");return new Uint8Array(t)})}};Zt&&pt("Please use the `legacy` build in Node.js environments.");function wl(c){return Q(this,null,function*(){let t=yield process.getBuiltinModule("fs").promises.readFile(c);return new Uint8Array(t)})}var Dr=class extends rn{},Nr=class extends en{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}},Or=class extends sn{_fetch(e){return Q(this,null,function*(){return wl(e)})}},Fr=class extends an{_fetch(e){return Q(this,null,function*(){return wl(e)})}},Jt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Br(c,e){if(!e)return;let t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),c.clip(s)}var ls=class{getPattern(){Pt("Abstract method `getPattern` called.")}},Hr=class extends ls{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let n;if(s===Jt.STROKE||s===Jt.FILL){let a=t.current.getClippedPathBoundingBox(s,Ot(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,h=Math.ceil(a[3]-a[1])||1,d=t.cachedCanvases.getCanvas("pattern",o,h),f=d.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-a[0],-a[1]),i=it.transform(i,[1,0,0,1,a[0],a[1]]),f.transform(...t.baseTransform),this.matrix&&f.transform(...this.matrix),Br(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),n=e.createPattern(d.canvas,"no-repeat");let m=new DOMMatrix(i);n.setTransform(m)}else Br(e,this._bbox),n=this._createGradient(e);return n}};function br(c,e,t,i,s,n,a,o){let h=e.coords,d=e.colors,f=c.data,m=c.width*4,b;h[t+1]>h[i+1]&&(b=t,t=i,i=b,b=n,n=a,a=b),h[i+1]>h[s+1]&&(b=i,i=s,s=b,b=a,a=o,o=b),h[t+1]>h[i+1]&&(b=t,t=i,i=b,b=n,n=a,a=b);let _=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,x=(h[i]+e.offsetX)*e.scaleX,C=(h[i+1]+e.offsetY)*e.scaleY,k=(h[s]+e.offsetX)*e.scaleX,D=(h[s+1]+e.offsetY)*e.scaleY;if(w>=D)return;let O=d[n],H=d[n+1],j=d[n+2],p=d[a],$=d[a+1],W=d[a+2],ot=d[o],wt=d[o+1],mt=d[o+2],at=Math.round(w),Dt=Math.round(D),Ct,Yt,K,Z,$t,de,Te,te;for(let Ht=at;Ht<=Dt;Ht++){if(Ht<C){let Mt=Ht<w?0:(w-Ht)/(w-C);Ct=_-(_-x)*Mt,Yt=O-(O-p)*Mt,K=H-(H-$)*Mt,Z=j-(j-W)*Mt}else{let Mt;Ht>D?Mt=1:C===D?Mt=0:Mt=(C-Ht)/(C-D),Ct=x-(x-k)*Mt,Yt=p-(p-ot)*Mt,K=$-($-wt)*Mt,Z=W-(W-mt)*Mt}let Ft;Ht<w?Ft=0:Ht>D?Ft=1:Ft=(w-Ht)/(w-D),$t=_-(_-k)*Ft,de=O-(O-ot)*Ft,Te=H-(H-wt)*Ft,te=j-(j-mt)*Ft;let qe=Math.round(Math.min(Ct,$t)),ei=Math.round(Math.max(Ct,$t)),ie=m*Ht+qe*4;for(let Mt=qe;Mt<=ei;Mt++)Ft=(Ct-Mt)/(Ct-$t),Ft<0?Ft=0:Ft>1&&(Ft=1),f[ie++]=Yt-(Yt-de)*Ft|0,f[ie++]=K-(K-Te)*Ft|0,f[ie++]=Z-(Z-te)*Ft|0,f[ie++]=255}}function vh(c,e,t){let i=e.coords,s=e.colors,n,a;switch(e.type){case"lattice":let o=e.verticesPerRow,h=Math.floor(i.length/o)-1,d=o-1;for(n=0;n<h;n++){let f=n*o;for(let m=0;m<d;m++,f++)br(c,t,i[f],i[f+1],i[f+o],s[f],s[f+1],s[f+o]),br(c,t,i[f+o+1],i[f+1],i[f+o],s[f+o+1],s[f+1],s[f+o])}break;case"triangles":for(n=0,a=i.length;n<a;n+=3)br(c,t,i[n],i[n+1],i[n+2],s[n],s[n+1],s[n+2]);break;default:throw new Error("illegal figure")}}var jr=class extends ls{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){let o=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-o,f=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(f*e[1]*1.1)),3e3),_=d/m,w=f/b,x={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-h,scaleX:1/_,scaleY:1/w},C=m+4,k=b+4,D=i.getCanvas("mesh",C,k),O=D.context,H=O.createImageData(m,b);if(t){let p=H.data;for(let $=0,W=p.length;$<W;$+=4)p[$]=t[0],p[$+1]=t[1],p[$+2]=t[2],p[$+3]=255}for(let p of this._figures)vh(H,p,x);return O.putImageData(H,2,2),{canvas:D.canvas,offsetX:o-2*_,offsetY:h-2*w,scaleX:_,scaleY:w}}getPattern(e,t,i,s){Br(e,this._bbox);let n;if(s===Jt.SHADING)n=it.singularValueDecompose2dScale(Ot(e));else if(n=it.singularValueDecompose2dScale(t.baseTransform),this.matrix){let o=it.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}let a=this._createMeshCanvas(n,s===Jt.SHADING?null:this._background,t.cachedCanvases);return s!==Jt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}},Vr=class extends ls{getPattern(){return"hotpink"}};function yh(c){switch(c[0]){case"RadialAxial":return new Hr(c);case"Mesh":return new jr(c);case"Dummy":return new Vr}throw new Error(`Unknown IR type: ${c[0]}`)}var cl={COLORED:1,UNCOLORED:2},_h=(()=>{class c{static MAX_PATTERN_SIZE=3e3;constructor(t,i,s,n,a){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=i,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=a}createPatternCanvas(t){let{bbox:i,operatorList:s,paintType:n,tilingType:a,color:o,canvasGraphicsFactory:h}=this,{xstep:d,ystep:f}=this;d=Math.abs(d),f=Math.abs(f),kn("TilingType: "+a);let m=i[0],b=i[1],_=i[2],w=i[3],x=_-m,C=w-b,k=it.singularValueDecompose2dScale(this.matrix),D=it.singularValueDecompose2dScale(this.baseTransform),O=k[0]*D[0],H=k[1]*D[1],j=x,p=C,$=!1,W=!1,ot=Math.ceil(d*O),wt=Math.ceil(f*H),mt=Math.ceil(x*O),at=Math.ceil(C*H);ot>=mt?j=d:$=!0,wt>=at?p=f:W=!0;let Dt=this.getSizeAndScale(j,this.ctx.canvas.width,O),Ct=this.getSizeAndScale(p,this.ctx.canvas.height,H),Yt=t.cachedCanvases.getCanvas("pattern",Dt.size,Ct.size),K=Yt.context,Z=h.createCanvasGraphics(K);if(Z.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(Z,n,o),K.translate(-Dt.scale*m,-Ct.scale*b),Z.transform(Dt.scale,0,0,Ct.scale,0,0),K.save(),this.clipBbox(Z,m,b,_,w),Z.baseTransform=Ot(Z.ctx),Z.executeOperatorList(s),Z.endDrawing(),K.restore(),$||W){let $t=Yt.canvas;$&&(j=d),W&&(p=f);let de=this.getSizeAndScale(j,this.ctx.canvas.width,O),Te=this.getSizeAndScale(p,this.ctx.canvas.height,H),te=de.size,Ht=Te.size,Ft=t.cachedCanvases.getCanvas("pattern-workaround",te,Ht),qe=Ft.context,ei=$?Math.floor(x/d):0,ie=W?Math.floor(C/f):0;for(let Mt=0;Mt<=ei;Mt++)for(let ue=0;ue<=ie;ue++)qe.drawImage($t,te*Mt,Ht*ue,te,Ht,0,0,te,Ht);return{canvas:Ft.canvas,scaleX:de.scale,scaleY:Te.scale,offsetX:m,offsetY:b}}return{canvas:Yt.canvas,scaleX:Dt.scale,scaleY:Ct.scale,offsetX:m,offsetY:b}}getSizeAndScale(t,i,s){let n=Math.max(c.MAX_PATTERN_SIZE,i),a=Math.ceil(t*s);return a>=n?a=n:s=a/t,{scale:s,size:a}}clipBbox(t,i,s,n,a){let o=n-i,h=a-s;t.ctx.rect(i,s,o,h),t.current.updateRectMinMax(Ot(t.ctx),[i,s,n,a]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,i,s){let n=t.ctx,a=t.current;switch(i){case cl.COLORED:let o=this.ctx;n.fillStyle=o.fillStyle,n.strokeStyle=o.strokeStyle,a.fillColor=o.fillStyle,a.strokeColor=o.strokeStyle;break;case cl.UNCOLORED:let h=it.makeHexColor(s[0],s[1],s[2]);n.fillStyle=h,n.strokeStyle=h,a.fillColor=h,a.strokeColor=h;break;default:throw new Ar(`Unsupported paint type: ${i}`)}}getPattern(t,i,s,n){let a=s;n!==Jt.SHADING&&(a=it.transform(a,i.baseTransform),this.matrix&&(a=it.transform(a,this.matrix)));let o=this.createPatternCanvas(i),h=new DOMMatrix(a);h=h.translate(o.offsetX,o.offsetY),h=h.scale(1/o.scaleX,1/o.scaleY);let d=t.createPattern(o.canvas,"repeat");return d.setTransform(h),d}}return c})();function Ah({src:c,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:n=4294967295,inverseDecode:a=!1}){let o=Xt.isLittleEndian?4278190080:255,[h,d]=a?[n,o]:[o,n],f=i>>3,m=i&7,b=c.length;t=new Uint32Array(t.buffer);let _=0;for(let w=0;w<s;w++){for(let C=e+f;e<C;e++){let k=e<b?c[e]:255;t[_++]=k&128?d:h,t[_++]=k&64?d:h,t[_++]=k&32?d:h,t[_++]=k&16?d:h,t[_++]=k&8?d:h,t[_++]=k&4?d:h,t[_++]=k&2?d:h,t[_++]=k&1?d:h}if(m===0)continue;let x=e<b?c[e++]:255;for(let C=0;C<m;C++)t[_++]=x&1<<7-C?d:h}return{srcPos:e,destPos:_}}var hl=16,dl=100,wh=15,ul=10,fl=1e3,he=16;function xh(c,e){if(c._removeMirroring)throw new Error("Context is already forwarding operations.");c.__originalSave=c.save,c.__originalRestore=c.restore,c.__originalRotate=c.rotate,c.__originalScale=c.scale,c.__originalTranslate=c.translate,c.__originalTransform=c.transform,c.__originalSetTransform=c.setTransform,c.__originalResetTransform=c.resetTransform,c.__originalClip=c.clip,c.__originalMoveTo=c.moveTo,c.__originalLineTo=c.lineTo,c.__originalBezierCurveTo=c.bezierCurveTo,c.__originalRect=c.rect,c.__originalClosePath=c.closePath,c.__originalBeginPath=c.beginPath,c._removeMirroring=()=>{c.save=c.__originalSave,c.restore=c.__originalRestore,c.rotate=c.__originalRotate,c.scale=c.__originalScale,c.translate=c.__originalTranslate,c.transform=c.__originalTransform,c.setTransform=c.__originalSetTransform,c.resetTransform=c.__originalResetTransform,c.clip=c.__originalClip,c.moveTo=c.__originalMoveTo,c.lineTo=c.__originalLineTo,c.bezierCurveTo=c.__originalBezierCurveTo,c.rect=c.__originalRect,c.closePath=c.__originalClosePath,c.beginPath=c.__originalBeginPath,delete c._removeMirroring},c.save=function(){e.save(),this.__originalSave()},c.restore=function(){e.restore(),this.__originalRestore()},c.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},c.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},c.transform=function(i,s,n,a,o,h){e.transform(i,s,n,a,o,h),this.__originalTransform(i,s,n,a,o,h)},c.setTransform=function(i,s,n,a,o,h){e.setTransform(i,s,n,a,o,h),this.__originalSetTransform(i,s,n,a,o,h)},c.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},c.rotate=function(i){e.rotate(i),this.__originalRotate(i)},c.clip=function(i){e.clip(i),this.__originalClip(i)},c.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},c.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},c.bezierCurveTo=function(t,i,s,n,a,o){e.bezierCurveTo(t,i,s,n,a,o),this.__originalBezierCurveTo(t,i,s,n,a,o)},c.rect=function(t,i,s,n){e.rect(t,i,s,n),this.__originalRect(t,i,s,n)},c.closePath=function(){e.closePath(),this.__originalClosePath()},c.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}var zr=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function Vs(c,e,t,i,s,n,a,o,h,d){let[f,m,b,_,w,x]=Ot(c);if(m===0&&b===0){let D=a*f+w,O=Math.round(D),H=o*_+x,j=Math.round(H),p=(a+h)*f+w,$=Math.abs(Math.round(p)-O)||1,W=(o+d)*_+x,ot=Math.abs(Math.round(W)-j)||1;return c.setTransform(Math.sign(f),0,0,Math.sign(_),O,j),c.drawImage(e,t,i,s,n,0,0,$,ot),c.setTransform(f,m,b,_,w,x),[$,ot]}if(f===0&&_===0){let D=o*b+w,O=Math.round(D),H=a*m+x,j=Math.round(H),p=(o+d)*b+w,$=Math.abs(Math.round(p)-O)||1,W=(a+h)*m+x,ot=Math.abs(Math.round(W)-j)||1;return c.setTransform(0,Math.sign(m),Math.sign(b),0,O,j),c.drawImage(e,t,i,s,n,0,0,ot,$),c.setTransform(f,m,b,_,w,x),[ot,$]}c.drawImage(e,t,i,s,n,a,o,h,d);let C=Math.hypot(f,m),k=Math.hypot(b,_);return[C*h,k*d]}function Sh(c){let{width:e,height:t}=c;if(e>fl||t>fl)return null;let i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=e+1,a=new Uint8Array(n*(t+1)),o,h,d,f=e+7&-8,m=new Uint8Array(f*t),b=0;for(let k of c.data){let D=128;for(;D>0;)m[b++]=k&D?0:255,D>>=1}let _=0;for(b=0,m[b]!==0&&(a[0]=1,++_),h=1;h<e;h++)m[b]!==m[b+1]&&(a[h]=m[b]?2:1,++_),b++;for(m[b]!==0&&(a[h]=2,++_),o=1;o<t;o++){b=o*f,d=o*n,m[b-f]!==m[b]&&(a[d]=m[b]?1:8,++_);let k=(m[b]?4:0)+(m[b-f]?8:0);for(h=1;h<e;h++)k=(k>>2)+(m[b+1]?4:0)+(m[b-f+1]?8:0),s[k]&&(a[d+h]=s[k],++_),b++;if(m[b-f]!==m[b]&&(a[d+h]=m[b]?2:4,++_),_>i)return null}for(b=f*(t-1),d=o*n,m[b]!==0&&(a[d]=8,++_),h=1;h<e;h++)m[b]!==m[b+1]&&(a[d+h]=m[b]?4:8,++_),b++;if(m[b]!==0&&(a[d+h]=4,++_),_>i)return null;let w=new Int32Array([0,n,-1,0,-n,0,0,0,1]),x=new Path2D;for(o=0;_&&o<=t;o++){let k=o*n,D=k+e;for(;k<D&&!a[k];)k++;if(k===D)continue;x.moveTo(k%n,o);let O=k,H=a[k];do{let j=w[H];do k+=j;while(!a[k]);let p=a[k];p!==5&&p!==10?(H=p,a[k]=0):(H=p&51*H>>4,a[k]&=H>>2|H<<2),x.lineTo(k%n,k/n|0),a[k]||--_}while(O!==k);--o}return m=null,a=null,function(k){k.save(),k.scale(1/e,-1/t),k.translate(0,-t),k.fill(x),k.beginPath(),k.restore()}}var ln=class{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_l,this.textMatrixScale=1,this.fontMatrix=_r,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Qt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=it.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){let i=it.applyTransform(t,e),s=it.applyTransform(t.slice(2),e),n=it.applyTransform([t[0],t[3]],e),a=it.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],n[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],n[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],n[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],n[1],a[1])}updateScalingPathMinMax(e,t){it.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,n,a,o,h,d,f){let m=it.bezierBoundingBox(t,i,s,n,a,o,h,d,f);f||this.updateRectMinMax(e,m)}getPathBoundingBox(e=Jt.FILL,t=null){let i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Jt.STROKE){t||Pt("Stroke bounding box must include transform.");let s=it.singularValueDecompose2dScale(t),n=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){let e=it.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Jt.FILL,t=null){return it.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function pl(c,e){if(e instanceof ImageData){c.putImageData(e,0,0);return}let t=e.height,i=e.width,s=t%he,n=(t-s)/he,a=s===0?n:n+1,o=c.createImageData(i,he),h=0,d,f=e.data,m=o.data,b,_,w,x;if(e.kind===Gs.GRAYSCALE_1BPP){let C=f.byteLength,k=new Uint32Array(m.buffer,0,m.byteLength>>2),D=k.length,O=i+7>>3,H=4294967295,j=Xt.isLittleEndian?4278190080:255;for(b=0;b<a;b++){for(w=b<n?he:s,d=0,_=0;_<w;_++){let p=C-h,$=0,W=p>O?i:p*8-7,ot=W&-8,wt=0,mt=0;for(;$<ot;$+=8)mt=f[h++],k[d++]=mt&128?H:j,k[d++]=mt&64?H:j,k[d++]=mt&32?H:j,k[d++]=mt&16?H:j,k[d++]=mt&8?H:j,k[d++]=mt&4?H:j,k[d++]=mt&2?H:j,k[d++]=mt&1?H:j;for(;$<W;$++)wt===0&&(mt=f[h++],wt=128),k[d++]=mt&wt?H:j,wt>>=1}for(;d<D;)k[d++]=0;c.putImageData(o,0,b*he)}}else if(e.kind===Gs.RGBA_32BPP){for(_=0,x=i*he*4,b=0;b<n;b++)m.set(f.subarray(h,h+x)),h+=x,c.putImageData(o,0,_),_+=he;b<a&&(x=i*s*4,m.set(f.subarray(h,h+x)),c.putImageData(o,0,_))}else if(e.kind===Gs.RGB_24BPP)for(w=he,x=i*w,b=0;b<a;b++){for(b>=n&&(w=s,x=i*w),d=0,_=x;_--;)m[d++]=f[h++],m[d++]=f[h++],m[d++]=f[h++],m[d++]=255;c.putImageData(o,0,b*he)}else throw new Error(`bad image kind: ${e.kind}`)}function gl(c,e){if(e.bitmap){c.drawImage(e.bitmap,0,0);return}let t=e.height,i=e.width,s=t%he,n=(t-s)/he,a=s===0?n:n+1,o=c.createImageData(i,he),h=0,d=e.data,f=o.data;for(let m=0;m<a;m++){let b=m<n?he:s;({srcPos:h}=Ah({src:d,srcPos:h,dest:f,width:i,height:b,nonBlackColor:0})),c.putImageData(o,0,m*he)}}function Ki(c,e){let t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(let i of t)c[i]!==void 0&&(e[i]=c[i]);c.setLineDash!==void 0&&(e.setLineDash(c.getLineDash()),e.lineDashOffset=c.lineDashOffset)}function zs(c){if(c.strokeStyle=c.fillStyle="#000000",c.fillRule="nonzero",c.globalAlpha=1,c.lineWidth=1,c.lineCap="butt",c.lineJoin="miter",c.miterLimit=10,c.globalCompositeOperation="source-over",c.font="10px sans-serif",c.setLineDash!==void 0&&(c.setLineDash([]),c.lineDashOffset=0),!Zt){let{filter:e}=c;e!=="none"&&e!==""&&(c.filter="none")}}function ml(c,e){if(e)return!0;let t=it.singularValueDecompose2dScale(c);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);let i=Math.fround((globalThis.devicePixelRatio||1)*Ze.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}var Eh=["butt","round","square"],Ch=["miter","round","bevel"],Th={},bl={},Ii=class c{constructor(e,t,i,s,n,{optionalContentConfig:a,markedContentStack:o=null},h,d){this.ctx=e,this.current=new ln(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new zr(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){let n=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,a),this.ctx.fillStyle=o,i){let h=this.cachedCanvases.getCanvas("transparent",n,a);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ot(this.compositeCtx))}this.ctx.save(),zs(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ot(this.ctx)}executeOperatorList(e,t,i,s){let n=e.argsArray,a=e.fnArray,o=t||0,h=n.length;if(h===o)return o;let d=h-o>ul&&typeof i=="function",f=d?Date.now()+wh:0,m=0,b=this.commonObjs,_=this.objs,w;for(;;){if(s!==void 0&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(w=a[o],w!==Ee.dependency)this[w].apply(this,n[o]);else for(let x of n[o]){let C=x.startsWith("g_")?b:_;if(!C.has(x))return C.get(x,i),o}if(o++,o===h)return o;if(d&&++m>ul){if(Date.now()>f)return i(),o;m=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let i=e.width??e.displayWidth,s=e.height??e.displayHeight,n=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,h=s,d="prescale1",f,m;for(;n>2&&o>1||a>2&&h>1;){let b=o,_=h;n>2&&o>1&&(b=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),n/=o/b),a>2&&h>1&&(_=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,a/=h/_),f=this.cachedCanvases.getCanvas(d,b,_),m=f.context,m.clearRect(0,0,b,_),m.drawImage(e,0,0,o,h,0,0,b,_),e=f.canvas,o=b,h=_,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:h}}_createMaskCanvas(e){let t=this.ctx,{width:i,height:s}=e,n=this.current.fillColor,a=this.current.patternFill,o=Ot(t),h,d,f,m;if((e.bitmap||e.data)&&e.count>1){let W=e.bitmap||e.data.buffer;d=JSON.stringify(a?o:[o.slice(0,4),n]),h=this._cachedBitmapsMap.get(W),h||(h=new Map,this._cachedBitmapsMap.set(W,h));let ot=h.get(d);if(ot&&!a){let wt=Math.round(Math.min(o[0],o[2])+o[4]),mt=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:ot,offsetX:wt,offsetY:mt}}f=ot}f||(m=this.cachedCanvases.getCanvas("maskCanvas",i,s),gl(m.context,e));let b=it.transform(o,[1/i,0,0,-1/s,0,0]);b=it.transform(b,[1,0,0,1,0,-s]);let[_,w,x,C]=it.getAxialAlignedBoundingBox([0,0,i,s],b),k=Math.round(x-_)||1,D=Math.round(C-w)||1,O=this.cachedCanvases.getCanvas("fillCanvas",k,D),H=O.context,j=_,p=w;H.translate(-j,-p),H.transform(...b),f||(f=this._scaleImage(m.canvas,Oe(H)),f=f.img,h&&a&&h.set(d,f)),H.imageSmoothingEnabled=ml(Ot(H),e.interpolate),Vs(H,f,0,0,f.width,f.height,0,0,i,s),H.globalCompositeOperation="source-in";let $=it.transform(Oe(H),[1,0,0,1,-j,-p]);return H.fillStyle=a?n.getPattern(t,this,$,Jt.FILL):n,H.fillRect(0,0,i,s),h&&!a&&(this.cachedCanvases.delete("fillCanvas"),h.set(d,O.canvas)),{canvas:O.canvas,offsetX:Math.round(j),offsetY:Math.round(p)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Eh[e]}setLineJoin(e){this.ctx.lineJoin=Ch[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){let i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");let e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;let n=this.ctx;n.setTransform(...Ot(this.suspendedCtx)),Ki(this.suspendedCtx,n),xh(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ki(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){let n=s[0],a=s[1],o=s[2]-n,h=s[3]-a;o===0||h===0||(this.genericComposeSMask(t.context,i,o,h,t.subtype,t.backdrop,t.transferMap,n,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,n,a,o,h,d,f,m){let b=e.canvas,_=h-f,w=d-m;if(a){let C=it.makeHexColor(...a);if(_<0||w<0||_+i>b.width||w+s>b.height){let k=this.cachedCanvases.getCanvas("maskExtension",i,s),D=k.context;D.drawImage(b,-_,-w),D.globalCompositeOperation="destination-atop",D.fillStyle=C,D.fillRect(0,0,i,s),D.globalCompositeOperation="source-over",b=k.canvas,_=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let k=new Path2D;k.rect(_,w,i,s),e.clip(k),e.globalCompositeOperation="destination-atop",e.fillStyle=C,e.fillRect(_,w,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),n==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):n==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));let x=new Path2D;x.rect(h,d,i,s),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(b,_,w,i,s,h,d,i,s),t.restore()}save(){this.inSMaskMode?(Ki(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();let e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ki(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,n,a){this.ctx.transform(e,t,i,s,n,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){let s=this.ctx,n=this.current,a=n.x,o=n.y,h,d,f=Ot(s),m=f[0]===0&&f[3]===0||f[1]===0&&f[2]===0,b=m?i.slice(0):null;for(let _=0,w=0,x=e.length;_<x;_++)switch(e[_]|0){case Ee.rectangle:a=t[w++],o=t[w++];let C=t[w++],k=t[w++],D=a+C,O=o+k;s.moveTo(a,o),C===0||k===0?s.lineTo(D,O):(s.lineTo(D,o),s.lineTo(D,O),s.lineTo(a,O)),m||n.updateRectMinMax(f,[a,o,D,O]),s.closePath();break;case Ee.moveTo:a=t[w++],o=t[w++],s.moveTo(a,o),m||n.updatePathMinMax(f,a,o);break;case Ee.lineTo:a=t[w++],o=t[w++],s.lineTo(a,o),m||n.updatePathMinMax(f,a,o);break;case Ee.curveTo:h=a,d=o,a=t[w+4],o=t[w+5],s.bezierCurveTo(t[w],t[w+1],t[w+2],t[w+3],a,o),n.updateCurvePathMinMax(f,h,d,t[w],t[w+1],t[w+2],t[w+3],a,o,b),w+=6;break;case Ee.curveTo2:h=a,d=o,s.bezierCurveTo(a,o,t[w],t[w+1],t[w+2],t[w+3]),n.updateCurvePathMinMax(f,h,d,a,o,t[w],t[w+1],t[w+2],t[w+3],b),a=t[w+2],o=t[w+3],w+=4;break;case Ee.curveTo3:h=a,d=o,a=t[w+2],o=t[w+3],s.bezierCurveTo(t[w],t[w+1],a,o,a,o),n.updateCurvePathMinMax(f,h,d,t[w],t[w+1],a,o,a,o,b),w+=4;break;case Ee.closePath:s.closePath();break}m&&n.updateScalingPathMinMax(f,b),n.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){let t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,Oe(t),Jt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){let t=this.ctx,i=this.current.fillColor,s=this.current.patternFill,n=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,Oe(t),Jt.FILL),n=!0);let a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),n&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Th}eoClip(){this.pendingClip=bl}beginText(){this.current.textMatrix=_l,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){let e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}let i=new Path2D,s=t.getTransform().invertSelf();for(let{transform:n,x:a,y:o,fontSize:h,path:d}of e)i.addPath(d,new DOMMatrix(n).preMultiplySelf(s).translate(a,o).scale(h,-h));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){let i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||_r,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&pt("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;let n=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${n}", ${i.fallbackName}`,o="normal";i.black?o="900":i.bold&&(o="bold");let h=i.italic?"italic":"normal",d=t;t<hl?d=hl:t>dl&&(d=dl),this.current.fontSizeScale=t/d,this.ctx.font=`${h} ${o} ${d}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,n,a){this.current.textMatrix=[e,t,i,s,n,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#i(e,t,i){let s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s}paintChar(e,t,i,s,n){let a=this.ctx,o=this.current,h=o.font,d=o.textRenderingMode,f=o.fontSize/o.fontSizeScale,m=d&Qt.FILL_STROKE_MASK,b=!!(d&Qt.ADD_TO_PATH_FLAG),_=o.patternFill&&!h.missingFile,w=o.patternStroke&&!h.missingFile,x;if((h.disableFontFace||b||_||w)&&(x=h.getPathGenerator(this.commonObjs,e)),h.disableFontFace||_||w){if(a.save(),a.translate(t,i),a.scale(f,-f),m===Qt.FILL||m===Qt.FILL_STROKE)if(s){let C=a.getTransform();a.setTransform(...s),a.fill(this.#i(x,C,s))}else a.fill(x);if(m===Qt.STROKE||m===Qt.FILL_STROKE)if(n){let C=a.getTransform();a.setTransform(...n),a.stroke(this.#i(x,C,n))}else a.lineWidth/=f,a.stroke(x);a.restore()}else(m===Qt.FILL||m===Qt.FILL_STROKE)&&a.fillText(e,t,i),(m===Qt.STROKE||m===Qt.FILL_STROKE)&&a.strokeText(e,t,i);b&&(this.pendingTextPaths||=[]).push({transform:Ot(a),x:t,y:i,fontSize:f,path:x})}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);let t=e.getImageData(0,0,10,10).data,i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return bt(this,"isFontSubpixelAAEnabled",i)}showText(e){let t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);let s=t.fontSize;if(s===0)return;let n=this.ctx,a=t.fontSizeScale,o=t.charSpacing,h=t.wordSpacing,d=t.fontDirection,f=t.textHScale*d,m=e.length,b=i.vertical,_=b?1:-1,w=i.defaultVMetrics,x=s*t.fontMatrix[0],C=t.textRenderingMode===Qt.FILL&&!i.disableFontFace&&!t.patternFill;n.save(),n.transform(...t.textMatrix),n.translate(t.x,t.y+t.textRise),d>0?n.scale(f,-1):n.scale(f,1);let k,D;if(t.patternFill){n.save();let $=t.fillColor.getPattern(n,this,Oe(n),Jt.FILL);k=Ot(n),n.restore(),n.fillStyle=$}if(t.patternStroke){n.save();let $=t.strokeColor.getPattern(n,this,Oe(n),Jt.STROKE);D=Ot(n),n.restore(),n.strokeStyle=$}let O=t.lineWidth,H=t.textMatrixScale;if(H===0||O===0){let $=t.textRenderingMode&Qt.FILL_STROKE_MASK;($===Qt.STROKE||$===Qt.FILL_STROKE)&&(O=this.getSinglePixelWidth())}else O/=H;if(a!==1&&(n.scale(a,a),O/=a),n.lineWidth=O,i.isInvalidPDFjsFont){let $=[],W=0;for(let ot of e)$.push(ot.unicode),W+=ot.width;n.fillText($.join(""),0,0),t.x+=W*x*f,n.restore(),this.compose();return}let j=0,p;for(p=0;p<m;++p){let $=e[p];if(typeof $=="number"){j+=_*$*s/1e3;continue}let W=!1,ot=($.isSpace?h:0)+o,wt=$.fontChar,mt=$.accent,at,Dt,Ct=$.width;if(b){let K=$.vmetric||w,Z=-($.vmetric?K[1]:Ct*.5)*x,$t=K[2]*x;Ct=K?-K[0]:Ct,at=Z/a,Dt=(j+$t)/a}else at=j/a,Dt=0;if(i.remeasure&&Ct>0){let K=n.measureText(wt).width*1e3/s*a;if(Ct<K&&this.isFontSubpixelAAEnabled){let Z=Ct/K;W=!0,n.save(),n.scale(Z,1),at/=Z}else Ct!==K&&(at+=(Ct-K)/2e3*s/a)}if(this.contentVisible&&($.isInFont||i.missingFile)){if(C&&!mt)n.fillText(wt,at,Dt);else if(this.paintChar(wt,at,Dt,k,D),mt){let K=at+s*mt.offset.x/a,Z=Dt-s*mt.offset.y/a;this.paintChar(mt.fontChar,K,Z,k,D)}}let Yt=b?Ct*x-ot*d:Ct*x+ot*d;j+=Yt,W&&n.restore()}b?t.y-=j:t.x+=j*f,n.restore(),this.compose()}showType3Text(e){let t=this.ctx,i=this.current,s=i.font,n=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,h=i.charSpacing,d=i.wordSpacing,f=i.textHScale*a,m=i.fontMatrix||_r,b=e.length,_=i.textRenderingMode===Qt.INVISIBLE,w,x,C,k;if(!(_||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(f,a),w=0;w<b;++w){if(x=e[w],typeof x=="number"){k=o*x*n/1e3,this.ctx.translate(k,0),i.x+=k*f;continue}let D=(x.isSpace?d:0)+h,O=s.charProcOperatorList[x.operatorListId];if(!O){pt(`Type3 character "${x.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=x,this.save(),t.scale(n,n),t.transform(...m),this.executeOperatorList(O),this.restore()),C=it.applyTransform([x.width,0],m)[0]*n+D,t.translate(C,0),i.x+=C*f}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,n,a){this.ctx.rect(i,s,n-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){let i=e[1],s=this.baseTransform||Ot(this.ctx),n={createCanvasGraphics:a=>new c(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new _h(e,i,this.ctx,n,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=it.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=it.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=yh(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;let t=this.ctx;this.save();let i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,Oe(t),Jt.SHADING);let s=Oe(t);if(s){let{width:n,height:a}=t.canvas,[o,h,d,f]=it.getAxialAlignedBoundingBox([0,0,n,a],s);this.ctx.fillRect(o,h,d-o,f-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Pt("Should not call beginInlineImage")}beginImageData(){Pt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ot(this.ctx),t)){let i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(Ot(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let t=this.ctx;e.isolated||kn("TODO: Support non-isolated groups."),e.knockout&&pt("Knockout groups not supported.");let i=Ot(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=it.getAxialAlignedBoundingBox(e.bbox,Ot(t)),n=[0,0,t.canvas.width,t.canvas.height];s=it.intersect(s,n)||[0,0,0,0];let a=Math.floor(s[0]),o=Math.floor(s[1]),h=Math.max(Math.ceil(s[2])-a,1),d=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,h,d]);let f="groupAt"+this.groupLevel;e.smask&&(f+="_smask_"+this.smaskCounter++%2);let m=this.cachedCanvases.getCanvas(f,h,d),b=m.context;b.translate(-a,-o),b.transform(...i),e.smask?this.smaskStack.push({canvas:m.canvas,context:b,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Ki(t,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;let t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();let s=Ot(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);let n=it.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,i,s,n){if(this.#t(),zs(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){let a=t[2]-t[0],o=t[3]-t[1];if(n&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;let[h,d]=it.singularValueDecompose2dScale(Ot(this.ctx)),{viewportScale:f}=this,m=Math.ceil(a*this.outputScaleX*f),b=Math.ceil(o*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(m,b);let{canvas:_,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(e,_),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.save(),this.ctx.setTransform(h,0,0,-d,0,o*d),zs(this.ctx)}else zs(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new ln(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;let t=e.count;e=this.getObject(e.data,e),e.count=t;let i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=Sh(e)),s.compiled)){s.compiled(i);return}let n=this._createMaskCanvas(e),a=n.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,n.offsetX,n.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,n,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);let o=this.ctx;o.save();let h=Ot(o);o.transform(t,i,s,n,0,0);let d=this._createMaskCanvas(e);o.setTransform(1,0,0,1,d.offsetX-h[4],d.offsetY-h[5]);for(let f=0,m=a.length;f<m;f+=2){let b=it.transform(h,[t,i,s,n,a[f],a[f+1]]),[_,w]=it.applyTransform([0,0],b);o.drawImage(d.canvas,_,w)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;let t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(let n of e){let{data:a,width:o,height:h,transform:d}=n,f=this.cachedCanvases.getCanvas("maskCanvas",o,h),m=f.context;m.save();let b=this.getObject(a,n);gl(m,b),m.globalCompositeOperation="source-in",m.fillStyle=s?i.getPattern(m,this,Oe(t),Jt.FILL):i,m.fillRect(0,0,o,h),m.restore(),t.save(),t.transform(...d),t.scale(1,-1),Vs(t,f.canvas,0,0,o,h,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;let t=this.getObject(e);if(!t){pt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;let n=this.getObject(e);if(!n){pt("Dependent image isn't ready yet");return}let a=n.width,o=n.height,h=[];for(let d=0,f=s.length;d<f;d+=2)h.push({transform:[t,0,0,i,s[d],s[d+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(n,h)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;let{bitmap:t,width:i,height:s}=e,n=this.cachedCanvases.getCanvas("inlineImage",i,s),a=n.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",n.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;let t=e.width,i=e.height,s=this.ctx;if(this.save(),!Zt){let{filter:o}=s;o!=="none"&&o!==""&&(s.filter="none")}s.scale(1/t,-1/i);let n;if(e.bitmap)n=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)n=e;else{let h=this.cachedCanvases.getCanvas("inlineImage",t,i).context;pl(h,e),n=this.applyTransferMapsToCanvas(h)}let a=this._scaleImage(n,Oe(s));s.imageSmoothingEnabled=ml(Ot(s),e.interpolate),Vs(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;let i=this.ctx,s;if(e.bitmap)s=e.bitmap;else{let n=e.width,a=e.height,h=this.cachedCanvases.getCanvas("inlineImage",n,a).context;pl(h,e),s=this.applyTransferMapsToCanvas(h)}for(let n of t)i.save(),i.transform(...n.transform),i.scale(1,-1),Vs(i,s,n.x,n.y,n.w,n.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){let t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);let i=this.ctx;this.pendingClip&&(t||(this.pendingClip===bl?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=Ot(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:i,c:s,d:n}=this.ctx.getTransform(),a,o;if(i===0&&s===0){let h=Math.abs(t),d=Math.abs(n);if(h===d)if(e===0)a=o=1/h;else{let f=h*e;a=o=f<1?1/f:1}else if(e===0)a=1/h,o=1/d;else{let f=h*e,m=d*e;a=f<1?1/f:1,o=m<1?1/m:1}}else{let h=Math.abs(t*n-i*s),d=Math.hypot(t,i),f=Math.hypot(s,n);if(e===0)a=f/h,o=d/h;else{let m=e*h;a=f>m?f/m:1,o=d>m?d/m:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){let{ctx:t}=this,{lineWidth:i}=this.current,[s,n]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&n===1){t.stroke();return}let a=t.getLineDash();if(e&&t.save(),t.scale(s,n),a.length>0){let o=Math.max(s,n);t.setLineDash(a.map(h=>h/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let c in Ee)Ii.prototype[c]!==void 0&&(Ii.prototype[Ee[c]]=Ii.prototype[c]);var di=class{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#t=e}static get workerSrc(){return this.#e}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#e=e}},Ur=class{#t;#e;constructor({parsedData:e,rawData:t}){this.#t=e,this.#e=t}getRaw(){return this.#e}get(e){return this.#t.get(e)??null}getAll(){return Ha(this.#t)}has(e){return this.#t.has(e)}},Mi=Symbol("INTERNAL"),$r=class{#t=!1;#e=!1;#i=!1;#s=!0;constructor(e,{name:t,intent:i,usage:s,rbGroups:n}){this.#t=!!(e&ge.DISPLAY),this.#e=!!(e&ge.PRINT),this.name=t,this.intent=i,this.usage=s,this.rbGroups=n}get visible(){if(this.#i)return this.#s;if(!this.#s)return!1;let{print:e,view:t}=this.usage;return this.#t?t?.viewState!=="OFF":this.#e?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==Mi&&Pt("Internal method `_setVisible` called."),this.#i=i,this.#s=t}},Gr=class{#t=null;#e=new Map;#i=null;#s=null;constructor(e,t=ge.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#s=e.order;for(let i of e.groups)this.#e.set(i.id,new $r(t,i));if(e.baseState==="OFF")for(let i of this.#e.values())i._setVisible(Mi,!1);for(let i of e.on)this.#e.get(i)._setVisible(Mi,!0);for(let i of e.off)this.#e.get(i)._setVisible(Mi,!1);this.#i=this.getHash()}}#r(e){let t=e.length;if(t<2)return!0;let i=e[0];for(let s=1;s<t;s++){let n=e[s],a;if(Array.isArray(n))a=this.#r(n);else if(this.#e.has(n))a=this.#e.get(n).visible;else return pt(`Optional content group not found: ${n}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"}isVisible(e){if(this.#e.size===0)return!0;if(!e)return kn("Optional content group not defined."),!0;if(e.type==="OCG")return this.#e.has(e.id)?this.#e.get(e.id).visible:(pt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(let t of e.ids){if(!this.#e.has(t))return pt(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(let t of e.ids){if(!this.#e.has(t))return pt(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(let t of e.ids){if(!this.#e.has(t))return pt(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(let t of e.ids){if(!this.#e.has(t))return pt(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return pt(`Unknown optional content policy ${e.policy}.`),!0}return pt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){let s=this.#e.get(e);if(!s){pt(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(let n of s.rbGroups)for(let a of n)a!==e&&this.#e.get(a)?._setVisible(Mi,!1,!0);s._setVisible(Mi,!!t,!0),this.#t=null}setOCGState({state:e,preserveRB:t}){let i;for(let s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}let n=this.#e.get(s);if(n)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!n.visible,t);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?Ha(this.#e):null}getGroup(e){return this.#e.get(e)||null}getHash(){if(this.#t!==null)return this.#t;let e=new Zs;for(let[t,i]of this.#e)e.update(`${t}:${i.visible}`);return this.#t=e.hexdigest()}},Wr=class{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Ut(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');let{length:s,initialData:n,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,n?.length>0){let h=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),e.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{let s=this._rangeReaders.some(function(n){return n._begin!==e?!1:(n._enqueue(i),!0)});Ut(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ut(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");let e=this._queuedChunks;return this._queuedChunks=null,new qr(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let i=new Xr(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},qr=class{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=Va(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(let n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){return Q(this,null,function*(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}},Xr=class{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){return Q(this,null,function*(){if(this._queuedChunk){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function kh(c){let e=!0,t=i("filename\\*","i").exec(c);if(t){t=t[1];let f=o(t);return f=unescape(f),f=h(f),f=d(f),n(f)}if(t=a(c),t){let f=d(t);return n(f)}if(t=i("filename","i").exec(c),t){t=t[1];let f=o(t);return f=d(f),n(f)}function i(f,m){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function s(f,m){if(f){if(!/^[\x00-\xFF]+$/.test(m))return m;try{let b=new TextDecoder(f,{fatal:!0}),_=Pn(m);m=b.decode(_),e=!1}catch{}}return m}function n(f){return e&&/[\x80-\xff]/.test(f)&&(f=s("utf-8",f),e&&(f=s("iso-8859-1",f))),f}function a(f){let m=[],b,_=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=_.exec(f))!==null;){let[,x,C,k]=b;if(x=parseInt(x,10),x in m){if(x===0)break;continue}m[x]=[C,k]}let w=[];for(let x=0;x<m.length&&x in m;++x){let[C,k]=m[x];k=o(k),C&&(k=unescape(k),x===0&&(k=h(k))),w.push(k)}return w.join("")}function o(f){if(f.startsWith('"')){let m=f.slice(1).split('\\"');for(let b=0;b<m.length;++b){let _=m[b].indexOf('"');_!==-1&&(m[b]=m[b].slice(0,_),m.length=b+1),m[b]=m[b].replaceAll(/\\(.)/g,"$1")}f=m.join('"')}return f}function h(f){let m=f.indexOf("'");if(m===-1)return f;let b=f.slice(0,m),w=f.slice(m+1).replace(/^[^']*'/,"");return s(b,w)}function d(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,b,_,w){if(_==="q"||_==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,C){return String.fromCharCode(parseInt(C,16))}),s(b,w);try{w=atob(w)}catch{}return s(b,w)})}return""}function xl(c,e){let t=new Headers;if(!c||!e||typeof e!="object")return t;for(let i in e){let s=e[i];s!==void 0&&t.append(i,s)}return t}function Ln(c){try{return new URL(c).origin}catch{}return null}function Sl({responseHeaders:c,isHttp:e,rangeChunkSize:t,disableRange:i}){let s={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(c.get("Content-Length"),10);return!Number.isInteger(n)||(s.suggestedLength=n,n<=2*t)||i||!e||c.get("Accept-Ranges")!=="bytes"||(c.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function El(c){let e=c.get("Content-Disposition");if(e){let t=kh(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Va(t))return t}return null}function Rn(c,e){return c===404||c===0&&e.startsWith("file:")?new ui('Missing PDF "'+e+'".'):new Ni(`Unexpected server response (${c}) while retrieving PDF "${e}".`,c)}function Cl(c){return c===200||c===206}function Tl(c,e,t){return{method:"GET",headers:c,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function kl(c){return c instanceof Uint8Array?c.buffer:c instanceof ArrayBuffer?c:(pt(`getArrayBuffer - unexpected data format: ${c}`),new Uint8Array(c).buffer)}var cn=class{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=xl(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ut(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Yr(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let i=new Kr(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Yr=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let i=new Headers(e.headers),s=t.url;fetch(s,Tl(i,this._withCredentials,this._abortController)).then(n=>{if(e._responseOrigin=Ln(n.url),!Cl(n.status))throw Rn(n.status,s);this._reader=n.body.getReader(),this._headersCapability.resolve();let a=n.headers,{allowRangeRequests:o,suggestedLength:h}=Sl({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=h||this._contentLength,this._filename=El(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Be("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return Q(this,null,function*(){yield this._headersCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:kl(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},Kr=class{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;let s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;let n=new Headers(e.headers);n.append("Range",`bytes=${t}-${i-1}`);let a=s.url;fetch(a,Tl(n,this._withCredentials,this._abortController)).then(o=>{let h=Ln(o.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!Cl(o.status))throw Rn(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){return Q(this,null,function*(){yield this._readCapability.promise;let{value:e,done:t}=yield this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:kl(e),done:!1})})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},vr=200,yr=206;function Ph(c){let e=c.response;return typeof e!="string"?e:Pn(e).buffer}var Qr=class{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=xl(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){let t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(let[n,a]of this.headers)t.setRequestHeader(n,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=yr):s.expectedStatus=vr,t.responseType="arraybuffer",Ut(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){let i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){let i=this.pendingRequests[e];if(!i)return;let s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}let n=s.status||vr;if(!(n===vr&&i.expectedStatus===yr)&&n!==i.expectedStatus){i.onError(s.status);return}let o=Ph(s);if(n===yr){let h=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?i.onDone({begin:parseInt(d[1],10),chunk:o}):(pt('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},Jr=class{constructor(e){this._source=e,this._manager=new Qr(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ut(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Zr(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let i=new ta(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Zr=class{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ln(t.responseURL);let i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{let[h,...d]=o.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:n,suggestedLength:a}=Sl({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=El(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Rn(e,this._url),this._headersCapability.reject(this._storedError);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}read(){return Q(this,null,function*(){if(yield this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},ta=class{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){let e=Ln(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Rn(e,this._url);for(let t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}read(){return Q(this,null,function*(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise})}cancel(e){this._done=!0;for(let t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},Mh=/^[a-z][a-z0-9\-+.]+:/i;function Ih(c){if(Mh.test(c))return new URL(c);let e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(c))}var ea=class{constructor(e){this.source=e,this.url=Ih(e.url),Ut(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ut(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new ia(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let i=new sa(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},ia=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();let i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new ui(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){return Q(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Be("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},sa=class{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();let s=e.source;this._isStreamingSupported=!s.disableStream;let n=process.getBuiltinModule("fs");this._setReadableStream(n.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}read(){return Q(this,null,function*(){if(yield this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}},Lh=1e5,le=30,Rh=.8,cs=class c{#t=Promise.withResolvers();#e=null;#i=!1;#s=!!globalThis.FontInspector?.enabled;#r=null;#n=null;#l=0;#o=0;#h=null;#c=null;#u=0;#d=0;#f=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#b=null;static#_=new Map;static#v=new Map;static#A=new WeakMap;static#x=null;static#E=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=t,this.#d=i.scale*(globalThis.devicePixelRatio||1),this.#u=i.rotation,this.#n={div:null,properties:null,ctx:null};let{pageWidth:s,pageHeight:n,pageX:a,pageY:o}=i.rawDims;this.#b=[1,0,0,-1,-a,o+n],this.#o=s,this.#l=n,c.#I(),fi(t,i),this.#t.promise.finally(()=>{c.#E.delete(this),this.#n=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=Xt.platform;return bt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){let e=()=>{this.#h.read().then(({value:t,done:i})=>{if(i){this.#t.resolve();return}this.#r??=t.lang,Object.assign(this.#f,t.styles),this.#T(t.items),e()},this.#t.reject)};return this.#h=this.#p.getReader(),c.#E.add(this),e(),this.#t.promise}update({viewport:e,onBefore:t=null}){let i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==this.#u&&(t?.(),this.#u=s,fi(this.#c,{rotation:s})),i!==this.#d){t?.(),this.#d=i;let n={div:null,properties:null,ctx:c.#k(this.#r)};for(let a of this.#m)n.properties=this.#g.get(a),n.div=a,this.#w(n)}}cancel(){let e=new Be("TextLayer task cancelled.");this.#h?.cancel(e).catch(()=>{}),this.#h=null,this.#t.reject(e)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#T(e){if(this.#i)return;this.#n.ctx??=c.#k(this.#r);let t=this.#m,i=this.#a;for(let s of e){if(t.length>Lh){pt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){let n=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id!==null&&this.#e.setAttribute("id",`${s.id}`),n.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(s.str),this.#P(s)}}#P(e){let t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#m.push(t);let s=it.transform(this.#b,e.transform),n=Math.atan2(s[1],s[0]),a=this.#f[e.fontName];a.vertical&&(n+=Math.PI/2);let o=this.#s&&a.fontSubstitution||a.fontFamily;o=c.fontFamilyMap.get(o)||o;let h=Math.hypot(s[2],s[3]),d=h*c.#D(o,this.#r),f,m;n===0?(f=s[4],m=s[5]-d):(f=s[4]+d*Math.sin(n),m=s[5]-d*Math.cos(n));let b="calc(var(--scale-factor)*",_=t.style;this.#e===this.#c?(_.left=`${(100*f/this.#o).toFixed(2)}%`,_.top=`${(100*m/this.#l).toFixed(2)}%`):(_.left=`${b}${f.toFixed(2)}px)`,_.top=`${b}${m.toFixed(2)}px)`),_.fontSize=`${b}${(c.#x*h).toFixed(2)}px)`,_.fontFamily=o,i.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#s&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),n!==0&&(i.angle=n*(180/Math.PI));let w=!1;if(e.str.length>1)w=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){let x=Math.abs(e.transform[0]),C=Math.abs(e.transform[3]);x!==C&&Math.max(x,C)/Math.min(x,C)>1.5&&(w=!0)}if(w&&(i.canvasWidth=a.vertical?e.height:e.width),this.#g.set(t,i),this.#n.div=t,this.#n.properties=i,this.#w(this.#n),i.hasText&&this.#e.append(t),i.hasEOL){let x=document.createElement("br");x.setAttribute("role","presentation"),this.#e.append(x)}}#w(e){let{div:t,properties:i,ctx:s}=e,{style:n}=t,a="";if(c.#x>1&&(a=`scale(${1/c.#x})`),i.canvasWidth!==0&&i.hasText){let{fontFamily:o}=n,{canvasWidth:h,fontSize:d}=i;c.#C(s,d*this.#d,o);let{width:f}=s.measureText(t.textContent);f>0&&(a=`scaleX(${h*this.#d/f}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(n.transform=a)}static cleanup(){if(!(this.#E.size>0)){this.#_.clear();for(let{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#k(e=null){let t=this.#v.get(e||="");if(!t){let i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#A.set(t,{size:0,family:""})}return t}static#C(e,t,i){let s=this.#A.get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)}static#I(){if(this.#x!==null)return;let e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#x=e.getBoundingClientRect().height,e.remove()}static#D(e,t){let i=this.#_.get(e);if(i)return i;let s=this.#k(t);s.canvas.width=s.canvas.height=le,this.#C(s,le,e);let n=s.measureText(""),a=n.fontBoundingBoxAscent,o=Math.abs(n.fontBoundingBoxDescent);if(a){let f=a/(a+o);return this.#_.set(e,f),s.canvas.width=s.canvas.height=0,f}s.strokeStyle="red",s.clearRect(0,0,le,le),s.strokeText("g",0,0);let h=s.getImageData(0,0,le,le).data;o=0;for(let f=h.length-1-3;f>=0;f-=4)if(h[f]>0){o=Math.ceil(f/4/le);break}s.clearRect(0,0,le,le),s.strokeText("A",0,le),h=s.getImageData(0,0,le,le).data,a=0;for(let f=0,m=h.length;f<m;f+=4)if(h[f]>0){a=le-Math.floor(f/4/le);break}s.canvas.width=s.canvas.height=0;let d=a?a/(a+o):Rh;return this.#_.set(e,d),d}},hs=class c{static textContent(e){let t=[],i={items:t,styles:Object.create(null)};function s(n){if(!n)return;let a=null,o=n.name;if(o==="#text")a=n.value;else if(c.shouldBuildText(o))n?.attributes?.textContent?a=n.attributes.textContent:n.value&&(a=n.value);else return;if(a!==null&&t.push({str:a}),!!n.children)for(let h of n.children)s(h)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}},Dh=65536,Nh=100,Oh=5e3,Fh=Zt?Nr:Lr,Bh=Zt?Or:nn,Hh=Zt?Dr:Rr,jh=Zt?Fr:on;function Vh(c={}){typeof c=="string"||c instanceof URL?c={url:c}:(c instanceof ArrayBuffer||ArrayBuffer.isView(c))&&(c={data:c});let e=new na,{docId:t}=e,i=c.url?zh(c.url):null,s=c.data?Uh(c.data):null,n=c.httpHeaders||null,a=c.withCredentials===!0,o=c.password??null,h=c.range instanceof hn?c.range:null,d=Number.isInteger(c.rangeChunkSize)&&c.rangeChunkSize>0?c.rangeChunkSize:Dh,f=c.worker instanceof Li?c.worker:null,m=c.verbosity,b=typeof c.docBaseUrl=="string"&&!In(c.docBaseUrl)?c.docBaseUrl:null,_=typeof c.cMapUrl=="string"?c.cMapUrl:null,w=c.cMapPacked!==!1,x=c.CMapReaderFactory||Bh,C=typeof c.standardFontDataUrl=="string"?c.standardFontDataUrl:null,k=c.StandardFontDataFactory||jh,D=c.stopAtErrors!==!0,O=Number.isInteger(c.maxImageSize)&&c.maxImageSize>-1?c.maxImageSize:-1,H=c.isEvalSupported!==!1,j=typeof c.isOffscreenCanvasSupported=="boolean"?c.isOffscreenCanvasSupported:!Zt,p=typeof c.isImageDecoderSupported=="boolean"?c.isImageDecoderSupported:!Zt&&(Xt.platform.isFirefox||!globalThis.chrome),$=Number.isInteger(c.canvasMaxAreaInBytes)?c.canvasMaxAreaInBytes:-1,W=typeof c.disableFontFace=="boolean"?c.disableFontFace:Zt,ot=c.fontExtraProperties===!0,wt=c.enableXfa===!0,mt=c.ownerDocument||globalThis.document,at=c.disableRange===!0,Dt=c.disableStream===!0,Ct=c.disableAutoFetch===!0,Yt=c.pdfBug===!0,K=c.CanvasFactory||Fh,Z=c.FilterFactory||Hh,$t=c.enableHWA===!0,de=h?h.length:c.length??NaN,Te=typeof c.useSystemFonts=="boolean"?c.useSystemFonts:!Zt&&!W,te=typeof c.useWorkerFetch=="boolean"?c.useWorkerFetch:x===nn&&k===on&&_&&C&&Zi(_,document.baseURI)&&Zi(C,document.baseURI),Ht=null;sh(m);let Ft={canvasFactory:new K({ownerDocument:mt,enableHWA:$t}),filterFactory:new Z({docId:t,ownerDocument:mt}),cMapReaderFactory:te?null:new x({baseUrl:_,isCompressed:w}),standardFontDataFactory:te?null:new k({baseUrl:C})};if(!f){let ie={verbosity:m,port:di.workerPort};f=ie.port?Li.fromPort(ie):new Li(ie),e._worker=f}let qe={docId:t,apiVersion:"4.10.38",data:s,password:o,disableAutoFetch:Ct,rangeChunkSize:d,length:de,docBaseUrl:b,enableXfa:wt,evaluatorOptions:{maxImageSize:O,disableFontFace:W,ignoreErrors:D,isEvalSupported:H,isOffscreenCanvasSupported:j,isImageDecoderSupported:p,canvasMaxAreaInBytes:$,fontExtraProperties:ot,useSystemFonts:Te,cMapUrl:te?_:null,standardFontDataUrl:te?C:null}},ei={disableFontFace:W,fontExtraProperties:ot,ownerDocument:mt,pdfBug:Yt,styleElement:Ht,loadingParams:{disableAutoFetch:Ct,enableXfa:wt}};return f.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");let ie=f.messageHandler.sendWithPromise("GetDocRequest",qe,s?[s.buffer]:null),Mt;if(h)Mt=new Wr(h,{disableRange:at,disableStream:Dt});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let ue;if(Zt)if(Zi(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");ue=cn}else ue=ea;else ue=Zi(i)?cn:Jr;Mt=new ue({url:i,length:de,httpHeaders:n,withCredentials:a,rangeChunkSize:d,disableRange:at,disableStream:Dt})}return ie.then(ue=>{if(e.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");let fe=new li(t,ue,f.port),On=new la(fe,e,Mt,ei,Ft);e._transport=On,fe.send("Ready",null)})}).catch(e._capability.reject),e}function zh(c){if(c instanceof URL)return c.href;try{return new URL(c,window.location).href}catch{if(Zt&&typeof c=="string")return c}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Uh(c){if(Zt&&typeof Buffer<"u"&&c instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength)return c;if(typeof c=="string")return Pn(c);if(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="object"&&!isNaN(c?.length))return new Uint8Array(c);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function vl(c){return typeof c=="object"&&Number.isInteger(c?.num)&&c.num>=0&&Number.isInteger(c?.gen)&&c.gen>=0}var na=class c{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${c.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){return Q(this,null,function*(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),yield this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null})}},hn=class{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(let i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(let i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(let t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(let e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Pt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}},ra=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return bt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},aa=class{#t=null;#e=!1;constructor(e,t,i,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new Ys:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new dn,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:n=!1}={}){return new ss({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:n})}getAnnotations({intent:e="display"}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return bt(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){return Q(this,null,function*(){return this._transport._htmlForXfa?.children[this._pageIndex]||null})}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=Qe.ENABLE,transform:n=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:h=null,pageColors:d=null,printAnnotationStorage:f=null,isEditing:m=!1}){this._stats?.time("Overall");let b=this._transport.getRenderingIntent(i,s,f,m),{renderingIntent:_,cacheKey:w}=b;this.#e=!1,this.#s(),o||=this._transport.getOptionalContentConfig(_);let x=this._intentStates.get(w);x||(x=Object.create(null),this._intentStates.set(w,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);let C=!!(_&ge.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));let k=H=>{x.renderTasks.delete(D),(this._maybeCleanupAfterRender||C)&&(this.#e=!0),this.#i(!C),H?(D.capability.reject(H),this._abortOperatorList({intentState:x,reason:H instanceof Error?H:new Error(H)})):D.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},D=new ha({callback:k,params:{canvasContext:e,viewport:t,transform:n,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!C,pdfBug:this._pdfBug,pageColors:d});(x.renderTasks||=new Set).add(D);let O=D.task;return Promise.all([x.displayReadyCapability.promise,o]).then(([H,j])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(j.renderingIntent&_))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");D.initializeGraphics({transparency:H,optionalContentConfig:j}),D.operatorListChanged()}).catch(k),O}getOperatorList({intent:e="display",annotationMode:t=Qe.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function n(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(h))}let a=this._transport.getRenderingIntent(e,t,i,s,!0),o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let h;return o.opListReadCapability||(h=Object.create(null),h.operatorListChanged=n,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(h),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>hs.textContent(i));let t=this.streamTextContent(e);return new Promise(function(i,s){function n(){a.read().then(function({value:h,done:d}){if(d){i(o);return}o.lang??=h.lang,Object.assign(o.styles,h.styles),o.items.push(...h.items),n()},s)}let a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(let i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(e)}cleanup(e=!1){this.#e=!0;let t=this.#i(!1);return e&&t&&(this._stats&&=new Ys),t}#i(e=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(e)return this.#t=setTimeout(()=>{this.#t=null,this.#i(!1)},Oh),!1;for(let{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(e,t){let i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#i(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){let{map:n,transfer:a}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:n,modifiedIds:s},a).getReader(),d=this._intentStates.get(t);d.streamReader=h;let f=()=>{h.read().then(({value:m,done:b})=>{if(b){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,d),f())},m=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(let b of d.renderTasks)b.operatorListChanged();this.#i(!0)}if(d.displayReadyCapability)d.displayReadyCapability.reject(m);else if(d.opListReadCapability)d.opListReadCapability.reject(m);else throw m}})};f()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof ns){let s=Nh;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Be(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[s,n]of this._intentStates)if(n===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}},oa=class{#t=new Map;#e=Promise.resolve();postMessage(e,t){let i={data:structuredClone(e,t?{transfer:t}:null)};this.#e.then(()=>{for(let[s]of this.#t)s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if(i?.signal instanceof AbortSignal){let{signal:n}=i;if(n.aborted){pt("LoopbackPort - cannot use an `aborted` signal.");return}let a=()=>this.removeEventListener(e,t);s=()=>n.removeEventListener("abort",a),n.addEventListener("abort",a)}this.#t.set(t,s)}removeEventListener(e,t){this.#t.get(t)?.(),this.#t.delete(t)}terminate(){for(let[,e]of this.#t)e?.();this.#t.clear()}},En,ci,hi,Ri,Ws,Di,qs,Nt=class Nt{constructor({name:e=null,port:t=null,verbosity:i=nh()}={}){ki(this,Ri);if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(De(Nt,hi)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(De(Nt,hi)||ks(Nt,hi,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new li("main","worker",e),this._messageHandler.on("ready",function(){}),Ps(this,Ri,Ws).call(this)}_initialize(){if(De(Nt,ci)||De(Nt,Di,qs)){this._setupFakeWorker();return}let{workerSrc:e}=Nt;try{Nt._isSameOrigin(window.location.href,e)||(e=Nt._createCDNWrapper(new URL(e,window.location).href));let t=new Worker(e,{type:"module"}),i=new li("main","worker",t),s=()=>{n.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:n.signal}),i.on("test",o=>{if(n.abort(),this.destroyed||!o){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,Ps(this,Ri,Ws).call(this)}),i.on("ready",o=>{if(n.abort(),this.destroyed){s();return}try{a()}catch{this._setupFakeWorker()}});let a=()=>{let o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{kn("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){De(Nt,ci)||(pt("Setting up fake worker."),ks(Nt,ci,!0)),Nt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}let t=new oa;this._port=t;let i=`fake${To(Nt,En)._++}`,s=new li(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new li(i,i+"_worker",t),Ps(this,Ri,Ws).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,De(Nt,hi)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");let t=De(this,hi)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Nt(e)}static get workerSrc(){if(di.workerSrc)return di.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return bt(this,"_setupFakeWorkerGlobal",Q(this,null,function*(){return De(this,Di,qs)?De(this,Di,qs):(yield import(this.workerSrc)).WorkerMessageHandler}))}};En=new WeakMap,ci=new WeakMap,hi=new WeakMap,Ri=new WeakSet,Ws=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Di=new WeakSet,qs=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},ki(Nt,Di),ki(Nt,En,0),ki(Nt,ci,!1),ki(Nt,hi),Zt&&(ks(Nt,ci,!0),di.workerSrc||="./pdf.worker.mjs"),Nt._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}let s=new URL(t,i);return i.origin===s.origin},Nt._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};var Li=Nt,la=class{#t=new Map;#e=new Map;#i=new Map;#s=new Map;#r=null;constructor(e,t,i,s,n){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new dn,this.fontLoader=new Mr({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#n(e,t=null){let i=this.#t.get(e);if(i)return i;let s=this.messageHandler.sendWithPromise(e,t);return this.#t.set(e,s),s}get annotationStorage(){return bt(this,"annotationStorage",new os)}getRenderingIntent(e,t=Qe.ENABLE,i=null,s=!1,n=!1){let a=ge.DISPLAY,o=Pr;switch(e){case"any":a=ge.ANY;break;case"display":break;case"print":a=ge.PRINT;break;default:pt(`getRenderingIntent - invalid intent: ${e}`)}let h=a&ge.PRINT&&i instanceof tn?i:this.annotationStorage;switch(t){case Qe.DISABLE:a+=ge.ANNOTATIONS_DISABLE;break;case Qe.ENABLE:break;case Qe.ENABLE_FORMS:a+=ge.ANNOTATIONS_FORMS;break;case Qe.ENABLE_STORAGE:a+=ge.ANNOTATIONS_STORAGE,o=h.serializable;break;default:pt(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=ge.IS_EDITING),n&&(a+=ge.OPLIST);let{ids:d,hash:f}=h.modifiedIds,m=[a,o.hash,f];return{renderingIntent:a,cacheKey:m.join("_"),annotationStorageSerializable:o,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));let e=[];for(let i of this.#e.values())e.push(i._destroy());this.#e.clear(),this.#i.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),cs.cleanup(),this._networkStream?.cancelAllRequests(new Be("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Ut(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},s.onPull=()=>{this._fullReader.read().then(function({value:n,done:a}){if(a){s.close();return}Ut(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{s.error(n)})},s.onCancel=n=>{this._fullReader.cancel(n),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",i=>Q(this,null,function*(){yield this._fullReader.headersReady;let{isStreamingSupported:s,isRangeSupported:n,contentLength:a}=this._fullReader;return(!s||!n)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:s,isRangeSupported:n,contentLength:a}})),e.on("GetRangeReader",(i,s)=>{Ut(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let n=this._networkStream.getRangeReader(i.begin,i.end);if(!n){s.close();return}s.onPull=()=>{n.read().then(function({value:a,done:o}){if(o){s.close();return}Ut(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{n.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new ra(i,this))}),e.on("DocException",i=>{t._capability.reject(ce(i))}),e.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!t.onPassword)throw ce(i);let s=n=>{n instanceof Error?this.#r.reject(n):this.#r.resolve({password:n})};t.onPassword(s,i.code)}catch(s){this.#r.reject(s)}return this.#r.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,n])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":let{disableFontFace:a,fontExtraProperties:o,pdfBug:h}=this._params;if("error"in n){let b=n.error;pt(`Error during font loading: ${b}`),this.commonObjs.resolve(i,b);break}let d=h&&globalThis.FontInspector?.enabled?(b,_)=>globalThis.FontInspector.fontAdded(b,_):null,f=new Ir(n,{disableFontFace:a,fontExtraProperties:o,inspectFont:d});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!o&&f.data&&(f.data=null),this.commonObjs.resolve(i,f)});break;case"CopyLocalImage":let{imageRef:m}=n;Ut(m,"The imageRef must be defined.");for(let b of this.#e.values())for(let[,_]of b.objs)if(_?.ref===m)return _.dataLen?(this.commonObjs.resolve(i,structuredClone(_)),_.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,n);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,n,a])=>{if(this.destroyed)return;let o=this.#e.get(s);if(!o.objs.has(i)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(n){case"Image":o.objs.resolve(i,a),a?.dataLen>Jc&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${n}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",i=>Q(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)})),e.on("FetchStandardFontData",i=>Q(this,null,function*(){if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&pt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));let t=e-1,i=this.#i.get(t);if(i)return i;let s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&this.#s.set(n.refStr,e);let a=new aa(t,n,this,this._params.pdfBug);return this.#e.set(t,a),a});return this.#i.set(t,s),s}getPageIndex(e){return vl(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#n("GetFieldObjects")}hasJSActions(){return this.#n("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#n("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#n("GetOptionalContentConfig").then(t=>new Gr(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){let e="GetMetadata",t=this.#t.get(e);if(t)return t;let i=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new Ur(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(e=!1){return Q(this,null,function*(){if(!this.destroyed){yield this.messageHandler.sendWithPromise("Cleanup",null);for(let t of this.#e.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),cs.cleanup()}})}cachedPageNumber(e){if(!vl(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#s.get(t)??null}},Qi=Symbol("INITIAL_DATA"),dn=class{#t=Object.create(null);#e(e){return this.#t[e]||=Ti(Ue({},Promise.withResolvers()),{data:Qi})}get(e,t=null){if(t){let s=this.#e(e);return s.promise.then(()=>t(s.data)),null}let i=this.#t[e];if(!i||i.data===Qi)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){let t=this.#t[e];return!!t&&t.data!==Qi}delete(e){let t=this.#t[e];return!t||t.data===Qi?!1:(delete this.#t[e],!0)}resolve(e,t=null){let i=this.#e(e);i.data=t,i.resolve()}clear(){for(let e in this.#t){let{data:t}=this.#t[e];t?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(let e in this.#t){let{data:t}=this.#t[e];t!==Qi&&(yield[e,t])}}},ca=class{#t=null;constructor(e){this.#t=e,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(e=0){this.#t.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#t.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#t;return e.form||e.canvas&&t?.size>0}},ha=class c{#t=null;static#e=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:a,pageIndex:o,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:f=!1,pdfBug:m=!1,pageColors:b=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=m,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ca(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(c.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{canvasContext:i,viewport:s,transform:n,background:a}=this.params;this.gfx=new Ii(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:s,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),c.#e.delete(this._canvas),this.callback(e||new ns(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){return Q(this,null,function*(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c.#e.delete(this._canvas),this.callback())))})}},$h="4.10.38",Gh="f9bea397f";function yl(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}function Ji(c){return Math.max(0,Math.min(255,255*c))}var un=class{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ji(e),[e,e,e]}static G_HTML([e]){let t=yl(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Ji)}static RGB_HTML(e){return`#${e.map(yl).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Ji(1-Math.min(1,e+s)),Ji(1-Math.min(1,i+s)),Ji(1-Math.min(1,t+s))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){let s=1-e,n=1-t,a=1-i,o=Math.min(s,n,a);return["CMYK",s,n,a,o]}},da=class{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");let s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Pt("Abstract method `_createSVG` called.")}},ds=class extends da{_createSVG(e){return document.createElementNS(Ge,e)}},fn=class{static setupStorage(e,t,i,s,n){let a=s.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),n==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),n==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),n==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(let o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{let h=o.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:n}){let{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(let[h,d]of Object.entries(a))if(d!=null)switch(h){case"class":d.length&&e.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!o||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,d)}o&&n.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){let t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,n=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:n,linkService:i});let o=n!=="richText",h=e.div;if(h.append(a),e.viewport){let m=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=m}o&&h.setAttribute("class","xfaLayer xfaFont");let d=[];if(s.children.length===0){if(s.value){let m=document.createTextNode(s.value);a.append(m),o&&hs.shouldBuildText(s.name)&&d.push(m)}return{textDivs:d}}let f=[[s,-1,a]];for(;f.length>0;){let[m,b,_]=f.at(-1);if(b+1===m.children.length){f.pop();continue}let w=m.children[++f.at(-1)[1]];if(w===null)continue;let{name:x}=w;if(x==="#text"){let k=document.createTextNode(w.value);d.push(k),_.append(k);continue}let C=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,x):document.createElement(x);if(_.append(C),w.attributes&&this.setAttributes({html:C,element:w,storage:t,intent:n,linkService:i}),w.children?.length>0)f.push([w,-1,C]);else if(w.value){let k=document.createTextNode(w.value);o&&hs.shouldBuildText(x)&&d.push(k),C.append(k)}}for(let m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){let t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}},ms=1e3,Wh=9,gi=new WeakSet;function Je(c){return{width:c[2]-c[0],height:c[3]-c[1]}}var ua=class{static create(e){switch(e.data.annotationType){case Wt.LINK:return new pn(e);case Wt.TEXT:return new fa(e);case Wt.WIDGET:switch(e.data.fieldType){case"Tx":return new pa(e);case"Btn":return e.data.radioButton?new gn(e):e.data.checkBox?new ma(e):new ba(e);case"Ch":return new va(e);case"Sig":return new ga(e)}return new We(e);case Wt.POPUP:return new us(e);case Wt.FREETEXT:return new mn(e);case Wt.LINE:return new _a(e);case Wt.SQUARE:return new Aa(e);case Wt.CIRCLE:return new wa(e);case Wt.POLYLINE:return new bn(e);case Wt.CARET:return new Sa(e);case Wt.INK:return new fs(e);case Wt.POLYGON:return new xa(e);case Wt.HIGHLIGHT:return new vn(e);case Wt.UNDERLINE:return new Ea(e);case Wt.SQUIGGLY:return new Ca(e);case Wt.STRIKEOUT:return new Ta(e);case Wt.STAMP:return new yn(e);case Wt.FILEATTACHMENT:return new ka(e);default:return new Vt(e)}}},Vt=class c{#t=null;#e=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return c._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};let{rect:t}=e;t&&this.#s(t),this.#i?.popup.updateEdited(e)}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#s(e){let{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:h}}}}=this;i?.splice(0,4,...e);let{width:d,height:f}=Je(e);t.left=`${100*(e[0]-o)/n}%`,t.top=`${100*(a-e[3]+h)/a}%`,s===0?(t.width=`${100*d/n}%`,t.height=`${100*f/a}%`):this.setRotation(s)}_createContainer(e){let{data:t,parent:{page:i,viewport:s}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",t.id),this instanceof We||(n.tabIndex=ms);let{style:a}=n;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(n.title=t.alternativeText),t.noRotate&&n.classList.add("norotate"),!t.rect||this instanceof us){let{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,n),n}let{width:o,height:h}=Je(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;let x=t.borderStyle.horizontalCornerRadius,C=t.borderStyle.verticalCornerRadius;if(x>0||C>0){let D=`calc(${x}px * var(--scale-factor)) / calc(${C}px * var(--scale-factor))`;a.borderRadius=D}else if(this instanceof gn){let D=`calc(${o}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;a.borderRadius=D}switch(t.borderStyle.style){case Yi.SOLID:a.borderStyle="solid";break;case Yi.DASHED:a.borderStyle="dashed";break;case Yi.BEVELED:pt("Unimplemented border style: beveled");break;case Yi.INSET:pt("Unimplemented border style: inset");break;case Yi.UNDERLINE:a.borderBottomStyle="solid";break;default:break}let k=t.borderColor||null;k?(this.#e=!0,a.borderColor=it.makeHexColor(k[0]|0,k[1]|0,k[2]|0)):a.borderWidth=0}let d=it.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:f,pageHeight:m,pageX:b,pageY:_}=s.rawDims;a.left=`${100*(d[0]-b)/f}%`,a.top=`${100*(d[1]-_)/m}%`;let{rotation:w}=t;return t.hasOwnCanvas||w===0?(a.width=`${100*o/f}%`,a.height=`${100*h/m}%`):this.setRotation(w,n),n}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:n,height:a}=Je(this.data.rect),o,h;e%180===0?(o=100*n/i,h=100*a/s):(o=100*a/i,h=100*n/s),t.style.width=`${o}%`,t.style.height=`${h}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){let e=(t,i,s)=>{let n=s.detail[t],a=n[0],o=n.slice(1);s.target.style[i]=un[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:un[`${a}_rgb`](o)})};return bt(this,"_commonActions",{display:t=>{let{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{let{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{let i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){let i=this._commonActions;for(let s of Object.keys(t.detail))(e[s]||i[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let i=this._commonActions;for(let[s,n]of Object.entries(t)){let a=i[s];if(a){let o={detail:{[s]:n},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,i,s,n]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){let[x,C,k,D]=e.subarray(2,6);if(s===x&&n===C&&t===k&&i===D)return}let{style:a}=this.container,o;if(this.#e){let{borderColor:x,borderWidth:C}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}let h=s-t,d=n-i,{svgFactory:f}=this,m=f.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0);let b=f.createElement("defs");m.append(b);let _=f.createElement("clipPath"),w=`clippath_${this.data.id}`;_.setAttribute("id",w),_.setAttribute("clipPathUnits","objectBoundingBox"),b.append(_);for(let x=2,C=e.length;x<C;x+=8){let k=e[x],D=e[x+1],O=e[x+2],H=e[x+3],j=f.createElement("rect"),p=(O-t)/h,$=(n-D)/d,W=(k-O)/h,ot=(D-H)/d;j.setAttribute("x",p),j.setAttribute("y",$),j.setAttribute("width",W),j.setAttribute("height",ot),_.append(j),o?.push(`<rect vector-effect="non-scaling-stroke" x="${p}" y="${$}" width="${W}" height="${ot}"/>`)}this.#e&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(m),this.container.style.clipPath=`url(#${w})`}_createPopup(){let{data:e}=this,t=this.#i=new us({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Pt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let i=[];if(this._fieldObjects){let s=this._fieldObjects[e];if(s)for(let{page:n,id:a,exportValues:o}of s){if(n===-1||a===t)continue;let h=typeof o=="string"?o:null,d=document.querySelector(`[data-element-id="${a}"]`);if(d&&!gi.has(d)){pt(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:h,domElement:d})}return i}for(let s of document.getElementsByName(e)){let{exportValue:n}=s,a=s.getAttribute("data-element-id");a!==t&&gi.has(s)&&i.push({id:a,exportValue:n,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}},pn=class extends Vt{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(i,e.action),s=!0):e.attachment?(this.#e(i,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(this.#i(i,e.setOCGState),s=!0):e.dest?(this._bindLink(i,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),s=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#t()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#t()}#e(e,t,i=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#t()}#i(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#t()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");let i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(let s of Object.keys(t.actions)){let n=i.get(s);n&&(e[n]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}e.onclick||(e.onclick=()=>!1),this.#t()}_bindResetFormAction(e,t){let i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){pt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();let{fields:s,refs:n,include:a}=t,o=[];if(s.length!==0||n.length!==0){let f=new Set(n);for(let m of s){let b=this._fieldObjects[m]||[];for(let{id:_}of b)f.add(_)}for(let m of Object.values(this._fieldObjects))for(let b of m)f.has(b.id)===a&&o.push(b)}else for(let f of Object.values(this._fieldObjects))o.push(...f);let h=this.annotationStorage,d=[];for(let f of o){let{id:m}=f;switch(d.push(m),f.type){case"text":{let _=f.defaultValue||"";h.setValue(m,{value:_});break}case"checkbox":case"radiobutton":{let _=f.defaultValue===f.exportValues;h.setValue(m,{value:_});break}case"combobox":case"listbox":{let _=f.defaultValue||"";h.setValue(m,{value:_});break}default:continue}let b=document.querySelector(`[data-element-id="${m}"]`);if(b){if(!gi.has(b)){pt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}},fa=class extends Vt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");let e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},We=class extends Vt{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Xt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,n){i.includes("mouse")?e.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a)}})})}_setEventListeners(e,t,i,s){for(let[n,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,n,a,s),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":it.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||Wh,n=e.style,a,o=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){let d=Math.abs(this.data.rect[3]-this.data.rect[1]-o),f=Math.round(d/($s*s))||1,m=d/f;a=Math.min(s,h(m/$s))}else{let d=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,h(d/$s))}n.fontSize=`calc(${a}px * var(--scale-factor))`,n.color=it.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(n.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}},pa=class extends We{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){let n=this.annotationStorage;for(let a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),n.setValue(a.id,{[s]:i})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){let s=e.getValue(t,{value:this.data.fieldValue}),n=s.value||"",a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&n.length>a&&(n=n.slice(0,a));let o=s.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));let h={userValue:n,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=o??n,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",o??n),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),gi.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=ms,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{let m=this.data.defaultFieldValue??"";i.value=h.userValue=m,h.formattedValue=null});let d=f=>{let{formattedValue:m}=h;m!=null&&(f.target.value=m),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",m=>{if(h.focused)return;let{target:b}=m;h.userValue&&(b.value=h.userValue),h.lastCommittedValue=b.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);let b={value(_){h.userValue=_.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){let{formattedValue:w}=_.detail;h.formattedValue=w,w!=null&&_.target!==document.activeElement&&(_.target.value=w),e.setValue(t,{formattedValue:w})},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{let{charLimit:w}=_.detail,{target:x}=_;if(w===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",w);let C=h.userValue;!C||C.length<=w||(C=C.slice(0,w),x.value=h.userValue=C,e.setValue(t,{value:C}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(b,m)}),i.addEventListener("keydown",m=>{h.commitKey=1;let b=-1;if(m.key==="Escape"?b=0:m.key==="Enter"&&!this.data.multiLine?b=2:m.key==="Tab"&&(h.commitKey=3),b===-1)return;let{value:_}=m.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:b,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});let f=d;d=null,i.addEventListener("blur",m=>{if(!h.focused||!m.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);let{value:b}=m.target;h.userValue=b,h.lastCommittedValue!==b&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}),f(m)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",m=>{h.lastCommittedValue=null;let{data:b,target:_}=m,{value:w,selectionStart:x,selectionEnd:C}=_,k=x,D=C;switch(m.inputType){case"deleteWordBackward":{let O=w.substring(0,x).match(/\w*[^\w]*$/);O&&(k-=O[0].length);break}case"deleteWordForward":{let O=w.substring(x).match(/^[^\w]*\w*/);O&&(D+=O[0].length);break}case"deleteContentBackward":x===C&&(k-=1);break;case"deleteContentForward":x===C&&(D+=1);break}m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,change:b||"",willCommit:!1,selStart:k,selEnd:D}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){let m=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},ga=class extends We{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},ma=class extends We{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,i=t.id,s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");let n=document.createElement("input");return gi.add(n),n.setAttribute("data-element-id",i),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=t.fieldName,s&&n.setAttribute("checked",!0),n.setAttribute("exportValue",t.exportValue),n.tabIndex=ms,n.addEventListener("change",a=>{let{name:o,checked:h}=a.target;for(let d of this._getElementsByName(o,i)){let f=h&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}e.setValue(i,{value:h})}),n.addEventListener("resetform",a=>{let o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",a=>{let o={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},gn=class extends We{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");let e=this.annotationStorage,t=this.data,i=t.id,s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(let a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});let n=document.createElement("input");if(gi.add(n),n.setAttribute("data-element-id",i),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=t.fieldName,s&&n.setAttribute("checked",!0),n.tabIndex=ms,n.addEventListener("change",a=>{let{name:o,checked:h}=a.target;for(let d of this._getElementsByName(o,i))e.setValue(d.id,{value:!1});e.setValue(i,{value:h})}),n.addEventListener("resetform",a=>{let o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){let a=t.buttonValue;n.addEventListener("updatefromsandbox",o=>{let h={value:d=>{let f=a===d.detail.value;for(let m of this._getElementsByName(d.target.name)){let b=f&&m.id===i;m.domElement&&(m.domElement.checked=b),e.setValue(m.id,{value:b})}}};this._dispatchEventFromSandbox(h,o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},ba=class extends pn{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}},va=class extends We{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");let e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");gi.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=ms;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",f=>{let m=this.data.defaultFieldValue;for(let b of s.options)b.selected=b.value===m});for(let f of this.data.options){let m=document.createElement("option");m.textContent=f.displayValue,m.value=f.exportValue,i.value.includes(f.exportValue)&&(m.setAttribute("selected",!0),n=!1),s.append(m)}let a=null;if(n){let f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),s.prepend(f),a=()=>{f.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}let o=f=>{let m=f?"value":"textContent",{options:b,multiple:_}=s;return _?Array.prototype.filter.call(b,w=>w.selected).map(w=>w[m]):b.selectedIndex===-1?null:b[b.selectedIndex][m]},h=o(!1),d=f=>{let m=f.target.options;return Array.prototype.map.call(m,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",f=>{let m={value(b){a?.();let _=b.detail.value,w=new Set(Array.isArray(_)?_:[_]);for(let x of s.options)x.selected=w.has(x.value);e.setValue(t,{value:o(!0)}),h=o(!1)},multipleSelection(b){s.multiple=!0},remove(b){let _=s.options,w=b.detail.remove;_[w].selected=!1,s.remove(w),_.length>0&&Array.prototype.findIndex.call(_,C=>C.selected)===-1&&(_[0].selected=!0),e.setValue(t,{value:o(!0),items:d(b)}),h=o(!1)},clear(b){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=o(!1)},insert(b){let{index:_,displayValue:w,exportValue:x}=b.detail.insert,C=s.children[_],k=document.createElement("option");k.textContent=w,k.value=x,C?C.before(k):s.append(k),e.setValue(t,{value:o(!0),items:d(b)}),h=o(!1)},items(b){let{items:_}=b.detail;for(;s.length!==0;)s.remove(0);for(let w of _){let{displayValue:x,exportValue:C}=w,k=document.createElement("option");k.textContent=x,k.value=C,s.append(k)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:d(b)}),h=o(!1)},indices(b){let _=new Set(b.detail.indices);for(let w of b.target.options)w.selected=_.has(w.index);e.setValue(t,{value:o(!0)}),h=o(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(m,f)}),s.addEventListener("input",f=>{let m=o(!0),b=o(!1);e.setValue(t,{value:m}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:b,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):s.addEventListener("input",function(f){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}},us=class extends Vt{constructor(e){let{data:t,elements:i}=e;super(e,{isRenderable:Vt._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");let e=this.popup=new ya({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(let i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${ja}${i}`).join(",")),this.container}},ya=class{#t=this.#T.bind(this);#e=this.#C.bind(this);#i=this.#k.bind(this);#s=this.#w.bind(this);#r=null;#n=null;#l=null;#o=null;#h=null;#c=null;#u=null;#d=!1;#f=null;#a=null;#p=null;#m=null;#g=null;#b=null;#_=!1;constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:n,contentsObj:a,richText:o,parent:h,rect:d,parentRect:f,open:m}){this.#n=e,this.#g=s,this.#l=a,this.#m=o,this.#c=h,this.#r=t,this.#p=d,this.#u=f,this.#h=i,this.#o=Ks.toDateObject(n),this.trigger=i.flatMap(b=>b.getElementsToTriggerPopup());for(let b of this.trigger)b.addEventListener("click",this.#s),b.addEventListener("mouseenter",this.#i),b.addEventListener("mouseleave",this.#e),b.classList.add("popupTriggerArea");for(let b of i)b.container?.addEventListener("keydown",this.#t);this.#n.hidden=!0,m&&this.#w()}render(){if(this.#f)return;let e=this.#f=document.createElement("div");if(e.className="popup",this.#r){let n=e.style.outlineColor=it.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:e.style.backgroundColor=it.makeHexColor(...this.#r.map(o=>Math.floor(.7*(255-o)+o)))}let t=document.createElement("span");t.className="header";let i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=this.#g,e.append(t),this.#o){let n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(n)}let s=this.#v;if(s)fn.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{let n=this._formatContents(this.#l);e.append(n)}this.#n.append(e)}get#v(){let e=this.#m,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#m.html||null}get#A(){return this.#v?.attributes?.style?.fontSize||0}get#x(){return this.#v?.attributes?.style?.color||null}#E(e){let t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#x,fontSize:this.#A?`calc(${this.#A}px * var(--scale-factor))`:""}};for(let n of e.split(`
`))t.push({name:"span",value:n,attributes:s});return i}_formatContents({str:e,dir:t}){let i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;let s=e.split(/(?:\r\n?|\n)/);for(let n=0,a=s.length;n<a;++n){let o=s[n];i.append(document.createTextNode(o)),n<a-1&&i.append(document.createElement("br"))}return i}#T(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#d)&&this.#w()}updateEdited({rect:e,popupContent:t}){this.#b||={contentsObj:this.#l,richText:this.#m},e&&(this.#a=null),t&&(this.#m=this.#E(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#b&&({contentsObj:this.#l,richText:this.#m}=this.#b,this.#b=null,this.#f?.remove(),this.#f=null,this.#a=null)}#P(){if(this.#a!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:n}}}=this.#c,a=!!this.#u,o=a?this.#u:this.#p;for(let w of this.#h)if(!o||it.intersect(w.data.rect,o)!==null){o=w.data.rect,a=!0;break}let h=it.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),f=a?o[2]-o[0]+5:0,m=h[0]+f,b=h[1];this.#a=[100*(m-s)/t,100*(b-n)/i];let{style:_}=this.#n;_.left=`${this.#a[0]}%`,_.top=`${this.#a[1]}%`}#w(){this.#d=!this.#d,this.#d?(this.#k(),this.#n.addEventListener("click",this.#s),this.#n.addEventListener("keydown",this.#t)):(this.#C(),this.#n.removeEventListener("click",this.#s),this.#n.removeEventListener("keydown",this.#t))}#k(){this.#f||this.render(),this.isVisible?this.#d&&this.#n.classList.add("focused"):(this.#P(),this.#n.hidden=!1,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)+1e3)}#C(){this.#n.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#n.hidden=!0,this.#n.style.zIndex=parseInt(this.#n.style.zIndex)-1e3)}forceHide(){this.#_=this.isVisible,this.#_&&(this.#n.hidden=!0)}maybeShow(){this.#_&&(this.#f||this.#k(),this.#_=!1,this.#n.hidden=!1)}get isVisible(){return this.#n.hidden===!1}},mn=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ft.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){let e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(let t of this.textContent){let i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},_a=class extends Vt{#t=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");let e=this.data,{width:t,height:i}=Je(e.rect),s=this.svgFactory.create(t,i,!0),n=this.#t=this.svgFactory.createElement("svg:line");return n.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),n.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),n.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),n.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),n.setAttribute("stroke-width",e.borderStyle.width||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),s.append(n),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},Aa=class extends Vt{#t=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");let e=this.data,{width:t,height:i}=Je(e.rect),s=this.svgFactory.create(t,i,!0),n=e.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",n/2),a.setAttribute("y",n/2),a.setAttribute("width",t-n),a.setAttribute("height",i-n),a.setAttribute("stroke-width",n||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},wa=class extends Vt{#t=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");let e=this.data,{width:t,height:i}=Je(e.rect),s=this.svgFactory.create(t,i,!0),n=e.borderStyle.width,a=this.#t=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",i/2),a.setAttribute("rx",t/2-n/2),a.setAttribute("ry",i/2-n/2),a.setAttribute("stroke-width",n||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},bn=class extends Vt{#t=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:i,popupRef:s}}=this;if(!t)return this.container;let{width:n,height:a}=Je(e),o=this.svgFactory.create(n,a,!0),h=[];for(let f=0,m=t.length;f<m;f+=2){let b=t[f]-e[0],_=e[3]-t[f+1];h.push(`${b},${_}`)}h=h.join(" ");let d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),o.append(d),this.container.append(o),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}},xa=class extends bn{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}},Sa=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},fs=class extends Vt{#t=null;#e=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ft.HIGHLIGHT:ft.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,rotation:t,inkLists:i,borderStyle:s,popupRef:n}}=this,{transform:a,width:o,height:h}=this.#i(t,e),d=this.svgFactory.create(o,h,!0),f=this.#t=this.svgFactory.createElement("svg:g");d.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",a);for(let m=0,b=i.length;m<b;m++){let _=this.svgFactory.createElement(this.svgElementName);this.#e.push(_),_.setAttribute("points",i[m].join(",")),f.append(_)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);let{thickness:t,points:i,rect:s}=e,n=this.#t;if(t>=0&&n.setAttribute("stroke-width",t||1),i)for(let a=0,o=this.#e.length;a<o;a++)this.#e[a].setAttribute("points",i[a].join(","));if(s){let{transform:a,width:o,height:h}=this.#i(this.data.rotation,s);n.parentElement.setAttribute("viewBox",`0 0 ${o} ${h}`),n.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}},vn=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ft.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}},Ea=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}},Ca=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}},Ta=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}},yn=class extends Vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ft.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},ka=class extends Vt{#t=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",Ue({source:this},t))}render(){this.container.classList.add("fileAttachmentAnnotation");let{container:e,data:t}=this,i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;let{isMac:s}=Xt.platform;return e.addEventListener("keydown",n=>{n.key==="Enter"&&(s?n.metaKey:n.ctrlKey)&&this.#e()}),!t.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},Pa=class{#t=null;#e=null;#i=new Map;#s=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:n,viewport:a,structTreeLayer:o}){this.div=e,this.#t=t,this.#e=i,this.#s=o||null,this.page=n,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#i.size>0}#r(e,t){return Q(this,null,function*(){let i=e.firstChild||e,s=i.id=`${ja}${t}`,n=yield this.#s?.getAriaAttributes(s);if(n)for(let[a,o]of n)i.setAttribute(a,o);this.div.append(e),this.#t?.moveElementInDOM(this.div,e,i,!1)})}render(e){return Q(this,null,function*(){let{annotations:t}=e,i=this.div;fi(i,this.viewport);let s=new Map,n={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new ds,annotationStorage:e.annotationStorage||new os,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let a of t){if(a.noHTML)continue;let o=a.annotationType===Wt.POPUP;if(o){let f=s.get(a.id);if(!f)continue;n.elements=f}else{let{width:f,height:m}=Je(a.rect);if(f<=0||m<=0)continue}n.data=a;let h=ua.create(n);if(!h.isRenderable)continue;if(!o&&a.popupRef){let f=s.get(a.popupRef);f?f.push(h):s.set(a.popupRef,[h])}let d=h.render();a.hidden&&(d.style.visibility="hidden"),yield this.#r(d,a.id),h._isEditable&&(this.#i.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#n()})}update({viewport:e}){let t=this.div;this.viewport=e,fi(t,{rotation:e.rotation}),this.#n(),t.hidden=!1}#n(){if(!this.#e)return;let e=this.div;for(let[t,i]of this.#e){let s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";let{firstChild:n}=s;n?n.nodeName==="CANVAS"?n.replaceWith(i):n.classList.contains("annotationContent")?n.after(i):n.before(i):s.append(i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(e){return this.#i.get(e)}},Us=/\r\n?|\n/g,Ma=class c extends Bt{#t;#e="";#i=`${this.id}-editor`;#s=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let e=c.prototype,t=n=>n.isEmpty(),i=as.TRANSLATE_SMALL,s=as.TRANSLATE_BIG;return bt(this,"_keyboardManager",new pi([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=ft.FREETEXT;constructor(e){super(Ti(Ue({},e),{name:"freeTextEditor"})),this.#t=e.color||c._defaultColor||Bt._defaultLineColor,this.#r=e.fontSize||c._defaultFontSize}static initialize(e,t){Bt.initialize(e,t);let i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case xt.FREETEXT_SIZE:c._defaultFontSize=t;break;case xt.FREETEXT_COLOR:c._defaultColor=t;break}}updateParams(e,t){switch(e){case xt.FREETEXT_SIZE:this.#n(t);break;case xt.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[xt.FREETEXT_SIZE,c._defaultFontSize],[xt.FREETEXT_COLOR,c._defaultColor||Bt._defaultLineColor]]}get propertiesToUpdate(){return[[xt.FREETEXT_SIZE,this.#r],[xt.FREETEXT_COLOR,this.#t]]}#n(e){let t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-this.#r)*this.parentScale),this.#r=s,this.#h()},i=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){let t=s=>{this.#t=this.editorDiv.style.color=s},i=this.#t;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let e=this.parentScale;return[-c._internalPadding*e,-(c._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ft.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#s=new AbortController;let e=this._uiManager.combinedSignal(this.#s);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.#s?.abort(),this.#s=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){let e=[];this.editorDiv.normalize();let t=null;for(let i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(c.#c(i)),t=i);return e.join(`
`)}#h(){let[e,t]=this.parentDimensions,i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{let{currentLayer:s,div:n}=this,a=n.style.display,o=n.classList.contains("hidden");n.classList.remove("hidden"),n.style.display="hidden",s.div.append(this.div),i=n.getBoundingClientRect(),n.remove(),n.style.display=a,n.classList.toggle("hidden",o)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#e,t=this.#e=this.#o().trimEnd();if(e===t)return;let i=s=>{if(this.#e=s,!s){this.remove();return}this.#u(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){c._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Qs(this,this.div,["dblclick","keydown"]),this.width){let[s,n]=this.parentDimensions;if(this.annotationElementId){let{position:a}=this._initialData,[o,h]=this.getInitialTranslation();[o,h]=this.pageTranslationToScreen(o,h);let[d,f]=this.pageDimensions,[m,b]=this.pageTranslation,_,w;switch(this.rotation){case 0:_=e+(a[0]-m)/d,w=t+this.height-(a[1]-b)/f;break;case 90:_=e+(a[0]-m)/d,w=t-(a[1]-b)/f,[o,h]=[h,-o];break;case 180:_=e-this.width+(a[0]-m)/d,w=t-(a[1]-b)/f,[o,h]=[-o,-h];break;case 270:_=e+(a[0]-m-this.height*f)/d,w=t+(a[1]-b-this.width*d)/f,[o,h]=[-h,o];break}this.setAt(_*s,w*n,o,h)}else this.setAt(e*s,t*n,this.width*s,this.height*n);this.#u(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Us,"")}editorDivPaste(e){let t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();let s=c.#f(t.getData("text")||"").replaceAll(Us,`
`);if(!s)return;let n=window.getSelection();if(!n.rangeCount)return;this.editorDiv.normalize(),n.deleteFromDocument();let a=n.getRangeAt(0);if(!s.includes(`
`)){a.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),n.collapseToStart();return}let{startContainer:o,startOffset:h}=a,d=[],f=[];if(o.nodeType===Node.TEXT_NODE){let _=o.parentElement;if(f.push(o.nodeValue.slice(h).replaceAll(Us,"")),_!==this.editorDiv){let w=d;for(let x of this.editorDiv.childNodes){if(x===_){w=f;continue}w.push(c.#c(x))}}d.push(o.nodeValue.slice(0,h).replaceAll(Us,""))}else if(o===this.editorDiv){let _=d,w=0;for(let x of this.editorDiv.childNodes)w++===h&&(_=f),_.push(c.#c(x))}this.#e=`${d.join(`
`)}${s}${f.join(`
`)}`,this.#u();let m=new Range,b=d.reduce((_,w)=>_+w.length,0);for(let{firstChild:_}of this.editorDiv.childNodes)if(_.nodeType===Node.TEXT_NODE){let w=_.nodeValue.length;if(b<=w){m.setStart(_,b),m.setEnd(_,b);break}b-=w}n.removeAllRanges(),n.addRange(m)}#u(){if(this.editorDiv.replaceChildren(),!!this.#e)for(let e of this.#e.split(`
`)){let t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#e.replaceAll("\xA0"," ")}static#f(e){return e.replaceAll(" ","\xA0")}get contentDiv(){return this.editorDiv}static deserialize(e,t,i){return Q(this,null,function*(){let s=null;if(e instanceof mn){let{data:{defaultAppearanceData:{fontSize:a,fontColor:o},rect:h,rotation:d,id:f,popupRef:m},textContent:b,textPosition:_,parent:{page:{pageNumber:w}}}=e;if(!b||b.length===0)return null;s=e={annotationType:ft.FREETEXT,color:Array.from(o),fontSize:a,value:b.join(`
`),position:_,pageIndex:w-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:m}}let n=yield oi(c,this,"deserialize").call(this,e,t,i);return n.#r=e.fontSize,n.#t=it.makeHexColor(...e.color),n.#e=c.#f(e.value),n.annotationElementId=e.id||null,n._initialData=s,n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=c._internalPadding*this.parentScale,i=this.getRect(t,t),s=Bt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),n={annotationType:ft.FREETEXT,color:s,fontSize:this.#r,value:this.#d(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?n:this.annotationElementId&&!this.#a(n)?null:(n.id=this.annotationElementId,n)}#a(e){let{value:t,fontSize:i,color:s,pageIndex:n}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((a,o)=>a!==s[o])||e.pageIndex!==n}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(this.deleted)return t;let{style:i}=t;i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#t,t.replaceChildren();for(let n of this.#e.split(`
`)){let a=document.createElement("div");a.append(n?document.createTextNode(n):document.createElement("br")),t.append(a)}let s=c._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:this.#e}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},J=(()=>{class c{static PRECISION=1e-4;toSVGPath(){Pt("Abstract method `toSVGPath` must be implemented.")}get box(){Pt("Abstract getter `box` must be implemented.")}serialize(t,i){Pt("Abstract method `serialize` must be implemented.")}static _rescale(t,i,s,n,a,o){o||=new Float32Array(t.length);for(let h=0,d=t.length;h<d;h+=2)o[h]=i+t[h]*n,o[h+1]=s+t[h+1]*a;return o}static _rescaleAndSwap(t,i,s,n,a,o){o||=new Float32Array(t.length);for(let h=0,d=t.length;h<d;h+=2)o[h]=i+t[h+1]*n,o[h+1]=s+t[h]*a;return o}static _translate(t,i,s,n){n||=new Float32Array(t.length);for(let a=0,o=t.length;a<o;a+=2)n[a]=i+t[a],n[a+1]=s+t[a+1];return n}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,i,s,n,a){switch(a){case 90:return[1-i/s,t/n];case 180:return[1-t/s,1-i/n];case 270:return[i/s,1-t/n];default:return[t/s,i/n]}}static _normalizePagePoint(t,i,s){switch(s){case 90:return[1-i,t];case 180:return[1-t,1-i];case 270:return[i,1-t];default:return[t,i]}}static createBezierPoints(t,i,s,n,a,o){return[(t+5*s)/6,(i+5*n)/6,(5*s+a)/6,(5*n+o)/6,(s+a)/2,(n+o)/2]}}return c})(),_n=class c{#t;#e=[];#i;#s;#r=[];#n=new Float32Array(18);#l;#o;#h;#c;#u;#d;#f=[];static#a=8;static#p=2;static#m=c.#a+c.#p;constructor({x:e,y:t},i,s,n,a,o=0){this.#t=i,this.#d=n*s,this.#s=a,this.#n.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=o,this.#c=c.#a*s,this.#h=c.#m*s,this.#u=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#n[8])}#g(){let e=this.#n.subarray(4,6),t=this.#n.subarray(16,18),[i,s,n,a]=this.#t;return[(this.#l+(e[0]-t[0])/2-i)/n,(this.#o+(e[1]-t[1])/2-s)/a,(this.#l+(t[0]-e[0])/2-i)/n,(this.#o+(t[1]-e[1])/2-s)/a]}add({x:e,y:t}){this.#l=e,this.#o=t;let[i,s,n,a]=this.#t,[o,h,d,f]=this.#n.subarray(8,12),m=e-d,b=t-f,_=Math.hypot(m,b);if(_<this.#h)return!1;let w=_-this.#c,x=w/_,C=x*m,k=x*b,D=o,O=h;o=d,h=f,d+=C,f+=k,this.#f?.push(e,t);let H=-k/w,j=C/w,p=H*this.#d,$=j*this.#d;return this.#n.set(this.#n.subarray(2,8),0),this.#n.set([d+p,f+$],4),this.#n.set(this.#n.subarray(14,18),12),this.#n.set([d-p,f-$],16),isNaN(this.#n[6])?(this.#r.length===0&&(this.#n.set([o+p,h+$],2),this.#r.push(NaN,NaN,NaN,NaN,(o+p-i)/n,(h+$-s)/a),this.#n.set([o-p,h-$],14),this.#e.push(NaN,NaN,NaN,NaN,(o-p-i)/n,(h-$-s)/a)),this.#n.set([D,O,o,h,d,f],6),!this.isEmpty()):(this.#n.set([D,O,o,h,d,f],6),Math.abs(Math.atan2(O-h,D-o)-Math.atan2(k,C))<Math.PI/2?([o,h,d,f]=this.#n.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((o+d)/2-i)/n,((h+f)/2-s)/a),[o,h,D,O]=this.#n.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((D+o)/2-i)/n,((O+h)/2-s)/a),!0):([D,O,o,h,d,f]=this.#n.subarray(0,6),this.#r.push(((D+5*o)/6-i)/n,((O+5*h)/6-s)/a,((5*o+d)/6-i)/n,((5*h+f)/6-s)/a,((o+d)/2-i)/n,((h+f)/2-s)/a),[d,f,o,h,D,O]=this.#n.subarray(12,18),this.#e.push(((D+5*o)/6-i)/n,((O+5*h)/6-s)/a,((5*o+d)/6-i)/n,((5*h+f)/6-s)/a,((o+d)/2-i)/n,((h+f)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";let e=this.#r,t=this.#e;if(isNaN(this.#n[6])&&!this.isEmpty())return this.#b();let i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#v(i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#_(i),i.join(" ")}#b(){let[e,t,i,s]=this.#t,[n,a,o,h]=this.#g();return`M${(this.#n[2]-e)/i} ${(this.#n[3]-t)/s} L${(this.#n[4]-e)/i} ${(this.#n[5]-t)/s} L${n} ${a} L${o} ${h} L${(this.#n[16]-e)/i} ${(this.#n[17]-t)/s} L${(this.#n[14]-e)/i} ${(this.#n[15]-t)/s} Z`}#_(e){let t=this.#e;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){let[t,i,s,n]=this.#t,a=this.#n.subarray(4,6),o=this.#n.subarray(16,18),[h,d,f,m]=this.#g();e.push(`L${(a[0]-t)/s} ${(a[1]-i)/n} L${h} ${d} L${f} ${m} L${(o[0]-t)/s} ${(o[1]-i)/n}`)}newFreeDrawOutline(e,t,i,s,n,a){return new An(e,t,i,s,n,a)}getOutlines(){let e=this.#r,t=this.#e,i=this.#n,[s,n,a,o]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let m=0,b=h.length-2;m<b;m+=2)h[m]=(this.#f[m]-s)/a,h[m+1]=(this.#f[m+1]-n)/o;if(h[h.length-2]=(this.#l-s)/a,h[h.length-1]=(this.#o-n)/o,isNaN(i[6])&&!this.isEmpty())return this.#A(h);let d=new Float32Array(this.#r.length+24+this.#e.length),f=e.length;for(let m=0;m<f;m+=2){if(isNaN(e[m])){d[m]=d[m+1]=NaN;continue}d[m]=e[m],d[m+1]=e[m+1]}f=this.#E(d,f);for(let m=t.length-6;m>=6;m-=6)for(let b=0;b<6;b+=2){if(isNaN(t[m+b])){d[f]=d[f+1]=NaN,f+=2;continue}d[f]=t[m+b],d[f+1]=t[m+b+1],f+=2}return this.#x(d,f),this.newFreeDrawOutline(d,h,this.#t,this.#u,this.#i,this.#s)}#A(e){let t=this.#n,[i,s,n,a]=this.#t,[o,h,d,f]=this.#g(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(t[2]-i)/n,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-i)/n,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(t[16]-i)/n,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-i)/n,(t[15]-s)/a],0),this.newFreeDrawOutline(m,e,this.#t,this.#u,this.#i,this.#s)}#x(e,t){let i=this.#e;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#E(e,t){let i=this.#n.subarray(4,6),s=this.#n.subarray(16,18),[n,a,o,h]=this.#t,[d,f,m,b]=this.#g();return e.set([NaN,NaN,NaN,NaN,(i[0]-n)/o,(i[1]-a)/h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,m,b,NaN,NaN,NaN,NaN,(s[0]-n)/o,(s[1]-a)/h],t),t+=24}},An=class extends J{#t;#e=new Float32Array(4);#i;#s;#r;#n;#l;constructor(e,t,i,s,n,a){super(),this.#l=e,this.#r=t,this.#t=i,this.#n=s,this.#i=n,this.#s=a,this.lastPoint=[NaN,NaN],this.#o(a);let[o,h,d,f]=this.#e;for(let m=0,b=e.length;m<b;m+=2)e[m]=(e[m]-o)/d,e[m+1]=(e[m+1]-h)/f;for(let m=0,b=t.length;m<b;m+=2)t[m]=(t[m]-o)/d,t[m+1]=(t[m+1]-h)/f}toSVGPath(){let e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,i=this.#l.length;t<i;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,s],n){let a=i-e,o=s-t,h,d;switch(n){case 0:h=J._rescale(this.#l,e,s,a,-o),d=J._rescale(this.#r,e,s,a,-o);break;case 90:h=J._rescaleAndSwap(this.#l,e,t,a,o),d=J._rescaleAndSwap(this.#r,e,t,a,o);break;case 180:h=J._rescale(this.#l,i,t,-a,o),d=J._rescale(this.#r,i,t,-a,o);break;case 270:h=J._rescaleAndSwap(this.#l,i,s,-a,-o),d=J._rescaleAndSwap(this.#r,i,s,-a,-o);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(e){let t=this.#l,i=t[4],s=t[5],n=i,a=s,o=i,h=s,d=i,f=s,m=e?Math.max:Math.min;for(let _=6,w=t.length;_<w;_+=6){if(isNaN(t[_]))n=Math.min(n,t[_+4]),a=Math.min(a,t[_+5]),o=Math.max(o,t[_+4]),h=Math.max(h,t[_+5]),f<t[_+5]?(d=t[_+4],f=t[_+5]):f===t[_+5]&&(d=m(d,t[_+4]));else{let x=it.bezierBoundingBox(i,s,...t.slice(_,_+6));n=Math.min(n,x[0]),a=Math.min(a,x[1]),o=Math.max(o,x[2]),h=Math.max(h,x[3]),f<x[3]?(d=x[2],f=x[3]):f===x[3]&&(d=m(d,x[2]))}i=t[_+4],s=t[_+5]}let b=this.#e;b[0]=n-this.#i,b[1]=a-this.#i,b[2]=o-n+2*this.#i,b[3]=h-a+2*this.#i,this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(e,t,i,s,n,a=0){return new _n(e,t,i,s,n,a)}getNewOutline(e,t){let[i,s,n,a]=this.#e,[o,h,d,f]=this.#t,m=n*d,b=a*f,_=i*d+o,w=s*f+h,x=this.newOutliner({x:this.#r[0]*m+_,y:this.#r[1]*b+w},this.#t,this.#n,e,this.#s,t??this.#i);for(let C=2;C<this.#r.length;C+=2)x.add({x:this.#r[C]*m+_,y:this.#r[C+1]*b+w});return x.getOutlines()}},ps=class{#t;#e;#i=[];#s=[];constructor(e,t=0,i=0,s=!0){let n=1/0,a=-1/0,o=1/0,h=-1/0,f=10**-4;for(let{x:k,y:D,width:O,height:H}of e){let j=Math.floor((k-t)/f)*f,p=Math.ceil((k+O+t)/f)*f,$=Math.floor((D-t)/f)*f,W=Math.ceil((D+H+t)/f)*f,ot=[j,$,W,!0],wt=[p,$,W,!1];this.#i.push(ot,wt),n=Math.min(n,j),a=Math.max(a,p),o=Math.min(o,$),h=Math.max(h,W)}let m=a-n+2*i,b=h-o+2*i,_=n-i,w=o-i,x=this.#i.at(s?-1:-2),C=[x[0],x[2]];for(let k of this.#i){let[D,O,H]=k;k[0]=(D-_)/m,k[1]=(O-w)/b,k[2]=(H-w)/b}this.#t=new Float32Array([_,w,m,b]),this.#e=C}getOutlines(){this.#i.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);let e=[];for(let t of this.#i)t[3]?(e.push(...this.#h(t)),this.#l(t)):(this.#o(t),e.push(...this.#h(t)));return this.#r(e)}#r(e){let t=[],i=new Set;for(let a of e){let[o,h,d]=a;t.push([o,h,a],[o,d,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){let h=t[a][2],d=t[a+1][2];h.push(d),d.push(h),i.add(h),i.add(d)}let s=[],n;for(;i.size>0;){let a=i.values().next().value,[o,h,d,f,m]=a;i.delete(a);let b=o,_=h;for(n=[o,d],s.push(n);;){let w;if(i.has(f))w=f;else if(i.has(m))w=m;else break;i.delete(w),[o,h,d,f,m]=w,b!==o&&(n.push(b,_,o,_===h?h:d),b=o),_=_===h?d:h}n.push(b,_)}return new Ia(s,this.#t,this.#e)}#n(e){let t=this.#s,i=0,s=t.length-1;for(;i<=s;){let n=i+s>>1,a=t[n][0];if(a===e)return n;a<e?i=n+1:s=n-1}return s+1}#l([,e,t]){let i=this.#n(e);this.#s.splice(i,0,[e,t])}#o([,e,t]){let i=this.#n(e);for(let s=i;s<this.#s.length;s++){let[n,a]=this.#s[s];if(n!==e)break;if(n===e&&a===t){this.#s.splice(s,1);return}}for(let s=i-1;s>=0;s--){let[n,a]=this.#s[s];if(n!==e)break;if(n===e&&a===t){this.#s.splice(s,1);return}}}#h(e){let[t,i,s]=e,n=[[t,i,s]],a=this.#n(s);for(let o=0;o<a;o++){let[h,d]=this.#s[o];for(let f=0,m=n.length;f<m;f++){let[,b,_]=n[f];if(!(d<=b||_<=h)){if(b>=h){if(_>d)n[f][1]=d;else{if(m===1)return[];n.splice(f,1),f--,m--}continue}n[f][2]=h,_>d&&n.push([t,d,_])}}}return n}},Ia=class extends J{#t;#e;constructor(e,t,i){super(),this.#e=e,this.#t=t,this.lastPoint=i}toSVGPath(){let e=[];for(let t of this.#e){let[i,s]=t;e.push(`M${i} ${s}`);for(let n=2;n<t.length;n+=2){let a=t[n],o=t[n+1];a===i?(e.push(`V${o}`),s=o):o===s&&(e.push(`H${a}`),i=a)}e.push("Z")}return e.join(" ")}serialize([e,t,i,s],n){let a=[],o=i-e,h=s-t;for(let d of this.#e){let f=new Array(d.length);for(let m=0;m<d.length;m+=2)f[m]=e+d[m]*o,f[m+1]=s-d[m+1]*h;a.push(f)}return a}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}},gs=class extends _n{newFreeDrawOutline(e,t,i,s,n,a){return new La(e,t,i,s,n,a)}},La=class extends An{newOutliner(e,t,i,s,n,a=0){return new gs(e,t,i,s,n,a)}},wn=class c{#t=null;#e=null;#i;#s=null;#r=!1;#n=!1;#l=null;#o;#h=null;#c=null;#u;static#d=null;static get _keyboardManager(){return bt(this,"_keyboardManager",new pi([[["Escape","mac+Escape"],c.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],c.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],c.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],c.prototype._moveToPrevious],[["Home","mac+Home"],c.prototype._moveToBeginning],[["End","mac+End"],c.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#n=!1,this.#u=xt.HIGHLIGHT_COLOR,this.#l=e):(this.#n=!0,this.#u=xt.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#o=this.#c._eventBus,this.#i=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",c.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){let e=this.#t=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);let t=this.#c._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});let i=this.#e=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#i,e.append(i),e}renderMainDropdown(){let e=this.#s=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){let e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",Ce,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(let[i,s]of this.#c.highlightColors){let n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",s),n.title=i,n.setAttribute("data-l10n-id",c.#d[i]);let a=document.createElement("span");n.append(a),a.className="swatch",a.style.backgroundColor=s,n.setAttribute("aria-selected",s===this.#i),n.addEventListener("click",this.#a.bind(this,s),{signal:t}),e.append(n)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#a(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#u,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#t){this.#m(e);return}let t=e.target.getAttribute("data-color");t&&this.#a(t,e)}_moveToNext(e){if(!this.#b){this.#m(e);return}if(e.target===this.#t){this.#s.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#s?.firstChild||e.target===this.#t){this.#b&&this._hideDropdownFromKeyboard();return}this.#b||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#b){this.#m(e);return}this.#s.firstChild?.focus()}_moveToEnd(e){if(!this.#b){this.#m(e);return}this.#s.lastChild?.focus()}#p(e){c._keyboardManager.exec(this,e)}#m(e){if(this.#b){this.hideDropdown();return}if(this.#r=e.detail===0,this.#h||(this.#h=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#c.combinedSignal(this.#h)})),this.#s){this.#s.classList.remove("hidden");return}let t=this.#s=this.#f();this.#t.append(t)}#g(e){this.#s?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#s?.classList.add("hidden"),this.#h?.abort(),this.#h=null}get#b(){return this.#s&&!this.#s.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#n){if(!this.#b){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#e&&(this.#e.style.backgroundColor=e),!this.#s)return;let t=this.#c.highlightColors.values();for(let i of this.#s.children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#s?.remove(),this.#s=null}},xn=class c extends Bt{#t=null;#e=0;#i;#s=null;#r=null;#n=null;#l=null;#o=0;#h=null;#c=null;#u=null;#d=!1;#f=null;#a;#p=null;#m="";#g;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=ft.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){let e=c.prototype;return bt(this,"_keyboardManager",new pi([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super(Ti(Ue({},e),{name:"highlightEditor"})),this.color=e.color||c._defaultColor,this.#g=e.thickness||c._defaultThickness,this.#a=e.opacity||c._defaultOpacity,this.#i=e.boxes||null,this.#b=e.methodOfCreation||"",this.#m=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#d=!0,this.#v(e),this.#P()):this.#i&&(this.#t=e.anchorNode,this.#e=e.anchorOffset,this.#l=e.focusNode,this.#o=e.focusOffset,this.#_(),this.#P(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#_(){let e=new ps(this.#i,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;let t=new ps(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#n=t.getOutlines();let{lastPoint:i}=this.#n;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#c=e;let s=1.5;if(this.#n=e.getNewOutline(this.#g/2+s,.0025),t>=0)this.#u=t,this.#s=i,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},!0);else if(this.parent){let f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#u,{bbox:c.#w(this.#c.box,(f-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:c.#w(this.#n.box,f),path:{d:this.#n.toSVGPath()}})}let[n,a,o,h]=e.box;switch(this.rotation){case 0:this.x=n,this.y=a,this.width=o,this.height=h;break;case 90:{let[f,m]=this.parentDimensions;this.x=a,this.y=1-n,this.width=o*m/f,this.height=h*f/m;break}case 180:this.x=1-n,this.y=1-a,this.width=o,this.height=h;break;case 270:{let[f,m]=this.parentDimensions;this.x=1-a,this.y=n,this.width=o*m/f,this.height=h*f/m;break}}let{lastPoint:d}=this.#n;this.#f=[(d[0]-n)/o,(d[1]-a)/h]}static initialize(e,t){Bt.initialize(e,t),c._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case xt.HIGHLIGHT_DEFAULT_COLOR:c._defaultColor=t;break;case xt.HIGHLIGHT_THICKNESS:c._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case xt.HIGHLIGHT_COLOR:this.#A(t);break;case xt.HIGHLIGHT_THICKNESS:this.#x(t);break}}static get defaultPropertiesToUpdate(){return[[xt.HIGHLIGHT_DEFAULT_COLOR,c._defaultColor],[xt.HIGHLIGHT_THICKNESS,c._defaultThickness]]}get propertiesToUpdate(){return[[xt.HIGHLIGHT_COLOR,this.color||c._defaultColor],[xt.HIGHLIGHT_THICKNESS,this.#g||c._defaultThickness],[xt.HIGHLIGHT_FREE,this.#d]]}#A(e){let t=(n,a)=>{this.color=n,this.#a=a,this.parent?.drawLayer.updateProperties(this.#u,{root:{fill:n,"fill-opacity":a}}),this.#r?.updateColor(n)},i=this.color,s=this.#a;this.addCommands({cmd:t.bind(this,e,c._defaultOpacity),undo:t.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#x(e){let t=this.#g,i=s=>{this.#g=s,this.#E(s)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:xt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}addEditToolbar(){return Q(this,null,function*(){let e=yield oi(c.prototype,this,"addEditToolbar").call(this);return e?(this._uiManager.highlightColors&&(this.#r=new wn({editor:this}),e.addColorPicker(this.#r)),e):null})}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#I())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#I())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#P(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#T():e&&(this.#P(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#E(e){if(!this.#d)return;this.#v({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();let[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}#T(){this.#u===null||!this.parent||(this.parent.drawLayer.remove(this.#u),this.#u=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#P(e=this.parent){this.#u===null&&({id:this.#u,clipPathId:this.#s}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#d},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#n.box,path:{d:this.#n.toSVGPath()}},this.#d),this.#h&&(this.#h.style.clipPath=this.#s))}static#w([e,t,i,s],n){switch(n){case 90:return[1-t-s,e,s,i];case 180:return[1-e-i,1-t-s,i,s];case 270:return[t,1-e-i,s,i]}return[e,t,i,s]}rotate(e){let{drawLayer:t}=this.parent,i;this.#d?(e=(e-this.rotation+360)%360,i=c.#w(this.#c.box,e)):i=c.#w([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#u,{bbox:i,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:c.#w(this.#n.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;let e=super.render();this.#m&&(e.setAttribute("aria-label",this.#m),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#k.bind(this),{signal:this._uiManager._signal});let t=this.#h=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#s;let[i,s]=this.parentDimensions;return this.setDims(this.width*i,this.height*s),Qs(this,this.#h,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#k(e){c._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(e){if(!this.#t)return;let t=window.getSelection();e?t.setPosition(this.#t,this.#e):t.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#d||this.#C(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#u,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#I(){return this.#d?this.rotation:0}#D(){if(this.#d)return null;let[e,t]=this.pageDimensions,[i,s]=this.pageTranslation,n=this.#i,a=new Float32Array(n.length*8),o=0;for(let{x:h,y:d,width:f,height:m}of n){let b=h*e+i,_=(1-d)*t+s;a[o]=a[o+4]=b,a[o+1]=a[o+3]=_,a[o+2]=a[o+6]=b+f*e,a[o+5]=a[o+7]=_-m*t,o+=8}return a}#O(e){return this.#c.serialize(e,this.#I())}static startHighlighting(e,t,{target:i,x:s,y:n}){let{x:a,y:o,width:h,height:d}=i.getBoundingClientRect(),f=new AbortController,m=e.combinedSignal(f),b=_=>{f.abort(),this.#y(e,_)};window.addEventListener("blur",b,{signal:m}),window.addEventListener("pointerup",b,{signal:m}),window.addEventListener("pointerdown",me,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Ce,{signal:m}),i.addEventListener("pointermove",this.#S.bind(this,e),{signal:m}),this._freeHighlight=new gs({x:s,y:n},[a,o,h,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#S(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#y(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static deserialize(e,t,i){return Q(this,null,function*(){let s=null;if(e instanceof vn){let{data:{quadPoints:w,rect:x,rotation:C,id:k,color:D,opacity:O,popupRef:H},parent:{page:{pageNumber:j}}}=e;s=e={annotationType:ft.HIGHLIGHT,color:Array.from(D),opacity:O,quadPoints:w,boxes:null,pageIndex:j-1,rect:x.slice(0),rotation:C,id:k,deleted:!1,popupRef:H}}else if(e instanceof fs){let{data:{inkLists:w,rect:x,rotation:C,id:k,color:D,borderStyle:{rawWidth:O},popupRef:H},parent:{page:{pageNumber:j}}}=e;s=e={annotationType:ft.HIGHLIGHT,color:Array.from(D),thickness:O,inkLists:w,boxes:null,pageIndex:j-1,rect:x.slice(0),rotation:C,id:k,deleted:!1,popupRef:H}}let{color:n,quadPoints:a,inkLists:o,opacity:h}=e,d=yield oi(c,this,"deserialize").call(this,e,t,i);d.color=it.makeHexColor(...n),d.#a=h||1,o&&(d.#g=e.thickness),d.annotationElementId=e.id||null,d._initialData=s;let[f,m]=d.pageDimensions,[b,_]=d.pageTranslation;if(a){let w=d.#i=[];for(let x=0;x<a.length;x+=8)w.push({x:(a[x]-b)/f,y:1-(a[x+1]-_)/m,width:(a[x+2]-a[x])/f,height:(a[x+1]-a[x+5])/m});d.#_(),d.#P(),d.rotate(d.rotation)}else if(o){d.#d=!0;let w=o[0],x={x:w[0]-b,y:m-(w[1]-_)},C=new gs(x,[0,0,f,m],1,d.#g/2,!0,.001);for(let O=0,H=w.length;O<H;O+=2)x.x=w[O]-b,x.y=m-(w[O+1]-_),C.add(x);let{id:k,clipPathId:D}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);d.#v({highlightOutlines:C.getOutlines(),highlightId:k,clipPathId:D}),d.#P()}return d})}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=this.getRect(0,0),i=Bt._colorManager.convert(this.color),s={annotationType:ft.HIGHLIGHT,color:i,opacity:this.#a,thickness:this.#g,quadPoints:this.#D(),outlines:this.#O(t),pageIndex:this.pageIndex,rect:t,rotation:this.#I(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#R(s)?null:(s.id=this.annotationElementId,s)}#R(e){let{color:t}=this._initialData;return e.color.some((i,s)=>i!==t[s])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}},Ra=class{#t=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(let[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){this.#t[e]=t}toSVGProperties(){let e=this.#t;return this.#t=Object.create(null),{root:e}}reset(){this.#t=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Pt("Not implemented")}},qh=(()=>{class c extends Bt{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#s=null;static#r=null;static#n=NaN;static#l=null;static#o=null;static#h=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:i,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=this.#u(t,this.parent),this.#m(t.box)}#u(t,i){let{id:s}=i.drawLayer.draw(c._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,i){let s=new Set(Object.keys(t));for(let[n,a]of Object.entries(i))s.has(n)?Object.assign(t[n],a):t[n]=a;return t}static getDefaultDrawingOptions(t){Pt("Not implemented")}static get typesMap(){Pt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){let s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(c.#i.updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){let s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){let t=[],i=this._defaultDrawingOptions;for(let[s,n]of this.typesMap)t.push([s,i[n]]);return t}get propertiesToUpdate(){let t=[],{_drawingOptions:i}=this;for(let[s,n]of this.constructor.typesMap)t.push([s,i[n]]);return t}_updateProperty(t,i,s){let n=this._drawingOptions,a=n[i],o=h=>{n.updateProperty(i,h);let d=this.#t.updateProperty(i,h);d&&this.#m(d),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,c._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,c._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g(t,i)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,c._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#d()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#u(this.#t,t)}}#a([t,i,s,n]){let{parentDimensions:[a,o],rotation:h}=this;switch(h){case 90:return[i,1-t,s*(o/a),n*(a/o)];case 180:return[1-t,1-i,s,n];case 270:return[1-i,t,s*(o/a),n*(a/o)];default:return[t,i,s,n]}}#p(){let{x:t,y:i,width:s,height:n,parentDimensions:[a,o],rotation:h}=this;switch(h){case 90:return[1-i,t,s*(a/o),n*(o/a)];case 180:return[1-t,1-i,s,n];case 270:return[i,1-t,s*(a/o),n*(o/a)];default:return[t,i,s,n]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();let[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()}#g(){let{x:t,y:i,width:s,height:n,rotation:a,parentRotation:o,parentDimensions:[h,d]}=this;switch((a*4+o)/90){case 1:return[1-i-n,t,n,s];case 2:return[1-t-s,1-i-n,s,n];case 3:return[i,1-t-s,n,s];case 4:return[t,i-s*(h/d),n*(d/h),s*(h/d)];case 5:return[1-i,t,s*(h/d),n*(d/h)];case 6:return[1-t-n*(d/h),1-i,n*(d/h),s*(h/d)];case 7:return[i-s*(h/d),1-t-n*(d/h),s*(h/d),n*(d/h)];case 8:return[t-s,i-n,s,n];case 9:return[1-i,t-s,n,s];case 10:return[1-t,1-i,s,n];case 11:return[i-n,1-t,n,s];case 12:return[t-n*(d/h),i,n*(d/h),s*(h/d)];case 13:return[1-i-s*(h/d),t-n*(d/h),s*(h/d),n*(d/h)];case 14:return[1-t,1-i-s*(h/d),n*(d/h),s*(h/d)];case 15:return[i,1-t,s*(h/d),n*(d/h)];default:return[t,i,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,c._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t=super.render();t.classList.add("draw");let i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";let[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,s,n,a){Pt("Not implemented")}static startDrawing(t,i,s,n){let{target:a,offsetX:o,offsetY:h,pointerId:d,pointerType:f}=n;if(c.#l&&c.#l!==f)return;let{viewport:{rotation:m}}=t,{width:b,height:_}=a.getBoundingClientRect(),w=c.#s=new AbortController,x=t.combinedSignal(w);if(c.#n||=d,c.#l??=f,window.addEventListener("pointerup",C=>{c.#n===C.pointerId?this._endDraw(C):c.#o?.delete(C.pointerId)},{signal:x}),window.addEventListener("pointercancel",C=>{c.#n===C.pointerId?this._currentParent.endDrawingSession():c.#o?.delete(C.pointerId)},{signal:x}),window.addEventListener("pointerdown",C=>{c.#l===C.pointerType&&((c.#o||=new Set).add(C.pointerId),c.#i.isCancellable()&&(c.#i.removeLastElement(),c.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Ce,{signal:x}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:x}),a.addEventListener("touchmove",C=>{C.timeStamp===c.#h&&me(C)},{signal:x}),t.toggleDrawing(),i._editorUndoBar?.hide(),c.#i){t.drawLayer.updateProperties(this._currentDrawId,c.#i.startNew(o,h,b,_,m));return}i.updateUIForDefaultProperties(this),c.#i=this.createDrawerInstance(o,h,b,_,m),c.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c.#r.toSVGProperties(),c.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(c.#h=-1,!c.#i)return;let{offsetX:i,offsetY:s,pointerId:n}=t;if(c.#n===n){if(c.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c.#i.add(i,s)),c.#h=t.timeStamp,me(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,c.#i=null,c.#r=null,c.#l=null,c.#h=NaN),c.#s&&(c.#s.abort(),c.#s=null,c.#n=NaN,c.#o=null)}static _endDraw(t){let i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t&&i.drawLayer.updateProperties(this._currentDrawId,c.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){let s=c.#i,n=this._currentDrawId,a=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(n,s.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(n,s.removeLastElement())},mustExec:!1,type:xt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){let i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(xt.DRAW_STEP),!c.#i.isEmpty()){let{pageDimensions:[s,n],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c.#i.getOutlines(s*a,n*a,a,this._INNER_MARGIN),drawingOptions:c.#r,mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,n,a,o){Pt("Not implemented")}static deserialize(t,i,s){return Q(this,null,function*(){let{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:h}}=i.viewport,d=this.deserializeDraw(o,h,n,a,this._INNER_MARGIN,t),f=yield oi(c,this,"deserialize").call(this,t,i,s);return f.createDrawingOptions(t),f.#c({drawOutlines:d}),f.#f(),f.onScaleChanging(),f.rotate(),f})}serializeDraw(t){let[i,s]=this.pageTranslation,[n,a]=this.pageDimensions;return this.#t.serialize([i,s,n,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}return c})(),Da=class{#t=new Float64Array(6);#e;#i;#s;#r;#n;#l="";#o=0;#h=new Sn;#c;#u;constructor(e,t,i,s,n,a){this.#c=i,this.#u=s,this.#s=n,this.#r=a,[e,t]=this.#d(e,t);let o=this.#e=[NaN,NaN,NaN,NaN,e,t];this.#n=[e,t],this.#i=[{line:o,points:this.#n}],this.#t.set(o,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#d(e,t){return J._normalizePoint(e,t,this.#c,this.#u,this.#s)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#n.length<=10}add(e,t){[e,t]=this.#d(e,t);let[i,s,n,a]=this.#t.subarray(2,6),o=e-n,h=t-a;return Math.hypot(this.#c*o,this.#u*h)<=2?null:(this.#n.push(e,t),isNaN(i)?(this.#t.set([n,a,e,t],2),this.#e.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,s,n,a,e,t],0),this.#e.push(...J.createBezierPoints(i,s,n,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){let i=this.add(e,t);return i||(this.#n.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,n){this.#c=i,this.#u=s,this.#s=n,[e,t]=this.#d(e,t);let a=this.#e=[NaN,NaN,NaN,NaN,e,t];this.#n=[e,t];let o=this.#i.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#i.push({line:a,points:this.#n}),this.#t.set(a,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#e=e.line,this.#n=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#h.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#h.removeLastElement();this.#i.pop(),this.#l="";for(let e=0,t=this.#i.length;e<t;e++){let{line:i,points:s}=this.#i[e];this.#e=i,this.#n=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){let e=J.svgRound(this.#e[4]),t=J.svgRound(this.#e[5]);if(this.#n.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#n.length<=6){let s=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,s)} M ${e} ${t}`,this.#o=6}if(this.#n.length===4){let s=J.svgRound(this.#e[10]),n=J.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${s} ${n}`,this.#o=12,this.#l}let i=[];this.#o===0&&(i.push(`M ${e} ${t}`),this.#o=6);for(let s=this.#o,n=this.#e.length;s<n;s+=6){let[a,o,h,d,f,m]=this.#e.slice(s,s+6).map(J.svgRound);i.push(`C${a} ${o} ${h} ${d} ${f} ${m}`)}return this.#l+=i.join(" "),this.#o=this.#e.length,this.#l}getOutlines(e,t,i,s){let n=this.#i.at(-1);return n.line=new Float32Array(n.line),n.points=new Float32Array(n.points),this.#h.build(this.#i,e,t,i,this.#s,this.#r,s),this.#t=null,this.#e=null,this.#i=null,this.#l=null,this.#h}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}},Sn=class c extends J{#t;#e=0;#i;#s;#r;#n;#l;#o;#h;build(e,t,i,s,n,a,o){this.#r=t,this.#n=i,this.#l=s,this.#o=n,this.#h=a,this.#i=o??0,this.#s=e,this.#d()}setLastElement(e){return this.#s.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#s.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){let e=[];for(let{line:t}of this.#s){if(e.push(`M${J.svgRound(t[4])} ${J.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${J.svgRound(t[10])} ${J.svgRound(t[11])}`);continue}for(let i=6,s=t.length;i<s;i+=6){let[n,a,o,h,d,f]=t.subarray(i,i+6).map(J.svgRound);e.push(`C${n} ${a} ${o} ${h} ${d} ${f}`)}}return e.join("")}serialize([e,t,i,s],n){let a=[],o=[],[h,d,f,m]=this.#u(),b,_,w,x,C,k,D,O,H;switch(this.#o){case 0:H=J._rescale,b=e,_=t+s,w=i,x=-s,C=e+h*i,k=t+(1-d-m)*s,D=e+(h+f)*i,O=t+(1-d)*s;break;case 90:H=J._rescaleAndSwap,b=e,_=t,w=i,x=s,C=e+d*i,k=t+h*s,D=e+(d+m)*i,O=t+(h+f)*s;break;case 180:H=J._rescale,b=e+i,_=t,w=-i,x=s,C=e+(1-h-f)*i,k=t+d*s,D=e+(1-h)*i,O=t+(d+m)*s;break;case 270:H=J._rescaleAndSwap,b=e+i,_=t+s,w=-i,x=-s,C=e+(1-d-m)*i,k=t+(1-h-f)*s,D=e+(1-d)*i,O=t+(1-h)*s;break}for(let{line:j,points:p}of this.#s)a.push(H(j,b,_,w,x,n?new Array(j.length):null)),o.push(H(p,b,_,w,x,n?new Array(p.length):null));return{lines:a,points:o,rect:[C,k,D,O]}}static deserialize(e,t,i,s,n,{paths:{lines:a,points:o},rotation:h,thickness:d}){let f=[],m,b,_,w,x;switch(h){case 0:x=J._rescale,m=-e/i,b=t/s+1,_=1/i,w=-1/s;break;case 90:x=J._rescaleAndSwap,m=-t/s,b=-e/i,_=1/s,w=1/i;break;case 180:x=J._rescale,m=e/i+1,b=-t/s,_=-1/i,w=1/s;break;case 270:x=J._rescaleAndSwap,m=t/s+1,b=e/i+1,_=-1/s,w=-1/i;break}if(!a){a=[];for(let k of o){let D=k.length;if(D===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1]]));continue}if(D===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,k[0],k[1],NaN,NaN,NaN,NaN,k[2],k[3]]));continue}let O=new Float32Array(3*(D-2));a.push(O);let[H,j,p,$]=k.subarray(0,4);O.set([NaN,NaN,NaN,NaN,H,j],0);for(let W=4;W<D;W+=2){let ot=k[W],wt=k[W+1];O.set(J.createBezierPoints(H,j,p,$,ot,wt),(W-2)*3),[H,j,p,$]=[p,$,ot,wt]}}}for(let k=0,D=a.length;k<D;k++)f.push({line:x(a[k].map(O=>O??NaN),m,b,_,w),points:x(o[k].map(O=>O??NaN),m,b,_,w)});let C=new c;return C.build(f,i,s,1,h,d,n),C}#c(e=this.#h){let t=this.#i+e/2*this.#l;return this.#o%180===0?[t/this.#r,t/this.#n]:[t/this.#n,t/this.#r]}#u(){let[e,t,i,s]=this.#t,[n,a]=this.#c(0);return[e+n,t+a,i-2*n,s-2*a]}#d(){let e=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(let{line:s}of this.#s){if(s.length<=12){for(let o=4,h=s.length;o<h;o+=6){let[d,f]=s.subarray(o,o+2);e[0]=Math.min(e[0],d),e[1]=Math.min(e[1],f),e[2]=Math.max(e[2],d),e[3]=Math.max(e[3],f)}continue}let n=s[4],a=s[5];for(let o=6,h=s.length;o<h;o+=6){let[d,f,m,b,_,w]=s.subarray(o,o+6);it.bezierBoundingBox(n,a,d,f,m,b,_,w,e),n=_,a=w}}let[t,i]=this.#c();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#t}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){let[t,i]=this.#c();this.#h=e;let[s,n]=this.#c(),[a,o]=[s-t,n-i],h=this.#t;return h[0]-=a,h[1]-=o,h[2]+=2*a,h[3]+=2*o,h}updateParentDimensions([e,t],i){let[s,n]=this.#c();this.#r=e,this.#n=t,this.#l=i;let[a,o]=this.#c(),h=a-s,d=o-n,f=this.#t;return f[0]-=h,f[1]-=d,f[2]+=2*h,f[3]+=2*d,f}updateRotation(e){return this.#e=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(J.svgRound).join(" ")}get defaultProperties(){let[e,t]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(e)} ${J.svgRound(t)}`}}}get rotationTransform(){let[,,e,t]=this.#t,i=0,s=0,n=0,a=0,o=0,h=0;switch(this.#e){case 90:s=t/e,n=-e/t,o=e;break;case 180:i=-1,a=-1,o=e,h=t;break;case 270:s=-t/e,n=e/t,h=t;break;default:return""}return`matrix(${i} ${s} ${n} ${a} ${J.svgRound(o)} ${J.svgRound(h)})`}getPathResizingSVGProperties([e,t,i,s]){let[n,a]=this.#c(),[o,h,d,f]=this.#t;if(Math.abs(d-n)<=J.PRECISION||Math.abs(f-a)<=J.PRECISION){let x=e+i/2-(o+d/2),C=t+s/2-(h+f/2);return{path:{"transform-origin":`${J.svgRound(e)} ${J.svgRound(t)}`,transform:`${this.rotationTransform} translate(${x} ${C})`}}}let m=(i-2*n)/(d-2*n),b=(s-2*a)/(f-2*a),_=d/i,w=f/s;return{path:{"transform-origin":`${J.svgRound(o)} ${J.svgRound(h)}`,transform:`${this.rotationTransform} scale(${_} ${w}) translate(${J.svgRound(n)} ${J.svgRound(a)}) scale(${m} ${b}) translate(${J.svgRound(-n)} ${J.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,i,s]){let[n,a]=this.#c(),o=this.#t,[h,d,f,m]=o;if(o[0]=e,o[1]=t,o[2]=i,o[3]=s,Math.abs(f-n)<=J.PRECISION||Math.abs(m-a)<=J.PRECISION){let C=e+i/2-(h+f/2),k=t+s/2-(d+m/2);for(let{line:D,points:O}of this.#s)J._translate(D,C,k,D),J._translate(O,C,k,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(e)} ${J.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}let b=(i-2*n)/(f-2*n),_=(s-2*a)/(m-2*a),w=-b*(h+n)+e+n,x=-_*(d+a)+t+a;if(b!==1||_!==1||w!==0||x!==0)for(let{line:C,points:k}of this.#s)J._rescale(C,w,x,b,_,C),J._rescale(k,w,x,b,_,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${J.svgRound(e)} ${J.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],i){let[s,n]=i,a=this.#t,o=e-a[0],h=t-a[1];if(this.#r===s&&this.#n===n)for(let{line:d,points:f}of this.#s)J._translate(d,o,h,d),J._translate(f,o,h,f);else{let d=this.#r/s,f=this.#n/n;this.#r=s,this.#n=n;for(let{line:m,points:b}of this.#s)J._rescale(m,o,h,d,f,m),J._rescale(b,o,h,d,f,b);a[2]*=d,a[3]*=f}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${J.svgRound(e)} ${J.svgRound(t)}`}}}get defaultSVGProperties(){let e=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${J.svgRound(e[0])} ${J.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}},Na=class c extends Ra{#t;constructor(e){super(),this.#t=e,super.updateProperties({fill:"none",stroke:Bt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#t.realScale),super.updateSVGProperty(e,t)}clone(){let e=new c(this.#t);return e.updateAll(this),e}},Oa=class c extends qh{static _type="ink";static _editorType=ft.INK;static _defaultDrawingOptions=null;constructor(e){super(Ti(Ue({},e),{name:"inkEditor"})),this._willKeepAspectRatio=!0}static initialize(e,t){Bt.initialize(e,t),this._defaultDrawingOptions=new Na(t.viewParameters)}static getDefaultDrawingOptions(e){let t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return bt(this,"typesMap",new Map([[xt.INK_THICKNESS,"stroke-width"],[xt.INK_COLOR,"stroke"],[xt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,s,n){return new Da(e,t,i,s,n,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,s,n,a){return Sn.deserialize(e,t,i,s,n,a)}static deserialize(e,t,i){return Q(this,null,function*(){let s=null;if(e instanceof fs){let{data:{inkLists:a,rect:o,rotation:h,id:d,color:f,opacity:m,borderStyle:{rawWidth:b},popupRef:_},parent:{page:{pageNumber:w}}}=e;s=e={annotationType:ft.INK,color:Array.from(f),thickness:b,opacity:m,paths:{points:a},boxes:null,pageIndex:w-1,rect:o.slice(0),rotation:h,id:d,deleted:!1,popupRef:_}}let n=yield oi(c,this,"deserialize").call(this,e,t,i);return n.annotationElementId=e.id||null,n._initialData=s,n})}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();let{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){let e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=c.getDefaultDrawingOptions({stroke:it.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let{lines:t,points:i,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:n,"stroke-opacity":a,"stroke-width":o}}=this,h={annotationType:ft.INK,color:Bt._colorManager.convert(n),opacity:a,thickness:o,paths:{lines:t,points:i},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?h:this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(e){let{color:t,thickness:i,opacity:s,pageIndex:n}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((a,o)=>a!==t[o])||e.thickness!==i||e.opacity!==s||e.pageIndex!==n}renderAnnotationElement(e){let{points:t,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:t}),null}},Fa=class c extends Bt{#t=null;#e=null;#i=null;#s=null;#r=null;#n="";#l=null;#o=null;#h=!1;#c=!1;static _type="stamp";static _editorType=ft.STAMP;constructor(e){super(Ti(Ue({},e),{name:"stampEditor"})),this.#s=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){Bt.initialize(e,t)}static get supportedTypes(){return bt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return bt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(ft.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#u(e,t=!1){if(!e){this.remove();return}this.#t=e.bitmap,t||(this.#e=e.id,this.#h=e.isSvg),e.file&&(this.#n=e.file.name),this.#a()}#d(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}mlGuessAltText(e=null,t=!0){return Q(this,null,function*(){if(this.hasAltTextData())return null;let{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!(yield i.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");let{data:s,width:n,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=yield i.guess({name:"altText",request:{data:s,width:n,height:a,channels:s.length/(n*a)}});if(!o)throw new Error("No response from the AI service.");if(o.error)throw new Error("Error from the AI service.");if(o.cancel)return null;if(!o.output)throw new Error("No valid response from the AI service.");let h=o.output;return yield this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h})}#f(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#d());return}if(this.#s){let i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#u(s)).finally(()=>this.#d());return}if(this.#r){let i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(s=>this.#u(s)).finally(()=>this.#d());return}let e=document.createElement("input");e.type="file",e.accept=c.supportedTypesStr;let t=this._uiManager._signal;this.#i=new Promise(i=>{e.addEventListener("change",()=>Q(this,null,function*(){if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let s=yield this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}i()}),{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#d()),e.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#f();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#s||this.#r||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#t?this.#a():this.#f(),this.width&&!this.annotationElementId){let[i,s]=this.parentDimensions;this.setAt(e*i,t*s,this.width*i,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);let e=200;this.#o=setTimeout(()=>{this.#o=null,this.#m()},e)}#a(){let{div:e}=this,{width:t,height:i}=this.#t,[s,n]=this.pageDimensions,a=.75;if(this.width)t=this.width*s,i=this.height*n;else if(t>a*s||i>a*n){let f=Math.min(a*s/t,a*n/i);t*=f,i*=f}let[o,h]=this.parentDimensions;this.setDims(t*o/s,i*h/n),this._uiManager.enableWaiting(!1);let d=this.#l=document.createElement("canvas");d.setAttribute("role","img"),this.addContainer(d),this.width=t/s,this.height=i/n,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#m(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#n&&d.setAttribute("aria-label",this.#n)}copyCanvas(e,t,i=!1){e||(e=224);let{width:s,height:n}=this.#t,a=new rs,o=this.#t,h=s,d=n,f=null;if(t){if(s>t||n>t){let p=Math.min(t/s,t/n);h=Math.floor(s*p),d=Math.floor(n*p)}f=document.createElement("canvas");let b=f.width=Math.ceil(h*a.sx),_=f.height=Math.ceil(d*a.sy);this.#h||(o=this.#p(b,_));let w=f.getContext("2d");w.filter=this._uiManager.hcmFilter;let x="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(x="#8f8f9d",C="#42414d");let k=15,D=k*a.sx,O=k*a.sy,H=new OffscreenCanvas(D*2,O*2),j=H.getContext("2d");j.fillStyle=x,j.fillRect(0,0,D*2,O*2),j.fillStyle=C,j.fillRect(0,0,D,O),j.fillRect(D,O,D,O),w.fillStyle=w.createPattern(H,"repeat"),w.fillRect(0,0,b,_),w.drawImage(o,0,0,o.width,o.height,0,0,b,_)}let m=null;if(i){let b,_;if(a.symmetric&&o.width<e&&o.height<e)b=o.width,_=o.height;else if(o=this.#t,s>e||n>e){let C=Math.min(e/s,e/n);b=Math.floor(s*C),_=Math.floor(n*C),this.#h||(o=this.#p(b,_))}let x=new OffscreenCanvas(b,_).getContext("2d",{willReadFrequently:!0});x.drawImage(o,0,0,o.width,o.height,0,0,b,_),m={width:b,height:_,data:x.getImageData(0,0,b,_).data}}return{canvas:f,width:h,height:d,imageData:m}}#p(e,t){let{width:i,height:s}=this.#t,n=i,a=s,o=this.#t;for(;n>2*e||a>2*t;){let h=n,d=a;n>2*e&&(n=n>=16384?Math.floor(n/2)-1:Math.ceil(n/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));let f=new OffscreenCanvas(n,a);f.getContext("2d").drawImage(o,0,0,h,d,0,0,n,a),o=f.transferToImageBitmap()}return o}#m(){let[e,t]=this.parentDimensions,{width:i,height:s}=this,n=new rs,a=Math.ceil(i*e*n.sx),o=Math.ceil(s*t*n.sy),h=this.#l;if(!h||h.width===a&&h.height===o)return;h.width=a,h.height=o;let d=this.#h?this.#t:this.#p(a,o),f=h.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,a,o)}getImageForAltText(){return this.#l}#g(e){if(e){if(this.#h){let s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}let t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#h){let[t,i]=this.pageDimensions,s=Math.round(this.width*t*Ze.PDF_TO_CSS_UNITS),n=Math.round(this.height*i*Ze.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(s,n);return a.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,n),a.transferToImageBitmap()}return structuredClone(this.#t)}static deserialize(e,t,i){return Q(this,null,function*(){let s=null;if(e instanceof yn){let{data:{rect:w,rotation:x,id:C,structParent:k,popupRef:D},container:O,parent:{page:{pageNumber:H}}}=e,j=O.querySelector("canvas"),p=i.imageManager.getFromCanvas(O.id,j);j.remove();let $=(yield t._structTree.getAriaAttributes(`${ja}${C}`))?.get("aria-label")||"";s=e={annotationType:ft.STAMP,bitmapId:p.id,bitmap:p.bitmap,pageIndex:H-1,rect:w.slice(0),rotation:x,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:$},isSvg:!1,structParent:k,popupRef:D}}let n=yield oi(c,this,"deserialize").call(this,e,t,i),{rect:a,bitmap:o,bitmapUrl:h,bitmapId:d,isSvg:f,accessibilityData:m}=e;d&&i.imageManager.isValidId(d)?(n.#e=d,o&&(n.#t=o)):n.#s=h,n.#h=f;let[b,_]=n.pageDimensions;return n.width=(a[2]-a[0])/b,n.height=(a[3]-a[1])/_,n.annotationElementId=e.id||null,m&&(n.altTextData=m),n._initialData=s,n.#c=!!s,n})}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let i={annotationType:ft.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#h,structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=this.#g(!0),i.accessibilityData=this.serializeAltText(!0),i;let{decorative:s,altText:n}=this.serializeAltText(!1);if(!s&&n&&(i.accessibilityData={type:"Figure",alt:n}),this.annotationElementId){let o=this.#b(i);if(o.isSame)return null;o.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,t===null)return i;t.stamps||=new Map;let a=this.#h?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:a,serialized:i}),i.bitmap=this.#g(!1);else if(this.#h){let o=t.stamps.get(this.#e);a>o.area&&(o.area=a,o.serialized.bitmap.close(),o.serialized.bitmap=this.#g(!1))}return i}#b(e){let{pageIndex:t,accessibilityData:{altText:i}}=this._initialData,s=e.pageIndex===t,n=(e.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&n,isSameAltText:n}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}},Xh=(()=>{class c{#t;#e=!1;#i=null;#s=null;#r=null;#n=new Map;#l=!1;#o=!1;#h=!1;#c=null;#u=null;#d=null;#f=null;#a;static _initialized=!1;static#p=new Map([Ma,Oa,Fa,xn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:i,div:s,structTreeLayer:n,accessibilityManager:a,annotationLayer:o,drawLayer:h,textLayer:d,viewport:f,l10n:m}){let b=[...c.#p.values()];if(!c._initialized){c._initialized=!0;for(let _ of b)_.initialize(m,t)}t.registerEditorTypes(b),this.#a=t,this.pageIndex=i,this.div=s,this.#t=a,this.#i=o,this.viewport=f,this.#d=d,this.drawLayer=h,this._structTree=n,this.#a.addLayer(this)}get isEmpty(){return this.#n.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===ft.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#v(),t){case ft.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ft.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ft.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:i}=this.div;for(let s of c.#p.values())i.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#d?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}enable(){return Q(this,null,function*(){this.#h=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);let t=new Set;for(let s of this.#n.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#a.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!this.#i){this.#h=!1;return}let i=this.#i.getEditableAnnotations();for(let s of i){if(s.hide(),this.#a.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;let n=yield this.deserialize(s);n&&(this.addOrRebuild(n),n.enableEditing())}this.#h=!1})}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);let t=new Map,i=new Map;for(let n of this.#n.values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){t.set(n.annotationElementId,n);continue}else i.set(n.annotationElementId,n);this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()}if(this.#i){let n=this.#i.getEditableAnnotations();for(let a of n){let{id:o}=a.data;if(this.#a.isDeletedAnnotationElement(o))continue;let h=i.get(o);if(h){h.resetAnnotationElement(a),h.show(!1),a.show();continue}h=t.get(o),h&&(this.#a.addChangedExistingAnnotation(h),h.renderAnnotationElement(a)&&h.show(!1)),a.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);let{classList:s}=this.div;for(let n of c.#p.values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;let t=this.#a.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#m(t){this.#a.unselectAll();let{target:i}=t;if(i===this.#d.div||(i.getAttribute("role")==="img"||i.classList.contains("endOfContent"))&&this.#d.div.contains(i)){let{isMac:s}=Xt.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#a.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),xn.startHighlighting(this,this.#a.direction==="ltr",{target:this.#d.div,x:t.x,y:t.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#s)return;this.#s=new AbortController;let t=this.#a.combinedSignal(this.#s);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});let i=this.pointerup.bind(this);this.div.addEventListener("pointerup",i,{signal:t}),this.div.addEventListener("pointercancel",i,{signal:t})}disableClick(){this.#s?.abort(),this.#s=null}attach(t){this.#n.set(t.id,t);let{annotationElementId:i}=t;i&&this.#a.isDeletedAnnotationElement(i)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#n.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),Bt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){let i=t.render();this.div.append(i),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#h),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;let{activeElement:i}=document;t.div.contains(i)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),i.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){let i=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:i,undo:s,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return c.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#b(t){let i=this.#g;return i?new i.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}pasteEditor(t,i){this.#a.updateToolbar(t),this.#a.updateMode(t);let{offsetX:s,offsetY:n}=this.#_(),a=this.getNextId(),o=this.#b(Ue({parent:this,id:a,x:s,y:n,uiManager:this.#a,isCentered:!0},i));o&&this.add(o)}deserialize(t){return Q(this,null,function*(){return(yield c.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a))||null})}createAndAddNewEditor(t,i,s={}){let n=this.getNextId(),a=this.#b(Ue({parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:i},s));return a&&this.add(a),a}#_(){let{x:t,y:i,width:s,height:n}=this.div.getBoundingClientRect(),a=Math.max(0,t),o=Math.max(0,i),h=Math.min(window.innerWidth,t+s),d=Math.min(window.innerHeight,i+n),f=(a+h)/2-t,m=(o+d)/2-i,[b,_]=this.viewport.rotation%180===0?[f,m]:[m,f];return{offsetX:b,offsetY:_}}addNewEditor(){this.createAndAddNewEditor(this.#_(),!0)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){let{isMac:i}=Xt.platform;if(!(t.button!==0||t.ctrlKey&&i)&&t.target===this.div&&this.#l&&(this.#l=!1,!(this.#g?.isDrawer&&this.#g.supportMultipleDrawings))){if(!this.#e){this.#e=!0;return}if(this.#a.getMode()===ft.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#a.getMode()===ft.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}let{isMac:i}=Xt.platform;if(t.button!==0||t.ctrlKey&&i||t.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(t);return}let s=this.#a.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#c){this.#g.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;let i=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#u=null,this.commitOrRemove())},{signal:i}),this.#g.startDrawing(this,this.#a,!1,t)}pause(t){if(t){let{activeElement:i}=document;this.div.contains(i)&&(this.#u=i);return}this.#u&&setTimeout(()=>{this.#u?.focus(),this.#u=null},0)}endDrawingSession(t=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#u=null,this.#g.endDrawing(t)):null}findNewParent(t,i,s){let n=this.#a.findParent(i,s);return n===null||n===this?!1:(n.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(let t of this.#n.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#n.clear(),this.#a.removeLayer(this)}#v(){for(let t of this.#n.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,fi(this.div,t);for(let i of this.#a.getEditors(this.pageIndex))this.add(i),i.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#v();let i=this.viewport.rotation,s=t.rotation;if(this.viewport=t,fi(this.div,{rotation:s}),i!==s)for(let n of this.#n.values())n.rotate(s)}get pageDimensions(){let{pageWidth:t,pageHeight:i}=this.viewport.rawDims;return[t,i]}get scale(){return this.#a.viewParameters.realScale}}return c})(),Ba=class c{#t=null;#e=0;#i=new Map;#s=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#t){this.#t=e;return}if(this.#t!==e){if(this.#i.size>0)for(let t of this.#i.values())t.remove(),e.append(t);this.#t=e}}static get _svgFactory(){return bt(this,"_svgFactory",new ds)}static#r(e,[t,i,s,n]){let{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*n}%`}#n(){let e=c._svgFactory.create(1,1,!0);return this.#t.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){let i=c._svgFactory.createElement("clipPath");e.append(i);let s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");let n=c._svgFactory.createElement("use");return i.append(n),n.setAttribute("href",`#${t}`),n.classList.add("clip"),s}#o(e,t){for(let[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)}draw(e,t=!1,i=!1){let s=this.#e++,n=this.#n(),a=c._svgFactory.createElement("defs");n.append(a);let o=c._svgFactory.createElement("path");a.append(o);let h=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",h),o.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#s.set(s,o);let d=i?this.#l(a,h):null,f=c._svgFactory.createElement("use");return n.append(f),f.setAttribute("href",`#${h}`),this.updateProperties(n,e),this.#i.set(s,n),{id:s,clipPathId:`url(#${d})`}}drawOutline(e,t){let i=this.#e++,s=this.#n(),n=c._svgFactory.createElement("defs");s.append(n);let a=c._svgFactory.createElement("path");n.append(a);let o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){let m=c._svgFactory.createElement("mask");n.append(m),h=`mask_p${this.pageIndex}_${i}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");let b=c._svgFactory.createElement("rect");m.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");let _=c._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${o}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}let d=c._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${o}`),h&&d.setAttribute("mask",`url(#${h})`);let f=d.cloneNode();return s.append(f),d.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#i.set(i,s),i}finalizeDraw(e,t){this.#s.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;let{root:i,bbox:s,rootClass:n,path:a}=t,o=typeof e=="number"?this.#i.get(e):e;if(o){if(i&&this.#o(o,i),s&&c.#r(o,s),n){let{classList:h}=o;for(let[d,f]of Object.entries(n))h.toggle(d,f)}if(a){let d=o.firstChild.firstChild;this.#o(d,a)}}}updateParent(e,t){if(t===this)return;let i=this.#i.get(e);i&&(t.#t.append(i),this.#i.delete(e),t.#i.set(e,i))}remove(e){this.#s.delete(e),this.#t!==null&&(this.#i.get(e).remove(),this.#i.delete(e))}destroy(){this.#t=null;for(let e of this.#i.values())e.remove();this.#i.clear(),this.#s.clear()}};globalThis.pdfjsTestingUtils={HighlightOutliner:ps};var pd=ht.AbortException,gd=ht.AnnotationEditorLayer,md=ht.AnnotationEditorParamsType,bd=ht.AnnotationEditorType,vd=ht.AnnotationEditorUIManager,yd=ht.AnnotationLayer,_d=ht.AnnotationMode,Ad=ht.ColorPicker,wd=ht.DOMSVGFactory,xd=ht.DrawLayer,Sd=ht.FeatureTest,Pl=ht.GlobalWorkerOptions,Ed=ht.ImageKind,Cd=ht.InvalidPDFException,Td=ht.MissingPDFException,kd=ht.OPS,Pd=ht.OutputScale,Md=ht.PDFDataRangeTransport,Id=ht.PDFDateString,Ld=ht.PDFWorker,Rd=ht.PasswordResponses,Dd=ht.PermissionFlag,Nd=ht.PixelsPerInch,Od=ht.RenderingCancelledException,Fd=ht.TextLayer,Bd=ht.TouchManager,Hd=ht.UnexpectedResponseException,jd=ht.Util,Vd=ht.VerbosityLevel,zd=ht.XfaLayer,Ud=ht.build,$d=ht.createValidAbsoluteUrl,Gd=ht.fetchData,Ua=ht.getDocument,Wd=ht.getFilenameFromUrl,qd=ht.getPdfFilenameFromUrl,Xd=ht.getXfaPageViewport,Yd=ht.isDataScheme,Kd=ht.isPdfFile,Qd=ht.noContextMenu,Jd=ht.normalizeUnicode,Zd=ht.setLayerDimensions,tu=ht.shadow,eu=ht.stopEvent,iu=ht.version;var Yh=["wrap"],Kh=["flipbook"];function Qh(c,e){if(c&1){let t=xe();z(0,"div",10)(1,"button",11),kt("click",function(){Lt(t);let s=ut();return Rt(s.volver())}),et(2,"Volver"),U(),z(3,"button",12),kt("click",function(){Lt(t);let s=ut();return Rt(s.prev())}),et(4,"Anterior"),U(),z(5,"button",12),kt("click",function(){Lt(t);let s=ut();return Rt(s.next())}),et(6,"Siguiente"),U(),At(7,"div",13),z(8,"button",14),kt("click",function(){Lt(t);let s=ut();return Rt(s.zoomOut())}),At(9,"i",15),U(),z(10,"button",14),kt("click",function(){Lt(t);let s=ut();return Rt(s.zoomIn())}),At(11,"i",16),U(),z(12,"button",14),kt("click",function(){Lt(t);let s=ut();return Rt(s.resetZoom())}),et(13),Oo(14,"number"),U(),z(15,"button",14),kt("click",function(){Lt(t);let s=ut();return Rt(s.fitToScreen())}),et(16," Ajustar "),U(),z(17,"button",14),kt("click",function(){Lt(t);let s=ut();return Rt(s.fitWide())}),et(18," Ancho 100% "),U(),z(19,"button",17),kt("click",function(){Lt(t);let s=ut();return Rt(s.toggleFullscreen())}),At(20,"i",18),U()()}if(c&2){let t=ut();q(8),nt("disabled",t.isLoading),q(2),nt("disabled",t.isLoading),q(2),nt("disabled",t.isLoading),q(),pe(" ",Fo(14,8,t.zoom*100,"1.0-0"),"% "),q(2),nt("disabled",t.isLoading),q(2),nt("disabled",t.isLoading),q(2),nt("disabled",t.isLoading),q(),nt("ngClass",t.isFullscreen?"bi-fullscreen-exit":"bi-fullscreen")}}function Jh(c,e){c&1&&(z(0,"div",19)(1,"span",20),et(2,"Teclado: \u2190/\u2192 para p\xE1ginas | PageUp/PageDown | Home/End"),U(),z(3,"span",21),et(4,"Usa botones/esquinas para pasar p\xE1ginas"),U()())}function Zh(c,e){if(c&1){let t=xe();z(0,"div",22)(1,"div",23),et(2,"Abriendo el PDF en otra pesta\xF1a\u2026"),U(),z(3,"div",24)(4,"a",25),et(5,"Abrir PDF"),U(),z(6,"a",26),et(7,"Descargar"),U(),z(8,"button",27),kt("click",function(){Lt(t);let s=ut();return Rt(s.volver())}),et(9,"Volver"),U()(),z(10,"div",28),et(11," Si tu navegador bloquea ventanas emergentes, usa \u201CAbrir PDF\u201D. "),U()()}if(c&2){let t=ut();q(4),nt("href",t.mobilePdfUrl,rr),q(2),nt("href",t.mobilePdfUrl,rr)}}function td(c,e){c&1&&(z(0,"div",34)(1,"div",35),et(2,"Cargando PDF..."),U()())}function ed(c,e){if(c&1&&(z(0,"div",34)(1,"div",36),et(2),U()()),c&2){let t=ut(2);q(2),$e(t.errorMsg)}}function id(c,e){if(c&1){let t=xe();z(0,"div",29,0),kt("contextmenu",function(s){return Lt(t),Rt(s.preventDefault())}),At(2,"div",30,1),z(4,"button",31),kt("click",function(){Lt(t);let s=ut();return Rt(s.prev())}),et(5," \u2039 "),U(),z(6,"button",32),kt("click",function(){Lt(t);let s=ut();return Rt(s.next())}),et(7," \u203A "),U(),oe(8,td,3,0,"div",33)(9,ed,3,1,"div",33),U()}if(c&2){let t=ut();Xi("mobile-mode",t.displayMode==="single"),q(2),Xi("is-hidden",!!t.errorMsg),q(2),nt("disabled",t.isLoading||!!t.errorMsg),q(2),nt("disabled",t.isLoading||!!t.errorMsg),q(2),nt("ngIf",t.isLoading),q(),nt("ngIf",!t.isLoading&&t.errorMsg)}}var Oi=class Oi{constructor(e,t,i,s){this.route=e;this.router=t;this.api=i;this.http=s;this.ruta=Os.ruta;this.id=0;this.titulo="";this.pdfUrl="";this.mobileExternal=!1;this.mobilePdfUrl="";this.mobilePopup=null;this.isLoading=!0;this.errorMsg="";this.zoom=1;this.isFullscreen=!1;this.zoomOverridden=!1;this.turnInitialized=!1;this.pdfDisableWorker=!1;this.pageCount=0;this.currentPage=1;this.basePageWidth=0;this.basePageHeight=0;this.zoomMin=.5;this.zoomMax=2.5;this.zoomStep=.1;this.displayMode="double";this.onFullscreenChangeBound=()=>this.onFullscreenChange();this.onKeydownBound=e=>this.onKeydown(e);this.touchStartX=0;this.touchStartY=0;this.onTouchStartBound=e=>this.onTouchStart(e);this.onTouchEndBound=e=>this.onTouchEnd(e);Pl.workerSrc=new URL("assets/pdfjs/pdf.worker.min.mjs",document.baseURI).toString()}fetchPdfAsArrayBuffer(e){return Q(this,null,function*(){let t=yield ko(this.http.get(e,{responseType:"arraybuffer"})),i=new Uint8Array(t.slice(0,5));if(String.fromCharCode(...Array.from(i))!=="%PDF-")throw new Error("El recurso no parece ser un PDF (posible login/HTML/JSON).");return t})}ngAfterViewInit(){if(document.addEventListener("fullscreenchange",this.onFullscreenChangeBound),document.addEventListener("keydown",this.onKeydownBound),this.displayMode=this.computeDisplayMode(),this.displayMode==="single")try{this.mobilePopup=window.open("about:blank","_blank","noopener,noreferrer")}catch{this.mobilePopup=null}if(this.bindTouchNavigation(),typeof ResizeObserver<"u"&&(this.resizeObs=new ResizeObserver(()=>{this.resizeTimer&&window.clearTimeout(this.resizeTimer),this.resizeTimer=window.setTimeout(()=>{let e=this.computeDisplayMode();e!==this.displayMode&&this.switchDisplayMode(e),!this.isLoading&&!this.errorMsg&&this.applyBestFit(!1)},80)}),this.wrapRef?.nativeElement&&this.resizeObs.observe(this.wrapRef.nativeElement)),this.id=Number(this.route.snapshot.paramMap.get("id")??0),!this.id){this.errorMsg="ID inv\xE1lido",this.isLoading=!1;return}this.api.seleccionar(this.id).subscribe({next:e=>Q(this,null,function*(){let t=e?.data;this.titulo=t?.nombre_documento??"";let i=(t?.archivo??"").toString();if(i.startsWith("http://")||i.startsWith("https://"))this.pdfUrl=i;else{let s=(this.ruta??"").toString().trim();s.startsWith("http://")||s.startsWith("https://")?this.pdfUrl=new URL(i,s).toString():this.pdfUrl=i.startsWith("/")?i:"/"+i}if(this.displayMode==="single"){this.mobileExternal=!0,this.mobilePdfUrl=this.pdfUrl,this.isLoading=!1,this.openPdfPuroMobile();return}try{yield this.ensureTurnLoaded(),yield this.renderPdfToFlipbook(this.pdfUrl),this.isLoading=!1}catch(s){console.error(s),this.errorMsg=this.toUserError(s),this.isLoading=!1}}),error:e=>{console.error(e),this.errorMsg="No se pudo cargar el documento",this.isLoading=!1}})}ngOnDestroy(){document.removeEventListener("fullscreenchange",this.onFullscreenChangeBound),document.removeEventListener("keydown",this.onKeydownBound),this.unbindTouchNavigation();try{this.resizeObs?.disconnect()}catch{}this.resizeTimer&&window.clearTimeout(this.resizeTimer),this.destroyTurn()}openPdfPuroMobile(){let e=this.mobilePdfUrl||this.pdfUrl;if(e){try{if(this.mobilePopup&&!this.mobilePopup.closed){this.mobilePopup.location.href=e;return}}catch{}try{if(window.open(e,"_blank","noopener,noreferrer"))return}catch{}window.location.href=e}}volver(){this.router.navigate(["/gestioninstitucion/biblioteca"])}prev(){if(this.displayMode==="single"){this.setCurrentPage(this.currentPage-1);return}if(!this.turnInitialized)return;let e=this.getJQuery();e&&e(this.flipbookRef.nativeElement).turn("previous")}next(){if(this.displayMode==="single"){this.setCurrentPage(this.currentPage+1);return}if(!this.turnInitialized)return;let e=this.getJQuery();e&&e(this.flipbookRef.nativeElement).turn("next")}zoomIn(){this.setZoomManual(this.zoom+this.zoomStep)}zoomOut(){this.setZoomManual(this.zoom-this.zoomStep)}resetZoom(){this.setZoomManual(1)}fitToScreen(){let e=this.computeFitZoom("fit");this.setZoomAuto(e)}fitWide(){let e=this.computeFitZoom("wide");this.setZoomAuto(e)}applyBestFit(e=!1){!e&&this.zoomOverridden||(this.displayMode==="single"?this.fitToScreen():this.fitWide())}setZoomManual(e){this.zoomOverridden=!0,this.setZoom(e)}setZoomAuto(e){this.zoomOverridden=!1,this.setZoom(e)}toggleFullscreen(){return Q(this,null,function*(){let e=this.wrapRef?.nativeElement;if(e)try{document.fullscreenElement?yield document.exitFullscreen():yield e.requestFullscreen()}catch(t){console.warn("No se pudo activar fullscreen",t)}})}destroyTurn(){try{if(this.turnInitialized&&this.flipbookRef?.nativeElement){let e=this.getJQuery();if(!e)return;e(this.flipbookRef.nativeElement).turn("destroy")}}catch{}this.turnInitialized=!1}setZoom(e){let t=Math.max(this.zoomMin,Math.min(this.zoomMax,Number(e.toFixed(2))));this.zoom=t,this.applyBookSize()}computeFitZoom(e){if(!this.basePageWidth||!this.basePageHeight)return 1;let t=this.wrapRef?.nativeElement;if(!t)return 1;let i=24,s=Math.max(200,t.clientWidth-i-2),n=Math.max(200,t.clientHeight-i),a=this.displayMode==="double"?2:1,o=this.basePageWidth*a,h=this.basePageHeight,d=s/o,f=n/h;if(e==="fit"){let b=Math.min(d,f);return Math.max(this.zoomMin,Math.min(this.zoomMax,Number(b.toFixed(2))))}let m=d;return Math.max(this.zoomMin,Math.min(this.zoomMax,Number(m.toFixed(2))))}applyBookSize(){if(!this.flipbookRef?.nativeElement||!this.basePageWidth||!this.basePageHeight)return;let e=this.zoom||1,t=Math.round(this.basePageWidth*e),i=Math.round(this.basePageHeight*e),s=this.displayMode==="double"?2:1,n=t*s,a=i,o=this.flipbookRef.nativeElement;if(o.style.width=n+"px",o.style.height=a+"px",o.querySelectorAll(".page").forEach(d=>{d.style.width=t+"px",d.style.height=i+"px"}),this.turnInitialized){let d=this.getJQuery();if(!d)return;try{d(o).turn("size",n,a)}catch{}}}computeDisplayMode(){return(window.innerWidth||1024)<992?"single":"double"}applyTurnDisplayMode(){if(!this.turnInitialized||!this.flipbookRef?.nativeElement)return;let e=this.getJQuery();if(e){try{e(this.flipbookRef.nativeElement).turn("display",this.displayMode)}catch{}this.applyBookSize()}}onFullscreenChange(){this.isFullscreen=!!document.fullscreenElement,setTimeout(()=>{this.applyBestFit(!1)},50)}onKeydown(e){if(!this.isLoading&&!this.errorMsg&&!this.mobileExternal){let n=(e.key||"").toLowerCase();if((e.ctrlKey||e.metaKey)&&(n==="s"||n==="p"||n==="u")){e.preventDefault();return}}if(!this.turnInitialized||this.isLoading||this.errorMsg)return;let t=e.target,i=(t?.tagName??"").toLowerCase();if(!(i==="input"||i==="textarea"||t?.isContentEditable||i==="select")){if(e.key==="ArrowLeft"||e.key==="PageUp"){e.preventDefault(),this.prev();return}if(e.key==="ArrowRight"||e.key==="PageDown"||e.key===" "){e.preventDefault(),this.next();return}if(e.key==="Home"){e.preventDefault();let n=this.getJQuery();if(!n)return;try{n(this.flipbookRef.nativeElement).turn("page",1)}catch{}}if(e.key==="End"){e.preventDefault();let n=this.getJQuery();if(!n)return;try{n(this.flipbookRef.nativeElement).turn("page","last")}catch{}}}}renderPdfToFlipbook(e){return Q(this,null,function*(){if(!this.flipbookRef?.nativeElement)return;this.destroyTurn(),this.flipbookRef.nativeElement.innerHTML="";let t;try{let o=yield this.fetchPdfAsArrayBuffer(e),h=new Uint8Array(o);t=yield Ua({data:h,disableWorker:this.pdfDisableWorker}).promise}catch(o){let h=(o?.message??"").toString();if(!this.pdfDisableWorker&&/worker|pdf\.worker|ERR_ABORTED|404/i.test(h)){this.pdfDisableWorker=!0;let d=yield this.fetchPdfAsArrayBuffer(e),f=new Uint8Array(d);t=yield Ua({data:f,disableWorker:!0}).promise}else throw o}let i=0,s=0;this.pageCount=t.numPages,this.currentPage=1;for(let o=1;o<=t.numPages;o++){let h=yield t.getPage(o),d=h.getViewport({scale:1.35});o===1&&(i=Math.round(d.width),s=Math.round(d.height));let f=document.createElement("canvas");f.width=Math.round(d.width),f.height=Math.round(d.height);let m=f.getContext("2d");if(!m)continue;yield h.render({canvasContext:m,viewport:d}).promise;let b=document.createElement("div");b.className="page",b.dataset.page=String(o),b.style.width=f.width+"px",b.style.height=f.height+"px",b.appendChild(f),this.flipbookRef.nativeElement.appendChild(b)}let n=i>0?i:900,a=s>0?s:600;this.basePageWidth=n,this.basePageHeight=a,this.displayMode=this.computeDisplayMode(),this.zoomOverridden=!1,this.displayMode==="double"?yield this.initTurnDouble():(this.destroyTurn(),this.turnInitialized=!1,this.setZoomAuto(this.computeFitZoom("fit")),this.setCurrentPage(1)),setTimeout(()=>this.applyBestFit(!1),0)})}initTurnDouble(){return Q(this,null,function*(){this.showAllPages(),this.zoom=this.computeFitZoom("wide"),this.applyBookSize();let e=Math.round(this.basePageWidth*2*this.zoom),t=Math.round(this.basePageHeight*this.zoom);this.assertTurnLoaded()(this.flipbookRef.nativeElement).turn({width:e,height:t,display:"double",autoCenter:!0,gradients:!0,elevation:50}),this.turnInitialized=!0,this.applyBookSize(),this.setTurnPageSafe(this.currentPage)})}switchDisplayMode(e){if(this.displayMode==="double"&&(this.currentPage=this.getTurnPageSafe()??this.currentPage),this.displayMode=e,this.zoomOverridden=!1,e==="single"){this.destroyTurn(),this.turnInitialized=!1,this.setZoomAuto(this.computeFitZoom("fit")),this.setCurrentPage(this.currentPage);return}!this.basePageWidth||!this.basePageHeight||this.initTurnDouble().catch(()=>{})}setCurrentPage(e){let t=Math.max(1,Math.min(this.pageCount||1,e));if(this.currentPage=t,this.displayMode==="double"){this.setTurnPageSafe(t);return}this.showOnlyPage(t)}showOnlyPage(e){let t=this.flipbookRef?.nativeElement;if(!t)return;t.querySelectorAll(".page").forEach(s=>{let n=Number(s.dataset.page??"0")===e;s.classList.toggle("is-active",n)})}showAllPages(){let e=this.flipbookRef?.nativeElement;if(!e)return;e.querySelectorAll(".page").forEach(i=>i.classList.add("is-active"))}getTurnPageSafe(){if(!this.turnInitialized)return null;let e=this.getJQuery();if(!e)return null;try{let t=e(this.flipbookRef.nativeElement).turn("page"),i=Number(t);return Number.isFinite(i)?i:null}catch{return null}}setTurnPageSafe(e){if(!this.turnInitialized)return;let t=this.getJQuery();if(t)try{t(this.flipbookRef.nativeElement).turn("page",e)}catch{}}bindTouchNavigation(){let e=this.wrapRef?.nativeElement;e&&(e.addEventListener("touchstart",this.onTouchStartBound,{passive:!0}),e.addEventListener("touchend",this.onTouchEndBound,{passive:!1}))}unbindTouchNavigation(){let e=this.wrapRef?.nativeElement;e&&(e.removeEventListener("touchstart",this.onTouchStartBound),e.removeEventListener("touchend",this.onTouchEndBound))}onTouchStart(e){if(!e.touches?.length)return;let t=e.touches[0];this.touchStartX=t.clientX,this.touchStartY=t.clientY}onTouchEnd(e){if(this.displayMode==="single"||!this.turnInitialized||this.isLoading||this.errorMsg)return;let t=e.changedTouches?.[0];if(!t)return;let i=t.clientX-this.touchStartX,s=t.clientY-this.touchStartY;Math.abs(i)<45||Math.abs(i)<Math.abs(s)||(e.preventDefault(),i>0?this.prev():this.next())}toUserError(e){let t=e?.message?String(e.message):"";return/Turn\.js no est[a] cargado/i.test(t)||/turn/i.test(t)?"No se pudo iniciar el visor (Turn.js no est\xE1 cargado)":/jQuery no est[a] cargado/i.test(t)||/jquery/i.test(t)?"No se pudo iniciar el visor (jQuery no est\xE1 cargado)":/worker|pdf\.worker|ERR_ABORTED|404/i.test(t)?"No se pudo cargar el worker de PDF.js (se intentar\xE1 sin worker). Recarga e intenta de nuevo.":/Invalid PDF structure/i.test(t)||/no parece ser un PDF/i.test(t)?"El archivo no se pudo abrir: el servidor no devolvi\xF3 un PDF v\xE1lido (revisar que el enlace sea p\xFAblico o que el token est\xE9 activo).":"No se pudo renderizar el PDF"}getJQuery(){return window.jQuery||window.$||null}ensureWindowJQuery(){let e=this.getJQuery();if(e)return e;let t=$a.default??$a;return window.jQuery=t,window.$=t,t}loadScriptOnce(e){return new Promise((t,i)=>{let s=document.querySelector(`script[data-lcch-src="${e}"]`);if(s){if(s.dataset?.loaded==="1")return t();s.addEventListener("load",()=>t()),s.addEventListener("error",()=>i(new Error(`No se pudo cargar: ${e}`)));return}let n=document.createElement("script");n.src=e,n.defer=!0,n.dataset.lcchSrc=e,n.addEventListener("load",()=>{n.dataset.loaded="1",t()}),n.addEventListener("error",()=>i(new Error(`No se pudo cargar: ${e}`))),document.head.appendChild(n)})}assertTurnLoaded(){let e=this.ensureWindowJQuery();if(!e)throw new Error("jQuery no est\xE1 cargado");if(!e.fn||!e.fn.turn)throw new Error("Turn.js no est\xE1 cargado");return e}ensureTurnLoaded(e=4e3){return Q(this,null,function*(){if(this.ensureWindowJQuery(),!this.getJQuery()?.fn?.turn){let i=["/assets/angular/browser/assets/turnlcch/lib/turn.min.js","/assets/turnlcch/lib/turn.min.js"],s=!1;for(let n of i)try{yield this.loadScriptOnce(n),s=!0;break}catch{}}let t=Date.now();for(;Date.now()-t<e;)try{this.assertTurnLoaded();return}catch{yield new Promise(i=>setTimeout(i,50))}this.assertTurnLoaded()})}};Oi.\u0275fac=function(t){return new(t||Oi)(Ne(zo),Ne(Ns),Ne(Fs),Ne(Vo))},Oi.\u0275cmp=Is({type:Oi,selectors:[["app-visor-biblioteca"]],viewQuery:function(t,i){if(t&1&&(ar(Yh,5),ar(Kh,5)),t&2){let s;or(s=lr())&&(i.wrapRef=s.first),or(s=lr())&&(i.flipbookRef=s.first)}},standalone:!1,decls:11,vars:5,consts:[["wrap",""],["flipbook",""],[1,"container-fluid","py-3","px-2"],[1,"d-flex","align-items-center","justify-content-between","mb-2"],[1,"small","text-muted"],[1,"fw-semibold"],["class","d-flex gap-2 flex-wrap justify-content-end",4,"ngIf"],["class","small text-muted mb-2",4,"ngIf"],["class","p-3",4,"ngIf"],["class","flipbook-wrap",3,"mobile-mode","contextmenu",4,"ngIf"],[1,"d-flex","gap-2","flex-wrap","justify-content-end"],[1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"vr","d-none","d-md-block"],[1,"btn","btn-outline-secondary","btn-sm",3,"click","disabled"],[1,"bi","bi-zoom-out"],[1,"bi","bi-zoom-in"],[1,"btn","btn-outline-dark","btn-sm",3,"click","disabled"],[1,"bi",3,"ngClass"],[1,"small","text-muted","mb-2"],[1,"d-none","d-lg-inline"],[1,"d-lg-none"],[1,"p-3"],[1,"alert","alert-info","mb-2"],[1,"d-flex","gap-2","flex-wrap"],["target","_blank","rel","noopener noreferrer",1,"btn","btn-primary",3,"href"],["download","",1,"btn","btn-outline-secondary",3,"href"],[1,"btn","btn-outline-secondary",3,"click"],[1,"small","text-muted","mt-2"],[1,"flipbook-wrap",3,"contextmenu"],[1,"flipbook"],["type","button","aria-label","P\xE1gina anterior",1,"corner-nav","corner-left","d-lg-none",3,"click","disabled"],["type","button","aria-label","P\xE1gina siguiente",1,"corner-nav","corner-right","d-lg-none",3,"click","disabled"],["class","overlay",4,"ngIf"],[1,"overlay"],[1,"text-center","py-4"],[1,"alert","alert-danger","m-0"]],template:function(t,i){t&1&&(z(0,"div",2)(1,"div",3)(2,"div")(3,"div",4),et(4,"Visor"),U(),z(5,"div",5),et(6),U()(),oe(7,Qh,21,11,"div",6),U(),oe(8,Jh,5,0,"div",7)(9,Zh,12,2,"div",8)(10,id,10,8,"div",9),U()),t&2&&(q(6),$e(i.titulo),q(),nt("ngIf",!i.mobileExternal),q(),nt("ngIf",!i.mobileExternal),q(),nt("ngIf",i.mobileExternal),q(),nt("ngIf",!i.mobileExternal))},dependencies:[Rs,Ds,Ho],styles:['@charset "UTF-8";.flipbook-wrap[_ngcontent-%COMP%]{position:relative;width:100%;min-height:520px;overflow-x:auto;overflow-y:auto;-webkit-overflow-scrolling:touch;display:flex;align-items:flex-start;justify-content:center;padding:10px;background:#f5f6f8;border-radius:12px;user-select:none;-webkit-user-select:none}.flipbook-wrap[_ngcontent-%COMP%]:fullscreen{width:100vw;height:100vh;min-height:100vh;padding:16px;background:#f5f6f8;border-radius:0}.flipbook[_ngcontent-%COMP%]{background:#fff;box-shadow:0 12px 30px #0000001f;overflow:hidden}.flipbook.is-hidden[_ngcontent-%COMP%]{display:none}.page[_ngcontent-%COMP%]{background:#fff;overflow:hidden}.flipbook-wrap.mobile-mode[_ngcontent-%COMP%]   .page[_ngcontent-%COMP%]{display:none}.flipbook-wrap.mobile-mode[_ngcontent-%COMP%]   .page.is-active[_ngcontent-%COMP%]{display:block}.page[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:12px;background:#f5f6f8e6;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.corner-nav[_ngcontent-%COMP%]{position:absolute;bottom:12px;z-index:5;width:44px;height:44px;border-radius:999px;border:1px solid rgba(0,0,0,.15);background:#ffffffe6;box-shadow:0 8px 18px #0000001f;color:#111;font-size:26px;line-height:1;display:inline-flex;align-items:center;justify-content:center}.corner-nav[_ngcontent-%COMP%]:disabled{opacity:.45}.corner-left[_ngcontent-%COMP%]{left:12px}.corner-right[_ngcontent-%COMP%]{right:12px}@media (max-width: 991.98px){.flipbook-wrap[_ngcontent-%COMP%]{height:calc(100dvh - 210px);max-height:calc(100dvh - 210px);min-height:320px;padding:8px}}']});var Dn=Oi;var sd=[{path:"biblioteca",component:Bs},{path:"visor-biblioteca/:id",component:Dn}],mi=class mi{};mi.\u0275fac=function(t){return new(t||mi)},mi.\u0275mod=Ls({type:mi}),mi.\u0275inj=Ms({imports:[ur.forChild(sd),ur]});var Nn=mi;var bi=class bi{};bi.\u0275fac=function(t){return new(t||bi)},bi.\u0275mod=Ls({type:bi}),bi.\u0275inj=Ms({imports:[jo,il,Qo,Jo,Nn]});var Ml=bi;export{Bs as a,Ml as b};
